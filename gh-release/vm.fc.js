"use strict";var e=require("zlib"),t=require("crypto");require("vm");var n=require("path"),r=require("fs"),o=require("json5"),i=require("got");function a(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function s(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}var c=s(t),u=s(n),f=s(r),l=s(o),d=a(i),p="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},g=function(e){return e&&e.Math==Math&&e},m=g("object"==typeof globalThis&&globalThis)||g("object"==typeof window&&window)||g("object"==typeof self&&self)||g("object"==typeof p&&p)||function(){return this}()||Function("return this")(),h={},y=function(e){try{return!!e()}catch(e){return!0}},v=!y((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),w=!y((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")})),_=w,b=Function.prototype.call,$=_?b.bind(b):function(){return b.apply(b,arguments)},T={},S={}.propertyIsEnumerable,O=Object.getOwnPropertyDescriptor,C=O&&!S.call({1:2},1);T.f=C?function(e){var t=O(this,e);return!!t&&t.enumerable}:S;var k,I,E=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},x=w,P=Function.prototype,j=P.bind,L=P.call,R=x&&j.bind(L,L),A=x?function(e){return e&&R(e)}:function(e){return e&&function(){return L.apply(e,arguments)}},N=A,U=N({}.toString),D=N("".slice),B=function(e){return D(U(e),8,-1)},F=y,z=B,M=Object,J=A("".split),q=F((function(){return!M("z").propertyIsEnumerable(0)}))?function(e){return"String"==z(e)?J(e,""):M(e)}:M,G=TypeError,K=function(e){if(null==e)throw G("Can't call method on "+e);return e},H=q,W=K,Y=function(e){return H(W(e))},Q=function(e){return"function"==typeof e},V=Q,X=function(e){return"object"==typeof e?null!==e:V(e)},Z=m,ee=Q,te=function(e){return ee(e)?e:void 0},ne=function(e,t){return arguments.length<2?te(Z[e]):Z[e]&&Z[e][t]},re=A({}.isPrototypeOf),oe=m,ie=ne("navigator","userAgent")||"",ae=oe.process,se=oe.Deno,ce=ae&&ae.versions||se&&se.version,ue=ce&&ce.v8;ue&&(I=(k=ue.split("."))[0]>0&&k[0]<4?1:+(k[0]+k[1])),!I&&ie&&(!(k=ie.match(/Edge\/(\d+)/))||k[1]>=74)&&(k=ie.match(/Chrome\/(\d+)/))&&(I=+k[1]);var fe=I,le=y,de=!!Object.getOwnPropertySymbols&&!le((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&fe&&fe<41})),pe=de&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,ge=ne,me=Q,he=re,ye=Object,ve=pe?function(e){return"symbol"==typeof e}:function(e){var t=ge("Symbol");return me(t)&&he(t.prototype,ye(e))},we=String,_e=function(e){try{return we(e)}catch(e){return"Object"}},be=Q,$e=_e,Te=TypeError,Se=function(e){if(be(e))return e;throw Te($e(e)+" is not a function")},Oe=Se,Ce=function(e,t){var n=e[t];return null==n?void 0:Oe(n)},ke=$,Ie=Q,Ee=X,xe=TypeError,Pe={exports:{}},je=m,Le=Object.defineProperty,Re=function(e,t){try{Le(je,e,{value:t,configurable:!0,writable:!0})}catch(n){je[e]=t}return t},Ae=Re,Ne=m["__core-js_shared__"]||Ae("__core-js_shared__",{}),Ue=Ne;(Pe.exports=function(e,t){return Ue[e]||(Ue[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.23.5",mode:"global",copyright:"Â© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.23.5/LICENSE",source:"https://github.com/zloirock/core-js"});var De=K,Be=Object,Fe=function(e){return Be(De(e))},ze=Fe,Me=A({}.hasOwnProperty),Je=Object.hasOwn||function(e,t){return Me(ze(e),t)},qe=A,Ge=0,Ke=Math.random(),He=qe(1..toString),We=function(e){return"Symbol("+(void 0===e?"":e)+")_"+He(++Ge+Ke,36)},Ye=m,Qe=Pe.exports,Ve=Je,Xe=We,Ze=de,et=pe,tt=Qe("wks"),nt=Ye.Symbol,rt=nt&&nt.for,ot=et?nt:nt&&nt.withoutSetter||Xe,it=function(e){if(!Ve(tt,e)||!Ze&&"string"!=typeof tt[e]){var t="Symbol."+e;Ze&&Ve(nt,e)?tt[e]=nt[e]:tt[e]=et&&rt?rt(t):ot(t)}return tt[e]},at=$,st=X,ct=ve,ut=Ce,ft=function(e,t){var n,r;if("string"===t&&Ie(n=e.toString)&&!Ee(r=ke(n,e)))return r;if(Ie(n=e.valueOf)&&!Ee(r=ke(n,e)))return r;if("string"!==t&&Ie(n=e.toString)&&!Ee(r=ke(n,e)))return r;throw xe("Can't convert object to primitive value")},lt=TypeError,dt=it("toPrimitive"),pt=function(e,t){if(!st(e)||ct(e))return e;var n,r=ut(e,dt);if(r){if(void 0===t&&(t="default"),n=at(r,e,t),!st(n)||ct(n))return n;throw lt("Can't convert object to primitive value")}return void 0===t&&(t="number"),ft(e,t)},gt=ve,mt=function(e){var t=pt(e,"string");return gt(t)?t:t+""},ht=X,yt=m.document,vt=ht(yt)&&ht(yt.createElement),wt=function(e){return vt?yt.createElement(e):{}},_t=wt,bt=!v&&!y((function(){return 7!=Object.defineProperty(_t("div"),"a",{get:function(){return 7}}).a})),$t=v,Tt=$,St=T,Ot=E,Ct=Y,kt=mt,It=Je,Et=bt,xt=Object.getOwnPropertyDescriptor;h.f=$t?xt:function(e,t){if(e=Ct(e),t=kt(t),Et)try{return xt(e,t)}catch(e){}if(It(e,t))return Ot(!Tt(St.f,e,t),e[t])};var Pt={},jt=v&&y((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),Lt=X,Rt=String,At=TypeError,Nt=function(e){if(Lt(e))return e;throw At(Rt(e)+" is not an object")},Ut=v,Dt=bt,Bt=jt,Ft=Nt,zt=mt,Mt=TypeError,Jt=Object.defineProperty,qt=Object.getOwnPropertyDescriptor;Pt.f=Ut?Bt?function(e,t,n){if(Ft(e),t=zt(t),Ft(n),"function"==typeof e&&"prototype"===t&&"value"in n&&"writable"in n&&!n.writable){var r=qt(e,t);r&&r.writable&&(e[t]=n.value,n={configurable:"configurable"in n?n.configurable:r.configurable,enumerable:"enumerable"in n?n.enumerable:r.enumerable,writable:!1})}return Jt(e,t,n)}:Jt:function(e,t,n){if(Ft(e),t=zt(t),Ft(n),Dt)try{return Jt(e,t,n)}catch(e){}if("get"in n||"set"in n)throw Mt("Accessors not supported");return"value"in n&&(e[t]=n.value),e};var Gt=Pt,Kt=E,Ht=v?function(e,t,n){return Gt.f(e,t,Kt(1,n))}:function(e,t,n){return e[t]=n,e},Wt={exports:{}},Yt=v,Qt=Je,Vt=Function.prototype,Xt=Yt&&Object.getOwnPropertyDescriptor,Zt=Qt(Vt,"name"),en={EXISTS:Zt,PROPER:Zt&&"something"===function(){}.name,CONFIGURABLE:Zt&&(!Yt||Yt&&Xt(Vt,"name").configurable)},tn=Q,nn=Ne,rn=A(Function.toString);tn(nn.inspectSource)||(nn.inspectSource=function(e){return rn(e)});var on,an,sn,cn=nn.inspectSource,un=Q,fn=cn,ln=m.WeakMap,dn=un(ln)&&/native code/.test(fn(ln)),pn=Pe.exports,gn=We,mn=pn("keys"),hn=function(e){return mn[e]||(mn[e]=gn(e))},yn={},vn=dn,wn=m,_n=A,bn=X,$n=Ht,Tn=Je,Sn=Ne,On=hn,Cn=yn,kn=wn.TypeError,In=wn.WeakMap;if(vn||Sn.state){var En=Sn.state||(Sn.state=new In),xn=_n(En.get),Pn=_n(En.has),jn=_n(En.set);on=function(e,t){if(Pn(En,e))throw new kn("Object already initialized");return t.facade=e,jn(En,e,t),t},an=function(e){return xn(En,e)||{}},sn=function(e){return Pn(En,e)}}else{var Ln=On("state");Cn[Ln]=!0,on=function(e,t){if(Tn(e,Ln))throw new kn("Object already initialized");return t.facade=e,$n(e,Ln,t),t},an=function(e){return Tn(e,Ln)?e[Ln]:{}},sn=function(e){return Tn(e,Ln)}}var Rn={set:on,get:an,has:sn,enforce:function(e){return sn(e)?an(e):on(e,{})},getterFor:function(e){return function(t){var n;if(!bn(t)||(n=an(t)).type!==e)throw kn("Incompatible receiver, "+e+" required");return n}}},An=y,Nn=Q,Un=Je,Dn=v,Bn=en.CONFIGURABLE,Fn=cn,zn=Rn.enforce,Mn=Rn.get,Jn=Object.defineProperty,qn=Dn&&!An((function(){return 8!==Jn((function(){}),"length",{value:8}).length})),Gn=String(String).split("String"),Kn=Wt.exports=function(e,t,n){"Symbol("===String(t).slice(0,7)&&(t="["+String(t).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(t="get "+t),n&&n.setter&&(t="set "+t),(!Un(e,"name")||Bn&&e.name!==t)&&(Dn?Jn(e,"name",{value:t,configurable:!0}):e.name=t),qn&&n&&Un(n,"arity")&&e.length!==n.arity&&Jn(e,"length",{value:n.arity});try{n&&Un(n,"constructor")&&n.constructor?Dn&&Jn(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(e){}var r=zn(e);return Un(r,"source")||(r.source=Gn.join("string"==typeof t?t:"")),e};Function.prototype.toString=Kn((function(){return Nn(this)&&Mn(this).source||Fn(this)}),"toString");var Hn=Q,Wn=Pt,Yn=Wt.exports,Qn=Re,Vn={},Xn=Math.ceil,Zn=Math.floor,er=Math.trunc||function(e){var t=+e;return(t>0?Zn:Xn)(t)},tr=function(e){var t=+e;return t!=t||0===t?0:er(t)},nr=tr,rr=Math.max,or=Math.min,ir=tr,ar=Math.min,sr=function(e){return e>0?ar(ir(e),9007199254740991):0},cr=function(e){return sr(e.length)},ur=Y,fr=function(e,t){var n=nr(e);return n<0?rr(n+t,0):or(n,t)},lr=cr,dr=function(e){return function(t,n,r){var o,i=ur(t),a=lr(i),s=fr(r,a);if(e&&n!=n){for(;a>s;)if((o=i[s++])!=o)return!0}else for(;a>s;s++)if((e||s in i)&&i[s]===n)return e||s||0;return!e&&-1}},pr={includes:dr(!0),indexOf:dr(!1)},gr=Je,mr=Y,hr=pr.indexOf,yr=yn,vr=A([].push),wr=function(e,t){var n,r=mr(e),o=0,i=[];for(n in r)!gr(yr,n)&&gr(r,n)&&vr(i,n);for(;t.length>o;)gr(r,n=t[o++])&&(~hr(i,n)||vr(i,n));return i},_r=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],br=wr,$r=_r.concat("length","prototype");Vn.f=Object.getOwnPropertyNames||function(e){return br(e,$r)};var Tr={};Tr.f=Object.getOwnPropertySymbols;var Sr=ne,Or=Vn,Cr=Tr,kr=Nt,Ir=A([].concat),Er=Sr("Reflect","ownKeys")||function(e){var t=Or.f(kr(e)),n=Cr.f;return n?Ir(t,n(e)):t},xr=Je,Pr=Er,jr=h,Lr=Pt,Rr=function(e,t,n){for(var r=Pr(t),o=Lr.f,i=jr.f,a=0;a<r.length;a++){var s=r[a];xr(e,s)||n&&xr(n,s)||o(e,s,i(t,s))}},Ar=y,Nr=Q,Ur=/#|\.prototype\./,Dr=function(e,t){var n=Fr[Br(e)];return n==Mr||n!=zr&&(Nr(t)?Ar(t):!!t)},Br=Dr.normalize=function(e){return String(e).replace(Ur,".").toLowerCase()},Fr=Dr.data={},zr=Dr.NATIVE="N",Mr=Dr.POLYFILL="P",Jr=Dr,qr=m,Gr=h.f,Kr=Ht,Hr=function(e,t,n,r){r||(r={});var o=r.enumerable,i=void 0!==r.name?r.name:t;if(Hn(n)&&Yn(n,i,r),r.global)o?e[t]=n:Qn(t,n);else{try{r.unsafe?e[t]&&(o=!0):delete e[t]}catch(e){}o?e[t]=n:Wn.f(e,t,{value:n,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return e},Wr=Re,Yr=Rr,Qr=Jr,Vr=function(e,t){var n,r,o,i,a,s=e.target,c=e.global,u=e.stat;if(n=c?qr:u?qr[s]||Wr(s,{}):(qr[s]||{}).prototype)for(r in t){if(i=t[r],o=e.dontCallGetSet?(a=Gr(n,r))&&a.value:n[r],!Qr(c?r:s+(u?".":"#")+r,e.forced)&&void 0!==o){if(typeof i==typeof o)continue;Yr(i,o)}(e.sham||o&&o.sham)&&Kr(i,"sham",!0),Hr(n,r,i,e)}},Xr=w,Zr=Function.prototype,eo=Zr.apply,to=Zr.call,no="object"==typeof Reflect&&Reflect.apply||(Xr?to.bind(eo):function(){return to.apply(eo,arguments)}),ro=Q,oo=String,io=TypeError,ao=A,so=Nt,co=function(e){if("object"==typeof e||ro(e))return e;throw io("Can't set "+oo(e)+" as a prototype")},uo=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=ao(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(n,[]),t=n instanceof Array}catch(e){}return function(n,r){return so(n),co(r),t?e(n,r):n.__proto__=r,n}}():void 0),fo=Pt.f,lo=Q,po=X,go=uo,mo={};mo[it("toStringTag")]="z";var ho="[object z]"===String(mo),yo=Q,vo=B,wo=it("toStringTag"),_o=Object,bo="Arguments"==vo(function(){return arguments}()),$o=ho?vo:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=_o(e),wo))?n:bo?vo(t):"Object"==(r=vo(t))&&yo(t.callee)?"Arguments":r},To=$o,So=String,Oo=function(e){if("Symbol"===To(e))throw TypeError("Cannot convert a Symbol value to a string");return So(e)},Co=Oo,ko=function(e,t){return void 0===e?arguments.length<2?"":t:Co(e)},Io=X,Eo=Ht,xo=function(e,t){Io(t)&&"cause"in t&&Eo(e,"cause",t.cause)},Po=Error,jo=A("".replace),Lo=String(Po("zxcasd").stack),Ro=/\n\s*at [^:]*:[^\n]*/,Ao=Ro.test(Lo),No=function(e,t){if(Ao&&"string"==typeof e&&!Po.prepareStackTrace)for(;t--;)e=jo(e,Ro,"");return e},Uo=E,Do=!y((function(){var e=Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",Uo(1,7)),7!==e.stack)})),Bo=ne,Fo=Je,zo=Ht,Mo=re,Jo=uo,qo=Rr,Go=function(e,t,n){n in e||fo(e,n,{configurable:!0,get:function(){return t[n]},set:function(e){t[n]=e}})},Ko=function(e,t,n){var r,o;return go&&lo(r=t.constructor)&&r!==n&&po(o=r.prototype)&&o!==n.prototype&&go(e,o),e},Ho=ko,Wo=xo,Yo=No,Qo=Do,Vo=v,Xo=Vr,Zo=no,ei=function(e,t,n,r){var o="stackTraceLimit",i=r?2:1,a=e.split("."),s=a[a.length-1],c=Bo.apply(null,a);if(c){var u=c.prototype;if(Fo(u,"cause")&&delete u.cause,!n)return c;var f=Bo("Error"),l=t((function(e,t){var n=Ho(r?t:e,void 0),o=r?new c(e):new c;return void 0!==n&&zo(o,"message",n),Qo&&zo(o,"stack",Yo(o.stack,2)),this&&Mo(u,this)&&Ko(o,this,l),arguments.length>i&&Wo(o,arguments[i]),o}));l.prototype=u,"Error"!==s?Jo?Jo(l,f):qo(l,f,{name:!0}):Vo&&o in c&&(Go(l,c,o),Go(l,c,"prepareStackTrace")),qo(l,c);try{u.name!==s&&zo(u,"name",s),u.constructor=l}catch(e){}return l}},ti=m.WebAssembly,ni=7!==Error("e",{cause:7}).cause,ri=function(e,t){var n={};n[e]=ei(e,t,ni),Xo({global:!0,constructor:!0,arity:1,forced:ni},n)},oi=function(e,t){if(ti&&ti[e]){var n={};n[e]=ei("WebAssembly."+e,t,ni),Xo({target:"WebAssembly",stat:!0,constructor:!0,arity:1,forced:ni},n)}};function ii(t){try{const n=e.unzipSync(Buffer.from(t,"base64")).toString();try{return decodeURIComponent(ai(n))}catch(e){return unescape(n)}}catch(e){throw new Error("Error: å½åå­ç¬¦ä¸²ä¸è½è¢«Gzipè§£å")}}function ai(e){return e.replace(/\\u([\d\w]{4})/gi,((e,t)=>String.fromCodePoint(parseInt(t,16))))}ri("Error",(function(e){return function(t){return Zo(e,this,arguments)}})),ri("EvalError",(function(e){return function(t){return Zo(e,this,arguments)}})),ri("RangeError",(function(e){return function(t){return Zo(e,this,arguments)}})),ri("ReferenceError",(function(e){return function(t){return Zo(e,this,arguments)}})),ri("SyntaxError",(function(e){return function(t){return Zo(e,this,arguments)}})),ri("TypeError",(function(e){return function(t){return Zo(e,this,arguments)}})),ri("URIError",(function(e){return function(t){return Zo(e,this,arguments)}})),oi("CompileError",(function(e){return function(t){return Zo(e,this,arguments)}})),oi("LinkError",(function(e){return function(t){return Zo(e,this,arguments)}})),oi("RuntimeError",(function(e){return function(t){return Zo(e,this,arguments)}}));var si=Pt.f,ci=Je,ui=it("toStringTag"),fi=m,li=function(e,t,n){e&&!n&&(e=e.prototype),e&&!ci(e,ui)&&si(e,ui,{configurable:!0,value:t})};Vr({global:!0},{Reflect:{}}),li(fi.Reflect,"Reflect",!0);const di=()=>Boolean(process.env.IS_QING_LONG||process.env.QL_BRANCH);function pi(){return global.IS_CFC||!1}function gi(){return global.IS_CFC||!1}function mi(){const e=di()?"cat_bili_config":"config",t=".json",{BILITOOLS_FILE_NAME:n}=process.env;return n?n.endsWith(t)?n:`${n}.json`:e+t}function hi(){const e=Object.keys(process.env),t=["securityToken","accessKeyID","accessKeySecret","FC_FUNCTION_MEMORY_SIZE","FC_FUNC_CODE_PATH","FC_RUNTIME_VERSION"];return e.filter((e=>t.includes(e))).length>=3||!0}function yi(){const e=Object.keys(process.env),t=e.filter((e=>e.startsWith("SCF_"))).length>=10,n=e.filter((e=>e.startsWith("TENCENTCLOUD_"))).length>=3;return t&&n||!1}function vi(){return yi()||hi()||gi()||pi()}const wi=["æ£","æ£å","æ£è¶","å æ²¹~","UPå æ²¹!","æ¯æ~","æ¯ææ¯æï¼","å¬æ´å¦","é¡¶é¡¶","çä¸èå°~","å¹²æ¯","bilibiliå¹²æ¯","o(*ï¿£â½ï¿£*)o","(ï½¡ï½¥âï½¥)ï¾ï¾å¨","(âËâËâ)","( â¢Ì Ï â¢Ì )y","(à¸ â¢_â¢)à¸",">.<","^_~"],_i=Object.prototype.toString;function bi(e,t){return _i.call(e)===`[object ${t}]`}function $i(e){return void 0!==e}function Ti(e){return!$i(e)}function Si(e){return null!==e&&bi(e,"Object")}function Oi(e){return null===e}function Ci(e){return bi(e,"Number")}function ki(e){return bi(e,"String")}function Ii(e){return"function"==typeof e}function Ei(e){return bi(e,"Boolean")}function xi(e){return e&&Array.isArray(e)}const Pi="undefined"==typeof window,ji=!Pi;function Li(e){const t=e||Ai(),n=t.getFullYear(),r=t.getMonth()+1;return 2===r?n%4==0&&n%100!=0||n%400==0?29:28:[4,6,9,11].includes(r)?30:31}function Ri(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=c.randomBytes(1)[0]%16;return("x"===e?t:3&t|8).toString(16)}))}function Ai(){const e=new Date,t=e.getTime(),n=e.getTimezoneOffset()/60;return new Date(t+36e5*(n+8))}function Ni(e){const t=e||Ai(),n=t.getFullYear(),r=t.getMonth()+1,o=t.getDate();return`${n}-${r<10?"0"+r:r}-${o<10?"0"+o:o}`}function Ui(e){const t=e.replace(/^\w+\(/,"").replace(/\)$/,"");return JSON.parse(t)}function Di(e,t){return Math.ceil(t/e)}function Bi(e,t,n){if(n&&"boolean"!=typeof n&&(t=n=void 0),void 0===n&&("boolean"==typeof t?(n=t,t=void 0):"boolean"==typeof e&&(n=e,e=void 0)),void 0===e&&void 0===t?(e=0,t=1):void 0===t&&(t=e,e=0),e>t){const n=e;e=t,t=n}if(n||e%1||t%1){const n=Math.random();return Math.min(e+n*(t-e+parseFloat("1e-"+((n+"").length-1))),t)}return e+Math.floor(Math.random()*(t-e+1))}function Fi(e="17:30:00-23:40:00",t){const n=e.split("-"),r=n[0].split(":").map((e=>+e)),o=n[1].split(":").map((e=>+e)),i=Bi(r[0]??19,o[0]??23);let a=0;a=i==r[0]?Bi(r[1],59):i==o[0]?Bi(o[1]):Bi(59);let s=0;return s=i==r[0]?Bi(r[2],59):i==o[0]?Bi(o[2]):Bi(59),zi({seconds:s,hours:i,minutes:a},t)}function zi({hours:e,minutes:t,seconds:n},r){let o;switch(n=n||0,r){case"scf":default:o=`${n} ${t} ${e} * * * *`;break;case"fc":o=`${n} ${t} ${e} * * *`;break;case"cfc":o=`corn(${t} ${e} * * *)`}return{value:o,string:`${e}:${t}:${n}`}}function Mi(e,t){let n="";for(let t=0;t<e;t++)n+=Yi("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ");return t?n.toLowerCase():n}function Ji(){return`${Bi(1,9)}${Mi(10,!0)}0`}function qi(e,t){e.includes(t)||e.push(t)}function Gi(e){return e||{}}function Ki(e,t=!1){return Si(e)?Array.isArray(e)?e.map((e=>Ki(e,t))):t?Object.keys(e).reduce(((n,r)=>(n[r]=Ki(e[r],t),n)),{}):Object.assign({},e):e}function Hi(e,t){return void 0===e||void 0===t?e||t:Si(e)&&Si(t)?Array.isArray(e)&&Array.isArray(t)?e.concat(t):Object.keys(t).reduce(((n,r)=>(n[r]=Hi(e[r],t[r]),n)),e):t}function Wi(e){if(!Si(e)&&!xi(e))return e;const t=new URLSearchParams;return Array.isArray(e)||(e=Object.entries(e)),e.forEach((([e,n])=>{Si(n)?t.append(e,JSON.stringify(n)):t.append(e,String(n))})),t.toString()}function Yi(e){return e[Bi(e.length-1)]}function Qi(e,t=!1){const n=c.createHash("md5");return n.update(e),t?n.digest("hex").toUpperCase():n.digest("hex")}function Vi(e={},t={}){function n(e){return Object.keys(e).reduce(((t,n)=>(t[n.toLowerCase()]=e[n],t)),{})}return Object.assign({},n(e),n(t))}function Xi(e){return e&&e.map((e=>Number(e))).filter((e=>e>0&&e%1==0))}function Zi(){return Math.floor((new Date).getTime()/1e3)}function ea(e,t=!0){return t?e.toLocaleString("zh-CN",{hour12:!1}):e.toLocaleString("zh-CN",{hour12:!1,hour:"numeric",minute:"numeric",second:"numeric"})}function ta(e="info"){const t=["error","warn","info","verbose","debug"],n=t.indexOf(e);return-1!==n?t.slice(0,n+1):t}function na(e){return u.resolve(process.cwd(),e)}class ra{static pushValue="";static brChar="\n";month=Ai().getMonth()+1;errorFile=na(`./logs/bt_error-${this.month}.log`);logFile=na(`./logs/bt_combined-${this.month}.log`);noFile=!1;constructor(e={console:"info",file:"info",push:"info"},t="default"){this.options=e,this.name=t,this.consoleLeval=ta(this.options.console),this.fileLeval=ta(this.options.file),this.pushLeval=ta(this.options.push),this.noFile=di()||vi(),this.noFile||this.createLogFile()}log({level:e},t,n){n=n||aa[e];const r=Ai(),o=["error","warn"].includes(e),i=this.options.payload?` [${this.options.payload}] `:" ";this.consoleLeval.includes(e)&&this.Conslole(`[${n} ${ea(r,!1)}]${i}${t}\n`,o),!this.noFile&&this.fileLeval.includes(e)&&this.File(`[${n} ${ea(r,!0)}]${i}${t}\n`,o),this.pushLeval.includes(e)&&this.Push(`[${n} ${ea(r,!1)}] ${t}${ra.brChar}`)}error(e){this.log({level:"error"},e)}warn(e){this.log({level:"warn"},e)}info(e,t){this.log({level:"info"},e,t)}verbose(e){this.log({level:"verbose"},e)}debug(e){this.log({level:"debug"},e)}Conslole(e,t){t?process.stderr.write(e):process.stdout.write(e)}File(e,t){t&&f.appendFileSync(this.errorFile,e,"utf-8"),f.appendFileSync(this.logFile,e,"utf-8")}Push(e){ra.pushValue+=e}createLogFile(){const e=na("./logs");f.existsSync(e)||f.mkdirSync(e)}static async init(){ra.pushValue="";try{const{TaskConfig:e}=await Promise.resolve().then((function(){return Us}));ra.brChar=e.message.br||"\n"}catch{}}}const oa=new class{constructor(){}log(){}error(){}warn(){}info(){}verbose(){}debug(){}},ia=new ra({console:"debug",file:"debug",push:"debug"}),aa={error:"â",warn:"â",info:"ð»",verbose:"ð¬",debug:"ð"};class sa{static configFileName=mi();static isQingLongPanel=di()}const ca=l.default?l.default:l;function ua(e){try{let t;if((r.existsSync(e)||r.existsSync(e+="5"))&&(t=r.readFileSync(e,"utf-8")),!t)return;return ca.parse(t)}catch(e){ia.error(e),function(e){if(!ki(e))return;if(e.includes("SyntaxError: JSON5"))throw new SyntaxError("éç½®æä»¶å­å¨ï¼ä½æ¯æ æ³è§£æï¼å¯è½ JSON5 æ ¼å¼ä¸æ­£ç¡®ï¼");throw new Error(e)}(e.message)}}const fa=e=>u.resolve(process.cwd(),e),la=e=>u.resolve(__dirname,"../",e),da=Array.from(new Set([fa("./config/config.dev.json"),fa(`./config/${sa.configFileName}`),fa(`./${sa.configFileName}`),la(`./config/${sa.configFileName}`),la(`./${sa.configFileName}`)])),pa=["./config.json",fa("./config/config.json")];function ga(e){let t;const n=Array.isArray(e);if(t=n?e:e.account.filter((e=>e.cookie)),0===t.length)return;if(sa.isQingLongPanel)return function(e){const t=process.argv.find((e=>e.includes("--item")||e.includes("-i")||e.includes("-I")));if(!t)return e[0];const n=Number(t.split("=")[1])-1;return!n||n>=e.length||n<0?(ia.warn("ä¼¼ä¹æ³è¦æå®ä¸ä¸ªä¸å­å¨çç¨æ·ï¼æä»¬å°æå®ç¬¬ä¸ä¸ªç¨æ·"),e[0]):e[n]}(t);ia.warn("å¨åç¨æ·åºæ¯ä¸éç½®äºå¤ç¨æ·ï¼æä»¬å°æ¾å¼å¤ä½çéç½®");const r=t[0];return n||(r.message=Object.assign(e.message||{},r.message)),r}function ma(){if(globalThis.BILITOOLS_CONFIG)return globalThis.BILITOOLS_CONFIG;sa.isQingLongPanel&&(da.splice(0,1),da.push(...pa));for(let e=0;e<da.length;e++){const t=ua(da[e]);if(t)return ia.verbose(`è¯»åéç½®æä»¶ ${da[e]}`),t}return(()=>{const{BILITOOLS_CONFIG:e,BILI_SCF_CONFIG:t,BILI_CONFIG:n}=process.env,r=e||t||n;if(r)try{return ca.parse(ii(r.trim()))}catch(e){throw ia.error(e),new Error("ç¯å¢ä¸­çéç½®ä¸æ¯ææç JSON å­ç¬¦ä¸²ï¼")}})()}function ha(e){return function(e,t=!1){if(!e)throw new Error("è·åéç½®å¤±è´¥ï¼æªæ¾å°éç½®æä»¶ï¼");if(t)return function(e){const t=e=>e.cookie&&e.cookie.length>90&&["bili_jct","SESSDATA","DedeUserID"].every((t=>e.cookie.includes(t)));if(Array.isArray(e))return e.filter(t);return e.account.filter(t)}(ya(e)?e:[e]);if(ya(e)){const t=ga(e);if(t)return t}if(!e.cookie)throw new Error("éç½®æä»¶ä¸­æ²¡æ cookieï¼");return e}(ma(),e)}function ya(e){return!!Array.isArray(e)||Boolean(e.account&&e.account.length)}var va=X,wa=B,_a=it("match"),ba=Nt,$a=$,Ta=Je,Sa=re,Oa=function(){var e=ba(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t},Ca=RegExp.prototype,ka=A,Ia=Fe,Ea=Math.floor,xa=ka("".charAt),Pa=ka("".replace),ja=ka("".slice),La=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,Ra=/\$([$&'`]|\d{1,2})/g,Aa=Vr,Na=$,Ua=A,Da=K,Ba=Q,Fa=function(e){var t;return va(e)&&(void 0!==(t=e[_a])?!!t:"RegExp"==wa(e))},za=Oo,Ma=Ce,Ja=function(e){var t=e.flags;return void 0!==t||"flags"in Ca||Ta(e,"flags")||!Sa(Ca,e)?t:$a(Oa,e)},qa=function(e,t,n,r,o,i){var a=n+e.length,s=r.length,c=Ra;return void 0!==o&&(o=Ia(o),c=La),Pa(i,c,(function(i,c){var u;switch(xa(c,0)){case"$":return"$";case"&":return e;case"`":return ja(t,0,n);case"'":return ja(t,a);case"<":u=o[ja(c,1,-1)];break;default:var f=+c;if(0===f)return i;if(f>s){var l=Ea(f/10);return 0===l?i:l<=s?void 0===r[l-1]?xa(c,1):r[l-1]+xa(c,1):i}u=r[f-1]}return void 0===u?"":u}))},Ga=it("replace"),Ka=TypeError,Ha=Ua("".indexOf);Ua("".replace);var Wa,Ya=Ua("".slice),Qa=Math.max,Va=function(e,t,n){return n>e.length?-1:""===t?n:Ha(e,t,n)};function Xa(e){return e?e.match(/([^;=]+)(?:=([^;]*))?/g).reduce(((e,t)=>{const[n,r]=t.trim().split("=");return e[n]=encodeURIComponent(r).replaceAll("%7C","|").replaceAll("%2B","+").replaceAll("%25","%").replaceAll("*","%2A"),e}),{}):{}}function Za(e){let t="";return e.forEach((e=>t+=e.split("; ")[0]+"; ")),t.endsWith("; ")&&(t=t.substring(0,t.length-2||0)),t}function es(e){return ts(Xa(e))}function ts(e){const t=Object.keys(e).reduce(((t,n)=>t+`${n}=${e[n]}; `),"");return t.substring(0,t.length-2||0)}function ns(e,t){return e||""===e?(ki(t)&&(t=[t]),t&&0!==t.length?ts({...Xa(e),...Xa(Za(t))}):e):""}function rs(e,t){if(!e)return null;const n=`(?:^|)${t}=([^;]*)(?:;|$)`,r=e.match(n);return r?r[1]:null}function os(e){return Number(rs(e,"DedeUserID"))||0}function is(e){return rs(e,"bili_jct")||""}Aa({target:"String",proto:!0},{replaceAll:function(e,t){var n,r,o,i,a,s,c,u,f=Da(this),l=0,d=0,p="";if(null!=e){if(Fa(e)&&(n=za(Da(Ja(e))),!~Ha(n,"g")))throw Ka("`.replaceAll` does not allow non-global regexes");if(r=Ma(e,Ga))return Na(r,e,f,t)}for(o=za(f),i=za(e),(a=Ba(t))||(t=za(t)),s=i.length,c=Qa(1,s),l=Va(o,i,0);-1!==l;)u=a?za(t(i,l,o)):qa(i,o,l,[],void 0,t),p+=Ya(o,d,l)+u,d=l+s,l=Va(o,i,l+c);return d<o.length&&(p+=Ya(o,d)),p}});class as{constructor(e){this.cookie=e}getCookieString(){return this.cookie}setCookie(e){this.cookie=ns(this.cookie,e)}toJSON(){return Xa(this.cookie)}getCookieItem(e){return rs(this.cookie,e)}}class ss{async getCookieString(){return Rs.cookie}async setCookie(e){Rs.cookie=ns(Rs.cookie,e)}}const cs={cookie:"",accessKey:"",message:{br:"\n",email:{host:"smtp.163.com",port:465},pushplusToken:null===(Wa=process.env.PUSHPLUS_TOKEN)||void 0===Wa?void 0:Wa.trim(),api:{method:"POST",headers:{"Content-Type":"application/json"},timeout:5e3,url:"",proxy:{host:"",port:443,auth:""},data:{}}},function:{silver2Coin:!0,liveSignTask:!0,addCoins:!0,mangaSign:!1,shareAndWatch:!0,supGroupSign:!1,liveSendMessage:!1,taskReward:!0,charging:!1,getVipPrivilege:!1,giveGift:!1,matchGame:!1,liveLottery:!1,liveRedPack:!1,batchUnfollow:!1,liveIntimacy:!1,mangaTask:!1,bigPoint:!1,liveFamine:!1,judgement:!1},apiDelay:[2,6],userAgent:"",dailyRunTime:"17:30:00-23:40:00",targetLevel:void 0,stayCoins:void 0,targetCoins:void 0,customizeUp:void 0,giftUp:void 0,chargeUpId:void 0,chargePresetTime:void 0,matchCoins:void 0,matchSelection:void 0,matchDiff:void 0,match:{coins:5,selection:1,diff:0},charge:{mid:0,presetTime:[10,20]},gift:{mids:[]},coin:{customizeUp:[],targetLevel:6,stayCoins:0,targetCoins:5,todayCoins:0},sls:{name:"",description:"",region:"ap-chengdu",dailyRunTime:"17:30:00-23:40:00"},lottery:{excludeAward:["è°","è¹","èªæµ·","ä»£éå¸","ä¼æ å¸","èªæ","ç§","åç","å¾","æç£","è½¦è½¦ä¸å±","åæ¥ä¸å±","æ¸¸æéå·"],includeAward:["è°¢"],blackUid:[65566781,1277481241,1643654862,603676925],isMoveTag:!0,moveTag:"å¤©éæ¶å»",pageNum:2,actFollowMsg:"read",scanFollow:void 0,skipNeedFollow:!1},redPack:{},intimacy:{liveSendMessage:!0,liveShare:!0,liveLike:!0,liveHeart:!1,whiteList:[],blackList:[]},jury:{mode:1,once:!0,vote:[0,1]},manga:{sign:!0,buy:!1,mc:[],name:[],love:!0,buyInterval:6,buyWeek:[3]},activity:{liveFamineTime:400},BILIJCT:"",USERID:0};function us(e){return function(e){!function(e){e.BILIJCT=is(e.cookie),e.USERID=os(e.cookie)}(e);const{coin:t,gift:n,charge:r,match:o}=e;xi(e.apiDelay)?e.apiDelay=Xi(e.apiDelay):e.apiDelay=[Number(e.apiDelay)];t.customizeUp=Xi(t.customizeUp),n.mids=Xi(n.mids),0===n.mids.length&&(n.mids=t.customizeUp);r.mid||(r.mid=e.USERID);t.targetCoins>5&&(t.targetCoins=5);o.coins>10&&(o.coins=10);return e}(function(e){return Object.keys(fs).forEach((t=>{if(void 0!==e[t]){const[n,r]=fs[t];e[n]=Gi(e[n]),e[n][r]=e[t]}delete e[t]})),e}(Hi(Ki(cs,!0),function(e){const{message:t}=e;if(t&&ki(t.api)){const e=t.api;t.api=Ki(cs.message.api,!0),t.api.url=e,t.api.method="GET"}return e}(e))))}const fs={targetLevel:["coin","targetLevel"],stayCoins:["coin","stayCoins"],targetCoins:["coin","targetCoins"],customizeUp:["coin","customizeUp"],giftUp:["gift","mids"],chargeUpId:["charge","mid"],chargePresetTime:["charge","presetTime"],matchCoins:["match","coins"],matchSelection:["match","selection"],matchDiff:["match","diff"]};const ls="https://account.bilibili.com",ds="https://live.bilibili.com",ps="https://space.bilibili.com",gs="https://message.bilibili.com",ms="https://www.bilibili.com",hs="https://www.bilibili.com/",ys="https://big.bilibili.com/mobile/bigPoint",vs="https://big.bilibili.com/mobile/bigPoint/task",ws="https://www.bilibili.com/judgement/",_s="https://account.bilibili.com",bs="https://api.live.bilibili.com",$s="https://api.bilibili.com",Ts="https://manga.bilibili.com",Ss="https://api.vc.bilibili.com",Os="https://live-trace.bilibili.com",Cs={"user-agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.41 Safari/537.36 Edg/101.0.1210.32","content-type":"application/x-www-form-urlencoded; charset=UTF-8","accept-language":"zh-CN,zh;q=0.9","accept-encoding":"gzip, deflate, br"};function ks({version:e="6.78.0",phone:t="MI 10 Pro",build:n="6780300",channel:r="xiaomi",os:o="10"}={}){return`Mozilla/5.0 BiliDroid/${e} (bbcallen@gmail.com) os/android model/${t} mobi_app/android build/${n} channel/${r} innerVer/${r} osVer/${o} network/2`}function Is(e={},t,n){return function(e,t="1d8b6e7d45233436",n="560c52ccd288fed045859ed18bffd973"){if(e={...e,platform:"android",mobi_app:"android",disable_rcmd:0,build:6780300,c_locale:"zh_CN",s_locale:"zh_CN",ts:Zi()},!Rs.accessKey&&!e.access_key)return Es(e,n,!0);return delete e.csrf,delete e.csrf_token,Es(e={access_key:Rs.accessKey,...e,actionKey:"appkey",appkey:t},n)}(e,t,n).query}function Es(e,t,n=!1){const r=Wi(function(e){return Object.keys(e).sort().map((t=>[t,e[t]]))}(e));if(n)return{query:r,sign:""};const o=Qi(r+t);return{query:r+"&sign="+o,sign:o}}function xs(e){return Object.keys(e).forEach((t=>{Ci(e[t])?e[t]=e[t].toString():Si(e[t])?xs(e[t]):xi(e[t])&&(e[t]=e[t].map((e=>Si(e)?xs(e):e.toString())))})),e}function Ps(e){let t=JSON.stringify(xs(e));const n=["SHA512","SHA3-512","SHA384","SHA3-384","BLAKE2b512"];for(const e of n)t=c.createHash(e).update(t).digest("hex");return t}function js(){return`XY${c.randomBytes(16).toString("hex").toUpperCase()}`}let Ls;const Rs=new Proxy({},{get:(e,t)=>(Ls||Ns(),Reflect.get(Ls,t)),set:(e,t,n)=>"config"===t&&n?(Ns(n),!0):Reflect.set(Ls,t,n)});let As=null;function Ns(e){e||(e=ha(!1));const t=us(e),n=js();Ls={...t,mobileUA:ks(),cookie:es(`${t.cookie}; Buvid=${n}`),buvid:n},As=class extends class{static money=0;static coinsTask=5;static share=!1;static watch=!1;static currentStartFun=0;static bCoinCouponBalance=0;static vipType=0;static vipStatus=0;static userLevel=0}{},As.coinsTask=Ls.coin.targetCoins}var Us=Object.freeze({__proto__:null,TaskConfig:Rs,get TaskModule(){return As},initialize:Ns,changeConfig:function(e){const t=ha();t[e]&&Ns(t[e])}});function Ds(e,t){const n=Fs(e,t);return new Promise((e=>{setTimeout((()=>{e(n)}),n)}))}function Bs(e,t){Fs(e,t)}function Fs(e,t){if(e&&t)return Bi(e,t);if(e)return e;const n=Rs.apiDelay;return 1===n.length?1e3*n[0]:1e3*Bi(n[0]||2,n[1]||6)}var zs=Object.freeze({__proto__:null,gzipEncode:function(t){try{return e.gzipSync(encodeURIComponent(t)).toString("base64")}catch(e){return"Error: å½åå­ç¬¦ä¸²ä¸è½è¢«Gzipåç¼©"}},gzipDecode:ii,unicode2str:ai,apiDelay:Ds,apiDelaySync:Bs,getCookieJSON:Xa,encodeCookie:es,getCookie:ns,getCookieItem:rs,getUserId:os,getBiliJct:is,getLIVE_BUVID:function(e){return rs(e,"LIVE_BUVID")||""},CookieJar:as,BiliCookieJar:ss,isQingLongPanel:di,isCFC:pi,isAGC:gi,setConfigFileName:mi,isFC:hi,isSCF:yi,isServerless:vi,Logger:ra,emptyLogger:oa,logger:ia,getMonthHasDays:Li,createUUID:Ri,getPRCDate:Ai,getDateString:Ni,jsonp2Object:Ui,getPageNum:Di,setCron:function(e=6e4,t){e=e||6e4;const n=Ai().getTime()+e,r=new Date(n),o=r.getSeconds(),i=r.getMinutes();return zi({hours:r.getHours(),minutes:i,seconds:o},t)},random:Bi,randomDailyRunTime:Fi,formatCron:zi,randomString:Mi,getVisitId:Ji,pushIfNotExist:qi,getNewObject:Gi,cloneObject:Ki,deepMergeObject:Hi,stringify:Wi,getRandomItem:Yi,md5:Qi,mergeHeaders:Vi,arr2numArr:Xi,base64Encode:function(e){return Buffer.from(e).toString("base64")},isTodayInTimeArr:function(e){if(!e||!e.length)return!0;const t=(new Date).getDate();return e.includes(t)},getUnixTime:Zi,is:bi,isDef:$i,isUnDef:Ti,isObject:Si,isEmpty:function(e){return xi(e)||ki(e)?0===e.length:e instanceof Map||e instanceof Set?0===e.size:!!Si(e)&&0===Object.keys(e).length},isDate:function(e){return bi(e,"Date")},isNull:Oi,isNullAndUnDef:function(e){return Ti(e)&&Oi(e)},isNullOrUnDef:function(e){return Ti(e)||Oi(e)},isNumber:Ci,isPromise:function(e){return bi(e,"Promise")&&Si(e)&&Ii(e.then)&&Ii(e.catch)},isString:ki,isFunction:Ii,isBoolean:Ei,isRegExp:function(e){return bi(e,"RegExp")},isArray:xi,isWindow:function(e){return"undefined"!=typeof window&&bi(e,"Window")},isElement:function(e){return Si(e)&&!!e.tagName},isMap:function(e){return bi(e,"Map")},isServer:Pi,isClient:ji,isUrl:function(e){return/(((^https?:(?:\/\/)?)(?:[-;:&=\+\$,\w]+@)?[A-Za-z0-9.-]+(?::\d+)?|(?:www.|[-;:&=\+\$,\w]+@)[A-Za-z0-9.-]+)((?:\/[\+~%\/.\w-_]*)?\??(?:[-\+=&;%@.\w_]*)#?(?:[\w]*))?)$/.test(e)},isEmail:function(e){return/\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*/.test(e)}}),Ms=!y((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),Js=Je,qs=Q,Gs=Fe,Ks=Ms,Hs=hn("IE_PROTO"),Ws=Object,Ys=Ws.prototype,Qs=Ks?Ws.getPrototypeOf:function(e){var t=Gs(e);if(Js(t,Hs))return t[Hs];var n=t.constructor;return qs(n)&&t instanceof n?n.prototype:t instanceof Ws?Ys:null},Vs={},Xs=wr,Zs=_r,ec=Object.keys||function(e){return Xs(e,Zs)},tc=v,nc=jt,rc=Pt,oc=Nt,ic=Y,ac=ec;Vs.f=tc&&!nc?Object.defineProperties:function(e,t){oc(e);for(var n,r=ic(t),o=ac(t),i=o.length,a=0;i>a;)rc.f(e,n=o[a++],r[n]);return e};var sc,cc=ne("document","documentElement"),uc=Nt,fc=Vs,lc=_r,dc=yn,pc=cc,gc=wt,mc=hn("IE_PROTO"),hc=function(){},yc=function(e){return"<script>"+e+"<\/script>"},vc=function(e){e.write(yc("")),e.close();var t=e.parentWindow.Object;return e=null,t},wc=function(){try{sc=new ActiveXObject("htmlfile")}catch(e){}var e,t;wc="undefined"!=typeof document?document.domain&&sc?vc(sc):((t=gc("iframe")).style.display="none",pc.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(yc("document.F=Object")),e.close(),e.F):vc(sc);for(var n=lc.length;n--;)delete wc.prototype[lc[n]];return wc()};dc[mc]=!0;var _c=Object.create||function(e,t){var n;return null!==e?(hc.prototype=uc(e),n=new hc,hc.prototype=null,n[mc]=e):n=wc(),void 0===t?n:fc.f(n,t)},bc=Se,$c=w,Tc=A(A.bind),Sc={},Oc=Sc,Cc=it("iterator"),kc=Array.prototype,Ic=$o,Ec=Ce,xc=Sc,Pc=it("iterator"),jc=function(e){if(null!=e)return Ec(e,Pc)||Ec(e,"@@iterator")||xc[Ic(e)]},Lc=$,Rc=Se,Ac=Nt,Nc=_e,Uc=jc,Dc=TypeError,Bc=$,Fc=Nt,zc=Ce,Mc=function(e,t){return bc(e),void 0===t?e:$c?Tc(e,t):function(){return e.apply(t,arguments)}},Jc=$,qc=Nt,Gc=_e,Kc=function(e){return void 0!==e&&(Oc.Array===e||kc[Cc]===e)},Hc=cr,Wc=re,Yc=function(e,t){var n=arguments.length<2?Uc(e):t;if(Rc(n))return Ac(Lc(n,e));throw Dc(Nc(e)+" is not iterable")},Qc=jc,Vc=function(e,t,n){var r,o;Fc(e);try{if(!(r=zc(e,"return"))){if("throw"===t)throw n;return n}r=Bc(r,e)}catch(e){o=!0,r=e}if("throw"===t)throw n;if(o)throw r;return Fc(r),n},Xc=TypeError,Zc=function(e,t){this.stopped=e,this.result=t},eu=Zc.prototype,tu=function(e,t,n){var r,o,i,a,s,c,u,f=n&&n.that,l=!(!n||!n.AS_ENTRIES),d=!(!n||!n.IS_RECORD),p=!(!n||!n.IS_ITERATOR),g=!(!n||!n.INTERRUPTED),m=Mc(t,f),h=function(e){return r&&Vc(r,"normal",e),new Zc(!0,e)},y=function(e){return l?(qc(e),g?m(e[0],e[1],h):m(e[0],e[1])):g?m(e,h):m(e)};if(d)r=e.iterator;else if(p)r=e;else{if(!(o=Qc(e)))throw Xc(Gc(e)+" is not iterable");if(Kc(o)){for(i=0,a=Hc(e);a>i;i++)if((s=y(e[i]))&&Wc(eu,s))return s;return new Zc(!1)}r=Yc(e,o)}for(c=d?e.next:r.next;!(u=Jc(c,r)).done;){try{s=y(u.value)}catch(e){Vc(r,"throw",e)}if("object"==typeof s&&s&&Wc(eu,s))return s}return new Zc(!1)},nu=Vr,ru=re,ou=Qs,iu=uo,au=Rr,su=_c,cu=Ht,uu=E,fu=No,lu=xo,du=tu,pu=ko,gu=Do,mu=it("toStringTag"),hu=Error,yu=[].push,vu=function(e,t){var n,r=arguments.length>2?arguments[2]:void 0,o=ru(wu,this);iu?n=iu(new hu,o?ou(this):wu):(n=o?this:su(wu),cu(n,mu,"Error")),void 0!==t&&cu(n,"message",pu(t)),gu&&cu(n,"stack",fu(n.stack,1)),lu(n,r);var i=[];return du(e,yu,{that:i}),cu(n,"errors",i),n};iu?iu(vu,hu):au(vu,hu,{name:!0});var wu=vu.prototype=su(hu.prototype,{constructor:uu(1,vu),message:uu(1,""),name:uu(1,"AggregateError")});nu({global:!0,constructor:!0,arity:2},{AggregateError:vu});var _u={},bu=Se,$u=function(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r})),this.resolve=bu(t),this.reject=bu(n)};_u.f=function(e){return new $u(e)};var Tu=$,Su=Se,Ou=ne,Cu=_u,ku=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}},Iu=tu;Vr({target:"Promise",stat:!0},{any:function(e){var t=this,n=Ou("AggregateError"),r=Cu.f(t),o=r.resolve,i=r.reject,a=ku((function(){var r=Su(t.resolve),a=[],s=0,c=1,u=!1;Iu(e,(function(e){var f=s++,l=!1;c++,Tu(r,t,e).then((function(e){l||u||(u=!0,o(e))}),(function(e){l||u||(l=!0,a[f]=e,--c||i(new n(a,"No one promise resolved")))}))})),--c||i(new n(a,"No one promise resolved"))}));return a.error&&i(a.value),r.promise}});const Eu=(e,t)=>{const{isTransformResponse:n,isReturnNativeResponse:r}=t;if(r)return e;if(!1===n)return e.body;const{body:o}=e;if(t.isJsonp&&ki(o))return Ui(o);try{if(ki(o)&&o.startsWith("{"))return JSON.parse(o)}catch{}return o};class xu{name="VGot";constructor(e){e.baseURL&&(e.prefixUrl=e.baseURL),this.options=e;const{withBiliCookie:t,withCredentials:n}=this.options.requestOptions;t?this.cookieJar=new ss:n&&(this.cookieJar=new as),this.gotInstance=d.default.extend(e,{cookieJar:this.cookieJar})}request(e){const{requestOptions:t={},headers:n={}}=this.options;return e.requestOptions=Object.assign({},t,e.requestOptions),e.headers=Vi(n,e.headers),t.retry&&(e.retry=t.retry),e=function(e){ki(e.url)||(e.url=e.url.toString()),Si(e.params)&&!ki(e.searchParams)&&(e.searchParams={...e.searchParams,...e.params});const t=e.headers["content-type"],n=null==t?void 0:t.startsWith("application/x-www-form-urlencoded");function r(t){e.agent||(e.agent={}),e.agent[t]=e[`${t}Agent`]}return Si(e.data)&&(n?e.body=Wi(e.data):e.json=e.data),ki(e.data)&&n&&(e.body=e.data),e.httpAgent&&r("http"),e.httpsAgent&&r("https"),e.url&&e.url.startsWith("/")&&(e.url=e.url.substring(1)),e}(e),new Promise(((t,n)=>{this.gotInstance(e).then((r=>{if(Ii(Eu))try{const n=Eu(r,e.requestOptions);t(n)}catch(e){n(e||new Error("è¯·æ±éè¯¯!"))}else t(r)})).catch((e=>{e.response&&(e.response.status=e.response.statusCode),n(e)}))}))}get(e,t){return ki(e)?this.request({...t,method:"GET",url:e}):this.request({...e,method:"GET"})}post(e,t,n){return ki(e)?this.request({...n,method:"POST",url:e,data:t}):this.request({...e,method:"POST"})}put(e,t,n){return this.request({...n,method:"PUT",url:e,data:t})}delete(e,t,n){return this.request({...n,method:"DELETE",url:e,data:t})}patch(e,t,n){return this.request({...n,method:"PATCH",url:e,data:t})}}function Pu(e){return new xu(Hi({timeout:1e4,headers:{"content-type":Cs["content-type"],"user-agent":Cs["user-agent"],"accept-language":Cs["accept-language"],"accept-encoding":Cs["accept-encoding"]},requestOptions:{isTransformResponse:!0,ignoreCancelToken:!0,withBiliCookie:!0}},e||{}))}const ju=Pu({requestOptions:{withBiliCookie:!1}}),Lu=Pu();ju.name;async function Ru(e,t){(async e=>{ia.info(e||"é¿éäº FC æµè¯ing")})();const{dailyHandle:n}=await Promise.resolve().then((function(){return Au}));return await n({event:e,context:t,slsType:"fc"})}(async()=>{ia.info("å¼å§æ§è¡ç½ç»ä»£ç ");Ru(JSON.parse(event.toString()),context).then((e=>{VMThis.message=e,VMThis.resolve(VMThis.message)})).catch((e=>{VMThis.error=e,VMThis.reject(VMThis.error)}))})();var Au=Object.freeze({__proto__:null,dailyHandle:async function({event:e,context:t,slsType:n}){const r=function(e,t){return"scf"===e?t.Message:t.payload}(n,e),o=await async function(e,t,n){const r="scf"===e?(await Promise.resolve().then((function(){return of}))).default:(await Promise.resolve().then((function(){return af}))).default;return(...e)=>r(t,n,...e)}(n,e,t);let i;try{i=JSON.parse(r)}catch(e){}return i&&i.lastTime===Ai().getDate().toString()?"ä»æ¥éå¤æ§è¡":await async function(e,...t){const{getBiliTask:n}=await Promise.resolve().then((function(){return Du})),{apiDelay:r,logger:o,Logger:i}=await Promise.resolve().then((function(){return zs})),{getWaitRuningFunc:a}=await Promise.resolve().then((function(){return Bu})),{sendMessage:s}=await Promise.resolve().then((function(){return ef})),{printVersion:c}=await Promise.resolve().then((function(){return rf}));await i.init(),await c();try{const e=await n("loginTask");await e()}catch(e){return o.error(`ç»å½å¤±è´¥: ${e}`),await s("ç»å½å¤±è´¥",i.pushValue),"æªå®æ"}const u=a();for await(const e of u)try{await e()}catch(t){o.error(`${e.name}å¤±è´¥: ${t}`)}finally{await r()}return e&&await e(...t),await s("æ¯æ¥å®æ",i.pushValue),"å®æ"}(o)}});const Nu=["taskReward","liveSignTask","addCoins","bigPoint","shareAndWatch","silver2Coin","mangaSign","mangaTask","supGroupSign","liveSendMessage","charging","getVipPrivilege","matchGame","batchUnfollow","liveLottery","liveRedPack","liveIntimacy","giveGift","loginTask","liveFamine","judgement"],Uu=[()=>Promise.resolve().then((function(){return Rf})),()=>Promise.resolve().then((function(){return Df})),()=>Promise.resolve().then((function(){return Ff})),()=>Promise.resolve().then((function(){return ll})),()=>Promise.resolve().then((function(){return dl})),()=>Promise.resolve().then((function(){return pl})),()=>Promise.resolve().then((function(){return Sl})),()=>Promise.resolve().then((function(){return Ol})),()=>Promise.resolve().then((function(){return Il})),()=>Promise.resolve().then((function(){return ql})),()=>Promise.resolve().then((function(){return Kl})),()=>Promise.resolve().then((function(){return Ql})),()=>Promise.resolve().then((function(){return Zl})),()=>Promise.resolve().then((function(){return sd})),()=>Promise.resolve().then((function(){return Ed})),()=>Promise.resolve().then((function(){return Rd})),()=>Promise.resolve().then((function(){return Ad})),()=>Promise.resolve().then((function(){return Bd})),()=>Promise.resolve().then((function(){return Jd})),()=>Promise.resolve().then((function(){return Wd})),()=>Promise.resolve().then((function(){return ip}))];var Du=Object.freeze({__proto__:null,taskExportOrder:Nu,biliTasks:Uu,getBiliTask:async function(e){const t=Nu.findIndex((t=>t===e));return-1===t?()=>Promise.resolve():(await Uu[t]()).default},default:Uu});var Bu=Object.freeze({__proto__:null,getWaitRuningFunc:function(){const e=function(){const e=Rs.function;return e.addCoins||e.shareAndWatch||(e.taskReward=!1),e.liveIntimacy&&Rs.intimacy.liveSendMessage&&(e.liveSendMessage=!1),e.mangaTask&&Rs.manga.sign&&(e.mangaSign=!1),e}(),t=[];return Nu.forEach(((n,r)=>{e[n]&&t.push(Uu[r])})),t.map((async e=>(await e()).default))}});let Fu={};function zu(){var e;const t=Rs.message||{};Fu=function(e={}){return Fu.SCKEY="",Fu.BARK_PUSH="",Fu.BARK_SOUND="",Fu.BARK_GROUP="QingLong",Fu.TG_BOT_TOKEN="",Fu.TG_USER_ID="",Fu.TG_PROXY_HOST="",Fu.TG_PROXY_PORT="",Fu.TG_PROXY_AUTH="",Fu.TG_API_HOST="api.telegram.org",Fu.DD_BOT_TOKEN="",Fu.DD_BOT_SECRET="",Fu.QYWX_KEY="",Fu.QYWX_AM="",Fu.IGOT_PUSH_KEY="",Fu.PUSH_PLUS_TOKEN="",Fu.PUSH_PLUS_USER="",Fu.QQ_SKEY="",Fu.QQ_MODE="",e}(Fu),["GOBOT_URL","GOBOT_TOKEN","GOBOT_QQ","SCKEY","QQ_SKEY","QQ_MODE","BARK_PUSH","BARK_SOUND","BARK_GROUP","TG_BOT_TOKEN","TG_USER_ID","TG_PROXY_AUTH","TG_PROXY_HOST","TG_PROXY_PORT","TG_API_HOST","DD_BOT_TOKEN","DD_BOT_SECRET","QYWX_KEY","QYWX_AM","IGOT_PUSH_KEY","PUSH_PLUS_TOKEN","PUSH_PLUS_USER"].forEach((e=>{const n=t[(r=e,r.toLowerCase().replace(/_(\w)/g,((e,t)=>t.toUpperCase())))]||t[e]||process.env[e];var r,o;n&&(Fu[e]=null===(o=n.trim)||void 0===o?void 0:o.call(n))})),null!==(e=Rs.message)&&void 0!==e&&e.pushplusToken&&(Fu.PUSH_PLUS_TOKEN=Rs.message.pushplusToken)}async function Mu(e,t){var n;const r=null===(n=Rs.message)||void 0===n?void 0:n.email;if(!(r&&r.pass&&r.from&&r.host))return;const{createTransport:o}=await Promise.resolve().then((function(){return s(require("nodemailer"))})),i=Number(r.port)||465,a=o({host:r.host,port:i,secure:465===i,auth:{user:r.from,pass:r.pass}}),c=await a.sendMail({from:`${e} <${r.from}>`,to:r.to,subject:e,headers:{"Content-Type":"text/plain; charset=utf-8"},text:t.replace(/\n/g,"\r\n")});ia.info(`é®ä»¶æ¶æ¯å·²åé: ${c.messageId}`)}async function Ju(e,t){try{const n=Rs.message.api;if(!n||!n.url)return;const{data:r,proxy:o,timeout:i,headers:a}=n,c={method:n.method.toUpperCase()||"POST",timeout:i,headers:a,url:""};if(c.url=n.url.replace("{title}",encodeURIComponent(e)).replace("{text}",encodeURIComponent(t)),o.host){const e=(await Promise.resolve().then((function(){return s(require("tunnel"))}))).httpsOverHttp({proxy:{host:o.host,port:+o.port,proxyAuth:o.auth},maxSockets:1});Object.assign(c,{httpsAgent:e})}const u=Object.keys(r);u.length&&(u.forEach((n=>{"{text}"===r[n]&&(r[n]=t),"{title}"===r[n]&&(r[n]=e)})),Object.assign(c,{data:r})),await ju.request(c),ia.info("èªå®ä¹æ¥å£æ¶æ¯å·²åéï¼")}catch(e){ia.info(`èªå®ä¹æ¥å£æ¶æ¯åéå¤±è´¥: ${e}`),ia.error(e)}}function qu(e,t,n=2100){return new Promise((r=>{const o=Fu.SCKEY;if(o){t=t.replace(/[\n\r]/g,"\n\n");const i={url:o.includes("SCT")?`https://sctapi.ftqq.com/${o}.send`:`https://sc.ftqq.com/${o}.send`,data:`text=${e}&desp=${t}`,headers:{"Content-Type":"application/x-www-form-urlencoded"},timeout:15e3};setTimeout((()=>{ju.post(i).then((e=>{0===e.errno||0===e.data.errno?ia.info("serveré±åééç¥æ¶æ¯æåð"):1024===e.errno?ia.info(`serveré±åééç¥æ¶æ¯å¼å¸¸: ${e.errmsg}`):ia.info(`serveré±åééç¥æ¶æ¯å¼å¸¸\n${JSON.stringify(e)}`)})).catch((e=>{ia.info("serveré±åééç¥è°ç¨APIå¤±è´¥ï¼ï¼"),ia.info(e)})).finally((()=>{r("")}))}),n)}else r("")}))}function Gu(e,t){return new Promise((n=>{const{QQ_SKEY:r,QQ_MODE:o}=Fu;if(r){const i={url:`https://push.xuthus.cc/${o}/${r}`,headers:{"Content-Type":"application/json"},data:{},params:{}};e=e.replace(/äº¬è±/g,"è±è±"),t=(t=(t=t.replace(/äº¬è±/g,"")).replace(/ð¶/g,"")).replace(/çº¢å/g,"Hå"),i.data="email"===o?{t:e,c:t}:`${e}\n\n${t}`;const a=function(e){switch(e){case"send":return"ä¸ªäºº";case"group":return"QQç¾¤";case"wx":return"å¾®ä¿¡";case"ww":return"ä¼ä¸å¾®ä¿¡";case"email":return"é®ä»¶";default:return"æªç¥æ¹å¼"}};ju.post(i).then((e=>{200===e.code?ia.info(`é·æ¨åé${a(o)}éç¥æ¶æ¯æåð`):400===e.code?ia.info(`QQé·æ¨(Cool Push)åé${a(o)}æ¨éå¤±è´¥ï¼${e.msg}`):503===e.code?ia.info(`QQé·æ¨åºéï¼${e.message}ï¼${e.data}`):ia.info(`é·æ¨æ¨éå¼å¸¸: ${JSON.stringify(e)}`)})).catch((e=>{ia.info(`åé${a(o)}éç¥è°ç¨APIå¤±è´¥ï¼ï¼`),ia.info(e)})).finally((()=>{n("")}))}else n("")}))}function Ku(e,t,n={}){return new Promise((r=>{const{BARK_PUSH:o,BARK_SOUND:i,BARK_GROUP:a}=Fu;if(o){const s={url:`${o}/${encodeURIComponent(e)}/${encodeURIComponent(t)}?sound=${i}&group=${a}&${Wi(n)}`,headers:{"Content-Type":"application/x-www-form-urlencoded"},timeout:15e3};ju.get(s).then((e=>{200===e.code?ia.info("Bark APPåééç¥æ¶æ¯æåð"):ia.info(`Bark APPåééå¤±è´¥ï¼${e.message}`)})).catch((e=>{ia.info("Bark APPåééç¥è°ç¨APIå¤±è´¥ï¼ï¼"),ia.error(e)})).finally((()=>{r("")}))}r("")}))}function Hu(e,t){return new Promise((async n=>{const{TG_BOT_TOKEN:r,TG_USER_ID:o,TG_API_HOST:i,TG_PROXY_HOST:a,TG_PROXY_PORT:c,TG_PROXY_AUTH:u}=Fu;if(r&&o){const f={url:`https://${i}/bot${r}/sendMessage`,data:`chat_id=${o}&text=${e}\n\n${t}&disable_web_page_preview=true`,headers:{"Content-Type":"application/x-www-form-urlencoded"},timeout:15e3};if(a&&c){const e=(await Promise.resolve().then((function(){return s(require("tunnel"))}))).httpsOverHttp({proxy:{host:a,port:+c,proxyAuth:u},maxSockets:1});Object.assign(f,{httpsAgent:e})}ju.post(f).then((e=>{e.ok?ia.info("Telegramåééç¥æ¶æ¯æåðã"):400===e.error_code?ia.info("è¯·ä¸»å¨ç»botåéä¸æ¡æ¶æ¯å¹¶æ£æ¥æ¥æ¶ç¨æ·IDæ¯å¦æ­£ç¡®ã"):401===e.error_code&&ia.info("Telegram bot token å¡«åéè¯¯ã")})).catch((e=>{ia.info("telegramåééç¥æ¶æ¯å¤±è´¥ï¼ï¼"),ia.info(e)})).finally((()=>{n("")}))}else n("")}))}function Wu(e,t){return new Promise((n=>{const{DD_BOT_TOKEN:r,DD_BOT_SECRET:o}=Fu,i={url:`https://oapi.dingtalk.com/robot/send?access_token=${r}`,data:{msgtype:"text",text:{content:` ${e}\n\n${t}`}},headers:{"Content-Type":"application/json"},timeout:15e3};if(r){if(o){const e=require("crypto"),t=Date.now(),n=e.createHmac("sha256",o);n.update(`${t}\n${o}`);const r=encodeURIComponent(n.digest("base64"));i.url=`${i.url}&timestamp=${t}&sign=${r}`}ju.post(i).then((e=>{0===e.errcode?ia.info("ééåééç¥æ¶æ¯æåðã"):ia.info(`ééåééç¥å¤±è´¥ï¼${e.errmsg}`)})).catch((e=>{ia.info("ééåééç¥æ¶æ¯å¤±è´¥ï¼ï¼"),ia.info(e)})),n("")}else n("")}))}function Yu(e,t){return new Promise((n=>{const{QYWX_KEY:r}=Fu,o={url:`https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=${r}`,data:{msgtype:"text",text:{content:` ${e}\n\n${t}`}},headers:{"Content-Type":"application/json"},timeout:15e3};r&&ju.post(o).then((e=>{0===e.errcode?ia.info("ä¼ä¸å¾®ä¿¡åééç¥æ¶æ¯æåðã"):ia.info(`ä¼ä¸å¾®ä¿¡åééç¥å¤±è´¥ï¼${e.errmsg}`)})).catch((e=>{ia.info("ä¼ä¸å¾®ä¿¡åééç¥æ¶æ¯å¤±è´¥ï¼ï¼"),ia.info(e)})).finally((()=>{n("")})),n("")}))}function Qu(e){const{QYWX_AM:t}=Fu,n=null==t?void 0:t.split(",");if(n[2]){const t=n[2].split("|");let r="";for(let n=0;n<t.length;n++){const o="ç­¾å°å· "+(n+1);e.match(o)&&(r=t[n])}return r||(r=n[2]),r}return"@all"}function Vu(e,t){return new Promise((n=>{const r=Fu.QYWX_AM;if(r){const o=r.split(","),i={url:"https://qyapi.weixin.qq.com/cgi-bin/gettoken",data:{corpid:`${o[0]}`,corpsecret:`${o[1]}`},headers:{"Content-Type":"application/json"},timeout:15e3};ju.post(i).then((r=>{const i=t.replace(/\n/g,"<br/>"),a=JSON.parse(r).access_token;let s;switch(o[4]){case"0":s={msgtype:"textcard",textcard:{title:`${e}`,description:`${t}`,url:"https://github.com/whyour/qinglong",btntxt:"æ´å¤"}};break;case"1":s={msgtype:"text",text:{content:`${e}\n\n${t}`}};break;default:s={msgtype:"mpnews",mpnews:{articles:[{title:`${e}`,thumb_media_id:`${o[4]}`,author:"æºè½å©æ",content_source_url:"",content:`${i}`,digest:`${t}`}]}}}o[4]||(s={msgtype:"text",text:{content:`${e}\n\n${t}`}}),s={url:`https://qyapi.weixin.qq.com/cgi-bin/message/send?access_token=${a}`,data:{touser:`${Qu(t)}`,agentid:`${o[3]}`,safe:"0",...s},headers:{"Content-Type":"application/json"}},ju.post(s).then((e=>{0===e.errcode?ia.info("æåID:"+Qu(t)+"ä¼ä¸å¾®ä¿¡åºç¨æ¶æ¯åééç¥æ¶æ¯æåðã"):ia.info(`ä¼ä¸å¾®ä¿¡åºç¨ï¼${e.errmsg}`)})).catch((e=>{ia.info("æåID:"+Qu(t)+"ä¼ä¸å¾®ä¿¡åºç¨æ¶æ¯åééç¥æ¶æ¯å¤±è´¥ï¼ï¼"),ia.info(e)})).finally((()=>{n("")}))})).catch((e=>{ia.error("ä¼ä¸å¾®ä¿¡åºç¨æ¶æ¯åééç¥æ¶æ¯å¤±è´¥ï¼ï¼")}))}else n("")}))}function Xu(e,t,n={}){return new Promise((r=>{const{IGOT_PUSH_KEY:o}=Fu;if(o){if(!new RegExp("^[a-zA-Z0-9]{24}$").test(o))return ia.info("æ¨ææä¾çIGOT_PUSH_KEYæ æ"),void r("");const i={url:`https://push.hellyw.com/${o.toLowerCase()}`,data:`title=${e}&content=${t}&${Wi(n)}`,headers:{"Content-Type":"application/x-www-form-urlencoded"},timeout:15e3};ju.post(i).then((e=>{"string"==typeof e&&(e=JSON.parse(e)),0===e.ret?ia.info("iGotåééç¥æ¶æ¯æåð"):ia.info(`iGotåééç¥æ¶æ¯å¤±è´¥ï¼${e.errMsg}`)})).catch((e=>{ia.info("iGotåééç¥è°ç¨APIå¤±è´¥ï¼ï¼"),ia.info(e)})).finally((()=>{r("")}))}else r("")}))}function Zu(e,t){return new Promise((n=>{const{PUSH_PLUS_TOKEN:r,PUSH_PLUS_USER:o}=Fu;if(r){t=t.replace(/[\n\r]/g,"<br>");const i={url:"https://www.pushplus.plus/send",data:{token:`${r}`,title:`${e}`,content:`${t}`,topic:`${o}`},headers:{"Content-Type":" application/json"},timeout:15e3};ju.post(i).then((e=>{200===e.code?ia.info(`push+åé${o?"ä¸å¯¹å¤":"ä¸å¯¹ä¸"}éç¥æ¶æ¯å®æã`):ia.info(`push+åé${o?"ä¸å¯¹å¤":"ä¸å¯¹ä¸"}éç¥æ¶æ¯å¤±è´¥ï¼${e.msg}`)})).catch((e=>{ia.info(`push+åé${o?"ä¸å¯¹å¤":"ä¸å¯¹ä¸"}éç¥æ¶æ¯å¤±è´¥ï¼ï¼`),ia.info(e)})).finally((()=>{n("")}))}else n("")}))}var ef=Object.freeze({__proto__:null,sendMessage:async function(e,t){ia.info("----ãæ¶æ¯æ¨éã----"),e=`Bili-${function(e=""){const t=e.length;return t<=3?e:`${e[0]}**${e[t-1]}`}(null==As?void 0:As.nickname)||Rs.USERID}-${e}`,await async function(e,t,n={},r="\n\næ¬éç¥ Byï¼https://github.com/KudouRan/BiliTools"){zu(),t+=r,await Promise.all([qu(e,t),Zu(e,t)]),await Promise.all([Ku(e,t,n),Hu(e,t),Wu(e,t),Yu(e,t),Vu(e,t),Xu(e,t,n),Mu(e,t),Ju(e,t),Gu(e,t)])}(e,t,void 0,"")}});function tf(){ia.info("å½åçæ¬ãv0.5.220710-rc1ã")}function nf(e,t){if(e.startsWith("v")&&(e=e.substring(1)),t.startsWith("v")&&(t=t.substring(1)),e===t)return!1;const n=e.split("."),r=t.split(".");for(let e=0;e<n.length;e++){const t=parseInt(n[e]),o=parseInt(r[e]);if(isNaN(t)||isNaN(o))return!0;if(t<o)return!0}return!1}var rf=Object.freeze({__proto__:null,printVersion:async function(){let e="v0.5.220710-rc1";e.includes(".")?tf():e=void 0;try{if(e||(e="v"+(function(){try{return require("../../package.json").version}catch{}}()||function(){try{return f.readFileSync(u.resolve(__dirname,"../version.txt"),"utf8").trim()}catch{}}()),ia.info(`å½åçæ¬ã${e}ã`)),!e)return;const t=await async function(){const e={timeout:6e3};try{return(await Promise.any([ju.get("https://api.github.com/repos/KudouRan/BiliTools/releases/latest",e),ju.get("https://gitee.com/api/v5/repos/KudouRan/BiliTools/releases/latest",e)])).tag_name}catch(e){return}}();t&&nf(e,t)&&ia.info(`å¯æ´æ°ï¼ææ°çæ¬ã${t}ã`)}catch{}},printStrVersion:tf,checkVersion:nf});var of=Object.freeze({__proto__:null,default:async function(e,t,n,r,o=2){if(!e.TriggerName)return!1;if(!process.env.TENCENT_SECRET_ID||!process.env.TENCENT_SECRET_KEY)return ia.info("ç¯å¢åéä¸å­å¨TENCENT_SECRET_IDåTENCENT_SECRET_KEY"),!1;const i=await async function(){try{return await Promise.resolve().then((function(){return s(require("tencentcloud-sdk-nodejs"))}))}catch{ia.warn("tencentcloud-sdk-nodejs not foundï¼è¿è¡ cd src && yarn add tencentcloud-sdk-nodejs")}}();if(!i)return!1;const a=i.scf.v20180416.Client,c=t.function_name,u=e.TriggerName,f=new a({credential:{secretId:process.env.TENCENT_SECRET_ID.trim(),secretKey:process.env.TENCENT_SECRET_KEY.trim()},region:t.tencentcloud_region,profile:{httpProfile:{endpoint:"scf.tencentcloudapi.com"}}});async function l(){const e=r||Fi(Rs.dailyRunTime,"scf"),t={FunctionName:c,TriggerName:u,Type:"timer",TriggerDesc:e.value,Qualifier:"$DEFAULT"},o=await async function(){try{const{Triggers:e}=await f.ListTriggers({FunctionName:c});return-1!==(null==e?void 0:e.findIndex((e=>e.TriggerName===u)))}catch({code:e,message:t}){return ia.error(`è·åtriggerå¤±è´¥ ${e} => ${t}`),!1}}();if(ia.info(`ä¿®æ¹æ¶é´ä¸ºï¼${e.string}`),o){const e=await async function(e){try{return await f.DeleteTrigger(e)}catch({code:e,message:t}){return ia.warn(`å é¤triggerå¤±è´¥ ${e} => ${t}`),!1}}(t);if(!e)return}return!!await async function(e){const t=Ai();e.CustomArgument=JSON.stringify({...n,lastTime:t.getDate().toString()});try{return await f.CreateTrigger(e)}catch({code:e,message:t}){return ia.error(`åå»ºtriggerå¤±è´¥ ${e} => ${t}`),!1}}(t)}let d=!1;for(;!d&&o;)d=await l(),o--;return d}});var af=Object.freeze({__proto__:null,default:async function(e,t,n,r,o=2){if(!e.triggerName)return!1;if(!process.env.ALI_SECRET_ID||!process.env.ALI_SECRET_KEY)return ia.info("ç¯å¢åéä¸å­å¨ALI_SECRET_IDåALI_SECRET_KEY"),!1;const i=await async function(){try{return await Promise.resolve().then((function(){return s(require("@alicloud/fc2"))}))}catch{ia.warn("@alicloud/fc2 not foundï¼è¿è¡ yarn add @alicloud/fc2")}}();if(!i)return!1;const a=i.default,c=t.function.name,u=e.triggerName,f=t.service.name,l=new a(t.accountId,{accessKeyID:process.env.ALI_SECRET_ID.trim(),accessKeySecret:process.env.ALI_SECRET_KEY.trim(),region:t.region});async function d(){const e=r||Fi(Rs.dailyRunTime,"fc");return ia.info(`ä¿®æ¹æ¶é´ä¸ºï¼${e.string}`),!!await async function(e){const t=Ai(),r=`CRON_TZ=Asia/Shanghai ${e}`;try{return await l.updateTrigger(f,c,u,{triggerConfig:{cronExpression:r,payload:JSON.stringify({...n,lastTime:t.getDate().toString()})}})}catch(e){return ia.error(`æ´æ°triggerå¤±è´¥ ${e.message}`),!1}}(e.value)}let p=!1;for(;!p&&o;)p=await d(),o--;return p}});const sf=Pu({baseURL:_s,headers:{"user-agent":Rs.userAgent}}),cf=Pu({baseURL:bs,headers:{Referer:hs,"user-agent":Rs.userAgent}}),uf=Pu({baseURL:$s,headers:{Referer:hs,"user-agent":Rs.userAgent}}),ff=Pu({baseURL:Ts,headers:{"user-agent":Rs.userAgent}}),lf=Pu({baseURL:Ss,headers:{"user-agent":Rs.userAgent}}),df=Pu({baseURL:Os,headers:{"user-agent":Rs.userAgent}});function pf(){return uf.get("x/web-interface/nav",{headers:{Origin:ls}})}function gf(){return sf.get("site/getCoin")}function mf(e=1,t=50,n=-10){return uf.get("x/relation/tag",{params:{tagid:n,pn:e,ps:t}})}function hf(e){return uf.post("x/relation/modify",{fid:e,act:2,re_src:11,spmid:"333.999.0.0",jsonp:"jsonp",csrf:Rs.BILIJCT})}function yf(e,t){return uf.post("x/relation/tags/addUsers?cross_domain=true",{fids:e,tagids:t,csrf:Rs.BILIJCT},{headers:{Origin:ps}})}function vf(e,t,n=1){return uf.post("/x/web-interface/coin/add",{aid:e,multiply:t,selectLike:n,csrf:Rs.BILIJCT})}function wf(e,t=1){return Lu.post("https://www.bilibili.com/audio/music-service-c/web/coin/add",{sid:e,multiply:t,csrf:Rs.BILIJCT})}const _f="video",bf="audio",$f="article";async function Tf(e=!0){try{const t=Rs.USERID,{data:n,message:r,code:o}=await(e?function(e=1,t=50){return mf(e,t,-10)}():function(e,t=1,n=50,r="desc",o="attention"){return uf.get("x/relation/followings",{params:{vmid:e,pn:t,ps:n,order:r,order_type:o}})}(t)),i=e?n:n.list;if(!i||0===i.length)return{msg:"æ²¡æå³æ³¨åè¡¨",code:1,data:{}};if(0===o){await Ds();const{mid:e}=Yi(i)||{};return await Cf(e)}return{msg:e?`æªè·åå°ç¹å«å³æ³¨åè¡¨: ${o}-${r}`:`æªè·åå°å³æ³¨åè¡¨: ${o}-${r}`,code:-1,data:{}}}catch(e){return{msg:e.message,code:-2,data:{}}}}async function Sf(){const e=Yi([1,3,4,5,160,22,119]);try{const{data:t,message:n,code:r}=await function(e=1,t=3){return uf.get("/x/web-interface/ranking/region",{params:{rid:e,day:t}})}(e,3);if(0==r){const{aid:e,title:n,author:r}=Yi(t);return{code:0,data:{id:Number(e),title:n,author:r}}}return{msg:`æªè·åå°æè¡ä¿¡æ¯: ${r}-${n}`,code:-1,data:{}}}catch(e){return{msg:e.message,code:-2,data:{}}}}async function Of(){const e=Rs.coin.customizeUp;return 0===e.length?{code:1,data:{}}:await Cf(Yi(e))}async function Cf(e){try{const{code:t,data:n,message:r}=await function(e){return uf.get(`/x/space/navnum?mid=${e}`)}(e);if(t)return{msg:`éè¿uidè·åè§é¢å¤±è´¥: ${t}-${r}`,code:-1,data:{}};await Ds();const{video:o,audio:i,article:a}=n,s=function([e,t,n]){const r=e+t+n;if(!r)return;const o=Bi(0,r-1);let i=o;if(o<e)return{coinType:_f,page:Di(30,i+1),index:i%30};const a=e+t;return i=o-e,o<a?{coinType:bf,page:Di(30,i+1),index:i%30}:(i=o-a,{coinType:$f,page:Di(12,i+1),index:i%12})}([o,i,a]);if(!s)return{msg:"ç¨æ·æ²¡ææç¨¿",code:1,data:{}};const{coinType:c,page:u,index:f}=s,l={[_f]:kf,[bf]:If,[$f]:Ef},d=await l[c](e,u,f);return d.message?{msg:d.message,code:-1,data:{}}:{code:0,data:d}}catch(e){return ia.debug(e),{msg:e.message,code:-2,data:{}}}}async function kf(e,t,n){const{code:r,data:o,message:i}=await function(e,t=30,n=1,r=""){return uf.get("/x/space/arc/search",{params:{jsonp:"jsonp",order:"pubdate",keyword:r,pn:n,tid:0,ps:t,mid:e}})}(e,30,t);if(r)return{message:i};const{aid:a,title:s,author:c}=o.list.vlist[n];return{coinType:_f,id:a,title:s,author:c}}async function If(e,t,n){const{code:r,data:o,msg:i}=await function(e,t=30,n=1){return uf.get("/audio/music-service/web/song/upper",{params:{jsonp:"jsonp",order:1,pn:n,ps:t,uid:e}})}(e,30,t);if(r)return{message:i};const{data:a}=o,{id:s,uname:c,title:u}=a[n];return{coinType:bf,id:s,title:u,author:c}}async function Ef(e,t,n){const{code:r,data:o,message:i}=await function(e,t=12,n=1){return uf.get("/x/space/article",{params:{callback:"__test",jsonp:"jsonp",sort:"publish_time",pn:n,ps:t,mid:e},requestOptions:{isJsonp:!0}})}(e,12,t);if(r)return{message:i};const{articles:a}=o,{id:s,title:c,author:{name:u}}=a[n];return{coinType:$f,id:s,title:c,author:u,mid:e}}function xf(){return Tf(!1)}async function Pf(){const e=function(){const e=function(){var e;const t=[Of,Tf,xf,Sf];return 0===(null===(e=Rs.coin.customizeUp)||void 0===e?void 0:e.length)&&t.shift(),t}();return e.splice(0,As.currentStartFun),e[0]||Sf}();return await Ds(),e()}async function jf({id:e,coin:t=1,coinType:n="video",mid:r}){const o={[_f]:vf,[bf]:wf,[$f]:(e,t=1)=>function(e,t,n=1){return uf.post("/x/web-interface/coin/add",{aid:t,upid:e,avtype:2,multiply:n,csrf:Rs.BILIJCT})}(r,e,t)},i=await o[n](Number(e),t);return{code:i.code,message:i.message||i.msg}}async function Lf(){const e=await async function(){try{const{data:e,code:t}=await uf.get("x/web-interface/coin/today/exp");if(0===t)return e/10}catch(e){ia.debug(`è·åæå¸æ°éå¼å¸¸ ${e.message}`)}}();return e||await async function(){try{const{code:e,message:t,data:n}=await uf.get("x/member/web/coin/log?jsonp=jsonp",{headers:{origin:ls}});if(0!==e)return void ia.warn(`è·åæå¸æ¶èç¡¬å¸å¤±è´¥ï¼${e} ${t}`);const r=n.list;if(!r||!r.length)return;const o=r.filter((e=>{if(-2!==e.delta&&-1!==e.delta)return!1;const{reason:t,time:n}=e;return t&&n&&t.startsWith("ç»")&&t.endsWith("æèµ")?!!n.startsWith(Ni()):void 0})).reduce(((e,t)=>e+t.delta),0);return Math.abs(o)}catch(e){ia.debug(`è·åæå¸æ¶èç¡¬å¸å¼å¸¸ ${e.message}`)}}()}var Rf=Object.freeze({__proto__:null,default:async function(){ia.info("----ãæ¯æ¥ä»»å¡å®ææåµã----");try{const{data:e,message:t,code:n}=await uf.get("x/member/web/exp/reward");await Ds();const r=await Lf();if(0!=n)return void ia.warn(`ç¶æè·åå¤±è´¥: ${n} ${t}`);const o=As.money-Rs.coin.stayCoins;let i=0;0===As.coinsTask?ia.info(`ä»æ¥æå¸æ°éï¼${r}ï¼è¿éæå¸0é¢ï¼ç»éªå¤äºï¼ä¸æ³æäº`):o<=0?ia.info(`ä»æ¥æå¸æ°éï¼${r}ï¼è¿éæå¸0é¢ï¼ç¡¬å¸ä¸å¤äºï¼ä¸æå¸äº`):o<As.coinsTask?(i=o,ia.info(`æå¸æ°é: ${r}ï¼è¿è½æå¸æ°é: ${o}é¢;(ç®æ ${As.coinsTask}é¢ï¼å¿½ç¥é¨åæå¸)`)):(i=As.coinsTask-r,ia.info(`æå¸æ°éï¼${r}ï¼è¿éæå¸æ°é: ${i}é¢;(ç®æ ${As.coinsTask}é¢)`)),As.coinsTask=i,ia.info("æ¯æ¥åäº«: "+(e.share?"å·²å®æ":"[æªå®æ]")),ia.info("æ¯æ¥æ­æ¾: "+(e.watch?"å·²å®æ":"[æªå®æ]")),As.share=e.share,As.watch=e.watch}catch(e){ia.error(`ç¶æè·åå¼å¸¸ ${e.message}`)}}});function Af(e=1,t=50,n=1){return cf.get(`/xlive/app-ucenter/v1/fansMedal/panel?page=${e}&page_size=${t}&target_id=${n}`)}function Nf({ruid:e,gift_num:t,bag_id:n,gift_id:r,roomid:o}){const i=Rs.BILIJCT,a=i,s={gift_id:r,ruid:e,gift_num:t,bag_id:n,biz_id:o,rnd:(new Date).getTime(),send_ruid:0,storm_beat_id:0,metadata:"",price:0,visit_id:"",csrf:i,platform:"pc",biz_code:"Live",csrf_token:a,uid:Rs.USERID};return cf.post("/xlive/revenue/v2/gift/sendBag",s,{headers:{Origin:ds}})}function Uf(e){return cf.get(`/xlive/lottery-interface/v1/Anchor/Check?roomid=${e}`)}var Df=Object.freeze({__proto__:null,default:async function(){ia.info("----ãç´æ­ç­¾å°ã----");try{const{data:e}=await cf.get("/xlive/web-ucenter/v1/sign/WebGetSignInfo");if(1===e.status)return ia.info("å·²ç­¾å°ï¼è·³è¿ç­¾å°"),void ia.info(`å·²ç»ç­¾å°${e.hadSignDays}å¤©ï¼${e.specialText}`)}catch(e){ia.debug(`ç´æ­ç­¾å°ï¼${e.message}`)}try{const{code:e,data:t,message:n}=await cf.get("/xlive/web-ucenter/v1/sign/DoSign");0===e?ia.info(`ç´æ­ç­¾å°æå: ${t.text}ï¼ç¹å«ä¿¡æ¯: ${t.specialText}ï¼æ¬æç­¾å°å¤©æ°: ${t.hadSignDays}å¤©;`):ia.warn(`ç´æ­ç­¾å°å¤±è´¥: ${e} ${n}`)}catch(e){ia.error(`ç´æ­ç­¾å°å¼å¸¸: ${e.message}`)}}});async function Bf(e){if(await async function(){let e=await Lf();e||(e=Rs.coin.todayCoins);const t=Rs.coin.targetCoins-e;As.coinsTask=t>0?t:0}(),As.coinsTask<=0||As.money<=0)return!0;const{data:t,code:n,msg:r}=await Pf();return 1===n?(As.currentStartFun++,!1):t&&t.id&&0===n?e.prevFillId===t.id?(As.currentStartFun++,!1):(await Ds(),await async function(e,t){const{id:n,coinType:r,mid:o}=e;try{const i=await jf({id:n,coinType:r,mid:o});switch(i.code){case 0:return function(e,{title:t,author:n}){return As.money--,As.coinsTask--,e.num++,ia.info(`ç»[ ${t}--upã${n}ã]æå¸æå`),!1}(t,e);case 34005:return function(e,t){t.fillCount++,t.prevFillId=e,ia.verbose(`å½åç¨¿ä»¶[${e}]ä¸è½åæå¸äº`),t.fillCount>=3&&(ia.warn("è¯¥ç±»åçç¨æ·ç»ä¼¼ä¹æ²¡æå¸å¯æäº"),t.fillCount=0,As.currentStartFun++);return!1}(n,t);case-104:case-111:return function(e,t){return ia.warn(`${e} ${t.message} æ æ³ç»§ç»­è¿è¡æå¸`),!0}(n,i);default:return function(e,t,n){if(t.eCount++,ia.warn(`ç»${e}æå¸å¤±è´¥ ${n.code} ${n.message}`),t.prevCode===n.code)return!0;return t.prevCode=n.code,!1}(n,t,i)}}catch(e){t.eCount++,ia.error(`æå¸å¼å¸¸ ${e.message}`)}return!1}(t,e)):(r&&ia.debug(r),e.eAidCount++,e.eAidCount>=10&&(ia.warn("è·åç¨¿ä»¶éè¯¯æ¬¡æ°è¶è¿ 10 æ¬¡ï¼èªå¨éåºæå¸"),!0))}var Ff=Object.freeze({__proto__:null,default:async function(){if(ia.info("----ãè§é¢æå¸ã----"),!As.coinsTask)return void ia.info("è·³è¿æå¸ï¼ä»æ¥å·²å®æ");const e={eCount:0,num:0,prevCode:void 0,fillCount:0,prevFillId:void 0,eAidCount:0};let t=!1;for(;As.coinsTask>0&&!t&&e.eCount<5&&e.num<5;)t=await Bf(e);e.eCount>=5&&ia.info("åºç°å¼å¸¸/éè¯¯5æ¬¡ï¼èªå¨éåºæå¸"),ia.info(`ä¸å±æåæå¸${e.num}é¢`),ia.info(`ç¡¬å¸è¿å©${As.money}é¢`)}}),zf=it,Mf=_c,Jf=Pt.f,qf=zf("unscopables"),Gf=Array.prototype;null==Gf[qf]&&Jf(Gf,qf,{configurable:!0,value:Mf(null)});var Kf=Fe,Hf=cr,Wf=tr,Yf=function(e){Gf[qf][e]=!0};Vr({target:"Array",proto:!0},{at:function(e){var t=Kf(this),n=Hf(t),r=Wf(e),o=r>=0?r:n+r;return o<0||o>=n?void 0:t[o]}}),Yf("at");var Qf=Vr,Vf=K,Xf=tr,Zf=Oo,el=y,tl=A("".charAt);Qf({target:"String",proto:!0,forced:el((function(){return"\ud842"!=="ð ®·".at(-2)}))},{at:function(e){var t=Zf(Vf(this)),n=t.length,r=Xf(e),o=r>=0?r:n+r;return o<0||o>=n?void 0:tl(t,o)}});const nl={"app-key":"android64",env:"prod","user-agent":Rs.mobileUA};const rl={ogvwatch:"è§çæ­£ç",tvodbuy:"è´­ä¹°è§é¢",vipmallbuy:"è´­ä¹°åå",bonus:"å¤§ä¼åç¦å©",privilege:"æµè§ä¼åæç","626act":"æµè§âæçåå©å°å±â",animatetab:"æµè§è¿½çª",filmtab:"æµè§å½±è§",vipmallview:"æµè§ä¼åè´­"};async function ol(){try{const{code:e,data:t,message:n}=await uf.get("x/vip_point/task/combine",{headers:nl});return 0!==e&&ia.error(`æ¥çå½åç¶æå¤±è´¥: ${e} ${n}`),t}catch(e){ia.error(e)}}async function il(){var e;const t=await ol();if(!t)return;const{vip_info:{status:n,type:r},point_info:{point:o},task_info:i}=t;if(!async function(e,t,n){if(ia.info(`å½åç§¯å: ${n}`),0===e||0===t)return void ia.warn("å½åæ å¤§ä¼åï¼æ æ³ç»§ç»­æ§è¡ä»»å¡");return!0}(n,r,o))return;if(i.score_month>=i.score_limit)return void ia.info("æ¬æç§¯åå·²é¢åå®");-401!==await async function(e){if(!e||!e.length)return;const t=e.find((e=>e.is_today));if(!t)return;if(t.signed)return void ia.info("ä»æ¥å·²ç­¾å° â");try{const{code:e,message:t}=await uf.post("pgc/activity/score/task/sign",Is({csrf:Rs.BILIJCT}),{headers:nl});return 0===e?(ia.info("ç­¾å°æå â"),e):(ia.error(`ç­¾å°å¤±è´¥: ${e} ${t}`),e)}catch(e){ia.error(e)}return-1}(null===(e=i.sing_task_item)||void 0===e?void 0:e.histories)?(await Ds(100,200),await async function(e){var t,n;function r(e){return!!e&&(!(e.vip_limit>As.vipType)&&(0===e.state||void 0))}const o=null===(t=e.modules.at(-1))||void 0===t||null===(n=t.common_task_item)||void 0===n?void 0:n.filter(r);if(!o||!o.length)return ia.info("æ²¡æéè¦é¢åçä»»å¡"),!1;return await async function(e){for(const t of e)await fl(t),await Ds(100,300)}(o.map((e=>e.task_code))),ia.info("é¢åä»»å¡å®æ"),!0}(i)?(await Ds(100,200),await al(await ol())):await al(t)):ia.error("åºç°éæ³è®¿é®å¼å¸¸ï¼å¯è½è´¦å·å­å¨å¼å¸¸ï¼æ¾å¼å¤§ç§¯åä»»å¡")}async function al(e){var t,n;if(!e||!e.task_info)return;const r=null===(t=e.task_info.modules)||void 0===t||null===(n=t.at(-1))||void 0===n?void 0:n.common_task_item;if(!r)return void ia.info("æ²¡æéè¦å®æçæ¯æ¥ä»»å¡");const o=r.filter((e=>!(e.vip_limit>As.vipType)&&(!(e.complete_times>=e.max_times)&&(1===e.state||void 0))));await async function(e){for(const t of e){switch(t.task_code){case"ogvwatch":await sl(t.complete_times);break;case"filmtab":await cl("tv_channel","æµè§å½±è§é¢é");break;case"animatetab":await cl("jp_channel","æµè§è¿½çªé¢é");break;case"vipmallview":await ul()}await Ds(1e3,3e3)}}(o)}async function sl(e){try{const t=function(e,t,n,r=[]){let o=Bi(t,n);for(;r.includes(o);)o=Bi(t,n);return Number(e+o)}("327",107,134,[122,123]),n=1===e?Bi(905,1800):Bi(1805,2e3);await function({start_ts:e,aid:t=243332804,cid:n=209599683,type:r=4,sub_type:o=5,dt:i=2,play_type:a=0,realtime:s=0,played_time:c=10,real_played_time:u=0,refer_url:f="",sid:l=33622,epid:d=327107}){return uf.post("x/click-interface/web/heartbeat",{start_ts:e,mid:Rs.USERID,aid:t,cid:n,type:r,sub_type:o,dt:i,play_type:a,realtime:s,played_time:c,real_played_time:u,refer_url:f,bsource:"",sid:l,epid:d,spmid:"666.25",from_spmid:"..0.0",csrf:Rs.BILIJCT})}({start_ts:Zi()-n,realtime:n,played_time:Bi(1e3)+n,real_played_time:n,refer_url:"https://www.bilibili.com/bangumi/media/md28229051/",epid:t}),ia.info("è§çè§é¢ï¼è¥¿æ¸¸è®°ï¼ä»»å¡ â")}catch(e){ia.error(e),ia.error(`è§çè§é¢ä»»å¡åºç°å¼å¸¸ï¼${e.message}`)}}async function cl(e,t){try{await uf.post("pgc/activity/deliver/susWin/receive",Is({csrf:Rs.BILIJCT}),{headers:nl}),Ds(1e3,2e3);const{code:r,message:o}=await(n=e,uf.post("pgc/activity/deliver/task/complete",Is({csrf:Rs.BILIJCT,position:n}),{headers:{...nl,referer:ys}}));if(0!==r)return void ia.error(`${t}å¤±è´¥: ${r} ${o}`);ia.info(`${t}æ¯æ¥ä»»å¡ â`)}catch(e){ia.error(e),ia.error(`æ¯æ¥ä»»å¡${t}åºç°å¼å¸¸ï¼${e.message}`)}var n}async function ul(){try{const{code:t,message:n}=await(e="hevent_oy4b7h3epeb",Lu.post(`https://show.bilibili.com/api/activity/fire/common/event/dispatch?${Is({csrf:Rs.BILIJCT})}`,{eventId:e},{headers:{"content-type":"application/json; charset=utf-8",...nl}}));if(0===t)return void ia.info("æµè§ä¼åè´­æ¯æ¥ä»»å¡ â");ia.error(`æµè§ä¼åè´­å¤±è´¥: ${t} ${n}`)}catch(e){ia.error(e),ia.error(`æ¯æ¥ä»»å¡ä¼åè´­åºç°å¼å¸¸ï¼${e.message}`)}var e}async function fl(e){try{const{code:t,message:n}=await function(e="ogvwatch"){return uf.post("pgc/activity/score/task/receive",{csrf:Rs.BILIJCT,ts:Zi(),taskCode:e},{http2:!0,headers:{"Content-Type":"application/json; charset=utf-8",Referer:vs,...nl,navtive_api_from:"h5"}})}(e);if(0===t)return!0;ia.error(`é¢åä»»å¡${rl[e]}å¤±è´¥: ${t} ${n}`)}catch(e){ia.error(e)}}var ll=Object.freeze({__proto__:null,default:async function(){ia.info("----ãå¤§ä¼åç§¯åã----");try{if(0===As.vipType||0===As.vipStatus)return void ia.info("å½åä¸æ¯å¤§ä¼åï¼è·³è¿ä»»å¡");await il(),ia.info("å¤§ä¼åç§¯åä»»å¡ç»æ")}catch(e){ia.error(`å¤§ä¼åç§¯åä»»å¡å¼å¸¸: ${e.message}`)}}});var dl=Object.freeze({__proto__:null,default:async function(){if(ia.info("----ãåäº«/æ­æ¾è§é¢ã----"),As.share&&As.watch)return void ia.info("å·²å®æï¼è·³è¿åäº«/æ­æ¾");let e=0;try{let t=await Pf();if(0!==t.code&&(t=await Sf()),0!==t.code)return ia.warn(`è·åè§é¢å¤±è´¥ ${t.msg}`),!1;{const{id:n,author:r,title:o}=t.data;e=n,ia.info(`è·åè§é¢: ${o} --upã${r}ã`)}}catch(e){return ia.error(`è·åè§é¢åºç°å¼å¸¸: ${e.message}`),!1}if(!As.share){await Ds();try{const{code:t,message:n}=await function(e){const t={csrf:Rs.BILIJCT,aid:e};return uf.post("/x/web-interface/share/add",t)}(e);0===t?ia.info("åäº«è§é¢æå!"):ia.warn(`åäº«è§é¢å¤±è´¥: ${t} ${n}`)}catch(e){ia.error(`åäº«è§é¢å¼å¸¸: ${e.message}`)}}if(!As.watch){await Ds();try{const{code:r,message:o}=await(t=e,n=Bi(4,60),uf.post("/x/click-interface/web/heartbeat",{aid:t,played_time:n}));0===r?ia.info("æ­æ¾è§é¢æå!"):ia.warn(`æ­æ¾è§é¢å¤±è´¥: ${r} ${o}`)}catch(e){ia.error(`æ­æ¾è§é¢å¼å¸¸: ${e.message}`)}}var t,n}});var pl=Object.freeze({__proto__:null,default:async function(){ia.info("----ãé¶çå­åæ¢ç¡¬å¸ã----");try{const{data:e,code:t,message:n}=await cf.get("/xlive/revenue/v1/wallet/getStatus");if(0!=t&&ia.info(`è·åçå­è¯¦æå¤±è´¥ ${n}`),0===e.silver_2_coin_left)ia.info("ä»æ¥å·²åæ¢ä¸æ¬¡");else if(e.silver<700)ia.info("åæ¢å¤±è´¥ï¼ä½ çå­ä¸å¤äº");else{const{message:e}=await cf.post("/xlive/revenue/v1/wallet/silver2coin",{csrf_token:Rs.BILIJCT,csrf:Rs.BILIJCT});ia.info(`åæ¢ç¡¬å¸ï¼ ${e}`),await cf.get("/xlive/revenue/v1/wallet/myWallet?need_bp=1&need_metal=1&platform=pc")}}catch(e){ia.error(`æä½å¼å¸¸ ${e.message}`)}}});let gl;async function ml(){gl=0;try{const{code:e,msg:t,data:n}=await function(e=1,t=50){return ff.post("twirp/user.v1.User/GetCoupons?platform=web",{not_expired:!0,page_num:e,page_size:t,tab_type:1})}();if(0!==e)return void ia.error(`è·åæ¼«è¯»å¸å¤±è´¥ï¼${e} ${t}`);const{user_coupons:r}=n;if(0===r.length)return void ia.info("æ²¡ææ¼«è¯»å¸ï¼è·³è¿ä»»å¡");const o=r.filter((e=>0!==e.will_expire));return gl=o.reduce(((e,t)=>e+t.remain_amount),0),gl}catch(e){ia.error(`è·åæ¼«è¯»å¸å¼å¸¸: ${e}`)}}async function hl(){try{const{code:e,msg:t,data:n}=await function(e=1,t=50,n=1){return ff.post("twirp/bookshelf.v1.Bookshelf/ListFavorite?platform=web",{page_num:e,page_size:t,order:n,wait_free:0})}();if(0===e)return n;ia.error(`è·åè¿½æ¼«åè¡¨å¤±è´¥ï¼${e} ${t}`)}catch(e){ia.error(`è·åè¿½æ¼«åè¡¨å¼å¸¸: ${e}`)}}async function yl(e){try{const{code:t,msg:n,data:r}=await function(e){return ff.post("twirp/comic.v1.Comic/ComicDetail",{device:"android",version:"4.16.0",comic_id:e})}(e);if(0!==t)return void ia.error(`è·åæ¼«ç»è¯¦æå¤±è´¥ï¼${t} ${n}`);if(!r||!r.ep_list)return;let o=r.ep_list;return 0!==r.disable_coupon_amount&&(o=o.slice(0,o.length-r.disable_coupon_amount)),o.filter((e=>e.is_locked))}catch(e){ia.error(`è·åæ¼«ç»è¯¦æå¼å¸¸: ${e}`)}}async function vl(e){try{const{code:t,msg:n,data:r}=await function(e){return ff.post("twirp/comic.v1.Comic/GetEpisodeBuyInfo?platform=web",{ep_id:e})}(e);if(0!==t)return void ia.error(`è·åè´­ä¹°ä¿¡æ¯å¤±è´¥ï¼${t} ${n}`);if(!r)return;if(!r.allow_coupon)return void ia.info("æ¼«ç»ä¸æ¯ææ¼«è¯»å¸");if(0===r.recommend_coupon_id||0===r.remain_coupon)return gl=0,void ia.info("æ²¡æè¶³å¤çæ¼«è¯»å¸äº");if(!r.remain_lock_ep_num)return;return r.recommend_coupon_id}catch(e){ia.error(`è·åè´­ä¹°ä¿¡æ¯å¼å¸¸: ${e}`)}}async function wl(e){try{const t=await vl(e);if(!t)return!0;const{code:n,msg:r}=await function(e,t,n=2,r=0){return ff.post("twirp/comic.v1.Comic/BuyEpisode?&platform=web",{buy_method:n,ep_id:e,coupon_id:t,auto_pay_gold_status:r})}(e,t);if(0!==n)return void ia.error(`è´­ä¹°æ¼«ç»å¤±è´¥ï¼${n} ${r}`);gl--,ia.info("è´­ä¹°æ¼«ç»æå")}catch(e){ia.error(`è´­ä¹°æ¼«ç»å¼å¸¸: ${e}`)}}async function _l(e){try{const{code:t,msg:n,data:r}=await function(e,t=1,n=9){return ff.post("twirp/comic.v1.Comic/Search?device=pc&platform=web",{keyword:e,page_num:t,page_size:n})}(e);if(0===t)return r;ia.error(`æç´¢æ¼«ç»å¤±è´¥ï¼${t} ${n}`)}catch(e){ia.error(`æç´¢æ¼«ç»å¼å¸¸: ${e}`)}}async function bl(e){const t=await yl(e);if(!t||0===t.length)return!1;for(let e=0;e<t.length;e++)if(await Ds(100),await wl(t[e].id))return!0}async function $l(){gl=await ml(),gl<1?ia.info("æ²¡æå³å°è¿æçæ¼«è¯»å¸ï¼è·³è¿ä»»å¡"):(await async function(){const{mc:e}=Rs.manga;if(0!==e.length)for(let t=0;t<e.length;t++){if(gl<=0)return;const n=e[t];await bl(n)}}(),await async function(){const{name:e}=Rs.manga;if(0!==e.length)for(let t=0;t<e.length;t++){if(gl<=0)return;const n=e[t],r=await _l(n);if(!r||0===r.list.length)continue;const o=r.list.find((e=>e.title===n));o&&await bl(o.id)}}(),await async function(){const{love:e}=Rs.manga;if(!e||gl<=0)return;const t=await hl();if(t&&0!==t.length)for(let e=0;e<t.length;e++){if(gl<=0)return;const n=t[e];await bl(n.comic_id)}}())}async function Tl(){try{const{code:e}=await function(e="android"){return ff.post("twirp/activity.v1.Activity/ClockIn",{platform:e})}();0==e?ia.info("æ¼«ç»ç­¾å°æå"):ia.warn("æ¼«ç»ç­¾å°å¤±è´¥")}catch(e){const{status:t,statusCode:n}=e.response||{};400===t||400===n?ia.info("å·²ç»ç­¾å°è¿äºï¼è·³è¿ä»»å¡"):ia.error(`æ¼«ç»ç­¾å°å¼å¸¸ ${e.message}`)}}var Sl=Object.freeze({__proto__:null,default:async function(){ia.info("----ãæ¼«ç»ç­¾å°ã----"),ia.warn("æ¼«ç»ç­¾å°ä»»å¡ç§»å¨å°äºæ¼«ç»ä»»å¡ä¸­ï¼è¯·ä¿®æ¹ä¸ºæ°çä»»å¡"),await Tl()}});var Ol=Object.freeze({__proto__:null,default:async function(){ia.info("----ãæ¼«ç»ä»»å¡ã----");const{manga:e}=Rs;try{e.sign&&(ia.info("å¼å§ç­¾å°"),await Tl());e.buy&&function(){const{buyWeek:e,buyInterval:t}=Rs.manga;if(!e||0===e.length)return!1;if(1===t)return!0;const n=new Date,r=n.getDay(),o=n.getDate();return e.includes(r)||o%t-1==0}()?(ia.info("å¼å§è´­ä¹°æ¼«ç»"),await $l()):ia.info("éè´­ä¹°æ¼«ç»æ¶é´ï¼ä¸è´­ä¹°")}catch(e){ia.error(`æ¼«ç»ä»»å¡å¼å¸¸: ${e}`)}}});async function Cl(){try{const{data:e,code:t,message:n}=await lf.get("/link_group/v1/member/my_groups");return 0===t?(null==e?void 0:e.list)||[]:(ia.warn(`è·åèªå·±çåºæ´å¢å¼å¸¸å¤±è´¥: ${n}`),[])}catch(e){ia.error(`è·åèªå·±çåºæ´å¢å¼å¸¸: ${e}`)}}async function kl(e,t){try{const{data:o,code:i,message:a}=await(n=e.group_id,r=e.owner_uid,lf.get("/link_setting/v1/link_setting/sign_in",{params:{group_id:n,owner_id:r}}));if(0!==i)return void ia.warn(`[${e.group_name}]ç­¾å°å¤±è´¥ ${a}`);0===o.status?t.value++:ia.verbose(`ç­¾å°å¤±è´¥: ${o.status} ${a}`)}catch(e){ia.error(`ç­¾å°å¼å¸¸ ${e.message}`)}finally{await Ds(400,1e3)}var n,r}var Il=Object.freeze({__proto__:null,default:async function(){ia.info("----ãåºæ´å¢ç­¾å°ã----");const e=await Cl();await Ds();const t={value:0};for(let n=0;n<e.length;n++){const r=e[n];await kl(r,t)}ia.info(`ç­¾å°ç»æï¼æå${t.value}/${e.length}`)}});function El({buvid:e=js(),gu_id:t=Mi(43).toLocaleUpperCase(),visit_id:n=Mi(32).toLocaleLowerCase(),uuid:r=Ri(),click_id:o=Ri(),room_id:i,up_id:a,uid:s,up_level:c=40,up_session:u="",parent_id:f=11,area_id:l=376}){const d={platform:"android",uuid:r,buvid:e,seq_id:"1",room_id:i,parent_id:f,area_id:l,timestamp:String(parseInt(String((new Date).getTime()/1e3))-60),secret_key:"axoaadsffcazxksectbbb",watch_time:"60",up_id:a||s,up_level:c,jump_from:"30000",gu_id:t,play_type:"0",play_url:"",s_time:"0",data_behavior_id:"",data_source_id:"",up_session:u,visit_id:n,watch_status:"",click_id:o,session_id:"-99998",player_type:"0",client_ts:String(parseInt(String((new Date).getTime()/1e3)))},p={...d,ts:parseInt(String((new Date).getTime()/1e3)),client_sign:Ps(d),csrf_token:Rs.BILIJCT,csrf:Rs.BILIJCT};return df.post("xlive/data-interface/v1/heartbeat/mobileHeartBeat",p)}const xl=["(ââ½â)","ï¼ï¿£â½ï¿£ï¼","(=ã»Ïã»=)","(ï½ã»Ïã»Â´)","(ãï¿£â³ï¿£)ã","(ï½¥âï½¥)","(Â°âÂ°)ï¾","(ï¿£3ï¿£)","â®(ï¿£â½ï¿£)â­","_(:3ãâ )_","( Â´_ãï½)","â_â","â_â","(<_<)","(>_>)","(;Â¬_Â¬)","(ï¾Ðï¾â¡ï¾Ð´ï¾)!?","Î£(ï¾Ð´ï¾;)","Î£( ï¿£â¡ï¿£||)","(Â´ï¼Ïï¼`)","ï¼/TÐT)/","(^ã»Ïã»^ )","(ï½¡ï½¥Ïï½¥ï½¡)","(âï¿£(ï½´)ï¿£â)","Îµ=Îµ=(ãâ§ââ¦)ã","(Â´ï½¥_ï½¥`)","(-_-#)","ï¼ï¿£ã¸ï¿£ï¼","(ï¿£Îµ(#ï¿£) Î£","ã½(`ÐÂ´)ï¾","ï¼#-_-)â¯ââ¯","(â¯Â°å£Â°)â¯(â´ââ´","ââ¡â","( â¥Ð´â¥)","Î£>â(ãÂ°ÏÂ°ã)â¡â","â(â ââ¢âÏââ¢â â)â","(â¬ï¾Ð´ï¾)âï¸»â»â³âä¸","ï½¥*ï½¥:â¡(ãÎµ:)","(æ±)","(è¦ç¬)"].concat("1","2","3","4","5","6","7","8","9","ç­¾å°","åå"),Pl=new ra({console:"debug",file:"debug",push:"warn",payload:As.nickname},"live");async function jl(){let e=99,t=0;const n=[];try{for(;t<e;){const{code:r,message:o,data:i}=await Af(t+1,50,Rs.USERID);if(0!==r)return ia.verbose(`è·ååç« ä¿¡æ¯å¤±è´¥ ${r} ${o}`),null;if(!i)return n;e=i.page_info.total_page,t=i.page_info.current_page,n.push(...i.list,...i.special_list)}return n}catch(e){return ia.error(`è·ååç« å¼å¸¸ ${e.message}`),null}}function Ll({room_info:e,medal:t}){if(null==e||!e.room_id)return!1;if(t.level>=20)return!1;if(t.today_feed>=t.day_limit)return!1;if(t.today_feed>=1300)return!1;const{whiteList:n,blackList:r}=Rs.intimacy;return n&&n.length?!(!n.includes(e.room_id)&&!n.includes(t.target_id)):!r||!r.includes(e.room_id)&&!r.includes(t.target_id)}async function Rl(e,t){const n=xl[Bi(xl.length-1)];try{const{code:r,message:o}=await function(e,t){const n=Rs.BILIJCT,r=n;return t||(t=Bi(10).toString()),cf.post("/msg/send",{color:5566168,fontsize:25,mode:1,msg:t,rnd:Date.now(),roomid:e,bubble:0,csrf:n,csrf_token:r})}(e,n);return 0===r||(11e3===r?(ia.warn(`ã${t}ã${e}-å¯è½æªå¼å¯è¯è®º`),!1):(ia.warn(`ã${t}ã${e}-åéå¤±è´¥ ${o}`),ia.verbose(`code: ${r}`),!1))}catch(e){ia.verbose(`åéå¼¹å¹å¼å¸¸ ${e.message}`)}}async function Al(e){try{const{code:n,message:r,data:o}=await(t=e,cf.post("xlive/web-room/v1/index/TrigerInteract",{roomid:t,interact_type:3,csrf:Rs.BILIJCT,csrf_token:Rs.BILIJCT,visit_id:""}));if(0===n)return o;ia.info(`ã${e}ãç´æ­é´åäº«å¤±è´¥ ${n} ${r}`)}catch(t){ia.warn(`åäº«ç´æ­é´ [${e}] å¼å¸¸ ${t.message}`)}var t}async function Nl(e){try{const{code:n,message:r,data:o}=await(t=e,cf.post("xlive/web-ucenter/v1/interact/likeInteract",{roomid:t,csrf:Rs.BILIJCT,csrf_token:Rs.BILIJCT}));if(0===n)return o;ia.info(`ã${e}ãç´æ­é´ç¹èµå¤±è´¥ ${n} ${r}`)}catch(e){ia.warn(`ç¹èµç´æ­é´å¼å¸¸ ${e.message}`)}var t}async function Ul(e,t){if(!(t.value>=31))try{const{code:n,message:r}=await El(e);if(0!==n)return void ia.warn(`ç´æ­é´å¿è·³å¤±è´¥ ${n} ${r}`);t.value++,Pl.info(`ç´æ­é´å¿è·³æå ${e.uname}ï¼${t.value}/31ï¼`)}catch(e){Pl.error(e),ia.error(`ç´æ­é´å¿è·³å¼å¸¸ ${e.message}`)}}async function Dl(){const e=(t=await jl())&&0!==t.length?t.filter(Ll):[];var t;return await Promise.allSettled([Bl(e),Fl(e)])}async function Bl(e){for(let t=0;t<e.length;t++){const n=e[t];await Ml(n)}}async function Fl(e){if(0===e.length)return;const{liveHeart:t}=Rs.intimacy;var n;return t?vi()?await(n=e,Promise.all(n.map((e=>async function(e,t,n){for(let r=0;r<31;r++){const{medal:r,anchor_info:o,room_info:i}=e;await Ul({up_id:r.target_id,room_id:i.room_id,uname:o.nick_name,...t},n),await Ds(6e4)}}(e,zl(),{value:0}))))):new Promise((t=>function(e,t){for(const e of t){const t={value:0},r={value:void 0},o=zl();n(e,o,t,r),r.value=setInterval(n,6e4,e,o,t,r),Bs(50,150)}async function n({medal:e,anchor_info:t,room_info:n},r,o,i){await Ul({up_id:e.target_id,room_id:n.room_id,uname:t.nick_name,...r},o),o.value>=31&&i&&i.value&&clearInterval(i.value)}e("ç´æ­é´å¿è·³")}(t,e))):void 0}function zl(){return{buvid:Rs.buvid,gu_id:Mi(43).toLocaleUpperCase(),visit_id:Mi(32).toLocaleLowerCase(),uuid:Ri(),click_id:Ri()}}async function Ml(e){const{room_info:t,anchor_info:n}=e;if(!t||!n)return;const{liveLike:r,liveSendMessage:o,liveShare:i}=Rs.intimacy,a=n.nick_name,s=t.room_id;(r||o||i)&&(o&&(Pl.verbose(`ã${a}ãå¼å§åéç´æ­å¼¹å¹`),await Rl(s,a)),i&&async function(){await Ds(100,300);for(let e=0;e<5;e++)Pl.verbose(`åäº« [${a}] ç´æ­é´`),await Al(s),await Ds(4e3)}().catch((e=>ia.error(e))),r&&async function(){await Ds(100,300);for(let e=0;e<3;e++)Pl.verbose(`ç» [${a}] ç´æ­é´ç¹èµ`),await Nl(s),await Ds(6500)}().catch((e=>ia.error(e))),await Ds(22e3))}var Jl,ql=Object.freeze({__proto__:null,default:async function(){ia.info("----ãåéç´æ­å¼¹å¹ã----"),ia.info("è¯¥å½æ°å³å°åºå¼ï¼è¯·ä½¿ç¨ liveIntimacy æ¿ä»£");try{const e=await jl(),t=e.length;let n=0,r=0;ia.info(`ä¸å±éè¦åé${t}ä¸ªç´æ­é´`),ia.verbose("æéæ¶é´å¯è½å¾é¿ï¼è¯·èå¿ç­å¾");for(let o=0;o<t;o++){const{room_info:i,anchor_info:a,medal:s}=e[o];null!=i&&i.room_id?100===s.today_feed||s.level>=20?r++:(await Rl(i.room_id,a.nick_name)&&n++,o<t-1&&await Ds(Bi(1e4,25e3))):(ia.info(`ã${a.nick_name}ãæ²¡æç´æ­é´å¦`),r++)}ia.info(`æååé${n}ä¸ªå¼¹å¹ï¼è·³è¿${r}ä¸ª`)}catch(e){ia.error(`ç´æ­é´åéå¼¹å¹å¼å¸¸: ${e.message}`)}}});async function Gl(){try{const{data:e,message:t,code:n}=await pf();if(0!==n)return void ia.warn(`è·åç¨æ·ä¿¡æ¯å¤±è´¥ï¼${n} ${t}`);!function(e){var t;As.bCoinCouponBalance=(null===(t=e.wallet)||void 0===t?void 0:t.coupon_balance)||0}(e)}catch(e){ia.error(`è·åç¨æ·ä¿¡æ¯å¼å¸¸ï¼${e.message}`)}}!function(e){e[e["æå"]=4]="æå",e[e["ä½äº20çµæ± "]=-2]="ä½äº20çµæ± ",e[e["Bå¸ä¸è¶³"]=-4]="Bå¸ä¸è¶³"}(Jl||(Jl={}));var Kl=Object.freeze({__proto__:null,default:async function(){if(ia.info("----ãç»ç®æ åçµã----"),await Gl(),await Ds(),function(){const e=Ai(),t=e.getDate(),n=Li(e);let r=Rs.charge.presetTime;return xi(r)||(r=[r]),As.bCoinCouponBalance<2?(ia.info(`å©ä½å¸ä¸º${As.bCoinCouponBalance}ï¼ä¸è¶³2è·³è¿åçµ`),!1):n===t?(ia.info("ä»å¤©æ¯æåä¸å¤©äº"),!0):!!r.some((e=>e===t))||(ia.info("ä¸å¨é¢è®¾æ¶é´ï¼ä¸ç¬¦åæ¡ä»¶"),!1)}())try{const e=As.bCoinCouponBalance||0,t=Rs.charge.mid;let n=0;ia.info(`b å¸å¸ä½é¢${e}`);const r=async()=>{const{code:n,message:r,data:o}=await function(e=50,t=!0,n=Rs.USERID,r="up",o=n){return uf.post("/x/ugcpay/web/v2/trade/elec/pay/quick",{csrf:Rs.BILIJCT,bp_num:e,is_bp_remains_prior:t,up_mid:n,otype:r,oid:o})}(e,!0,t);0===n?(ia.info(`ç®æ ã${t}ã${Jl[o.status]}`),o.status===Jl["æå"]&&(As.chargeOrderNo=o.order_no,await Ds(),await async function(){try{if(!As.chargeOrderNo)return!1;const e=wi[Bi(0,wi.length-1)],{code:t}=await function(e,t="æ¯æå¤§ä½¬ä¸æ³¢"){return uf.post("/x/ugcpay/trade/elec/message",{csrf:Rs.BILIJCT,message:t,order_id:e})}(As.chargeOrderNo,e);0===t&&ia.info("çè¨æåï¼")}catch{}}())):ia.warn(`åçµå¤±è´¥ï¼${n} ${r}`)};for(As.chargeOrderNo="";!(As.chargeOrderNo||(await r(),await Ds(),n++>2)););}catch(e){ia.error(`åçµåºç°å¼å¸¸ï¼${e.message}`)}}});async function Hl(){try{const{data:e,code:t,message:n}=await uf.get("/x/vip/privilege/my",{headers:{origin:ls,referer:hs}});if(0!==t)return void ia.info(`è·åé¢åç¶æå¤±è´¥ï¼${t} ${n}`);const{list:r}=e,o=r.filter((e=>0===e.state));return 0===o.length?void ia.info("ææ å¯é¢åæçï¼å·²é¢åï¼"):o}catch(e){ia.error(`è·åé¢åç¶æåºç°å¼å¸¸ï¼${e.message}`)}}async function Wl(e){try{const t=function(e){switch(e){case 1:return"B å¸å¸";case 2:return"ä¼åè´­ä¼æ å¸";case 3:return"æ¼«è¯»å¸";case 4:return"ä¼åè´­è¿è´¹å¸";default:return"æªç¥"}}(e),{code:n,message:r}=await function(e=1){return uf.post("/x/vip/privilege/receive",{csrf:Rs.BILIJCT,type:e},{headers:{origin:ms,referer:hs}})}(e);let o="æå";return 0!==n&&(o=`å¤±è´¥ ${r}`),ia.info(`é¢å${t}${o}`),!0}catch(e){ia.error(`é¢åæçåºç°å¼å¸¸ï¼${e.message}`),ia.error(e)}return!1}async function Yl(e){if(![1,3].includes(e))return;let t=0,n=!1;for(;!(n||(n=await Wl(e),t>2));)t++;return n}var Ql=Object.freeze({__proto__:null,default:async function(){try{if(ia.info("----ãé¢åå¤§ä¼åæçã----"),0===As.vipStatus||0===As.vipType)return void ia.info("æ¨è¿ä¸æ¯å¤§ä¼åï¼æ æ³é¢åæç");const e=await Hl();if(!e||0===e.length)return;for(let t=0;t<e.length;t++){await Ds(100);const n=e[t];await Yl(n.type)}}catch(e){ia.error(`é¢åå¤§ä¼åæçåºç°å¼å¸¸ï¼${e.message}`),ia.error(e)}}});function Vl(e,t,n,r){const o=Rs.BILIJCT,i={is_fav:0,main_id:t,oid:e,detail_id:n,count:r,csrf:o,csrf_token:o};return uf.post("/x/esports/guess/add",i)}function Xl(){const{coin:e,match:t}=Rs;return As.money-t.coins<e.stayCoins&&(ia.info(`éè¦ä¿ç${e.stayCoins}ä¸ªç¡¬å¸ï¼ä»»å¡ç»æ`),!0)}var Zl=Object.freeze({__proto__:null,default:async function(){ia.info("----ãèµäºç¡¬å¸ç«çã----");const{match:e}=Rs;if(e.coins<=0)return void ia.info("ç¡¬å¸æ°éä¸è½å°äº 0");if(Xl())return;const t=await async function(){try{const{code:e,message:t,data:{list:n,page:r}}=await function(e="",t=""){return uf.get(`/x/esports/guess/collection/question?pn=1&ps=50&gid=&sids=&stime=${e}&etime=${t}`)}();return 0!==e?void ia.warn(`è·åèµäºéè¯¯ ${e} ${t}`):0===r.total?(ia.info("ä»æ¥å·²ç»æ æ³è·åèµäº"),null):n}catch(e){ia.debug(e.message)}}();if(await Ds(),!t)return;const n=await async function(e){let t=0;try{for(const n of e){const{contest:e,questions:r}=n,o=e.id,[{id:i,title:a,details:s,is_guess:c}]=r,[u,f]=s;if(Xl())return t;if(c)continue;ia.info(`${a} <=> ${u.odds}:${f.odds}`);const l=u.odds>f.odds,{match:d}=Rs;let p;p=d.selection>0?l?f:u:l?u:f,ia.info(`é¢æµ[ ${p.option} ] ${d.coins} é¢ç¡¬å¸`),await Ds();const{code:g}=await Vl(o,i,p.detail_id,d.coins);0!==g?ia.info("é¢æµå¤±è´¥"):(t++,As.money-=d.coins)}}catch(e){console.warn(e.message)}return t}(function(e,t){return e.filter((e=>{const{questions:n}=e,[{details:r,is_guess:o}]=n;if(o)return!1;const[i,a]=r;return Math.abs(i.odds-a.odds)>=t}))}(t,e.diff));ia.info(`ãç«çç»æãä¸å±åä¸${n}æ¬¡é¢æµ`)}});const ed=new ra({console:"debug",file:"warn",push:"warn"},"live");async function td(){const{data:e,code:t}=await mf(1,1,0);if(0!==t)throw new Error(`è·åæåä¸ä¸ªå³æ³¨å¤±è´¥: ${t}`);return e[0]}async function nd(e){const{data:t,code:n}=await uf.get("x/relation/tags?jsonp=jsonp&callback=__jp3",{headers:{Referer:"https://space.bilibili.com/1/fans/follow?tagid=0"},requestOptions:{isJsonp:!0}});if(0===n)return t.find((t=>t.name===e));ia.warn(`è·ååç»åè¡¨å¤±è´¥: ${n}`)}async function rd(e){const t=await nd(e);if(t)return t.tagid;await Ds(300);const{data:n,code:r,message:o}=await(i=e,uf.post("x/relation/tag/create",{tag:i,jsonp:"jsonp",csrf:Rs.BILIJCT}));var i;if(22106===r){await Ds(300);const t=await nd(e);return t&&t.tagid}return 0!==r&&ia.warn(`åå»ºåç»å¤±è´¥: ${r}-${o}`),n.tagid}async function od(e,t="å¤©éæ¶å»"){if(0===e.length)return;const n=await rd(t);if(n)for(const t of e){const{code:e,message:r}=await yf(t.mid,n);0!==e&&ia.warn(`ç§»å¨ã${t.uname}ãå¤±è´¥: ${e}-${r}`),await Ds(500,1300)}}async function id(e="å¤©éæ¶å»",t=-1){const n=await nd(e);if(n&&(await Ds(),n.tagid))try{const{data:r,code:o}=await mf(1,20,n.tagid);if(0!==o||!r.length)return;if(t=await async function(e,t=-1){for(const n of e){if(0===t)return t;try{const{code:e,message:r}=await hf(n.mid);ed.info(`åå³ã${n.uname}ãæåï¼`),0!==e&&ia.warn(`åå³ã${n.uname}ãå¤±è´¥: ${e}-${r}`),-1!==t&&t--,await Ds(1500)}catch(e){ia.warn(`åå³ã${n.uname}ãå¼å¸¸: ${e.message}`)}}return t}(r,t),r.length<20)return;0!==t&&await id(e,t)}catch(e){ia.warn(`åå³åç»å¼å¸¸: ${e.message}`)}}async function ad(e,t,n,r=1){if(e.length>t.length)return;const{data:o,code:i,message:a}=await mf(r,20,0);if(0===i){for(const{mid:r,uname:i}of o){if(e.length>=t.length)return;if(r===n)return;(t.includes(r)||t.includes(i))&&e.push({mid:r,uname:i})}if(!(o.length<20))return await ad(e,t,n,r+1)}else ia.warn(`è·åå³æ³¨ç¨æ·å¤±è´¥: ${i}-${a}`)}var sd=Object.freeze({__proto__:null,default:async function(){ia.info("----ãæ¹éåå³ã----");try{await id(Rs.lottery.moveTag),ia.info("æ¹éåå³å®æ")}catch(e){ia.error(`æ¹éåå³: ${e.message}`)}}});const cd=0,ud=1,fd=5,ld=1,dd=504,pd=1096;let gd;async function md(){try{const{data:e,code:t,message:n}=await cf.get("/xlive/web-interface/v1/index/getWebAreaList?source_id=2");return 0!==t&&ia.info(`è·åç´æ­ååºå¤±è´¥: ${t}-${n}`),e.data.map((e=>e.list)).map((e=>e.map((e=>({areaId:e.id,parentId:e.parent_id})))))}catch(e){throw ia.error(`è·åç´æ­ååºå¼å¸¸: ${e.message}`),e}}async function hd(e,t,n=1,r="lottery"){try{await Ds(100);const{data:o,code:i,message:a}=await function(e,t,n=1){return cf.get(`/xlive/web-interface/v1/second/getList?platform=web&parent_area_id=${e}&area_id=${t}&page=${n}`)}(t,e,n);return 0!==i&&ia.info(`è·åç´æ­é´åè¡¨å¤±è´¥: ${i}-${a}`),function(e){const t=[],n=[];return e.forEach((e=>{const r=e.pendant_info[2];r&&(r.pendent_id===dd?t.push(e):r.pendent_id===pd&&n.push(e))})),{lotteryTime:t,lotteryPacket:n}}(o.list)["lottery"===r?"lotteryTime":"lotteryPacket"]}catch(e){throw ia.error(`è·åç´æ­é´åè¡¨å¼å¸¸: ${e.message}`),e}}async function yd(e,t,n=1){const r=await hd(e,t,n),o=[];for(const e of r){const t=await vd(e);t&&(o.push({...t,uid:e.uid,uname:e.uname}),await Ds(100))}return o}async function vd(e){const{blackUid:t}=Rs.lottery;if(t.includes(e.uid))return void ia.info(`è·³è¿é»ååç¨æ·: ${e.uname}`);let n,r,o;try{({data:r,code:n,message:o}=await Uf(e.roomid))}catch(t){return void ia.info(`ç´æ­é´${e.roomid}æ£æµå¼å¸¸: ${t.message}`)}if(0!==n)return void ia.debug(`ç´æ­é´${e.roomid}æ£æµå¤±è´¥: ${n}-${o}`);if(null===r)return;const{excludeAward:i,includeAward:a}=Rs.lottery,s=i.some((e=>r.award_name.match(e)));if(a.some((e=>r.award_name.match(e)))||!s){if(r.status===ld&&!(r.gift_price>0))return 4===r.require_type&&(ia.info("æ¨è½åé¦ç»ä½èè¾åºäºä»ä¹åï¼"),ia.info(`${r.require_type}--${r.require_text}--${r.require_value}`),ia.info("ä¹è®¸è¿æ­£æ¯æä»¬æ³è¦çã")),r.require_type===fd&&As.userLevel>=r.require_value||r.require_type===cd?r:r.require_type!==ud||Rs.lottery.skipNeedFollow?void 0:r}else ia.info(`è·³è¿å±è½å¥å: ${r.award_name}`)}async function wd(e,t=!0){try{const{id:r,gift_id:o,gift_num:i,award_name:a,uid:s,uname:c,require_type:u,require_text:f}=e;ia.info(`å¤©éä¸»æ­ï¼ã${c}ã`),ia.info(`å¥åï¼${a}`);const{code:l,message:d}=await(n={id:r,gift_id:o,gift_num:i},cf.post("/xlive/lottery-interface/v1/Anchor/Join",{...n,csrf:Rs.BILIJCT,csrf_token:Rs.BILIJCT,visit_id:Ji(),platform:"pc"}));if(0!==l)return void ia.info(`å¤©éå¤±è´¥: ${l}-${d}`);if(ia.info("å¤©éæå â"),u===ud&&t){qi(gd,s);(function(e){const t=(e=e.replace("å³æ³¨ä¸»æ­","")).split(/\s*\+\s*/);return t.shift(),t})(f).forEach((e=>qi(gd,e)))}}catch(e){ia.info(`å¤©éå¼å¸¸: ${e.message}`)}var n}async function _d(e,t,n=2){for(let r=1;r<=n;r++){const n=await yd(e,t,r);for(const e of n)await wd(e),await Ds(300)}}async function bd(e){try{const{data:t,code:n}=await function(e){return cf.get(`/xlive/lottery-interface/v1/lottery/getLotteryInfoWeb?roomid=${e}`)}(e);if(0!==n)return;const{popularity_red_pocket:r}=t;if(!r)return;const{lot_id:o,lot_status:i}=r[0];if(2===i)return;return o}catch(e){ia.debug(`æ£æµçº¢åå¼å¸¸: ${e.message}`)}}async function $d(e,t,n=1){const r=await hd(e,t,n,"redPack"),o=[];for(const e of r){const t=await bd(e.roomid);t&&(o.push({uid:e.uid,uname:e.uname,lot_id:t,room_id:e.roomid}),await Ds(100))}return o}async function Td(e){try{const{lot_id:n,uid:r,uname:o,room_id:i}=e;ia.info(`çº¢åä¸»æ­ï¼ã${o}ã`);const{code:a,message:s}=await(t={room_id:i,lot_id:n,ruid:r},cf.post("/xlive/lottery-interface/v1/popularityRedPocket/RedPocketDraw",{...t,spm_id:"444.8.red_envelope.extract",jump_from:"",session_id:"",csrf_token:Rs.BILIJCT,csrf:Rs.BILIJCT,visit_id:""}));if(0!==a)return void ia.info(`çº¢åå¤±è´¥: ${a}-${s}`);gd.push(r),ia.info("çº¢åæå â")}catch(e){ia.info(`çº¢åå¼å¸¸: ${e.message}`)}var t}async function Sd(e,t,n=2){for(let r=1;r<=n;r++){const n=await $d(e,t,r);for(const e of n)await El({room_id:e.room_id,up_id:e.uid}),await Ds(100),await Td(e),await Ds(400)}}async function Od(){const e=[];return await async function t(n=1){try{var r;const{data:o,code:i,message:a}=await function(e=1,t=9){return cf.get(`/xlive/web-ucenter/user/following?page=${e}&page_size=${t}`)}(n,9);if(0!==i)return void ia.info(`è·åå³æ³¨ç´æ­é´å¤±è´¥: ${i}-${a}`);const s=null===(r=o.list)||void 0===r?void 0:r.filter((e=>1===e.live_status));if(9===s.length&&n<o.totalPage)return e.push(...s),t(n+1);e.push(...s)}catch(e){ia.error(`è·åå³æ³¨ç´æ­é´å¼å¸¸: ${e.message}`)}}(),e}async function Cd(e){try{const{code:t,message:n,data:r}=await Uf(e.roomid);if(0!==t)return void ia.debug(`ç´æ­é´${e.roomid}æ£æµå¤±è´¥: ${t}-${n}`);if(null===r)return;if(r.status!==ld)return;if(r.gift_price>0)return;return r}catch(t){return void ia.info(`ç´æ­é´${e.roomid}æ£æµå¼å¸¸: ${t.message}`)}}async function kd(){const{scanFollow:e}=Rs.lottery;if(!e)return!0;try{ia.info("å¼å§æ«æå³æ³¨çä¸»æ­");const e=await async function(){const e=await Od(),t=[];for(const n of e){const e=await Cd(n);e&&t.push({...e,uid:n.uid,uname:n.uname}),await Ds(100)}return t}();for(const t of e)await wd(t,!1),await Ds(300);ia.info("å³æ³¨çä¸»æ­å¤©éå®æ")}catch(e){ia.error(`å³æ³¨çä¸»æ­å¤©éå¼å¸¸: ${e.message}`)}return"only"!==e}async function Id(){ia.info("----ãå¤©éæ¶å»ã----");const e=await kd();if(!e)return e;try{const e=await td();ia.info(`æåä¸ä¸ªå³æ³¨çUP: ${e.uname}`);const t=await async function(){gd=[];const{pageNum:e}=Rs.lottery,t=await md();for(const n of t)for(const t of n)await _d(t.areaId,t.parentId,e);return gd}();ia.info("æ«æå®æ");const n=[];await ad(n,t,null==e?void 0:e.mid),Rs.lottery.isMoveTag&&(await od(n,Rs.lottery.moveTag),ia.info("ç§»å¨å³æ³¨UPå°åç»æå"))}catch(e){ia.warn(`å¤©éæ¶å»å¼å¸¸: ${e.message}`),ia.debug(e)}ia.info("ç»æå¤©éæ¶å»")}var Ed=Object.freeze({__proto__:null,default:Id,liveLottery:Id});async function xd(e){try{const{code:t,message:n,data:r}=await function({session_type:e}={session_type:1}){return lf.get(`/session_svr/v1/session_svr/get_sessions?session_type=${e}&group_fold=1&unfollow_fold=1&sort_rule=2&build=0&mobi_app=web`)}();if(0!==t)return void ia.warn(`è·åä¼è¯å¤±è´¥ï¼${t}-${n}`);const{session_list:o}=r;if(o.length<=0)return;return o.filter((({unread_count:t,talker_id:n,is_follow:r,last_msg:o})=>{return e.find((e=>e.mid===n))&&t>0&&n===o.sender_uid&&1===r&&(i=o.timestamp,Date.now()-1e3*i<36e5);var i}))}catch(e){ia.error(`è·åä¼è¯å¼å¸¸ï¼${e.message}`)}}async function Pd(e){const t=await xd(e);await Ds(200);try{for(let e=0;e<t.length;e++){const n=t[e];await jd(n)}}catch(e){ia.error(`æ´æ°ä¼è¯å¼å¸¸ï¼${e.message}`)}t.length>=19&&await Pd(e)}async function jd(e){switch(Rs.lottery.actFollowMsg){case"del":case"delete":await function({talker_id:e,session_type:t}){return lf.post("/session_svr/v1/session_svr/remove_session",{talker_id:e,session_type:t,build:0,mobi_app:"web",csrf_token:Rs.BILIJCT,csrf:Rs.BILIJCT})}(e);break;case"read":await function({talker_id:e,session_type:t,ack_seqno:n}){return lf.post("/session_svr/v1/session_svr/update_ack",{talker_id:e,session_type:t,ack_seqno:n,build:0,mobi_app:"web",csrf_token:Rs.BILIJCT,csrf:Rs.BILIJCT},{headers:{origin:gs}})}(e)}await Ds(50)}async function Ld(){ia.info("----ãå¤©éçº¢åã----");try{const e=await td();ia.info(`æåä¸ä¸ªå³æ³¨çUP: ${e.uname}`);const t=await async function(){gd=[];const{pageNum:e}=Rs.lottery,t=await md();for(const n of t)for(const t of n)await Sd(t.areaId,t.parentId,e);return gd}();ia.info("æ«æå®æï¼è·åæ°å³æ³¨çUP");const n=[];await ad(n,t,null==e?void 0:e.mid),ia.info("å¼å§è¯»åæ¶æ¯"),await Pd(n),Rs.lottery.isMoveTag&&(ia.info("ç§»å¨å³æ³¨UPå°åç»"),await od(n,Rs.lottery.moveTag),ia.info("ç§»å¨å³æ³¨UPå°åç»æå"))}catch(e){ia.warn(`å¤©éæ¶å»å¼å¸¸: ${e.message}`),ia.debug(e)}ia.info("ç»æå¤©éçº¢å")}var Rd=Object.freeze({__proto__:null,default:Ld,liveRedPack:Ld});var Ad=Object.freeze({__proto__:null,default:async function(){ia.info("----ãç´æ­äº²å¯åº¦ã----");try{await Dl(),ia.info("ç´æ­äº²å¯åº¦å®æ")}catch(e){ia.error(`ç´æ­äº²å¯åº¦: ${e.message}`)}}});let Nd=0;async function Ud(){try{const{data:{list:e}}=await function(e=3394945){const t=(new Date).getTime();return cf.get(`/xlive/web-room/v1/gift/bag_list?t=${t}&room_id=${e}`)}();if(!e)return;return e.filter((e=>{if(e.expire_at<=0)return!1;const t=(1e3*e.expire_at-(new Date).getTime())/864e5<2,n=![1,30607,30426,31531].includes(e.gift_id);return n&&t&&ia.info(`${e.gift_name} å³å°è¿æè¯·å°½å¿«æå`),!n&&t}))}catch(e){if(Nd++)return null;await Ud()}}async function Dd(e){try{const{data:{live_room:t,name:n}}=await function(e){return uf.get(`x/space/acc/info?mid=${e}&jsonp=jsonp`)}(e);if(await Ds(),t.roomStatus)return{roomid:t.roomid,name:n}}catch{}}var Bd=Object.freeze({__proto__:null,default:async function(){ia.info("----ãæåè¿æé£ç©ã----");try{const e=await Ud();if(await Ds(),null==e||!e.length)return void ia.info("æ²¡æ2å¤©åè¿æçç®åç¤¼ç©");const t=await async function(){const{gift:e}=Rs,t=e.mids||[],n=()=>t.splice(Bi(t.length-1),1)[0];for(;t.length;){const e=n(),t=await Dd(e);if(t)return{mid:e,...t}}return await async function(){const{data:{count:e,items:t}}=await function(e=1,t=10){return e>10&&(e=10),cf.get(`/xlive/app-ucenter/v1/user/GetMyMedals?page=${e}&page_size=${t}`)}();if(await Ds(),!e)return;const n=t[Bi(t.length-1)];return{mid:n.target_id,roomid:n.roomid||0,name:n.uname}}()}();if(!t)return void ia.info("æ²¡ææ¾å°æåç®æ ");await async function({roomid:e,mid:t,name:n},r){for(const o of r){await Ds();try{const{code:r,message:i,data:a}=await Nf({roomid:e,ruid:t,bag_id:o.bag_id,gift_id:o.gift_id,gift_num:o.gift_num});if(0!==r){ia.warn(`å[${n}]æå[${o.gift_name}]ï¼${i}`);continue}a.gift_list.forEach((e=>{ia.info(`æåç» [${n}] æå${e.gift_name}`)}))}catch{ia.debug(`å[${n}]æå[${o.gift_name}]ï¼å¼å¸¸`)}}}(t,e)}catch(e){ia.info(`æåè¿æé£ç©å¼å¸¸ ${e}`)}}});async function Fd(e,t={},...n){const r=void 0===(o=t.logger)?ia:Ei(o)?o?ia:oa:o;var o;const{name:i,successCode:a=0}=t;try{const{code:t,message:o,msg:s,data:c}=await e(...n);return t!==a?void r.warn(`${i||e.name}è¯·æ±å¤±è´¥ï¼${t} ${o||s}`):c}catch(t){r.error(`${i||e.name}è¯·æ±åºç°å¼å¸¸`),r.error(t)}}function zd(e){const t=e.level_info,n=t.current_level;if(n>=Rs.coin.targetLevel&&(As.coinsTask=0),ia.info(`å½åç­çº§: ${t.current_level}`),n>=6){const e=Rs.function;e.shareAndWatch=!1,e.addCoins=!1,e.taskReward=!1,ia.info("å·²ç»æ»¡çº§ï¼ä¸éè¦åæå¸äºï¼åä¸ªç½å«æªå§")}else{const e=t.next_exp-t.current_exp;ia.info(`è·ç¦»åçº§è¿éè¦ ${e} ç»éªï¼é¢è®¡ ${function(e){const{targetCoins:t}=Rs.coin;if(t<=0)return e/15;const n=10*t+15,r=e/n,o=As.money/(t-1);return r<o?Math.floor(r):(e-o*n)/25+o}(e).toFixed(2)} å¤©`)}}function Md(e){let t="";switch(As.vipType=e.vipType,As.vipStatus=e.vipStatus,e.vipType){case 0:t="æ å¤§ä¼å";break;case 1:t="æåº¦å¤§ä¼å";break;case 2:t="å¹´åº¦å¤§ä¼å"}0===e.vipStatus&&(t="æ å¤§ä¼å"===t?t:t+"[å·²è¿æ]"),ia.info(`å¤§ä¼åç¶æ: ${t}`)}var Jd=Object.freeze({__proto__:null,setVipStatus:Md,default:async function(){ia.info("----ãç»å½ã----");const{data:e,message:t,code:n}=await pf();if(0!==n)throw ia.error(`ç»å½éè¯¯ ${n} ${t}`),new Error(t);if(!e.isLogin)throw new Error("æ¥å£è¿åä¸ºæªç»å½");await Ds(),await async function(e){try{var t;const{money:n}=await Fd(gf);ia.info(`ç»å½æå: ${e.uname}`),ia.info(`ç¡¬å¸ä½é¢: ${n||0}`),As.nickname=e.uname,As.money=n||0,As.userLevel=e.level_info.current_level,As.bCoinCouponBalance=(null===(t=e.wallet)||void 0===t?void 0:t.coupon_balance)||0,zd(e),Md(e)}catch(e){ia.error(`è·åç¡¬å¸ä¿¡æ¯å¼å¸¸: ${e.message}`),ia.debug(e)}}(e)}});const qd=new ra({console:"debug",file:"warn",push:"warn",payload:As.nickname},"live");async function Gd(){const e=await async function(){try{const{data:e,code:t,message:n}=await cf.get(`activity_php/v1/Famine/recommendAnchors?_=${(new Date).getTime()}`);return 0!==t?void qd.warn(`è·åæ´»å¨ä¸»æ­å¤±è´¥ ${t} ${n}`):e.anchor_list}catch(e){qd.error(e),qd.error(`è·åæ´»å¨çä¸»æ­å¼å¸¸ ${e.message}`)}}();if(!e||0===e.length)return;const t=Yi(e);qd.info(`è·åå°ä¸»æ­ï¼${t.nickname} æ¿é´å·ï¼${t.room_id}`);const n=zl();await async function(e,t){for(let n=t;n>0;n--)await Kd(e),await Ds(6e4)}({up_id:t.uid,room_id:t.room_id,...n},10)}async function Kd(e){try{const{code:t,message:n}=await El(e);if(0!==t)return void qd.warn(`ç´æ­é´å¿è·³å¤±è´¥ ${t} ${n}`);qd.info("ç´æ­é´å¿è·³æå")}catch(e){qd.error(e),qd.error(`ç´æ­é´å¿è·³å¼å¸¸ ${e.message}`)}}async function Hd(){try{const{data:e,code:t,message:n}=await cf.get(`activity_php/v1/Famine/userWatchTime?_=${(new Date).getTime()}`);return 0!==t?void qd.warn(`è·åè§çæ¶é´å¤±è´¥ ${t} ${n}`):e}catch(e){qd.error(e),qd.error(`è·åè§çæ¶é´å¤±è´¥ ${e.message}`)}}var Wd=Object.freeze({__proto__:null,default:async function(){ia.info("----ãé¥¥èç´æ­é´ææºã----");try{await async function(e=400){for(let t=e/6;t>0&&!((await Hd()).duration>360);t--)await Gd()}(Rs.activity.liveFamineTime),ia.info("é¥¥èç´æ­é´ææºå®æ")}catch(e){ia.error(`é¥¥èç´æ­é´ææº: ${e.message}`)}}});function Yd(e){return{Origin:ms,Referer:`${ws}case-detail/${e}`}}function Qd(){return uf.post("x/credit/v2/jury/apply",{csrf:Rs.BILIJCT},{headers:{Origin:ms}})}function Vd(){return uf.get(`x/credit/v2/jury/case/next?csrf=${Rs.BILIJCT}`,{headers:{Origin:ms,Referer:ws+"index"}})}function Xd(e){return uf.get(`x/credit/v2/jury/case/opinion?case_id=${e}&pn=1&ps=20`,{headers:Yd(e)})}function Zd(e,t,n=0,r=0){return uf.post("x/credit/v2/jury/vote",{case_id:e,vote:t,csrf:Rs.BILIJCT,insiders:n,anonymous:r},{headers:Yd(e)})}const ep={1:"åé",2:"ä¸è¬",3:"ä¸åé",4:"æ æ³å¤æ­",11:"å¥½",12:"æ®é",13:"å·®",14:"æ æ³å¤æ­"},tp=new ra({console:"debug",file:"debug",push:"warn"},"jury");async function np(e,t){try{const n=function(e,t){const n={};for(const e of t)Reflect.has(n,e.vote)?n[e.vote]++:n[e.vote]=1;const r=+Object.keys(n).reduce(((e,t)=>n[e]>n[t]?e:t));return tp.debug(`ã${e}ãçè§ç¹åå¸ï¼è§ç¹id: æç¥¨äººæ°ï¼${JSON.stringify(n)}`),t.find((e=>e.vote===r))||{vote:0,uname:"æ "}}(e,t),r=n.vote;tp.info(`ä¸ºã${e}ãéæ©äºã${ep[r]}ãï¼${r}ï¼`);const{code:o,message:i}=await Zd(e,r);return 0!==o?(tp.warn(`é£çºªå§åæç¥¨å¤±è´¥ï¼éè¯¯ç ï¼ã${o}ãï¼ä¿¡æ¯ä¸ºï¼ã${i}ã`),!1):(tp.info(`æåæ ¹æ®ã${n.uname}ãçè§ç¹ä¸ºæ¡ä»¶ã${e}ãæä¸ã${ep[r]}ã`),!0)}catch(e){tp.error(`é£çºªå§åæç¥¨å¤±è´¥ï¼éè¯¯ä¿¡æ¯ï¼${e}`)}return!1}async function rp(e,t){try{const r=await(n=e,uf.get(`x/credit/v2/jury/case/info?case_id=${n}`,{headers:Yd(n)}));if(0===r.code){const n=r.data.vote_items[t],o=await Zd(e,n.vote);return 0===o.code?(tp.info(`æåæ ¹æ®ãéç½®æä»¶ãä¸ºæ¡ä»¶ã${e}ãæä¸ã${n.vote_text}ã`),!0):(tp.warn(`é£çºªå§åæç¥¨å¤±è´¥ï¼éè¯¯ç ï¼ã${o.code}ãï¼ä¿¡æ¯ä¸ºï¼ã${o.message}ã`),!1)}return tp.error(`è·åé£çºªå§åæ¡ä»¶ä¿¡æ¯å¤±è´¥ï¼éè¯¯ç ï¼ã${r.code}ãï¼ä¿¡æ¯ä¸ºï¼ã${r.message}ã`),!1}catch(e){tp.error(`é£çºªå§åæç¥¨å¼å¸¸ï¼éè¯¯ä¿¡æ¯ï¼${e}`)}var n;return!1}async function op(){const{mode:e}=Rs.jury;try{if(1===e)return async function(e=3){for(;e>0;)try{const{code:t,data:n,message:r}=await Vd();if(0===t){const t=n.case_id,{data:r}=await Xd(t);await Zd(t,0),await Ds(1e4,2e4),r.list?await np(t,r.list)||(e-=1):await rp(t,Yi(Rs.jury.vote))||(e-=1)}else{if(25014===t)return void tp.info(`${r}`);if(25008===t){if(tp.info(`${r}`),!Rs.jury.once)return;tp.info("ä¼ç 30åéåç»§ç»­è·åæ¡ä»¶ï¼"),await Ds(18e5)}else if(25006===t){tp.warn(`${r}`);const e=await Qd();if(0!==e.code)return void tp.info(`${e}`)}else tp.warn(`è·åé£çºªå§åæ¡ä»¶ä¿¡æ¯å¤±è´¥ï¼éè¯¯ç ï¼ã${t}ãï¼ä¿¡æ¯ä¸ºï¼ã${r}ã`),e-=1,await Ds(2e4,4e4)}}catch(e){tp.error(`é£çºªå§åæç¥¨å¼å¸¸ï¼éè¯¯ä¿¡æ¯ï¼${e}`)}tp.error("éè¯¯æ¬¡æ°è¿å¤ï¼ç»æä»»å¡ï¼")}();if(2===e)return async function(e=3){const t=[];for(;e>0;)try{const{code:n,data:r,message:o}=await Vd();if(0===n){const n=r.case_id,{data:o}=await Xd(n);await Zd(n,0),await Ds(1e4,2e4),o.list?await np(n,o.list)||(e-=1):t.push(n)}else{if(25014===n)return void tp.info(`${o}`);if(25008===n)if(tp.info(`${o}`),!t.length&&Rs.jury.once)tp.info("ä¼ç 30åéåç»§ç»­è·åæ¡ä»¶ï¼"),await Ds(18e5);else for(const n of t){if(t.splice(t.indexOf(n),1),0===e)return void tp.error("éè¯¯æ¬¡æ°è¿å¤ï¼ç»æä»»å¡ï¼");await rp(n,Yi(Rs.jury.vote))||(e-=1),await Ds(1e4,2e4)}else if(25006===n){tp.warn(`${o}`);const e=await Qd();if(0!==e.code)return void tp.info(`${e}`)}else tp.warn(`è·åé£çºªå§åæ¡ä»¶å¤±è´¥ï¼éè¯¯ç ï¼ã${n}ãï¼ä¿¡æ¯ä¸ºï¼ã${o}ã`),e-=1,await Ds(2e4,4e4)}}catch(t){tp.error(`åçéè¯¯ï¼éè¯¯ä¿¡æ¯ä¸ºï¼${t}`),e-=1,await Ds(2e4,4e4)}tp.error("éè¯¯æ¬¡æ°è¿å¤ï¼ç»æä»»å¡ï¼")}()}catch(e){tp.error(`åçéè¯¯ï¼éè¯¯ä¿¡æ¯ä¸ºï¼${e}`)}}var ip=Object.freeze({__proto__:null,default:async function(){ia.info("----ãé£çºªä»»å¡ã----");try{await op(),ia.info("é£çºªä»»å¡å®æ")}catch(e){ia.error(`é£çºªä»»å¡: ${e.message}`)}}});
