"use strict";var e=require("zlib"),t=require("crypto"),i=require("path"),n=require("fs"),o=require("url"),s=require("events"),r=require("util"),a=require("stream"),c=require("http"),u=require("https"),l=require("dns"),p=require("os"),d=require("buffer"),h=require("http2"),m=require("tls"),f=require("net"),g=require("punycode"),v=require("child_process");function x(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function y(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(i){if("default"!==i){var n=Object.getOwnPropertyDescriptor(e,i);Object.defineProperty(t,i,n.get?n:{enumerable:!0,get:function(){return e[i]}})}})),t.default=e,Object.freeze(t)}function b(e,t){return t.forEach((function(t){t&&"string"!=typeof t&&!Array.isArray(t)&&Object.keys(t).forEach((function(i){if("default"!==i&&!(i in e)){var n=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(e,i,n.get?n:{enumerable:!0,get:function(){return t[i]}})}}))})),Object.freeze(e)}require("assert");var w=x(e),_=y(t),D=x(t),E=y(i),C=x(i),A=y(n),k=x(n),S=x(o),F=x(s),T=x(r),B=x(a),O=x(c),j=x(u),I=x(l),P=x(p),L=x(d),R=x(h),N=x(m),$=x(f),H=x(g),U=x(v),q="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function M(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var z=function(e){return e&&e.Math==Math&&e},G=z("object"==typeof globalThis&&globalThis)||z("object"==typeof window&&window)||z("object"==typeof self&&self)||z("object"==typeof q&&q)||function(){return this}()||Function("return this")(),V={},W=function(e){try{return!!e()}catch(e){return!0}},J=!W((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),K=!W((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")})),Q=K,X=Function.prototype.call,Y=Q?X.bind(X):function(){return X.apply(X,arguments)},Z={},ee={}.propertyIsEnumerable,te=Object.getOwnPropertyDescriptor,ie=te&&!ee.call({1:2},1);Z.f=ie?function(e){var t=te(this,e);return!!t&&t.enumerable}:ee;var ne,oe,se=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},re=K,ae=Function.prototype,ce=ae.bind,ue=ae.call,le=re&&ce.bind(ue,ue),pe=re?function(e){return e&&le(e)}:function(e){return e&&function(){return ue.apply(e,arguments)}},de=pe,he=de({}.toString),me=de("".slice),fe=function(e){return me(he(e),8,-1)},ge=W,ve=fe,xe=Object,ye=pe("".split),be=ge((function(){return!xe("z").propertyIsEnumerable(0)}))?function(e){return"String"==ve(e)?ye(e,""):xe(e)}:xe,we=TypeError,_e=function(e){if(null==e)throw we("Can't call method on "+e);return e},De=be,Ee=_e,Ce=function(e){return De(Ee(e))},Ae=function(e){return"function"==typeof e},ke=Ae,Se=function(e){return"object"==typeof e?null!==e:ke(e)},Fe=G,Te=Ae,Be=function(e){return Te(e)?e:void 0},Oe=function(e,t){return arguments.length<2?Be(Fe[e]):Fe[e]&&Fe[e][t]},je=pe({}.isPrototypeOf),Ie=G,Pe=Oe("navigator","userAgent")||"",Le=Ie.process,Re=Ie.Deno,Ne=Le&&Le.versions||Re&&Re.version,$e=Ne&&Ne.v8;$e&&(oe=(ne=$e.split("."))[0]>0&&ne[0]<4?1:+(ne[0]+ne[1])),!oe&&Pe&&(!(ne=Pe.match(/Edge\/(\d+)/))||ne[1]>=74)&&(ne=Pe.match(/Chrome\/(\d+)/))&&(oe=+ne[1]);var He=oe,Ue=W,qe=!!Object.getOwnPropertySymbols&&!Ue((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&He&&He<41})),Me=qe&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,ze=Oe,Ge=Ae,Ve=je,We=Object,Je=Me?function(e){return"symbol"==typeof e}:function(e){var t=ze("Symbol");return Ge(t)&&Ve(t.prototype,We(e))},Ke=String,Qe=function(e){try{return Ke(e)}catch(e){return"Object"}},Xe=Ae,Ye=Qe,Ze=TypeError,et=function(e){if(Xe(e))return e;throw Ze(Ye(e)+" is not a function")},tt=et,it=function(e,t){var i=e[t];return null==i?void 0:tt(i)},nt=Y,ot=Ae,st=Se,rt=TypeError,at={exports:{}},ct=G,ut=Object.defineProperty,lt=function(e,t){try{ut(ct,e,{value:t,configurable:!0,writable:!0})}catch(i){ct[e]=t}return t},pt=lt,dt=G["__core-js_shared__"]||pt("__core-js_shared__",{}),ht=dt;(at.exports=function(e,t){return ht[e]||(ht[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.23.1",mode:"global",copyright:"Â© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.23.1/LICENSE",source:"https://github.com/zloirock/core-js"});var mt=_e,ft=Object,gt=function(e){return ft(mt(e))},vt=gt,xt=pe({}.hasOwnProperty),yt=Object.hasOwn||function(e,t){return xt(vt(e),t)},bt=pe,wt=0,_t=Math.random(),Dt=bt(1..toString),Et=function(e){return"Symbol("+(void 0===e?"":e)+")_"+Dt(++wt+_t,36)},Ct=G,At=at.exports,kt=yt,St=Et,Ft=qe,Tt=Me,Bt=At("wks"),Ot=Ct.Symbol,jt=Ot&&Ot.for,It=Tt?Ot:Ot&&Ot.withoutSetter||St,Pt=function(e){if(!kt(Bt,e)||!Ft&&"string"!=typeof Bt[e]){var t="Symbol."+e;Ft&&kt(Ot,e)?Bt[e]=Ot[e]:Bt[e]=Tt&&jt?jt(t):It(t)}return Bt[e]},Lt=Y,Rt=Se,Nt=Je,$t=it,Ht=function(e,t){var i,n;if("string"===t&&ot(i=e.toString)&&!st(n=nt(i,e)))return n;if(ot(i=e.valueOf)&&!st(n=nt(i,e)))return n;if("string"!==t&&ot(i=e.toString)&&!st(n=nt(i,e)))return n;throw rt("Can't convert object to primitive value")},Ut=TypeError,qt=Pt("toPrimitive"),Mt=function(e,t){if(!Rt(e)||Nt(e))return e;var i,n=$t(e,qt);if(n){if(void 0===t&&(t="default"),i=Lt(n,e,t),!Rt(i)||Nt(i))return i;throw Ut("Can't convert object to primitive value")}return void 0===t&&(t="number"),Ht(e,t)},zt=Je,Gt=function(e){var t=Mt(e,"string");return zt(t)?t:t+""},Vt=Se,Wt=G.document,Jt=Vt(Wt)&&Vt(Wt.createElement),Kt=function(e){return Jt?Wt.createElement(e):{}},Qt=Kt,Xt=!J&&!W((function(){return 7!=Object.defineProperty(Qt("div"),"a",{get:function(){return 7}}).a})),Yt=J,Zt=Y,ei=Z,ti=se,ii=Ce,ni=Gt,oi=yt,si=Xt,ri=Object.getOwnPropertyDescriptor;V.f=Yt?ri:function(e,t){if(e=ii(e),t=ni(t),si)try{return ri(e,t)}catch(e){}if(oi(e,t))return ti(!Zt(ei.f,e,t),e[t])};var ai={},ci=J&&W((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),ui=Se,li=String,pi=TypeError,di=function(e){if(ui(e))return e;throw pi(li(e)+" is not an object")},hi=J,mi=Xt,fi=ci,gi=di,vi=Gt,xi=TypeError,yi=Object.defineProperty,bi=Object.getOwnPropertyDescriptor;ai.f=hi?fi?function(e,t,i){if(gi(e),t=vi(t),gi(i),"function"==typeof e&&"prototype"===t&&"value"in i&&"writable"in i&&!i.writable){var n=bi(e,t);n&&n.writable&&(e[t]=i.value,i={configurable:"configurable"in i?i.configurable:n.configurable,enumerable:"enumerable"in i?i.enumerable:n.enumerable,writable:!1})}return yi(e,t,i)}:yi:function(e,t,i){if(gi(e),t=vi(t),gi(i),mi)try{return yi(e,t,i)}catch(e){}if("get"in i||"set"in i)throw xi("Accessors not supported");return"value"in i&&(e[t]=i.value),e};var wi=ai,_i=se,Di=J?function(e,t,i){return wi.f(e,t,_i(1,i))}:function(e,t,i){return e[t]=i,e},Ei={exports:{}},Ci=J,Ai=yt,ki=Function.prototype,Si=Ci&&Object.getOwnPropertyDescriptor,Fi=Ai(ki,"name"),Ti={EXISTS:Fi,PROPER:Fi&&"something"===function(){}.name,CONFIGURABLE:Fi&&(!Ci||Ci&&Si(ki,"name").configurable)},Bi=Ae,Oi=dt,ji=pe(Function.toString);Bi(Oi.inspectSource)||(Oi.inspectSource=function(e){return ji(e)});var Ii,Pi,Li,Ri=Oi.inspectSource,Ni=Ae,$i=Ri,Hi=G.WeakMap,Ui=Ni(Hi)&&/native code/.test($i(Hi)),qi=at.exports,Mi=Et,zi=qi("keys"),Gi=function(e){return zi[e]||(zi[e]=Mi(e))},Vi={},Wi=Ui,Ji=G,Ki=pe,Qi=Se,Xi=Di,Yi=yt,Zi=dt,en=Gi,tn=Vi,nn=Ji.TypeError,on=Ji.WeakMap;if(Wi||Zi.state){var sn=Zi.state||(Zi.state=new on),rn=Ki(sn.get),an=Ki(sn.has),cn=Ki(sn.set);Ii=function(e,t){if(an(sn,e))throw new nn("Object already initialized");return t.facade=e,cn(sn,e,t),t},Pi=function(e){return rn(sn,e)||{}},Li=function(e){return an(sn,e)}}else{var un=en("state");tn[un]=!0,Ii=function(e,t){if(Yi(e,un))throw new nn("Object already initialized");return t.facade=e,Xi(e,un,t),t},Pi=function(e){return Yi(e,un)?e[un]:{}},Li=function(e){return Yi(e,un)}}var ln={set:Ii,get:Pi,has:Li,enforce:function(e){return Li(e)?Pi(e):Ii(e,{})},getterFor:function(e){return function(t){var i;if(!Qi(t)||(i=Pi(t)).type!==e)throw nn("Incompatible receiver, "+e+" required");return i}}},pn=W,dn=Ae,hn=yt,mn=J,fn=Ti.CONFIGURABLE,gn=Ri,vn=ln.enforce,xn=ln.get,yn=Object.defineProperty,bn=mn&&!pn((function(){return 8!==yn((function(){}),"length",{value:8}).length})),wn=String(String).split("String"),_n=Ei.exports=function(e,t,i){"Symbol("===String(t).slice(0,7)&&(t="["+String(t).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),i&&i.getter&&(t="get "+t),i&&i.setter&&(t="set "+t),(!hn(e,"name")||fn&&e.name!==t)&&yn(e,"name",{value:t,configurable:!0}),bn&&i&&hn(i,"arity")&&e.length!==i.arity&&yn(e,"length",{value:i.arity});try{i&&hn(i,"constructor")&&i.constructor?mn&&yn(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(e){}var n=vn(e);return hn(n,"source")||(n.source=wn.join("string"==typeof t?t:"")),e};Function.prototype.toString=_n((function(){return dn(this)&&xn(this).source||gn(this)}),"toString");var Dn=Ae,En=ai,Cn=Ei.exports,An=lt,kn={},Sn=Math.ceil,Fn=Math.floor,Tn=Math.trunc||function(e){var t=+e;return(t>0?Fn:Sn)(t)},Bn=function(e){var t=+e;return t!=t||0===t?0:Tn(t)},On=Bn,jn=Math.max,In=Math.min,Pn=Bn,Ln=Math.min,Rn=function(e){return e>0?Ln(Pn(e),9007199254740991):0},Nn=function(e){return Rn(e.length)},$n=Ce,Hn=function(e,t){var i=On(e);return i<0?jn(i+t,0):In(i,t)},Un=Nn,qn=function(e){return function(t,i,n){var o,s=$n(t),r=Un(s),a=Hn(n,r);if(e&&i!=i){for(;r>a;)if((o=s[a++])!=o)return!0}else for(;r>a;a++)if((e||a in s)&&s[a]===i)return e||a||0;return!e&&-1}},Mn={includes:qn(!0),indexOf:qn(!1)},zn=yt,Gn=Ce,Vn=Mn.indexOf,Wn=Vi,Jn=pe([].push),Kn=function(e,t){var i,n=Gn(e),o=0,s=[];for(i in n)!zn(Wn,i)&&zn(n,i)&&Jn(s,i);for(;t.length>o;)zn(n,i=t[o++])&&(~Vn(s,i)||Jn(s,i));return s},Qn=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Xn=Kn,Yn=Qn.concat("length","prototype");kn.f=Object.getOwnPropertyNames||function(e){return Xn(e,Yn)};var Zn={};Zn.f=Object.getOwnPropertySymbols;var eo=Oe,to=kn,io=Zn,no=di,oo=pe([].concat),so=eo("Reflect","ownKeys")||function(e){var t=to.f(no(e)),i=io.f;return i?oo(t,i(e)):t},ro=yt,ao=so,co=V,uo=ai,lo=function(e,t,i){for(var n=ao(t),o=uo.f,s=co.f,r=0;r<n.length;r++){var a=n[r];ro(e,a)||i&&ro(i,a)||o(e,a,s(t,a))}},po=W,ho=Ae,mo=/#|\.prototype\./,fo=function(e,t){var i=vo[go(e)];return i==yo||i!=xo&&(ho(t)?po(t):!!t)},go=fo.normalize=function(e){return String(e).replace(mo,".").toLowerCase()},vo=fo.data={},xo=fo.NATIVE="N",yo=fo.POLYFILL="P",bo=fo,wo=G,_o=V.f,Do=Di,Eo=function(e,t,i,n){n||(n={});var o=n.enumerable,s=void 0!==n.name?n.name:t;return Dn(i)&&Cn(i,s,n),n.global?o?e[t]=i:An(t,i):(n.unsafe?e[t]&&(o=!0):delete e[t],o?e[t]=i:En.f(e,t,{value:i,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})),e},Co=lt,Ao=lo,ko=bo,So=function(e,t){var i,n,o,s,r,a=e.target,c=e.global,u=e.stat;if(i=c?wo:u?wo[a]||Co(a,{}):(wo[a]||{}).prototype)for(n in t){if(s=t[n],o=e.dontCallGetSet?(r=_o(i,n))&&r.value:i[n],!ko(c?n:a+(u?".":"#")+n,e.forced)&&void 0!==o){if(typeof s==typeof o)continue;Ao(s,o)}(e.sham||o&&o.sham)&&Do(s,"sham",!0),Eo(i,n,s,e)}},Fo=K,To=Function.prototype,Bo=To.apply,Oo=To.call,jo="object"==typeof Reflect&&Reflect.apply||(Fo?Oo.bind(Bo):function(){return Oo.apply(Bo,arguments)}),Io=Ae,Po=String,Lo=TypeError,Ro=pe,No=di,$o=function(e){if("object"==typeof e||Io(e))return e;throw Lo("Can't set "+Po(e)+" as a prototype")},Ho=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,i={};try{(e=Ro(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(i,[]),t=i instanceof Array}catch(e){}return function(i,n){return No(i),$o(n),t?e(i,n):i.__proto__=n,i}}():void 0),Uo=ai.f,qo=Ae,Mo=Se,zo=Ho,Go={};Go[Pt("toStringTag")]="z";var Vo="[object z]"===String(Go),Wo=Ae,Jo=fe,Ko=Pt("toStringTag"),Qo=Object,Xo="Arguments"==Jo(function(){return arguments}()),Yo=Vo?Jo:function(e){var t,i,n;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(i=function(e,t){try{return e[t]}catch(e){}}(t=Qo(e),Ko))?i:Xo?Jo(t):"Object"==(n=Jo(t))&&Wo(t.callee)?"Arguments":n},Zo=Yo,es=String,ts=function(e){if("Symbol"===Zo(e))throw TypeError("Cannot convert a Symbol value to a string");return es(e)},is=function(e,t){return void 0===e?arguments.length<2?"":t:ts(e)},ns=Se,os=Di,ss=function(e,t){ns(t)&&"cause"in t&&os(e,"cause",t.cause)},rs=Error,as=pe("".replace),cs=String(rs("zxcasd").stack),us=/\n\s*at [^:]*:[^\n]*/,ls=us.test(cs),ps=function(e,t){if(ls&&"string"==typeof e&&!rs.prepareStackTrace)for(;t--;)e=as(e,us,"");return e},ds=se,hs=!W((function(){var e=Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",ds(1,7)),7!==e.stack)})),ms=Oe,fs=yt,gs=Di,vs=je,xs=Ho,ys=lo,bs=function(e,t,i){i in e||Uo(e,i,{configurable:!0,get:function(){return t[i]},set:function(e){t[i]=e}})},ws=function(e,t,i){var n,o;return zo&&qo(n=t.constructor)&&n!==i&&Mo(o=n.prototype)&&o!==i.prototype&&zo(e,o),e},_s=is,Ds=ss,Es=ps,Cs=hs,As=J,ks=So,Ss=jo,Fs=function(e,t,i,n){var o="stackTraceLimit",s=n?2:1,r=e.split("."),a=r[r.length-1],c=ms.apply(null,r);if(c){var u=c.prototype;if(fs(u,"cause")&&delete u.cause,!i)return c;var l=ms("Error"),p=t((function(e,t){var i=_s(n?t:e,void 0),o=n?new c(e):new c;return void 0!==i&&gs(o,"message",i),Cs&&gs(o,"stack",Es(o.stack,2)),this&&vs(u,this)&&ws(o,this,p),arguments.length>s&&Ds(o,arguments[s]),o}));p.prototype=u,"Error"!==a?xs?xs(p,l):ys(p,l,{name:!0}):As&&o in c&&(bs(p,c,o),bs(p,c,"prepareStackTrace")),ys(p,c);try{u.name!==a&&gs(u,"name",a),u.constructor=p}catch(e){}return p}},Ts=G.WebAssembly,Bs=7!==Error("e",{cause:7}).cause,Os=function(e,t){var i={};i[e]=Fs(e,t,Bs),ks({global:!0,constructor:!0,arity:1,forced:Bs},i)},js=function(e,t){if(Ts&&Ts[e]){var i={};i[e]=Fs("WebAssembly."+e,t,Bs),ks({target:"WebAssembly",stat:!0,constructor:!0,arity:1,forced:Bs},i)}};Os("Error",(function(e){return function(t){return Ss(e,this,arguments)}})),Os("EvalError",(function(e){return function(t){return Ss(e,this,arguments)}})),Os("RangeError",(function(e){return function(t){return Ss(e,this,arguments)}})),Os("ReferenceError",(function(e){return function(t){return Ss(e,this,arguments)}})),Os("SyntaxError",(function(e){return function(t){return Ss(e,this,arguments)}})),Os("TypeError",(function(e){return function(t){return Ss(e,this,arguments)}})),Os("URIError",(function(e){return function(t){return Ss(e,this,arguments)}})),js("CompileError",(function(e){return function(t){return Ss(e,this,arguments)}})),js("LinkError",(function(e){return function(t){return Ss(e,this,arguments)}})),js("RuntimeError",(function(e){return function(t){return Ss(e,this,arguments)}})),process.env.IS_LOCAL="true",async function(){const{getConfig:e}=await Promise.resolve().then((function(){return Ea})),t=e(!0);await async function(e){const{logger:t}=await Promise.resolve().then((function(){return Dr})),i=e.length;if(0===i)return Promise.reject(new Error("éç½®ä¸ºç©ºæè cookie ä¸åæ³ï¼"));const{initialize:n}=await Promise.resolve().then((function(){return Na}));n(e[0]);const o=await Promise.resolve().then((function(){return $a}));for(let s=0;s<e.length;s++)t.info(`æ­£å¨æ§è¡ç¬¬${s+1}/${i}ä¸ªéç½®`),n(e[s]),await o.dailyTasks(),t.info("æ§è¡å®æ¯\n")}(t)}();const Is=()=>process.env.QL_BRANCH;function Ps(){return global.IS_CFC||!1}function Ls(){return global.IS_CFC||!1}function Rs(){const e=Is()?"cat_bili_config":"config",t=".json",{BILITOOLS_FILE_NAME:i}=process.env;return i?i.endsWith(t)?i:`${i}.json`:e+t}function Ns(){const e=Object.keys(process.env),t=["securityToken","accessKeyID","accessKeySecret","FC_FUNCTION_MEMORY_SIZE","FC_FUNC_CODE_PATH","FC_RUNTIME_VERSION"];return e.filter((e=>t.includes(e))).length>=3||!1}function $s(){const e=Object.keys(process.env),t=e.filter((e=>e.startsWith("SCF_"))).length>=10,i=e.filter((e=>e.startsWith("TENCENTCLOUD_"))).length>=3;return t&&i||!1}function Hs(){return $s()||Ns()||Ls()||Ps()}const Us=["æ£","æ£å","æ£è¶","å æ²¹~","UPå æ²¹!","æ¯æ~","æ¯ææ¯æï¼","å¬æ´å¦","é¡¶é¡¶","çä¸èå°~","å¹²æ¯","bilibiliå¹²æ¯","o(*ï¿£â½ï¿£*)o","(ï½¡ï½¥âï½¥)ï¾ï¾å¨","(âËâËâ)","( â¢Ì Ï â¢Ì )y","(à¸ â¢_â¢)à¸",">.<","^_~"],qs=Object.prototype.toString;function Ms(e,t){return qs.call(e)===`[object ${t}]`}function zs(e){return void 0!==e}function Gs(e){return!zs(e)}function Vs(e){return null!==e&&Ms(e,"Object")}function Ws(e){return null===e}function Js(e){return Ms(e,"Number")}function Ks(e){return Ms(e,"String")}function Qs(e){return"function"==typeof e}function Xs(e){return e&&Array.isArray(e)}const Ys="undefined"==typeof window,Zs=!Ys;function er(e){const t=e||ir(),i=t.getFullYear(),n=t.getMonth()+1;return 2===n?i%4==0&&i%100!=0||i%400==0?29:28:[4,6,9,11].includes(n)?30:31}function tr(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=_.randomBytes(1)[0]%16;return("x"===e?t:3&t|8).toString(16)}))}function ir(){const e=new Date,t=e.getTime(),i=e.getTimezoneOffset()/60;return new Date(t+36e5*(i+8))}function nr(e){const t=e.replace(/^\w+\(/,"").replace(/\)$/,"");return JSON.parse(t)}function or(e,t){return Math.ceil(t/e)}function sr(e,t,i){if(i&&"boolean"!=typeof i&&(t=i=void 0),void 0===i&&("boolean"==typeof t?(i=t,t=void 0):"boolean"==typeof e&&(i=e,e=void 0)),void 0===e&&void 0===t?(e=0,t=1):void 0===t&&(t=e,e=0),e>t){const i=e;e=t,t=i}if(i||e%1||t%1){const i=Math.random();return Math.min(e+i*(t-e+parseFloat("1e-"+((i+"").length-1))),t)}return e+Math.floor(Math.random()*(t-e+1))}function rr({hours:e,minutes:t,seconds:i},n){let o;switch(i=i||0,n){case"scf":default:o=`${i} ${t} ${e} * * * *`;break;case"fc":o=`${i} ${t} ${e} * * *`;break;case"cfc":o=`corn(${t} ${e} * * *)`}return{value:o,string:`${e}:${t}:${i}`}}function ar(e,t){let i="";for(let t=0;t<e;t++)i+=mr("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ");return t?i.toLowerCase():i}function cr(){return`${sr(1,9)}${ar(10,!0)}0`}function ur(e,t){e.includes(t)||e.push(t)}function lr(e){return e||{}}function pr(e,t=!1){return Vs(e)?Array.isArray(e)?e.map((e=>pr(e,t))):t?Object.keys(e).reduce(((i,n)=>(i[n]=pr(e[n],t),i)),{}):Object.assign({},e):e}function dr(e,t){return void 0===e||void 0===t?e||t:Vs(e)&&Vs(t)?Array.isArray(e)&&Array.isArray(t)?e.concat(t):Object.keys(t).reduce(((i,n)=>(i[n]=dr(e[n],t[n]),i)),e):t}function hr(e){if(!Vs(e)&&!Xs(e))return e;const t=new URLSearchParams;return Array.isArray(e)||(e=Object.entries(e)),e.forEach((([e,i])=>{Vs(i)?t.append(e,JSON.stringify(i)):t.append(e,String(i))})),t.toString()}function mr(e){return e[sr(e.length-1)]}function fr(e={},t={}){function i(e){return Object.keys(e).reduce(((t,i)=>(t[i.toLowerCase()]=e[i],t)),{})}return Object.assign({},i(e),i(t))}function gr(e){return e&&e.map((e=>Number(e))).filter((e=>e>0&&e%1==0))}function vr(e,t=!0){return t?e.toLocaleString("zh-CN",{hour12:!1}):e.toLocaleString("zh-CN",{hour12:!1,hour:"numeric",minute:"numeric",second:"numeric"})}function xr(e="info"){const t=["error","warn","info","verbose","debug"],i=t.indexOf(e);return-1!==i?t.slice(0,i+1):t}function yr(e){return E.resolve(process.cwd(),e)}class br{static pushValue="";static brChar="\n";month=ir().getMonth()+1;errorFile=yr(`./logs/bt_error-${this.month}.log`);logFile=yr(`./logs/bt_combined-${this.month}.log`);noFile=!1;constructor(e={console:"info",file:"info",push:"info"},t="default"){this.options=e,this.name=t,this.consoleLeval=xr(this.options.console),this.fileLeval=xr(this.options.file),this.pushLeval=xr(this.options.push),this.noFile=Is()||Hs(),this.noFile||this.createLogFile()}log({level:e},t,i){i=i||_r[e];const n=ir(),o=`[${i} ${vr(n,!1)}] ${t}\n`,s=["error","warn"].includes(e);this.consoleLeval.includes(e)&&this.Conslole(o,s),!this.noFile&&this.fileLeval.includes(e)&&this.File(`[${i} ${vr(n,!0)}] ${t}\n`,s),this.pushLeval.includes(e)&&this.Push(`[${i} ${vr(n,!1)}] ${t}${br.brChar}`)}error(e){this.log({level:"error"},e)}warn(e){this.log({level:"warn"},e)}info(e,t){this.log({level:"info"},e,t)}verbose(e){this.log({level:"verbose"},e)}debug(e){this.log({level:"debug"},e)}Conslole(e,t){t?process.stderr.write(e):process.stdout.write(e)}File(e,t){t&&A.appendFileSync(this.errorFile,e,"utf-8"),A.appendFileSync(this.logFile,e,"utf-8")}Push(e){br.pushValue+=e}createLogFile(){const e=yr("./logs");A.existsSync(e)||A.mkdirSync(e)}static async init(){br.pushValue="";try{const{TaskConfig:e}=await Promise.resolve().then((function(){return Na}));br.brChar=e.message.br||"\n"}catch{}}}const wr=new br({console:"debug",file:"debug",push:"debug"}),_r={error:"â",warn:"â",info:"ð»",verbose:"ð¬",debug:"ð"};var Dr=Object.freeze({__proto__:null,Logger:br,logger:wr}),Er=ai.f,Cr=yt,Ar=Pt("toStringTag"),kr=G,Sr=function(e,t,i){e&&!i&&(e=e.prototype),e&&!Cr(e,Ar)&&Er(e,Ar,{configurable:!0,value:t})};function Fr(t){try{const i=e.unzipSync(Buffer.from(t,"base64")).toString();try{return decodeURIComponent(Tr(i))}catch(e){return unescape(i)}}catch(e){throw new Error("Error: å½åå­ç¬¦ä¸²ä¸è½è¢«Gzipè§£å")}}function Tr(e){return e.replace(/\\u([\d\w]{4})/gi,((e,t)=>String.fromCodePoint(parseInt(t,16))))}So({global:!0},{Reflect:{}}),Sr(kr.Reflect,"Reflect",!0);class Br{static configFileName=Rs();static isQingLongPanel=Is()}var Or={Space_Separator:/[\u1680\u2000-\u200A\u202F\u205F\u3000]/,ID_Start:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312E\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEA\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE83\uDE86-\uDE89\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F\uDFE0\uDFE1]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]/,ID_Continue:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u08D4-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u09FC\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9-\u0AFF\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D00-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19D9\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1CD0-\u1CD2\u1CD4-\u1CF9\u1D00-\u1DF9\u1DFB-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u2E2F\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099\u309A\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312E\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEA\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC00-\uDC46\uDC66-\uDC6F\uDC7F-\uDCBA\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDCA-\uDDCC\uDDD0-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE3E\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3C-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC00-\uDC4A\uDC50-\uDC59\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB7\uDEC0-\uDEC9\uDF00-\uDF19\uDF1D-\uDF2B\uDF30-\uDF39]|\uD806[\uDCA0-\uDCE9\uDCFF\uDE00-\uDE3E\uDE47\uDE50-\uDE83\uDE86-\uDE99\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC36\uDC38-\uDC40\uDC50-\uDC59\uDC72-\uDC8F\uDC92-\uDCA7\uDCA9-\uDCB6\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD36\uDD3A\uDD3C\uDD3D\uDD3F-\uDD47\uDD50-\uDD59]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50-\uDF7E\uDF8F-\uDF9F\uDFE0\uDFE1]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6\uDD00-\uDD4A\uDD50-\uDD59]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uDB40[\uDD00-\uDDEF]/},jr={isSpaceSeparator:e=>"string"==typeof e&&Or.Space_Separator.test(e),isIdStartChar:e=>"string"==typeof e&&(e>="a"&&e<="z"||e>="A"&&e<="Z"||"$"===e||"_"===e||Or.ID_Start.test(e)),isIdContinueChar:e=>"string"==typeof e&&(e>="a"&&e<="z"||e>="A"&&e<="Z"||e>="0"&&e<="9"||"$"===e||"_"===e||"â"===e||"â"===e||Or.ID_Continue.test(e)),isDigit:e=>"string"==typeof e&&/[0-9]/.test(e),isHexDigit:e=>"string"==typeof e&&/[0-9A-Fa-f]/.test(e)};let Ir,Pr,Lr,Rr,Nr,$r,Hr,Ur,qr;function Mr(e,t,i){const n=e[t];if(null!=n&&"object"==typeof n)for(const e in n){const t=Mr(n,e,i);void 0===t?delete n[e]:n[e]=t}return i.call(e,t,n)}let zr,Gr,Vr,Wr,Jr;function Kr(){for(zr="default",Gr="",Vr=!1,Wr=1;;){Jr=Qr();const e=Yr[zr]();if(e)return e}}function Qr(){if(Ir[Rr])return String.fromCodePoint(Ir.codePointAt(Rr))}function Xr(){const e=Qr();return"\n"===e?(Nr++,$r=0):e?$r+=e.length:$r++,e&&(Rr+=e.length),e}const Yr={default(){switch(Jr){case"\t":case"\v":case"\f":case" ":case"Â ":case"\ufeff":case"\n":case"\r":case"\u2028":case"\u2029":return void Xr();case"/":return Xr(),void(zr="comment");case void 0:return Xr(),Zr("eof")}if(!jr.isSpaceSeparator(Jr))return Yr[Pr]();Xr()},comment(){switch(Jr){case"*":return Xr(),void(zr="multiLineComment");case"/":return Xr(),void(zr="singleLineComment")}throw sa(Xr())},multiLineComment(){switch(Jr){case"*":return Xr(),void(zr="multiLineCommentAsterisk");case void 0:throw sa(Xr())}Xr()},multiLineCommentAsterisk(){switch(Jr){case"*":return void Xr();case"/":return Xr(),void(zr="default");case void 0:throw sa(Xr())}Xr(),zr="multiLineComment"},singleLineComment(){switch(Jr){case"\n":case"\r":case"\u2028":case"\u2029":return Xr(),void(zr="default");case void 0:return Xr(),Zr("eof")}Xr()},value(){switch(Jr){case"{":case"[":return Zr("punctuator",Xr());case"n":return Xr(),ea("ull"),Zr("null",null);case"t":return Xr(),ea("rue"),Zr("boolean",!0);case"f":return Xr(),ea("alse"),Zr("boolean",!1);case"-":case"+":return"-"===Xr()&&(Wr=-1),void(zr="sign");case".":return Gr=Xr(),void(zr="decimalPointLeading");case"0":return Gr=Xr(),void(zr="zero");case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return Gr=Xr(),void(zr="decimalInteger");case"I":return Xr(),ea("nfinity"),Zr("numeric",1/0);case"N":return Xr(),ea("aN"),Zr("numeric",NaN);case'"':case"'":return Vr='"'===Xr(),Gr="",void(zr="string")}throw sa(Xr())},identifierNameStartEscape(){if("u"!==Jr)throw sa(Xr());Xr();const e=ta();switch(e){case"$":case"_":break;default:if(!jr.isIdStartChar(e))throw aa()}Gr+=e,zr="identifierName"},identifierName(){switch(Jr){case"$":case"_":case"â":case"â":return void(Gr+=Xr());case"\\":return Xr(),void(zr="identifierNameEscape")}if(!jr.isIdContinueChar(Jr))return Zr("identifier",Gr);Gr+=Xr()},identifierNameEscape(){if("u"!==Jr)throw sa(Xr());Xr();const e=ta();switch(e){case"$":case"_":case"â":case"â":break;default:if(!jr.isIdContinueChar(e))throw aa()}Gr+=e,zr="identifierName"},sign(){switch(Jr){case".":return Gr=Xr(),void(zr="decimalPointLeading");case"0":return Gr=Xr(),void(zr="zero");case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return Gr=Xr(),void(zr="decimalInteger");case"I":return Xr(),ea("nfinity"),Zr("numeric",Wr*(1/0));case"N":return Xr(),ea("aN"),Zr("numeric",NaN)}throw sa(Xr())},zero(){switch(Jr){case".":return Gr+=Xr(),void(zr="decimalPoint");case"e":case"E":return Gr+=Xr(),void(zr="decimalExponent");case"x":case"X":return Gr+=Xr(),void(zr="hexadecimal")}return Zr("numeric",0*Wr)},decimalInteger(){switch(Jr){case".":return Gr+=Xr(),void(zr="decimalPoint");case"e":case"E":return Gr+=Xr(),void(zr="decimalExponent")}if(!jr.isDigit(Jr))return Zr("numeric",Wr*Number(Gr));Gr+=Xr()},decimalPointLeading(){if(jr.isDigit(Jr))return Gr+=Xr(),void(zr="decimalFraction");throw sa(Xr())},decimalPoint(){switch(Jr){case"e":case"E":return Gr+=Xr(),void(zr="decimalExponent")}return jr.isDigit(Jr)?(Gr+=Xr(),void(zr="decimalFraction")):Zr("numeric",Wr*Number(Gr))},decimalFraction(){switch(Jr){case"e":case"E":return Gr+=Xr(),void(zr="decimalExponent")}if(!jr.isDigit(Jr))return Zr("numeric",Wr*Number(Gr));Gr+=Xr()},decimalExponent(){switch(Jr){case"+":case"-":return Gr+=Xr(),void(zr="decimalExponentSign")}if(jr.isDigit(Jr))return Gr+=Xr(),void(zr="decimalExponentInteger");throw sa(Xr())},decimalExponentSign(){if(jr.isDigit(Jr))return Gr+=Xr(),void(zr="decimalExponentInteger");throw sa(Xr())},decimalExponentInteger(){if(!jr.isDigit(Jr))return Zr("numeric",Wr*Number(Gr));Gr+=Xr()},hexadecimal(){if(jr.isHexDigit(Jr))return Gr+=Xr(),void(zr="hexadecimalInteger");throw sa(Xr())},hexadecimalInteger(){if(!jr.isHexDigit(Jr))return Zr("numeric",Wr*Number(Gr));Gr+=Xr()},string(){switch(Jr){case"\\":return Xr(),void(Gr+=function(){switch(Qr()){case"b":return Xr(),"\b";case"f":return Xr(),"\f";case"n":return Xr(),"\n";case"r":return Xr(),"\r";case"t":return Xr(),"\t";case"v":return Xr(),"\v";case"0":if(Xr(),jr.isDigit(Qr()))throw sa(Xr());return"\0";case"x":return Xr(),function(){let e="",t=Qr();if(!jr.isHexDigit(t))throw sa(Xr());if(e+=Xr(),t=Qr(),!jr.isHexDigit(t))throw sa(Xr());return e+=Xr(),String.fromCodePoint(parseInt(e,16))}();case"u":return Xr(),ta();case"\n":case"\u2028":case"\u2029":return Xr(),"";case"\r":return Xr(),"\n"===Qr()&&Xr(),"";case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case void 0:throw sa(Xr())}return Xr()}());case'"':return Vr?(Xr(),Zr("string",Gr)):void(Gr+=Xr());case"'":return Vr?void(Gr+=Xr()):(Xr(),Zr("string",Gr));case"\n":case"\r":throw sa(Xr());case"\u2028":case"\u2029":!function(e){console.warn(`JSON5: '${ca(e)}' in strings is not valid ECMAScript; consider escaping`)}(Jr);break;case void 0:throw sa(Xr())}Gr+=Xr()},start(){switch(Jr){case"{":case"[":return Zr("punctuator",Xr())}zr="value"},beforePropertyName(){switch(Jr){case"$":case"_":return Gr=Xr(),void(zr="identifierName");case"\\":return Xr(),void(zr="identifierNameStartEscape");case"}":return Zr("punctuator",Xr());case'"':case"'":return Vr='"'===Xr(),void(zr="string")}if(jr.isIdStartChar(Jr))return Gr+=Xr(),void(zr="identifierName");throw sa(Xr())},afterPropertyName(){if(":"===Jr)return Zr("punctuator",Xr());throw sa(Xr())},beforePropertyValue(){zr="value"},afterPropertyValue(){switch(Jr){case",":case"}":return Zr("punctuator",Xr())}throw sa(Xr())},beforeArrayValue(){if("]"===Jr)return Zr("punctuator",Xr());zr="value"},afterArrayValue(){switch(Jr){case",":case"]":return Zr("punctuator",Xr())}throw sa(Xr())},end(){throw sa(Xr())}};function Zr(e,t){return{type:e,value:t,line:Nr,column:$r}}function ea(e){for(const t of e){if(Qr()!==t)throw sa(Xr());Xr()}}function ta(){let e="",t=4;for(;t-- >0;){const t=Qr();if(!jr.isHexDigit(t))throw sa(Xr());e+=Xr()}return String.fromCodePoint(parseInt(e,16))}const ia={start(){if("eof"===Hr.type)throw ra();na()},beforePropertyName(){switch(Hr.type){case"identifier":case"string":return Ur=Hr.value,void(Pr="afterPropertyName");case"punctuator":return void oa();case"eof":throw ra()}},afterPropertyName(){if("eof"===Hr.type)throw ra();Pr="beforePropertyValue"},beforePropertyValue(){if("eof"===Hr.type)throw ra();na()},beforeArrayValue(){if("eof"===Hr.type)throw ra();"punctuator"!==Hr.type||"]"!==Hr.value?na():oa()},afterPropertyValue(){if("eof"===Hr.type)throw ra();switch(Hr.value){case",":return void(Pr="beforePropertyName");case"}":oa()}},afterArrayValue(){if("eof"===Hr.type)throw ra();switch(Hr.value){case",":return void(Pr="beforeArrayValue");case"]":oa()}},end(){}};function na(){let e;switch(Hr.type){case"punctuator":switch(Hr.value){case"{":e={};break;case"[":e=[]}break;case"null":case"boolean":case"numeric":case"string":e=Hr.value}if(void 0===qr)qr=e;else{const t=Lr[Lr.length-1];Array.isArray(t)?t.push(e):t[Ur]=e}if(null!==e&&"object"==typeof e)Lr.push(e),Pr=Array.isArray(e)?"beforeArrayValue":"beforePropertyName";else{const e=Lr[Lr.length-1];Pr=null==e?"end":Array.isArray(e)?"afterArrayValue":"afterPropertyValue"}}function oa(){Lr.pop();const e=Lr[Lr.length-1];Pr=null==e?"end":Array.isArray(e)?"afterArrayValue":"afterPropertyValue"}function sa(e){return ua(void 0===e?`JSON5: invalid end of input at ${Nr}:${$r}`:`JSON5: invalid character '${ca(e)}' at ${Nr}:${$r}`)}function ra(){return ua(`JSON5: invalid end of input at ${Nr}:${$r}`)}function aa(){return $r-=5,ua(`JSON5: invalid identifier character at ${Nr}:${$r}`)}function ca(e){const t={"'":"\\'",'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\v","\0":"\\0","\u2028":"\\u2028","\u2029":"\\u2029"};if(t[e])return t[e];if(e<" "){const t=e.charCodeAt(0).toString(16);return"\\x"+("00"+t).substring(t.length)}return e}function ua(e){const t=new SyntaxError(e);return t.lineNumber=Nr,t.columnNumber=$r,t}const la={parse:function(e,t){Ir=String(e),Pr="start",Lr=[],Rr=0,Nr=1,$r=0,Hr=void 0,Ur=void 0,qr=void 0;do{Hr=Kr(),ia[Pr]()}while("eof"!==Hr.type);return"function"==typeof t?Mr({"":qr},"",t):qr},stringify:function(e,t,i){const n=[];let o,s,r,a="",c="";if(null==t||"object"!=typeof t||Array.isArray(t)||(i=t.space,r=t.quote,t=t.replacer),"function"==typeof t)s=t;else if(Array.isArray(t)){o=[];for(const e of t){let t;"string"==typeof e?t=e:("number"==typeof e||e instanceof String||e instanceof Number)&&(t=String(e)),void 0!==t&&o.indexOf(t)<0&&o.push(t)}}return i instanceof Number?i=Number(i):i instanceof String&&(i=String(i)),"number"==typeof i?i>0&&(i=Math.min(10,Math.floor(i)),c="          ".substr(0,i)):"string"==typeof i&&(c=i.substr(0,10)),u("",{"":e});function u(e,t){let i=t[e];switch(null!=i&&("function"==typeof i.toJSON5?i=i.toJSON5(e):"function"==typeof i.toJSON&&(i=i.toJSON(e))),s&&(i=s.call(t,e,i)),i instanceof Number?i=Number(i):i instanceof String?i=String(i):i instanceof Boolean&&(i=i.valueOf()),i){case null:return"null";case!0:return"true";case!1:return"false"}return"string"==typeof i?l(i):"number"==typeof i?String(i):"object"==typeof i?Array.isArray(i)?function(e){if(n.indexOf(e)>=0)throw TypeError("Converting circular structure to JSON5");n.push(e);let t=a;a+=c;let i,o=[];for(let t=0;t<e.length;t++){const i=u(String(t),e);o.push(void 0!==i?i:"null")}if(0===o.length)i="[]";else if(""===c){i="["+o.join(",")+"]"}else{let e=",\n"+a,n=o.join(e);i="[\n"+a+n+",\n"+t+"]"}return n.pop(),a=t,i}(i):function(e){if(n.indexOf(e)>=0)throw TypeError("Converting circular structure to JSON5");n.push(e);let t=a;a+=c;let i,s=o||Object.keys(e),r=[];for(const t of s){const i=u(t,e);if(void 0!==i){let e=p(t)+":";""!==c&&(e+=" "),e+=i,r.push(e)}}if(0===r.length)i="{}";else{let e;if(""===c)e=r.join(","),i="{"+e+"}";else{let n=",\n"+a;e=r.join(n),i="{\n"+a+e+",\n"+t+"}"}}return n.pop(),a=t,i}(i):void 0}function l(e){const t={"'":.1,'"':.2},i={"'":"\\'",'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\v","\0":"\\0","\u2028":"\\u2028","\u2029":"\\u2029"};let n="";for(let o=0;o<e.length;o++){const s=e[o];switch(s){case"'":case'"':t[s]++,n+=s;continue;case"\0":if(jr.isDigit(e[o+1])){n+="\\x00";continue}}if(i[s])n+=i[s];else if(s<" "){let e=s.charCodeAt(0).toString(16);n+="\\x"+("00"+e).substring(e.length)}else n+=s}const o=r||Object.keys(t).reduce(((e,i)=>t[e]<t[i]?e:i));return n=n.replace(new RegExp(o,"g"),i[o]),o+n+o}function p(e){if(0===e.length)return l(e);const t=String.fromCodePoint(e.codePointAt(0));if(!jr.isIdStartChar(t))return l(e);for(let i=t.length;i<e.length;i++)if(!jr.isIdContinueChar(String.fromCodePoint(e.codePointAt(i))))return l(e);return e}}};var pa=la;const da=pa||Object.freeze({__proto__:null,default:pa});function ha(e){try{let t;if((n.existsSync(e)||n.existsSync(e+="5"))&&(t=n.readFileSync(e,"utf-8")),!t)return;return da.parse(t)}catch(e){wr.error(e),function(e){if(!Ks(e))return;if(e.includes("SyntaxError: JSON5"))throw new SyntaxError("éç½®æä»¶å­å¨ï¼ä½æ¯æ æ³è§£æï¼å¯è½ JSON5 æ ¼å¼ä¸æ­£ç¡®ï¼");throw new Error(e)}(e.message)}}const ma=e=>E.resolve(process.cwd(),e),fa=e=>E.resolve(__dirname,"../",e);const ga=Array.from(new Set([ma("./config/config.dev.json"),ma(`./config/${Br.configFileName}`),ma(`./${Br.configFileName}`),fa(`./config/${Br.configFileName}`),fa(`./${Br.configFileName}`)])),va=["./config.json",ma("./config/config.json")];function xa(e){let t;const i=Array.isArray(e);if(t=i?e:e.account.filter((e=>e.cookie)),0===t.length)return;if(Br.isQingLongPanel)return function(e){const t=process.argv.find((e=>e.includes("--item")||e.includes("-i")||e.includes("-I")));if(!t)return e[0];const i=Number(t.split("=")[1])-1;return!i||i>=e.length||i<0?(wr.warn("ä¼¼ä¹æ³è¦æå®ä¸ä¸ªä¸å­å¨çç¨æ·ï¼æä»¬å°æå®ç¬¬ä¸ä¸ªç¨æ·"),e[0]):e[i]}(t);wr.warn("å¨åç¨æ·åºæ¯ä¸éç½®äºå¤ç¨æ·ï¼æä»¬å°æ¾å¼å¤ä½çéç½®");const n=t[0];return i||(n.message=Object.assign(e.message||{},n.message)),n}function ya(){if(globalThis.BILITOOLS_CONFIG)return globalThis.BILITOOLS_CONFIG;Br.isQingLongPanel&&ga.splice(0,1,...va);for(let e=0;e<ga.length;e++){const t=ha(ga[e]);if(t)return wr.verbose(`è¯»åéç½®æä»¶ ${ga[e]}`),t}return(()=>{const{BILITOOLS_CONFIG:e,BILI_SCF_CONFIG:t,BILI_CONFIG:i}=process.env,n=e||t||i;if(n)try{return da.parse(Fr(n))}catch(e){throw wr.error(e),new Error("ç¯å¢ä¸­çéç½®ä¸æ¯ææç JSON å­ç¬¦ä¸²ï¼")}})()}function ba(e){return wa(ya(),e)}function wa(e,t=!1){if(!e)throw new Error("è·åéç½®å¤±è´¥ï¼æªæ¾å°éç½®æä»¶ï¼");if(t)return Da(_a(e)?e:[e]);if(_a(e)){const t=xa(e);if(t)return t}if(!e.cookie)throw new Error("éç½®æä»¶ä¸­æ²¡æ cookieï¼");return e}function _a(e){return!!Array.isArray(e)||Boolean(e.account&&e.account.length)}function Da(e){const t=e=>e.cookie&&e.cookie.length>90&&["bili_jct","SESSDATA","DedeUserID"].every((t=>e.cookie.includes(t)));return Array.isArray(e)?e.filter(t):e.account.filter(t)}var Ea=Object.freeze({__proto__:null,getConfigPathFile:function(e){try{const t=ha(e);if(!t)throw wr.error("éç½®æä»¶ä¸ºç©ºï¼æéç½®åå®¹ç¼ºå¤±ï¼"),new Error("éç½®æä»¶ä¸ºç©ºï¼æéç½®åå®¹ç¼ºå¤±ï¼");return wr.verbose(`è¯»åéç½®æä»¶ ${e}`),_a(t)?Da(t):[t]}catch(e){throw wr.error(e),function(e){if(e.includes&&e.includes("in JSON at position"))throw new Error("éç½®æä»¶å­å¨ï¼ä½æ¯æ æ³è§£æï¼å¯è½ JSON æ ¼å¼ä¸æ­£ç¡®ï¼")}(e.message),new Error(e.message||"éç½®æä»¶ä¸å­å¨ï¼")}},getConfig:ba,checkConfig:wa});function Ca(e){return e?e.split("; ").map((e=>e.split("="))):[]}function Aa(e,t){return e?t&&0!==t.length?function(e){const t=Object.keys(e).reduce(((t,i)=>t+`${i}=${e[i]}; `),"");return t.substring(0,t.length-2||0)}(function(e,t){const i=Ca(null==t?void 0:t[0]).filter((e=>2===e.length)),n=Ca(e).concat(i).filter((e=>2===e.length)),o={};for(const e of n)o[e[0]]?o[e[0]]=e[1]:Object.defineProperty(o,e[0],{value:e[1],enumerable:!0,writable:!0});return o}(e,t)):e:""}function ka(e,t){if(!e)return null;const i=`(?:^|)${t}=([^;]*)(?:;|$)`,n=e.match(i);return n?n[1]:null}function Sa(e){return Number(ka(e,"DedeUserID"))||0}function Fa(e){return ka(e,"bili_jct")||""}const Ta={cookie:"",message:{br:"\n",email:{host:"smtp.163.com",port:465},pushplusToken:process.env.PUSHPLUS_TOKEN,api:{method:"POST",headers:{"Content-Type":"application/json"},timeout:5e3,url:"",proxy:{host:"",port:443,auth:""},data:{}}},function:{silver2Coin:!0,liveSignTask:!0,addCoins:!0,mangaSign:!1,shareAndWatch:!0,supGroupSign:!1,liveSendMessage:!1,taskReward:!0,charging:!1,getVipPrivilege:!1,giveGift:!1,matchGame:!1,liveLottery:!1,liveRedPack:!1,liveIntimacy:!1,mangaTask:!1},apiDelay:[2,6],userAgent:"",dailyRunTime:"17:30:00-23:40:00",targetLevel:void 0,stayCoins:void 0,targetCoins:void 0,customizeUp:void 0,giftUp:void 0,coinRetryNum:void 0,chargeUpId:void 0,chargePresetTime:void 0,matchCoins:void 0,matchSelection:void 0,matchDiff:void 0,match:{coins:5,selection:1,diff:0},charge:{mid:0,presetTime:[10,20]},gift:{mids:[]},coin:{customizeUp:[],retryNum:4,targetLevel:6,stayCoins:0,targetCoins:5},sls:{name:"",description:"",region:"ap-chengdu",dailyRunTime:"17:30:00-23:40:00"},lottery:{excludeAward:["è°","è¹","èªæµ·","ä»£éå¸","ä¼æ å¸","èªæ","ç§","åç","å¾","æç£","è½¦è½¦ä¸å±","åæ¥ä¸å±","æ¸¸æéå·"],includeAward:["è°¢"],blackUid:[65566781,1277481241,1643654862,603676925],isMoveTag:!0,moveTag:"å¤©éæ¶å»",pageNum:2,actFollowMsg:"read",scanFollow:void 0,skipNeedFollow:!1},redPack:{},intimacy:{liveSendMessage:!0,liveShare:!0,liveLike:!0,liveHeart:!1,whiteList:[],blackList:[]},manga:{sign:!0,buy:!1,mc:[],name:[],love:!0,buyInterval:6,buyWeek:[3]},BILIJCT:"",USERID:0};function Ba(e){return function(e){!function(e){e.BILIJCT=Fa(e.cookie),e.USERID=Sa(e.cookie)}(e);const{coin:t,gift:i,charge:n}=e;Xs(e.apiDelay)?e.apiDelay=gr(e.apiDelay):e.apiDelay=[Number(e.apiDelay)];t.customizeUp=gr(t.customizeUp),i.mids=gr(i.mids),0===i.mids.length&&(i.mids=t.customizeUp);n.mid||(n.mid=e.USERID);return e}(function(e){return Object.keys(Oa).forEach((t=>{if(void 0!==e[t]){const[i,n]=Oa[t];e[i]=lr(e[i]),e[i][n]=e[t]}delete e[t]})),e}(dr(pr(Ta,!0),function(e){const{message:t}=e;if(t&&Ks(t.api)){const e=t.api;t.api=pr(Ta.message.api,!0),t.api.url=e,t.api.method="GET"}return e}(e))))}const Oa={targetLevel:["coin","targetLevel"],stayCoins:["coin","stayCoins"],targetCoins:["coin","targetCoins"],customizeUp:["coin","customizeUp"],coinRetryNum:["coin","retryNum"],giftUp:["gift","mids"],chargeUpId:["charge","mid"],chargePresetTime:["charge","presetTime"],matchCoins:["match","coins"],matchSelection:["match","selection"],matchDiff:["match","diff"]};class ja{constructor(e){this.COOKIE=e.cookie,this.BILIJCT=e.BILIJCT,this.USERID=e.USERID,this.USER_AGENT=e.userAgent,this.BILI_API_DELAY=e.apiDelay;const t=e.message;this.PUSHPLUS_TOKEN=t.pushplusToken;const i=e.coin;this.BILI_CUSTOMIZE_UP=i.customizeUp,this.BILI_COIN_RETRY_NUM=i.retryNum,this.BILI_TARGET_LEVEL=i.targetLevel,this.BILI_STAY_COINS=i.stayCoins,this.BILI_TARGET_COINS=i.targetCoins;const n=e.gift;this.BILI_GIFT_UP=n.mids;const o=e.match;this.MATCH_COINS=o.coins,this.MATCH_SELECTION=o.selection,this.MATCH_DIFF=o.diff}}let Ia;const Pa=new Proxy({},{get:(e,t)=>(Ia||Ra(),Reflect.get(Ia,t)),set:(e,t,i)=>"config"===t&&i?(Ra(i),!0):Reflect.set(Ia,t,i)});let La=null;function Ra(e){e||(e=ba(!1));const t=Ba(e);Ia={...new ja(wa(t)),...t},La=class extends class{static money=0;static coinsTask=5;static share=!1;static watch=!1;static currentStartFun=0;static bCoinCouponBalance=0;static vipType=0;static vipStatus=0;static userLevel=0}{},La.coinsTask=Ia.BILI_TARGET_COINS}var Na=Object.freeze({__proto__:null,TaskConfig:Pa,get TaskModule(){return La},initialize:Ra,changeConfig:function(e){const t=ba();t[e]&&Ra(t[e])}});var $a=Object.freeze({__proto__:null,dailyTasks:async function(e,...t){const{apiDelay:i,logger:n,Logger:o}=await Promise.resolve().then((function(){return Ma})),{offFunctions:s}=await Promise.resolve().then((function(){return za})),{sendMessage:r}=await Promise.resolve().then((function(){return Sd})),{loginTask:a,default:c}=await Promise.resolve().then((function(){return gm})),{printVersion:u}=await Promise.resolve().then((function(){return rg}));await o.init(),await u();try{await a()}catch(e){return n.error(`ç»å½å¤±è´¥: ${e}`),await r("ç»å½å¤±è´¥",o.pushValue),"æªå®æ"}const l=s([...Object.values(c)]);for(const e of l)try{await e()}catch(t){n.error(`${e.name}å¤±è´¥: ${t}`)}finally{await i()}return e&&await e(...t),await r("æ¯æ¥å®æ",o.pushValue),"å®æ"}});function Ha(e,t){const i=qa(e,t);return new Promise((e=>{setTimeout((()=>{e(i)}),i)}))}function Ua(e,t){qa(e,t)}function qa(e,t){if(e&&t)return sr(e,t);if(e)return e;const i=Pa.BILI_API_DELAY;return 1===i.length?1e3*i[0]:1e3*sr(i[0]||2,i[1]||6)}var Ma=Object.freeze({__proto__:null,gzipEncode:function(t){try{return e.gzipSync(encodeURIComponent(t)).toString("base64")}catch(e){return"Error: å½åå­ç¬¦ä¸²ä¸è½è¢«Gzipåç¼©"}},gzipDecode:Fr,unicode2str:Tr,apiDelay:Ha,apiDelaySync:Ua,getCookieItem:ka,getUserId:Sa,getBiliJct:Fa,getLIVE_BUVID:function(e){return ka(e,"LIVE_BUVID")||""},isQingLongPanel:Is,isCFC:Ps,isAGC:Ls,setConfigFileName:Rs,isFC:Ns,isSCF:$s,isServerless:Hs,Logger:br,logger:wr,getMonthHasDays:er,createUUID:tr,getPRCDate:ir,jsonp2Object:nr,getPageNum:or,setCron:function(e=6e4,t){e=e||6e4;const i=ir().getTime()+e,n=new Date(i),o=n.getSeconds(),s=n.getMinutes();return rr({hours:n.getHours(),minutes:s,seconds:o},t)},random:sr,randomDailyRunTime:function(e="17:30:00-23:40:00",t){const i=e.split("-"),n=i[0].split(":").map((e=>+e)),o=i[1].split(":").map((e=>+e)),s=sr(n[0]??19,o[0]??23);let r=0;r=s==n[0]?sr(n[1],59):s==o[0]?sr(o[1]):sr(59);let a=0;return a=s==n[0]?sr(n[2],59):s==o[0]?sr(o[2]):sr(59),rr({seconds:a,hours:s,minutes:r},t)},formatCron:rr,randomString:ar,getVisitId:cr,pushIfNotExist:ur,getNewObject:lr,cloneObject:pr,deepMergeObject:dr,stringify:hr,getRandomItem:mr,md5:function(e,t=!1){const i=_.createHash("md5");return i.update(e),t?i.digest("hex").toUpperCase():i.digest("hex")},mergeHeaders:fr,arr2numArr:gr,base64Encode:function(e){return Buffer.from(e).toString("base64")},isTodayInTimeArr:function(e){if(!e||!e.length)return!0;const t=(new Date).getDate();return e.includes(t)},is:Ms,isDef:zs,isUnDef:Gs,isObject:Vs,isEmpty:function(e){return Xs(e)||Ks(e)?0===e.length:e instanceof Map||e instanceof Set?0===e.size:!!Vs(e)&&0===Object.keys(e).length},isDate:function(e){return Ms(e,"Date")},isNull:Ws,isNullAndUnDef:function(e){return Gs(e)&&Ws(e)},isNullOrUnDef:function(e){return Gs(e)||Ws(e)},isNumber:Js,isPromise:function(e){return Ms(e,"Promise")&&Vs(e)&&Qs(e.then)&&Qs(e.catch)},isString:Ks,isFunction:Qs,isBoolean:function(e){return Ms(e,"Boolean")},isRegExp:function(e){return Ms(e,"RegExp")},isArray:Xs,isWindow:function(e){return"undefined"!=typeof window&&Ms(e,"Window")},isElement:function(e){return Vs(e)&&!!e.tagName},isMap:function(e){return Ms(e,"Map")},isServer:Ys,isClient:Zs,isUrl:function(e){return/(((^https?:(?:\/\/)?)(?:[-;:&=\+\$,\w]+@)?[A-Za-z0-9.-]+(?::\d+)?|(?:www.|[-;:&=\+\$,\w]+@)[A-Za-z0-9.-]+)((?:\/[\+~%\/.\w-_]*)?\??(?:[-\+=&;%@.\w_]*)#?(?:[\w]*))?)$/.test(e)},isEmail:function(e){return/\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*/.test(e)}});var za=Object.freeze({__proto__:null,offFunctions:function(e){const t=function(){const e=Pa.function;return e.addCoins||e.shareAndWatch||(e.taskReward=!1),e.liveIntimacy&&Pa.intimacy.liveSendMessage&&(e.liveSendMessage=!1),e.mangaTask&&Pa.manga.sign&&(e.mangaSign=!1),e}();return e.map((e=>t[e.name]?e:null)).filter((e=>e))}});const Ga="https://account.bilibili.com",Va="https://live.bilibili.com",Wa="https://space.bilibili.com",Ja="https://message.bilibili.com",Ka="https://www.bilibili.com",Qa="https://www.bilibili.com/",Xa="https://account.bilibili.com",Ya="https://api.live.bilibili.com",Za="https://api.bilibili.com",ec="https://manga.bilibili.com",tc="https://api.vc.bilibili.com",ic="https://live-trace.bilibili.com",nc={"user-agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.41 Safari/537.36 Edg/101.0.1210.32","content-type":"application/x-www-form-urlencoded; charset=UTF-8","accept-language":"zh-CN,zh;q=0.9","accept-encoding":"gzip, deflate, br"};function oc({version:e="6.74.0",phone:t="MI 10 Pro",build:i="6740400",channel:n="xiaomi",os:o="10"}={}){return`Mozilla/5.0 BiliDroid/${e} (bbcallen@gmail.com) os/android model/${t} mobi_app/android build/${i} channel/${n} innerVer/${n} osVer/${o} network/2`}var sc={exports:{}},rc={},ac={exports:{}};!function(e,t){Object.defineProperty(t,"__esModule",{value:!0});const i=["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];const n=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Blob","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","FormData","URLSearchParams","HTMLElement",...i];const o=["null","undefined","string","number","bigint","boolean","symbol"];function s(e){return t=>typeof t===e}const{toString:r}=Object.prototype,a=e=>{const t=r.call(e).slice(8,-1);return/HTML\w+Element/.test(t)&&u.domElement(e)?"HTMLElement":function(e){return n.includes(e)}(t)?t:void 0},c=e=>t=>a(t)===e;function u(e){if(null===e)return"null";switch(typeof e){case"undefined":return"undefined";case"string":return"string";case"number":return"number";case"boolean":return"boolean";case"function":return"Function";case"bigint":return"bigint";case"symbol":return"symbol"}if(u.observable(e))return"Observable";if(u.array(e))return"Array";if(u.buffer(e))return"Buffer";const t=a(e);if(t)return t;if(e instanceof String||e instanceof Boolean||e instanceof Number)throw new TypeError("Please don't use object wrappers for primitive types");return"Object"}u.undefined=s("undefined"),u.string=s("string");const l=s("number");u.number=e=>l(e)&&!u.nan(e),u.bigint=s("bigint"),u.function_=s("function"),u.null_=e=>null===e,u.class_=e=>u.function_(e)&&e.toString().startsWith("class "),u.boolean=e=>!0===e||!1===e,u.symbol=s("symbol"),u.numericString=e=>u.string(e)&&!u.emptyStringOrWhitespace(e)&&!Number.isNaN(Number(e)),u.array=(e,t)=>!!Array.isArray(e)&&(!u.function_(t)||e.every(t)),u.buffer=e=>{var t,i,n,o;return null!==(o=null===(n=null===(i=null===(t=e)||void 0===t?void 0:t.constructor)||void 0===i?void 0:i.isBuffer)||void 0===n?void 0:n.call(i,e))&&void 0!==o&&o},u.blob=e=>c("Blob")(e),u.nullOrUndefined=e=>u.null_(e)||u.undefined(e),u.object=e=>!u.null_(e)&&("object"==typeof e||u.function_(e)),u.iterable=e=>{var t;return u.function_(null===(t=e)||void 0===t?void 0:t[Symbol.iterator])},u.asyncIterable=e=>{var t;return u.function_(null===(t=e)||void 0===t?void 0:t[Symbol.asyncIterator])},u.generator=e=>{var t,i;return u.iterable(e)&&u.function_(null===(t=e)||void 0===t?void 0:t.next)&&u.function_(null===(i=e)||void 0===i?void 0:i.throw)},u.asyncGenerator=e=>u.asyncIterable(e)&&u.function_(e.next)&&u.function_(e.throw),u.nativePromise=e=>c("Promise")(e);u.promise=e=>u.nativePromise(e)||(e=>{var t,i;return u.function_(null===(t=e)||void 0===t?void 0:t.then)&&u.function_(null===(i=e)||void 0===i?void 0:i.catch)})(e),u.generatorFunction=c("GeneratorFunction"),u.asyncGeneratorFunction=e=>"AsyncGeneratorFunction"===a(e),u.asyncFunction=e=>"AsyncFunction"===a(e),u.boundFunction=e=>u.function_(e)&&!e.hasOwnProperty("prototype"),u.regExp=c("RegExp"),u.date=c("Date"),u.error=c("Error"),u.map=e=>c("Map")(e),u.set=e=>c("Set")(e),u.weakMap=e=>c("WeakMap")(e),u.weakSet=e=>c("WeakSet")(e),u.int8Array=c("Int8Array"),u.uint8Array=c("Uint8Array"),u.uint8ClampedArray=c("Uint8ClampedArray"),u.int16Array=c("Int16Array"),u.uint16Array=c("Uint16Array"),u.int32Array=c("Int32Array"),u.uint32Array=c("Uint32Array"),u.float32Array=c("Float32Array"),u.float64Array=c("Float64Array"),u.bigInt64Array=c("BigInt64Array"),u.bigUint64Array=c("BigUint64Array"),u.arrayBuffer=c("ArrayBuffer"),u.sharedArrayBuffer=c("SharedArrayBuffer"),u.dataView=c("DataView"),u.enumCase=(e,t)=>Object.values(t).includes(e),u.directInstanceOf=(e,t)=>Object.getPrototypeOf(e)===t.prototype,u.urlInstance=e=>c("URL")(e),u.urlString=e=>{if(!u.string(e))return!1;try{return new URL(e),!0}catch(e){return!1}},u.truthy=e=>Boolean(e),u.falsy=e=>!e,u.nan=e=>Number.isNaN(e),u.primitive=e=>u.null_(e)||function(e){return o.includes(e)}(typeof e),u.integer=e=>Number.isInteger(e),u.safeInteger=e=>Number.isSafeInteger(e),u.plainObject=e=>{if("[object Object]"!==r.call(e))return!1;const t=Object.getPrototypeOf(e);return null===t||t===Object.getPrototypeOf({})},u.typedArray=e=>function(e){return i.includes(e)}(a(e));u.arrayLike=e=>!u.nullOrUndefined(e)&&!u.function_(e)&&(e=>u.safeInteger(e)&&e>=0)(e.length),u.inRange=(e,t)=>{if(u.number(t))return e>=Math.min(0,t)&&e<=Math.max(t,0);if(u.array(t)&&2===t.length)return e>=Math.min(...t)&&e<=Math.max(...t);throw new TypeError(`Invalid range: ${JSON.stringify(t)}`)};const p=["innerHTML","ownerDocument","style","attributes","nodeValue"];u.domElement=e=>u.object(e)&&1===e.nodeType&&u.string(e.nodeName)&&!u.plainObject(e)&&p.every((t=>t in e)),u.observable=e=>{var t,i,n,o;return!!e&&(e===(null===(i=(t=e)[Symbol.observable])||void 0===i?void 0:i.call(t))||e===(null===(o=(n=e)["@@observable"])||void 0===o?void 0:o.call(n)))},u.nodeStream=e=>u.object(e)&&u.function_(e.pipe)&&!u.observable(e),u.infinite=e=>e===1/0||e===-1/0;const d=e=>t=>u.integer(t)&&Math.abs(t%2)===e;u.evenInteger=d(0),u.oddInteger=d(1),u.emptyArray=e=>u.array(e)&&0===e.length,u.nonEmptyArray=e=>u.array(e)&&e.length>0,u.emptyString=e=>u.string(e)&&0===e.length;u.emptyStringOrWhitespace=e=>u.emptyString(e)||(e=>u.string(e)&&!/\S/.test(e))(e),u.nonEmptyString=e=>u.string(e)&&e.length>0,u.nonEmptyStringAndNotWhitespace=e=>u.string(e)&&!u.emptyStringOrWhitespace(e),u.emptyObject=e=>u.object(e)&&!u.map(e)&&!u.set(e)&&0===Object.keys(e).length,u.nonEmptyObject=e=>u.object(e)&&!u.map(e)&&!u.set(e)&&Object.keys(e).length>0,u.emptySet=e=>u.set(e)&&0===e.size,u.nonEmptySet=e=>u.set(e)&&e.size>0,u.emptyMap=e=>u.map(e)&&0===e.size,u.nonEmptyMap=e=>u.map(e)&&e.size>0,u.propertyKey=e=>u.any([u.string,u.number,u.symbol],e),u.formData=e=>c("FormData")(e),u.urlSearchParams=e=>c("URLSearchParams")(e);const h=(e,t,i)=>{if(!u.function_(t))throw new TypeError(`Invalid predicate: ${JSON.stringify(t)}`);if(0===i.length)throw new TypeError("Invalid number of values");return e.call(i,t)};u.any=(e,...t)=>(u.array(e)?e:[e]).some((e=>h(Array.prototype.some,e,t))),u.all=(e,...t)=>h(Array.prototype.every,e,t);const m=(e,t,i,n={})=>{if(!e){const{multipleValues:e}=n,o=e?`received values of types ${[...new Set(i.map((e=>`\`${u(e)}\``)))].join(", ")}`:`received value of type \`${u(i)}\``;throw new TypeError(`Expected value which is \`${t}\`, ${o}.`)}};t.assert={undefined:e=>m(u.undefined(e),"undefined",e),string:e=>m(u.string(e),"string",e),number:e=>m(u.number(e),"number",e),bigint:e=>m(u.bigint(e),"bigint",e),function_:e=>m(u.function_(e),"Function",e),null_:e=>m(u.null_(e),"null",e),class_:e=>m(u.class_(e),"Class",e),boolean:e=>m(u.boolean(e),"boolean",e),symbol:e=>m(u.symbol(e),"symbol",e),numericString:e=>m(u.numericString(e),"string with a number",e),array:(e,t)=>{m(u.array(e),"Array",e),t&&e.forEach(t)},buffer:e=>m(u.buffer(e),"Buffer",e),blob:e=>m(u.blob(e),"Blob",e),nullOrUndefined:e=>m(u.nullOrUndefined(e),"null or undefined",e),object:e=>m(u.object(e),"Object",e),iterable:e=>m(u.iterable(e),"Iterable",e),asyncIterable:e=>m(u.asyncIterable(e),"AsyncIterable",e),generator:e=>m(u.generator(e),"Generator",e),asyncGenerator:e=>m(u.asyncGenerator(e),"AsyncGenerator",e),nativePromise:e=>m(u.nativePromise(e),"native Promise",e),promise:e=>m(u.promise(e),"Promise",e),generatorFunction:e=>m(u.generatorFunction(e),"GeneratorFunction",e),asyncGeneratorFunction:e=>m(u.asyncGeneratorFunction(e),"AsyncGeneratorFunction",e),asyncFunction:e=>m(u.asyncFunction(e),"AsyncFunction",e),boundFunction:e=>m(u.boundFunction(e),"Function",e),regExp:e=>m(u.regExp(e),"RegExp",e),date:e=>m(u.date(e),"Date",e),error:e=>m(u.error(e),"Error",e),map:e=>m(u.map(e),"Map",e),set:e=>m(u.set(e),"Set",e),weakMap:e=>m(u.weakMap(e),"WeakMap",e),weakSet:e=>m(u.weakSet(e),"WeakSet",e),int8Array:e=>m(u.int8Array(e),"Int8Array",e),uint8Array:e=>m(u.uint8Array(e),"Uint8Array",e),uint8ClampedArray:e=>m(u.uint8ClampedArray(e),"Uint8ClampedArray",e),int16Array:e=>m(u.int16Array(e),"Int16Array",e),uint16Array:e=>m(u.uint16Array(e),"Uint16Array",e),int32Array:e=>m(u.int32Array(e),"Int32Array",e),uint32Array:e=>m(u.uint32Array(e),"Uint32Array",e),float32Array:e=>m(u.float32Array(e),"Float32Array",e),float64Array:e=>m(u.float64Array(e),"Float64Array",e),bigInt64Array:e=>m(u.bigInt64Array(e),"BigInt64Array",e),bigUint64Array:e=>m(u.bigUint64Array(e),"BigUint64Array",e),arrayBuffer:e=>m(u.arrayBuffer(e),"ArrayBuffer",e),sharedArrayBuffer:e=>m(u.sharedArrayBuffer(e),"SharedArrayBuffer",e),dataView:e=>m(u.dataView(e),"DataView",e),enumCase:(e,t)=>m(u.enumCase(e,t),"EnumCase",e),urlInstance:e=>m(u.urlInstance(e),"URL",e),urlString:e=>m(u.urlString(e),"string with a URL",e),truthy:e=>m(u.truthy(e),"truthy",e),falsy:e=>m(u.falsy(e),"falsy",e),nan:e=>m(u.nan(e),"NaN",e),primitive:e=>m(u.primitive(e),"primitive",e),integer:e=>m(u.integer(e),"integer",e),safeInteger:e=>m(u.safeInteger(e),"integer",e),plainObject:e=>m(u.plainObject(e),"plain object",e),typedArray:e=>m(u.typedArray(e),"TypedArray",e),arrayLike:e=>m(u.arrayLike(e),"array-like",e),domElement:e=>m(u.domElement(e),"HTMLElement",e),observable:e=>m(u.observable(e),"Observable",e),nodeStream:e=>m(u.nodeStream(e),"Node.js Stream",e),infinite:e=>m(u.infinite(e),"infinite number",e),emptyArray:e=>m(u.emptyArray(e),"empty array",e),nonEmptyArray:e=>m(u.nonEmptyArray(e),"non-empty array",e),emptyString:e=>m(u.emptyString(e),"empty string",e),emptyStringOrWhitespace:e=>m(u.emptyStringOrWhitespace(e),"empty string or whitespace",e),nonEmptyString:e=>m(u.nonEmptyString(e),"non-empty string",e),nonEmptyStringAndNotWhitespace:e=>m(u.nonEmptyStringAndNotWhitespace(e),"non-empty string and not whitespace",e),emptyObject:e=>m(u.emptyObject(e),"empty object",e),nonEmptyObject:e=>m(u.nonEmptyObject(e),"non-empty object",e),emptySet:e=>m(u.emptySet(e),"empty set",e),nonEmptySet:e=>m(u.nonEmptySet(e),"non-empty set",e),emptyMap:e=>m(u.emptyMap(e),"empty map",e),nonEmptyMap:e=>m(u.nonEmptyMap(e),"non-empty map",e),propertyKey:e=>m(u.propertyKey(e),"PropertyKey",e),formData:e=>m(u.formData(e),"FormData",e),urlSearchParams:e=>m(u.urlSearchParams(e),"URLSearchParams",e),evenInteger:e=>m(u.evenInteger(e),"even integer",e),oddInteger:e=>m(u.oddInteger(e),"odd integer",e),directInstanceOf:(e,t)=>m(u.directInstanceOf(e,t),"T",e),inRange:(e,t)=>m(u.inRange(e,t),"in range",e),any:(e,...t)=>m(u.any(e,...t),"predicate returns truthy for any value",t,{multipleValues:!0}),all:(e,...t)=>m(u.all(e,...t),"predicate returns truthy for all values",t,{multipleValues:!0})},Object.defineProperties(u,{class:{value:u.class_},function:{value:u.function_},null:{value:u.null_}}),Object.defineProperties(t.assert,{class:{value:t.assert.class_},function:{value:t.assert.function_},null:{value:t.assert.null_}}),t.default=u,e.exports=u,e.exports.default=u,e.exports.assert=t.assert}(ac,ac.exports);var cc,uc={},lc={exports:{}};var pc={},dc={},hc={exports:{}},mc={exports:{}};!function(e,t){Object.defineProperty(t,"__esModule",{value:!0});const i=(e,t)=>{let i;if("function"==typeof t){i={connect:t}}else i=t;const n="function"==typeof i.connect,o="function"==typeof i.secureConnect,s="function"==typeof i.close,r=()=>{n&&i.connect(),function(e){return e.encrypted}(e)&&o&&(e.authorized?i.secureConnect():e.authorizationError||e.once("secureConnect",i.secureConnect)),s&&e.once("close",i.close)};e.writable&&!e.connecting?r():e.connecting?e.once("connect",r):e.destroyed&&s&&i.close(e._hadError)};t.default=i,e.exports=i,e.exports.default=i}(mc,mc.exports),function(e,t){Object.defineProperty(t,"__esModule",{value:!0});const i=mc.exports,n=T.default,o=Number(process.versions.node.split(".")[0]),s=e=>{if(e.timings)return e.timings;const t={start:Date.now(),socket:void 0,lookup:void 0,connect:void 0,secureConnect:void 0,upload:void 0,response:void 0,end:void 0,error:void 0,abort:void 0,phases:{wait:void 0,dns:void 0,tcp:void 0,tls:void 0,request:void 0,firstByte:void 0,download:void 0,total:void 0}};e.timings=t;const s=e=>{const i=e.emit.bind(e);e.emit=(n,...o)=>("error"===n&&(t.error=Date.now(),t.phases.total=t.error-t.start,e.emit=i),i(n,...o))};s(e);const r=()=>{t.abort=Date.now(),(!t.response||o>=13)&&(t.phases.total=Date.now()-t.start)};e.prependOnceListener("abort",r);const a=e=>{if(t.socket=Date.now(),t.phases.wait=t.socket-t.start,n.types.isProxy(e))return;const o=()=>{t.lookup=Date.now(),t.phases.dns=t.lookup-t.socket};e.prependOnceListener("lookup",o),i.default(e,{connect:()=>{t.connect=Date.now(),void 0===t.lookup&&(e.removeListener("lookup",o),t.lookup=t.connect,t.phases.dns=t.lookup-t.socket),t.phases.tcp=t.connect-t.lookup},secureConnect:()=>{t.secureConnect=Date.now(),t.phases.tls=t.secureConnect-t.connect}})};e.socket?a(e.socket):e.prependOnceListener("socket",a);const c=()=>{var e;t.upload=Date.now(),t.phases.request=t.upload-(null!==(e=t.secureConnect)&&void 0!==e?e:t.connect)};return("boolean"==typeof e.writableFinished?!e.writableFinished:!e.finished||0!==e.outputSize||e.socket&&0!==e.socket.writableLength)?e.prependOnceListener("finish",c):c(),e.prependOnceListener("response",(e=>{t.response=Date.now(),t.phases.firstByte=t.response-t.upload,e.timings=t,s(e),e.prependOnceListener("end",(()=>{t.end=Date.now(),t.phases.download=t.end-t.response,t.phases.total=t.end-t.start})),e.prependOnceListener("aborted",r)})),t};t.default=s,e.exports=s,e.exports.default=s}(hc,hc.exports);var fc={exports:{}};const{V4MAPPED:gc,ADDRCONFIG:vc,ALL:xc,promises:{Resolver:yc},lookup:bc}=I.default,{promisify:wc}=T.default,_c=P.default,Dc=Symbol("cacheableLookupCreateConnection"),Ec=Symbol("cacheableLookupInstance"),Cc=Symbol("expires"),Ac="number"==typeof xc,kc=e=>{if(!e||"function"!=typeof e.createConnection)throw new Error("Expected an Agent instance as the first argument")},Sc=()=>{let e=!1,t=!1;for(const i of Object.values(_c.networkInterfaces()))for(const n of i)if(!n.internal&&("IPv6"===n.family?t=!0:e=!0,e&&t))return{has4:e,has6:t};return{has4:e,has6:t}},Fc={ttl:!0},Tc={all:!0};class Bc{constructor({cache:e=new Map,maxTtl:t=1/0,fallbackDuration:i=3600,errorTtl:n=.15,resolver:o=new yc,lookup:s=bc}={}){if(this.maxTtl=t,this.errorTtl=n,this._cache=e,this._resolver=o,this._dnsLookup=wc(s),this._resolver instanceof yc?(this._resolve4=this._resolver.resolve4.bind(this._resolver),this._resolve6=this._resolver.resolve6.bind(this._resolver)):(this._resolve4=wc(this._resolver.resolve4.bind(this._resolver)),this._resolve6=wc(this._resolver.resolve6.bind(this._resolver))),this._iface=Sc(),this._pending={},this._nextRemovalTime=!1,this._hostnamesToFallback=new Set,i<1)this._fallback=!1;else{this._fallback=!0;const e=setInterval((()=>{this._hostnamesToFallback.clear()}),1e3*i);e.unref&&e.unref()}this.lookup=this.lookup.bind(this),this.lookupAsync=this.lookupAsync.bind(this)}set servers(e){this.clear(),this._resolver.setServers(e)}get servers(){return this._resolver.getServers()}lookup(e,t,i){if("function"==typeof t?(i=t,t={}):"number"==typeof t&&(t={family:t}),!i)throw new Error("Callback must be a function.");this.lookupAsync(e,t).then((e=>{t.all?i(null,e):i(null,e.address,e.family,e.expires,e.ttl)}),i)}async lookupAsync(e,t={}){"number"==typeof t&&(t={family:t});let i=await this.query(e);if(6===t.family){const e=i.filter((e=>6===e.family));t.hints&gc&&(Ac&&t.hints&xc||0===e.length)?(e=>{for(const t of e)6!==t.family&&(t.address=`::ffff:${t.address}`,t.family=6)})(i):i=e}else 4===t.family&&(i=i.filter((e=>4===e.family)));if(t.hints&vc){const{_iface:e}=this;i=i.filter((t=>6===t.family?e.has6:e.has4))}if(0===i.length){const t=new Error(`cacheableLookup ENOTFOUND ${e}`);throw t.code="ENOTFOUND",t.hostname=e,t}return t.all?i:i[0]}async query(e){let t=await this._cache.get(e);if(!t){const i=this._pending[e];if(i)t=await i;else{const i=this.queryAndCache(e);this._pending[e]=i;try{t=await i}finally{delete this._pending[e]}}}return t=t.map((e=>({...e}))),t}async _resolve(e){const[t,i]=await Promise.all([this._resolve4(e,Fc),this._resolve6(e,Fc)].map((e=>(async e=>{try{return await e}catch(e){if("ENODATA"===e.code||"ENOTFOUND"===e.code)return[];throw e}})(e))));let n=0,o=0,s=0;const r=Date.now();for(const e of t)e.family=4,e.expires=r+1e3*e.ttl,n=Math.max(n,e.ttl);for(const e of i)e.family=6,e.expires=r+1e3*e.ttl,o=Math.max(o,e.ttl);return s=t.length>0?i.length>0?Math.min(n,o):n:o,{entries:[...t,...i],cacheTtl:s}}async _lookup(e){try{return{entries:await this._dnsLookup(e,{all:!0}),cacheTtl:0}}catch(e){return{entries:[],cacheTtl:0}}}async _set(e,t,i){if(this.maxTtl>0&&i>0){i=1e3*Math.min(i,this.maxTtl),t[Cc]=Date.now()+i;try{await this._cache.set(e,t,i)}catch(e){this.lookupAsync=async()=>{const t=new Error("Cache Error. Please recreate the CacheableLookup instance.");throw t.cause=e,t}}n=this._cache,Symbol.iterator in n&&this._tick(i)}var n}async queryAndCache(e){if(this._hostnamesToFallback.has(e))return this._dnsLookup(e,Tc);let t=await this._resolve(e);0===t.entries.length&&this._fallback&&(t=await this._lookup(e),0!==t.entries.length&&this._hostnamesToFallback.add(e));const i=0===t.entries.length?this.errorTtl:t.cacheTtl;return await this._set(e,t.entries,i),t.entries}_tick(e){const t=this._nextRemovalTime;(!t||e<t)&&(clearTimeout(this._removalTimeout),this._nextRemovalTime=e,this._removalTimeout=setTimeout((()=>{this._nextRemovalTime=!1;let e=1/0;const t=Date.now();for(const[i,n]of this._cache){const o=n[Cc];t>=o?this._cache.delete(i):o<e&&(e=o)}e!==1/0&&this._tick(e-t)}),e),this._removalTimeout.unref&&this._removalTimeout.unref())}install(e){if(kc(e),Dc in e)throw new Error("CacheableLookup has been already installed");e[Dc]=e.createConnection,e[Ec]=this,e.createConnection=(t,i)=>("lookup"in t||(t.lookup=this.lookup),e[Dc](t,i))}uninstall(e){if(kc(e),e[Dc]){if(e[Ec]!==this)throw new Error("The agent is not owned by this CacheableLookup instance");e.createConnection=e[Dc],delete e[Dc],delete e[Ec]}}updateInterfaceInfo(){const{_iface:e}=this;this._iface=Sc(),(e.has4&&!this._iface.has4||e.has6&&!this._iface.has6)&&this._cache.clear()}clear(e){e?this._cache.delete(e):this._cache.clear()}}fc.exports=Bc,fc.exports.default=Bc;const Oc=(e,t)=>t.some((t=>t instanceof RegExp?t.test(e):t===e));var jc=(e,t)=>{if(t={defaultProtocol:"http:",normalizeProtocol:!0,forceHttp:!1,forceHttps:!1,stripAuthentication:!0,stripHash:!1,stripTextFragment:!0,stripWWW:!0,removeQueryParameters:[/^utm_\w+/i],removeTrailingSlash:!0,removeSingleSlash:!0,removeDirectoryIndex:!1,sortQueryParameters:!0,...t},e=e.trim(),/^data:/i.test(e))return((e,{stripHash:t})=>{const i=/^data:(?<type>[^,]*?),(?<data>[^#]*?)(?:#(?<hash>.*))?$/.exec(e);if(!i)throw new Error(`Invalid URL: ${e}`);let{type:n,data:o,hash:s}=i.groups;const r=n.split(";");s=t?"":s;let a=!1;"base64"===r[r.length-1]&&(r.pop(),a=!0);const c=(r.shift()||"").toLowerCase(),u=r.map((e=>{let[t,i=""]=e.split("=").map((e=>e.trim()));return"charset"===t&&(i=i.toLowerCase(),"us-ascii"===i)?"":`${t}${i?`=${i}`:""}`})).filter(Boolean),l=[...u];return a&&l.push("base64"),(0!==l.length||c&&"text/plain"!==c)&&l.unshift(c),`data:${l.join(";")},${a?o.trim():o}${s?`#${s}`:""}`})(e,t);if(/^view-source:/i.test(e))throw new Error("`view-source:` is not supported as it is a non-standard protocol");const i=e.startsWith("//");!i&&/^\.*\//.test(e)||(e=e.replace(/^(?!(?:\w+:)?\/\/)|^\/\//,t.defaultProtocol));const n=new URL(e);if(t.forceHttp&&t.forceHttps)throw new Error("The `forceHttp` and `forceHttps` options cannot be used together");if(t.forceHttp&&"https:"===n.protocol&&(n.protocol="http:"),t.forceHttps&&"http:"===n.protocol&&(n.protocol="https:"),t.stripAuthentication&&(n.username="",n.password=""),t.stripHash?n.hash="":t.stripTextFragment&&(n.hash=n.hash.replace(/#?:~:text.*?$/i,"")),n.pathname&&(n.pathname=n.pathname.replace(/(?<!\b(?:[a-z][a-z\d+\-.]{1,50}:))\/{2,}/g,"/")),n.pathname)try{n.pathname=decodeURI(n.pathname)}catch(e){}if(!0===t.removeDirectoryIndex&&(t.removeDirectoryIndex=[/^index\.[a-z]+$/]),Array.isArray(t.removeDirectoryIndex)&&t.removeDirectoryIndex.length>0){let e=n.pathname.split("/");const i=e[e.length-1];Oc(i,t.removeDirectoryIndex)&&(e=e.slice(0,e.length-1),n.pathname=e.slice(1).join("/")+"/")}if(n.hostname&&(n.hostname=n.hostname.replace(/\.$/,""),t.stripWWW&&/^www\.(?!www\.)(?:[a-z\-\d]{1,63})\.(?:[a-z.\-\d]{2,63})$/.test(n.hostname)&&(n.hostname=n.hostname.replace(/^www\./,""))),Array.isArray(t.removeQueryParameters))for(const e of[...n.searchParams.keys()])Oc(e,t.removeQueryParameters)&&n.searchParams.delete(e);!0===t.removeQueryParameters&&(n.search=""),t.sortQueryParameters&&n.searchParams.sort(),t.removeTrailingSlash&&(n.pathname=n.pathname.replace(/\/$/,""));const o=e;return e=n.toString(),t.removeSingleSlash||"/"!==n.pathname||o.endsWith("/")||""!==n.hash||(e=e.replace(/\/$/,"")),(t.removeTrailingSlash||"/"===n.pathname)&&""===n.hash&&t.removeSingleSlash&&(e=e.replace(/\/$/,"")),i&&!t.normalizeProtocol&&(e=e.replace(/^http:\/\//,"//")),t.stripProtocol&&(e=e.replace(/^(?:https?:)?\/\//,"")),e},Ic={exports:{}},Pc={exports:{}},Lc=function e(t,i){if(t&&i)return e(t)(i);if("function"!=typeof t)throw new TypeError("need wrapper function");return Object.keys(t).forEach((function(e){n[e]=t[e]})),n;function n(){for(var e=new Array(arguments.length),i=0;i<e.length;i++)e[i]=arguments[i];var n=t.apply(this,e),o=e[e.length-1];return"function"==typeof n&&n!==o&&Object.keys(o).forEach((function(e){n[e]=o[e]})),n}};var Rc=Lc;function Nc(e){var t=function(){return t.called?t.value:(t.called=!0,t.value=e.apply(this,arguments))};return t.called=!1,t}function $c(e){var t=function(){if(t.called)throw new Error(t.onceError);return t.called=!0,t.value=e.apply(this,arguments)},i=e.name||"Function wrapped with `once`";return t.onceError=i+" shouldn't be called more than once",t.called=!1,t}Pc.exports=Rc(Nc),Pc.exports.strict=Rc($c),Nc.proto=Nc((function(){Object.defineProperty(Function.prototype,"once",{value:function(){return Nc(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return $c(this)},configurable:!0})}));var Hc=Pc.exports,Uc=function(){},qc=function(e,t,i){if("function"==typeof t)return qc(e,null,t);t||(t={}),i=Hc(i||Uc);var n=e._writableState,o=e._readableState,s=t.readable||!1!==t.readable&&e.readable,r=t.writable||!1!==t.writable&&e.writable,a=!1,c=function(){e.writable||u()},u=function(){r=!1,s||i.call(e)},l=function(){s=!1,r||i.call(e)},p=function(t){i.call(e,t?new Error("exited with error code: "+t):null)},d=function(t){i.call(e,t)},h=function(){process.nextTick(m)},m=function(){if(!a)return(!s||o&&o.ended&&!o.destroyed)&&(!r||n&&n.ended&&!n.destroyed)?void 0:i.call(e,new Error("premature close"))},f=function(){e.req.on("finish",u)};return!function(e){return e.setHeader&&"function"==typeof e.abort}(e)?r&&!n&&(e.on("end",c),e.on("close",c)):(e.on("complete",u),e.on("abort",h),e.req?f():e.on("request",f)),function(e){return e.stdio&&Array.isArray(e.stdio)&&3===e.stdio.length}(e)&&e.on("exit",p),e.on("end",l),e.on("finish",u),!1!==t.error&&e.on("error",d),e.on("close",h),function(){a=!0,e.removeListener("complete",u),e.removeListener("abort",h),e.removeListener("request",f),e.req&&e.req.removeListener("finish",u),e.removeListener("end",c),e.removeListener("close",c),e.removeListener("finish",u),e.removeListener("exit",p),e.removeListener("end",l),e.removeListener("error",d),e.removeListener("close",h)}},Mc=qc,zc=Pc.exports,Gc=Mc,Vc=k.default,Wc=function(){},Jc=/^v?\.0/.test(process.version),Kc=function(e){return"function"==typeof e},Qc=function(e,t,i,n){n=zc(n);var o=!1;e.on("close",(function(){o=!0})),Gc(e,{readable:t,writable:i},(function(e){if(e)return n(e);o=!0,n()}));var s=!1;return function(t){if(!o&&!s)return s=!0,function(e){return!!Jc&&!!Vc&&(e instanceof(Vc.ReadStream||Wc)||e instanceof(Vc.WriteStream||Wc))&&Kc(e.close)}(e)?e.close(Wc):function(e){return e.setHeader&&Kc(e.abort)}(e)?e.abort():Kc(e.destroy)?e.destroy():void n(t||new Error("stream was destroyed"))}},Xc=function(e){e()},Yc=function(e,t){return e.pipe(t)},Zc=function(){var e,t=Array.prototype.slice.call(arguments),i=Kc(t[t.length-1]||Wc)&&t.pop()||Wc;if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new Error("pump requires two streams per minimum");var n=t.map((function(o,s){var r=s<t.length-1;return Qc(o,r,s>0,(function(t){e||(e=t),t&&n.forEach(Xc),r||(n.forEach(Xc),i(e))}))}));return t.reduce(Yc)};const{PassThrough:eu}=B.default;const{constants:tu}=L.default,iu=Zc,nu=e=>{e={...e};const{array:t}=e;let{encoding:i}=e;const n="buffer"===i;let o=!1;t?o=!(i||n):i=i||"utf8",n&&(i=null);const s=new eu({objectMode:o});i&&s.setEncoding(i);let r=0;const a=[];return s.on("data",(e=>{a.push(e),o?r=a.length:r+=e.length})),s.getBufferedValue=()=>t?a:n?Buffer.concat(a,r):a.join(""),s.getBufferedLength=()=>r,s};class ou extends Error{constructor(){super("maxBuffer exceeded"),this.name="MaxBufferError"}}async function su(e,t){if(!e)return Promise.reject(new Error("Expected a stream"));t={maxBuffer:1/0,...t};const{maxBuffer:i}=t;let n;return await new Promise(((o,s)=>{const r=e=>{e&&n.getBufferedLength()<=tu.MAX_LENGTH&&(e.bufferedData=n.getBufferedValue()),s(e)};n=iu(e,nu(t),(e=>{e?r(e):o()})),n.on("data",(()=>{n.getBufferedLength()>i&&r(new ou)}))})),n.getBufferedValue()}Ic.exports=su,Ic.exports.default=su,Ic.exports.buffer=(e,t)=>su(e,{...t,encoding:"buffer"}),Ic.exports.array=(e,t)=>su(e,{...t,array:!0}),Ic.exports.MaxBufferError=ou;const ru=new Set([200,203,204,206,300,301,404,405,410,414,501]),au=new Set([200,203,204,300,301,302,303,307,308,404,405,410,414,501]),cu=new Set([500,502,503,504]),uu={date:!0,connection:!0,"keep-alive":!0,"proxy-authenticate":!0,"proxy-authorization":!0,te:!0,trailer:!0,"transfer-encoding":!0,upgrade:!0},lu={"content-length":!0,"content-encoding":!0,"transfer-encoding":!0,"content-range":!0};function pu(e){const t=parseInt(e,10);return isFinite(t)?t:0}function du(e){const t={};if(!e)return t;const i=e.trim().split(/\s*,\s*/);for(const e of i){const[i,n]=e.split(/\s*=\s*/,2);t[i]=void 0===n||n.replace(/^"|"$/g,"")}return t}function hu(e){let t=[];for(const i in e){const n=e[i];t.push(!0===n?i:i+"="+n)}if(t.length)return t.join(", ")}var mu=e=>{const t={};for(const[i,n]of Object.entries(e))t[i.toLowerCase()]=n;return t};const fu=B.default.Readable,gu=mu;var vu=class extends fu{constructor(e,t,i,n){if("number"!=typeof e)throw new TypeError("Argument `statusCode` should be a number");if("object"!=typeof t)throw new TypeError("Argument `headers` should be an object");if(!(i instanceof Buffer))throw new TypeError("Argument `body` should be a buffer");if("string"!=typeof n)throw new TypeError("Argument `url` should be a string");super(),this.statusCode=e,this.headers=gu(t),this.body=i,this.url=n}_read(){this.push(this.body),this.push(null)}};const xu=["destroy","setTimeout","socket","headers","trailers","rawHeaders","statusCode","httpVersion","httpVersionMinor","httpVersionMajor","rawTrailers","statusMessage"];const yu=B.default.PassThrough,bu=(e,t)=>{const i=new Set(Object.keys(e).concat(xu));for(const n of i)n in t||(t[n]="function"==typeof e[n]?e[n].bind(e):e[n])};var wu=e=>{if(!e||!e.pipe)throw new TypeError("Parameter `response` must be a response stream.");const t=new yu;return bu(e,t),e.pipe(t)};var _u={stringify:function e(t){if(void 0===t)return t;if(t&&Buffer.isBuffer(t))return JSON.stringify(":base64:"+t.toString("base64"));if(t&&t.toJSON&&(t=t.toJSON()),t&&"object"==typeof t){var i="",n=Array.isArray(t);i=n?"[":"{";var o=!0;for(var s in t){var r="function"==typeof t[s]||!n&&void 0===t[s];Object.hasOwnProperty.call(t,s)&&!r&&(o||(i+=","),o=!1,n?null==t[s]?i+="null":i+=e(t[s]):void 0!==t[s]&&(i+=e(s)+":"+e(t[s])))}return i+=n?"]":"}"}return"string"==typeof t?JSON.stringify(/^:/.test(t)?":"+t:t):void 0===t?"null":JSON.stringify(t)},parse:function(e){return JSON.parse(e,(function(e,t){return"string"==typeof t?/^:base64:/.test(t)?Buffer.from(t.substring(8),"base64"):/^:/.test(t)?t.substring(1):t:t}))}},Du={exports:{}};const{promisify:Eu}=T.default,Cu=_u,Au=w.default,ku=(e={},t={})=>{const i={...e.params||{},...t.params||{}};return{...e,...t,...Object.keys(i).length?{params:i}:{}}},Su=Eu(Au.brotliCompress),Fu=Eu(Au.brotliDecompress),Tu=e=>e;Du.exports=({enable:e=!0,serialize:t=Cu.stringify,deserialize:i=Cu.parse,compressOptions:n,decompressOptions:o}={})=>e?{serialize:t,deserialize:i,compress:async(e,i={})=>{if(void 0===e)return e;const o=t(e);return Su(o,ku(n,i))},decompress:async(e,t={})=>void 0===e?e:i(await Fu(e,ku(o,t)))}:{serialize:t,deserialize:i,decompress:Tu,compress:Tu},Du.exports.stringify=Cu.stringify,Du.exports.parse=Cu.parse;const Bu=F.default,Ou=_u,ju=Du.exports,Iu=e=>{const t={redis:"@keyv/redis",rediss:"@keyv/redis",mongodb:"@keyv/mongo",mongo:"@keyv/mongo",sqlite:"@keyv/sqlite",postgresql:"@keyv/postgres",postgres:"@keyv/postgres",mysql:"@keyv/mysql",etcd:"@keyv/etcd",offline:"@keyv/offline",tiered:"@keyv/tiered"};if(e.adapter||e.uri){return new(function(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}(t[e.adapter||/^[^:+]*/.exec(e.uri)[0]]))(e)}return new Map},Pu=["sqlite","postgres","mysql","mongo","redis","tiered"];var Lu=class extends Bu{constructor(e,{emitErrors:t=!0,...i}={}){if(super(),this.opts={namespace:"keyv",serialize:Ou.stringify,deserialize:Ou.parse,..."string"==typeof e?{uri:e}:e,...i},!this.opts.store){const e={...this.opts};this.opts.store=Iu(e)}if(this.opts.compress){const e=ju(this.opts.compress.opts);this.opts.serialize=async({value:t,expires:i})=>e.serialize({value:await e.compress(t),expires:i}),this.opts.deserialize=async t=>{const{value:i,expires:n}=e.deserialize(t);return{value:await e.decompress(i),expires:n}}}"function"==typeof this.opts.store.on&&t&&this.opts.store.on("error",(e=>this.emit("error",e))),this.opts.store.namespace=this.opts.namespace;const n=e=>async function*(){for await(const[t,i]of"function"==typeof e?e(this.opts.store.namespace):e){const e=this.opts.deserialize(i);this.opts.store.namespace&&!t.includes(this.opts.store.namespace)||("number"==typeof e.expires&&Date.now()>e.expires?this.delete(t):yield[this._getKeyUnprefix(t),e.value])}};"function"==typeof this.opts.store[Symbol.iterator]&&this.opts.store instanceof Map?this.iterator=n(this.opts.store):"function"==typeof this.opts.store.iterator&&this.opts.store.opts&&this._checkIterableAdaptar()&&(this.iterator=n(this.opts.store.iterator.bind(this.opts.store)))}_checkIterableAdaptar(){return Pu.includes(this.opts.store.opts.dialect)||Pu.findIndex((e=>this.opts.store.opts.url.includes(e)))>=0}_getKeyPrefix(e){return`${this.opts.namespace}:${e}`}_getKeyPrefixArray(e){return e.map((e=>`${this.opts.namespace}:${e}`))}_getKeyUnprefix(e){return e.split(":").splice(1).join(":")}get(e,t){const{store:i}=this.opts,n=Array.isArray(e),o=n?this._getKeyPrefixArray(e):this._getKeyPrefix(e);if(n&&void 0===i.getMany){const e=[];for(const n of o)e.push(Promise.resolve().then((()=>i.get(n))).then((e=>"string"==typeof e?this.opts.deserialize(e):e)).then((e=>{if(null!=e)return"number"==typeof e.expires&&Date.now()>e.expires?this.delete(n).then((()=>{})):t&&t.raw?e:e.value})));return Promise.allSettled(e).then((e=>{const t=[];for(const i of e)t.push(i.value);return t.every((e=>void 0===e))?[]:t}))}return Promise.resolve().then((()=>n?i.getMany(o):i.get(o))).then((e=>"string"==typeof e?this.opts.deserialize(e):e)).then((i=>{if(null!=i){if(n){const n=[];if(0===i.length)return[];for(let o of i)"string"==typeof o&&(o=this.opts.deserialize(o)),null!=o?"number"==typeof o.expires&&Date.now()>o.expires?(this.delete(e).then((()=>{})),n.push(void 0)):n.push(t&&t.raw?o:o.value):n.push(void 0);return n.every((e=>void 0===e))?[]:n}return"number"==typeof i.expires&&Date.now()>i.expires?this.delete(e).then((()=>{})):t&&t.raw?i:i.value}}))}set(e,t,i){const n=this._getKeyPrefix(e);void 0===i&&(i=this.opts.ttl),0===i&&(i=void 0);const{store:o}=this.opts;return Promise.resolve().then((()=>{const e="number"==typeof i?Date.now()+i:null;return"symbol"==typeof t&&this.emit("error","symbol cannot be serialized"),t={value:t,expires:e},this.opts.serialize(t)})).then((e=>o.set(n,e,i))).then((()=>!0))}delete(e){const{store:t}=this.opts;if(Array.isArray(e)){const i=this._getKeyPrefixArray(e);if(void 0===t.deleteMany){const e=[];for(const n of i)e.push(t.delete(n));return Promise.allSettled(e).then((e=>e.every((e=>!0===e.value))))}return Promise.resolve().then((()=>t.deleteMany(i)))}const i=this._getKeyPrefix(e);return Promise.resolve().then((()=>t.delete(i)))}clear(){const{store:e}=this.opts;return Promise.resolve().then((()=>e.clear()))}has(e){const t=this._getKeyPrefix(e),{store:i}=this.opts;return Promise.resolve().then((async()=>{if("function"==typeof i.has)return i.has(t);return void 0!==await i.get(t)}))}disconnect(){const{store:e}=this.opts;if("function"==typeof e.disconnect)return e.disconnect()}};const Ru=F.default,Nu=S.default,$u=jc,Hu=Ic.exports,Uu=class{constructor(e,t,{shared:i,cacheHeuristic:n,immutableMinTimeToLive:o,ignoreCargoCult:s,_fromObject:r}={}){if(r)this._fromObject(r);else{if(!t||!t.headers)throw Error("Response headers missing");this._assertRequestHasHeaders(e),this._responseTime=this.now(),this._isShared=!1!==i,this._cacheHeuristic=void 0!==n?n:.1,this._immutableMinTtl=void 0!==o?o:864e5,this._status="status"in t?t.status:200,this._resHeaders=t.headers,this._rescc=du(t.headers["cache-control"]),this._method="method"in e?e.method:"GET",this._url=e.url,this._host=e.headers.host,this._noAuthorization=!e.headers.authorization,this._reqHeaders=t.headers.vary?e.headers:null,this._reqcc=du(e.headers["cache-control"]),s&&"pre-check"in this._rescc&&"post-check"in this._rescc&&(delete this._rescc["pre-check"],delete this._rescc["post-check"],delete this._rescc["no-cache"],delete this._rescc["no-store"],delete this._rescc["must-revalidate"],this._resHeaders=Object.assign({},this._resHeaders,{"cache-control":hu(this._rescc)}),delete this._resHeaders.expires,delete this._resHeaders.pragma),null==t.headers["cache-control"]&&/no-cache/.test(t.headers.pragma)&&(this._rescc["no-cache"]=!0)}}now(){return Date.now()}storable(){return!(this._reqcc["no-store"]||!("GET"===this._method||"HEAD"===this._method||"POST"===this._method&&this._hasExplicitExpiration())||!au.has(this._status)||this._rescc["no-store"]||this._isShared&&this._rescc.private||this._isShared&&!this._noAuthorization&&!this._allowsStoringAuthenticated()||!(this._resHeaders.expires||this._rescc["max-age"]||this._isShared&&this._rescc["s-maxage"]||this._rescc.public||ru.has(this._status)))}_hasExplicitExpiration(){return this._isShared&&this._rescc["s-maxage"]||this._rescc["max-age"]||this._resHeaders.expires}_assertRequestHasHeaders(e){if(!e||!e.headers)throw Error("Request headers missing")}satisfiesWithoutRevalidation(e){this._assertRequestHasHeaders(e);const t=du(e.headers["cache-control"]);if(t["no-cache"]||/no-cache/.test(e.headers.pragma))return!1;if(t["max-age"]&&this.age()>t["max-age"])return!1;if(t["min-fresh"]&&this.timeToLive()<1e3*t["min-fresh"])return!1;if(this.stale()){if(!(t["max-stale"]&&!this._rescc["must-revalidate"]&&(!0===t["max-stale"]||t["max-stale"]>this.age()-this.maxAge())))return!1}return this._requestMatches(e,!1)}_requestMatches(e,t){return(!this._url||this._url===e.url)&&this._host===e.headers.host&&(!e.method||this._method===e.method||t&&"HEAD"===e.method)&&this._varyMatches(e)}_allowsStoringAuthenticated(){return this._rescc["must-revalidate"]||this._rescc.public||this._rescc["s-maxage"]}_varyMatches(e){if(!this._resHeaders.vary)return!0;if("*"===this._resHeaders.vary)return!1;const t=this._resHeaders.vary.trim().toLowerCase().split(/\s*,\s*/);for(const i of t)if(e.headers[i]!==this._reqHeaders[i])return!1;return!0}_copyWithoutHopByHopHeaders(e){const t={};for(const i in e)uu[i]||(t[i]=e[i]);if(e.connection){const i=e.connection.trim().split(/\s*,\s*/);for(const e of i)delete t[e]}if(t.warning){const e=t.warning.split(/,/).filter((e=>!/^\s*1[0-9][0-9]/.test(e)));e.length?t.warning=e.join(",").trim():delete t.warning}return t}responseHeaders(){const e=this._copyWithoutHopByHopHeaders(this._resHeaders),t=this.age();return t>86400&&!this._hasExplicitExpiration()&&this.maxAge()>86400&&(e.warning=(e.warning?`${e.warning}, `:"")+'113 - "rfc7234 5.5.4"'),e.age=`${Math.round(t)}`,e.date=new Date(this.now()).toUTCString(),e}date(){const e=Date.parse(this._resHeaders.date);return isFinite(e)?e:this._responseTime}age(){return this._ageValue()+(this.now()-this._responseTime)/1e3}_ageValue(){return pu(this._resHeaders.age)}maxAge(){if(!this.storable()||this._rescc["no-cache"])return 0;if(this._isShared&&this._resHeaders["set-cookie"]&&!this._rescc.public&&!this._rescc.immutable)return 0;if("*"===this._resHeaders.vary)return 0;if(this._isShared){if(this._rescc["proxy-revalidate"])return 0;if(this._rescc["s-maxage"])return pu(this._rescc["s-maxage"])}if(this._rescc["max-age"])return pu(this._rescc["max-age"]);const e=this._rescc.immutable?this._immutableMinTtl:0,t=this.date();if(this._resHeaders.expires){const i=Date.parse(this._resHeaders.expires);return Number.isNaN(i)||i<t?0:Math.max(e,(i-t)/1e3)}if(this._resHeaders["last-modified"]){const i=Date.parse(this._resHeaders["last-modified"]);if(isFinite(i)&&t>i)return Math.max(e,(t-i)/1e3*this._cacheHeuristic)}return e}timeToLive(){const e=this.maxAge()-this.age(),t=e+pu(this._rescc["stale-if-error"]),i=e+pu(this._rescc["stale-while-revalidate"]);return 1e3*Math.max(0,e,t,i)}stale(){return this.maxAge()<=this.age()}_useStaleIfError(){return this.maxAge()+pu(this._rescc["stale-if-error"])>this.age()}useStaleWhileRevalidate(){return this.maxAge()+pu(this._rescc["stale-while-revalidate"])>this.age()}static fromObject(e){return new this(void 0,void 0,{_fromObject:e})}_fromObject(e){if(this._responseTime)throw Error("Reinitialized");if(!e||1!==e.v)throw Error("Invalid serialization");this._responseTime=e.t,this._isShared=e.sh,this._cacheHeuristic=e.ch,this._immutableMinTtl=void 0!==e.imm?e.imm:864e5,this._status=e.st,this._resHeaders=e.resh,this._rescc=e.rescc,this._method=e.m,this._url=e.u,this._host=e.h,this._noAuthorization=e.a,this._reqHeaders=e.reqh,this._reqcc=e.reqcc}toObject(){return{v:1,t:this._responseTime,sh:this._isShared,ch:this._cacheHeuristic,imm:this._immutableMinTtl,st:this._status,resh:this._resHeaders,rescc:this._rescc,m:this._method,u:this._url,h:this._host,a:this._noAuthorization,reqh:this._reqHeaders,reqcc:this._reqcc}}revalidationHeaders(e){this._assertRequestHasHeaders(e);const t=this._copyWithoutHopByHopHeaders(e.headers);if(delete t["if-range"],!this._requestMatches(e,!0)||!this.storable())return delete t["if-none-match"],delete t["if-modified-since"],t;this._resHeaders.etag&&(t["if-none-match"]=t["if-none-match"]?`${t["if-none-match"]}, ${this._resHeaders.etag}`:this._resHeaders.etag);if(t["accept-ranges"]||t["if-match"]||t["if-unmodified-since"]||this._method&&"GET"!=this._method){if(delete t["if-modified-since"],t["if-none-match"]){const e=t["if-none-match"].split(/,/).filter((e=>!/^\s*W\//.test(e)));e.length?t["if-none-match"]=e.join(",").trim():delete t["if-none-match"]}}else this._resHeaders["last-modified"]&&!t["if-modified-since"]&&(t["if-modified-since"]=this._resHeaders["last-modified"]);return t}revalidatedPolicy(e,t){if(this._assertRequestHasHeaders(e),this._useStaleIfError()&&function(e){return!e||cu.has(e.status)}(t))return{modified:!1,matches:!1,policy:this};if(!t||!t.headers)throw Error("Response headers missing");let i=!1;if(void 0!==t.status&&304!=t.status?i=!1:t.headers.etag&&!/^\s*W\//.test(t.headers.etag)?i=this._resHeaders.etag&&this._resHeaders.etag.replace(/^\s*W\//,"")===t.headers.etag:this._resHeaders.etag&&t.headers.etag?i=this._resHeaders.etag.replace(/^\s*W\//,"")===t.headers.etag.replace(/^\s*W\//,""):this._resHeaders["last-modified"]?i=this._resHeaders["last-modified"]===t.headers["last-modified"]:this._resHeaders.etag||this._resHeaders["last-modified"]||t.headers.etag||t.headers["last-modified"]||(i=!0),!i)return{policy:new this.constructor(e,t),modified:304!=t.status,matches:!1};const n={};for(const e in this._resHeaders)n[e]=e in t.headers&&!lu[e]?t.headers[e]:this._resHeaders[e];const o=Object.assign({},t,{status:this._status,method:this._method,headers:n});return{policy:new this.constructor(e,o,{shared:this._isShared,cacheHeuristic:this._cacheHeuristic,immutableMinTimeToLive:this._immutableMinTtl}),modified:!1,matches:!0}}},qu=vu,Mu=mu,zu=wu,Gu=Lu;class Vu{constructor(e,t){if("function"!=typeof e)throw new TypeError("Parameter `request` must be a function");return this.cache=new Gu({uri:"string"==typeof t&&t,store:"string"!=typeof t&&t,namespace:"cacheable-request"}),this.createCacheableRequest(e)}createCacheableRequest(e){return(t,i)=>{let n;if("string"==typeof t)n=Ju(Nu.parse(t)),t={};else if(t instanceof Nu.URL)n=Ju(Nu.parse(t.toString())),t={};else{const[e,...i]=(t.path||"").split("?"),o=i.length>0?`?${i.join("?")}`:"";n=Ju({...t,pathname:e,search:o})}(t={headers:{},method:"GET",cache:!0,strictTtl:!1,automaticFailover:!1,...t,...Wu(n)}).headers=Mu(t.headers);const o=new Ru,s=$u(Nu.format(n),{stripWWW:!1,removeTrailingSlash:!1,stripAuthentication:!1}),r=`${t.method}:${s}`;let a=!1,c=!1;const u=t=>{c=!0;let n,s=!1;const u=new Promise((e=>{n=()=>{s||(s=!0,e())}})),l=e=>{if(a&&!t.forceRefresh){e.status=e.statusCode;const i=Uu.fromObject(a.cachePolicy).revalidatedPolicy(t,e);if(!i.modified){const t=i.policy.responseHeaders();(e=new qu(a.statusCode,t,a.body,a.url)).cachePolicy=i.policy,e.fromCache=!0}}let n;e.fromCache||(e.cachePolicy=new Uu(t,e,t),e.fromCache=!1),t.cache&&e.cachePolicy.storable()?(n=zu(e),(async()=>{try{const i=Hu.buffer(e);if(await Promise.race([u,new Promise((t=>e.once("end",t)))]),s)return;const n=await i,o={cachePolicy:e.cachePolicy.toObject(),url:e.url,statusCode:e.fromCache?a.statusCode:e.statusCode,body:n};let c=t.strictTtl?e.cachePolicy.timeToLive():void 0;t.maxTtl&&(c=c?Math.min(c,t.maxTtl):t.maxTtl),await this.cache.set(r,o,c)}catch(e){o.emit("error",new Vu.CacheError(e))}})()):t.cache&&a&&(async()=>{try{await this.cache.delete(r)}catch(e){o.emit("error",new Vu.CacheError(e))}})(),o.emit("response",n||e),"function"==typeof i&&i(n||e)};try{const i=e(t,l);i.once("error",n),i.once("abort",n),o.emit("request",i)}catch(e){o.emit("error",new Vu.RequestError(e))}};return(async()=>{const e=async e=>{await Promise.resolve();const t=e.cache?await this.cache.get(r):void 0;if(void 0===t)return u(e);const n=Uu.fromObject(t.cachePolicy);if(n.satisfiesWithoutRevalidation(e)&&!e.forceRefresh){const e=n.responseHeaders(),s=new qu(t.statusCode,e,t.body,t.url);s.cachePolicy=n,s.fromCache=!0,o.emit("response",s),"function"==typeof i&&i(s)}else a=t,e.headers=n.revalidationHeaders(e),u(e)},n=e=>o.emit("error",new Vu.CacheError(e));this.cache.once("error",n),o.on("response",(()=>this.cache.removeListener("error",n)));try{await e(t)}catch(e){t.automaticFailover&&!c&&u(t),o.emit("error",new Vu.CacheError(e))}})(),o}}}function Wu(e){const t={...e};return t.path=`${e.pathname||"/"}${e.search||""}`,delete t.pathname,delete t.search,t}function Ju(e){return{protocol:e.protocol,auth:e.auth,hostname:e.hostname||e.host||"localhost",port:e.port,pathname:e.pathname,search:e.search}}Vu.RequestError=class extends Error{constructor(e){super(e.message),this.name="RequestError",Object.assign(this,e)}},Vu.CacheError=class extends Error{constructor(e){super(e.message),this.name="CacheError",Object.assign(this,e)}};var Ku=Vu;const Qu=["aborted","complete","headers","httpVersion","httpVersionMinor","httpVersionMajor","method","rawHeaders","rawTrailers","setTimeout","socket","statusCode","statusMessage","trailers","url"];const{Transform:Xu,PassThrough:Yu}=B.default,Zu=w.default,el=(e,t)=>{if(t._readableState.autoDestroy)throw new Error("The second stream must have the `autoDestroy` option set to `false`");const i=new Set(Object.keys(e).concat(Qu)),n={};for(const o of i)o in t||(n[o]={get(){const t=e[o];return"function"==typeof t?t.bind(e):t},set(t){e[o]=t},enumerable:!0,configurable:!1});return Object.defineProperties(t,n),e.once("aborted",(()=>{t.destroy(),t.emit("aborted")})),e.once("close",(()=>{e.complete&&t.readable?t.once("end",(()=>{t.emit("close")})):t.emit("close")})),t};var tl=e=>{const t=(e.headers["content-encoding"]||"").toLowerCase();if(!["gzip","deflate","br"].includes(t))return e;const i="br"===t;if(i&&"function"!=typeof Zu.createBrotliDecompress)return e.destroy(new Error("Brotli is not supported on Node.js < 12")),e;let n=!0;const o=new Xu({transform(e,t,i){n=!1,i(null,e)},flush(e){e()}}),s=new Yu({autoDestroy:!1,destroy(t,i){e.destroy(),i(t)}}),r=i?Zu.createBrotliDecompress():Zu.createUnzip();return r.once("error",(t=>{!n||e.readable?s.destroy(t):s.end()})),el(e,s),e.pipe(o).pipe(r).pipe(s),s};class il{constructor(e={}){if(!(e.maxSize&&e.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");this.maxSize=e.maxSize,this.onEviction=e.onEviction,this.cache=new Map,this.oldCache=new Map,this._size=0}_set(e,t){if(this.cache.set(e,t),this._size++,this._size>=this.maxSize){if(this._size=0,"function"==typeof this.onEviction)for(const[e,t]of this.oldCache.entries())this.onEviction(e,t);this.oldCache=this.cache,this.cache=new Map}}get(e){if(this.cache.has(e))return this.cache.get(e);if(this.oldCache.has(e)){const t=this.oldCache.get(e);return this.oldCache.delete(e),this._set(e,t),t}}set(e,t){return this.cache.has(e)?this.cache.set(e,t):this._set(e,t),this}has(e){return this.cache.has(e)||this.oldCache.has(e)}peek(e){return this.cache.has(e)?this.cache.get(e):this.oldCache.has(e)?this.oldCache.get(e):void 0}delete(e){const t=this.cache.delete(e);return t&&this._size--,this.oldCache.delete(e)||t}clear(){this.cache.clear(),this.oldCache.clear(),this._size=0}*keys(){for(const[e]of this)yield e}*values(){for(const[,e]of this)yield e}*[Symbol.iterator](){for(const e of this.cache)yield e;for(const e of this.oldCache){const[t]=e;this.cache.has(t)||(yield e)}}get size(){let e=0;for(const t of this.oldCache.keys())this.cache.has(t)||e++;return Math.min(this._size+e,this.maxSize)}}var nl=il;const ol=F.default,sl=N.default,rl=R.default,al=nl,cl=Symbol("currentStreamsCount"),ul=Symbol("request"),ll=Symbol("cachedOriginSet"),pl=Symbol("gracefullyClosing"),dl=["maxDeflateDynamicTableSize","maxSessionMemory","maxHeaderListPairs","maxOutstandingPings","maxReservedRemoteStreams","maxSendHeaderBlockLength","paddingStrategy","localAddress","path","rejectUnauthorized","minDHSize","ca","cert","clientCertEngine","ciphers","key","pfx","servername","minVersion","maxVersion","secureProtocol","crl","honorCipherOrder","ecdhCurve","dhparam","secureOptions","sessionIdContext"],hl=(e,t)=>e.remoteSettings.maxConcurrentStreams>t.remoteSettings.maxConcurrentStreams,ml=(e,t)=>{for(const i of e)i[ll].length<t[ll].length&&i[ll].every((e=>t[ll].includes(e)))&&i[cl]+t[cl]<=t.remoteSettings.maxConcurrentStreams&&gl(i)},fl=({agent:e,isFree:t})=>{const i={};for(const n in e.sessions){const o=e.sessions[n].filter((e=>{const i=e[vl.kCurrentStreamsCount]<e.remoteSettings.maxConcurrentStreams;return t?i:!i}));0!==o.length&&(i[n]=o)}return i},gl=e=>{e[pl]=!0,0===e[cl]&&e.close()};class vl extends ol{constructor({timeout:e=6e4,maxSessions:t=1/0,maxFreeSessions:i=10,maxCachedTlsSessions:n=100}={}){super(),this.sessions={},this.queue={},this.timeout=e,this.maxSessions=t,this.maxFreeSessions=i,this._freeSessionsCount=0,this._sessionsCount=0,this.settings={enablePush:!1},this.tlsSessionCache=new al({maxSize:n})}static normalizeOrigin(e,t){return"string"==typeof e&&(e=new URL(e)),t&&e.hostname!==t&&(e.hostname=t),e.origin}normalizeOptions(e){let t="";if(e)for(const i of dl)e[i]&&(t+=`:${e[i]}`);return t}_tryToCreateNewSession(e,t){if(!(e in this.queue)||!(t in this.queue[e]))return;const i=this.queue[e][t];this._sessionsCount<this.maxSessions&&!i.completed&&(i.completed=!0,i())}getSession(e,t,i){return new Promise(((n,o)=>{Array.isArray(i)?(i=[...i],n()):i=[{resolve:n,reject:o}];const s=this.normalizeOptions(t),r=vl.normalizeOrigin(e,t&&t.servername);if(void 0===r){for(const{reject:e}of i)e(new TypeError("The `origin` argument needs to be a string or an URL object"));return}if(s in this.sessions){const e=this.sessions[s];let t,n=-1,o=-1;for(const i of e){const e=i.remoteSettings.maxConcurrentStreams;if(e<n)break;if(i[ll].includes(r)){const s=i[cl];if(s>=e||i[pl]||i.destroyed)continue;t||(n=e),s>o&&(t=i,o=s)}}if(t){if(1!==i.length){for(const{reject:e}of i){e(new Error(`Expected the length of listeners to be 1, got ${i.length}.\nPlease report this to https://github.com/szmarczak/http2-wrapper/`))}return}return void i[0].resolve(t)}}if(s in this.queue){if(r in this.queue[s])return this.queue[s][r].listeners.push(...i),void this._tryToCreateNewSession(s,r)}else this.queue[s]={};const a=()=>{s in this.queue&&this.queue[s][r]===c&&(delete this.queue[s][r],0===Object.keys(this.queue[s]).length&&delete this.queue[s])},c=()=>{const n=`${r}:${s}`;let o=!1;try{const u=rl.connect(e,{createConnection:this.createConnection,settings:this.settings,session:this.tlsSessionCache.get(n),...t});u[cl]=0,u[pl]=!1;const l=()=>u[cl]<u.remoteSettings.maxConcurrentStreams;let p=!0;u.socket.once("session",(e=>{this.tlsSessionCache.set(n,e)})),u.once("error",(e=>{for(const{reject:t}of i)t(e);this.tlsSessionCache.delete(n)})),u.setTimeout(this.timeout,(()=>{u.destroy()})),u.once("close",(()=>{if(o){p&&this._freeSessionsCount--,this._sessionsCount--;const e=this.sessions[s];e.splice(e.indexOf(u),1),0===e.length&&delete this.sessions[s]}else{const e=new Error("Session closed without receiving a SETTINGS frame");e.code="HTTP2WRAPPER_NOSETTINGS";for(const{reject:t}of i)t(e);a()}this._tryToCreateNewSession(s,r)}));const d=()=>{if(s in this.queue&&l())for(const e of u[ll])if(e in this.queue[s]){const{listeners:t}=this.queue[s][e];for(;0!==t.length&&l();)t.shift().resolve(u);const i=this.queue[s];if(0===i[e].listeners.length&&(delete i[e],0===Object.keys(i).length)){delete this.queue[s];break}if(!l())break}};u.on("origin",(()=>{u[ll]=u.originSet,l()&&(d(),ml(this.sessions[s],u))})),u.once("remoteSettings",(()=>{if(u.ref(),u.unref(),this._sessionsCount++,c.destroyed){const e=new Error("Agent has been destroyed");for(const t of i)t.reject(e);u.destroy()}else{u[ll]=u.originSet;{const e=this.sessions;if(s in e){const t=e[s];t.splice(((e,t,i)=>{let n=0,o=e.length;for(;n<o;){const s=n+o>>>1;i(e[s],t)?n=s+1:o=s}return n})(t,u,hl),0,u)}else e[s]=[u]}this._freeSessionsCount+=1,o=!0,this.emit("session",u),d(),a(),0===u[cl]&&this._freeSessionsCount>this.maxFreeSessions&&u.close(),0!==i.length&&(this.getSession(r,t,i),i.length=0),u.on("remoteSettings",(()=>{d(),ml(this.sessions[s],u)}))}})),u[ul]=u.request,u.request=(e,t)=>{if(u[pl])throw new Error("The session is gracefully closing. No new streams are allowed.");const i=u[ul](e,t);return u.ref(),++u[cl],u[cl]===u.remoteSettings.maxConcurrentStreams&&this._freeSessionsCount--,i.once("close",(()=>{if(p=l(),--u[cl],!u.destroyed&&!u.closed&&(((e,t)=>{for(const i of e)t[ll].length<i[ll].length&&t[ll].every((e=>i[ll].includes(e)))&&t[cl]+i[cl]<=i.remoteSettings.maxConcurrentStreams&&gl(t)})(this.sessions[s],u),l()&&!u.closed)){p||(this._freeSessionsCount++,p=!0);const e=0===u[cl];e&&u.unref(),e&&(this._freeSessionsCount>this.maxFreeSessions||u[pl])?u.close():(ml(this.sessions[s],u),d())}})),i}}catch(e){for(const t of i)t.reject(e);a()}};c.listeners=i,c.completed=!1,c.destroyed=!1,this.queue[s][r]=c,this._tryToCreateNewSession(s,r)}))}request(e,t,i,n){return new Promise(((o,s)=>{this.getSession(e,t,[{reject:s,resolve:e=>{try{o(e.request(i,n))}catch(e){s(e)}}}])}))}createConnection(e,t){return vl.connect(e,t)}static connect(e,t){t.ALPNProtocols=["h2"];const i=e.port||443,n=e.hostname||e.host;return void 0===t.servername&&(t.servername=n),sl.connect(i,n,t)}closeFreeSessions(){for(const e of Object.values(this.sessions))for(const t of e)0===t[cl]&&t.close()}destroy(e){for(const t of Object.values(this.sessions))for(const i of t)i.destroy(e);for(const e of Object.values(this.queue))for(const t of Object.values(e))t.destroyed=!0;this.queue={}}get freeSessions(){return fl({agent:this,isFree:!0})}get busySessions(){return fl({agent:this,isFree:!1})}}vl.kCurrentStreamsCount=cl,vl.kGracefullyClosing=pl;var xl={Agent:vl,globalAgent:new vl};const{Readable:yl}=B.default;var bl=class extends yl{constructor(e,t){super({highWaterMark:t,autoDestroy:!1}),this.statusCode=null,this.statusMessage="",this.httpVersion="2.0",this.httpVersionMajor=2,this.httpVersionMinor=0,this.headers={},this.trailers={},this.req=null,this.aborted=!1,this.complete=!1,this.upgrade=null,this.rawHeaders=[],this.rawTrailers=[],this.socket=e,this.connection=e,this._dumped=!1}_destroy(e){this.req._request.destroy(e)}setTimeout(e,t){return this.req.setTimeout(e,t),this}_dump(){this._dumped||(this._dumped=!0,this.removeAllListeners("data"),this.resume())}_read(){this.req&&this.req._request.resume()}},wl=e=>{const t={protocol:e.protocol,hostname:"string"==typeof e.hostname&&e.hostname.startsWith("[")?e.hostname.slice(1,-1):e.hostname,host:e.host,hash:e.hash,search:e.search,pathname:e.pathname,href:e.href,path:`${e.pathname||""}${e.search||""}`};return"string"==typeof e.port&&0!==e.port.length&&(t.port=Number(e.port)),(e.username||e.password)&&(t.auth=`${e.username||""}:${e.password||""}`),t},_l={exports:{}};!function(e){const t=(t,i,n)=>{e.exports[i]=class extends t{constructor(...e){super("string"==typeof n?n:n(e)),this.name=`${super.name} [${i}]`,this.code=i}}};t(TypeError,"ERR_INVALID_ARG_TYPE",(e=>{const t=e[0].includes(".")?"property":"argument";let i=e[1];const n=Array.isArray(i);return n&&(i=`${i.slice(0,-1).join(", ")} or ${i.slice(-1)}`),`The "${e[0]}" ${t} must be ${n?"one of":"of"} type ${i}. Received ${typeof e[2]}`})),t(TypeError,"ERR_INVALID_PROTOCOL",(e=>`Protocol "${e[0]}" not supported. Expected "${e[1]}"`)),t(Error,"ERR_HTTP_HEADERS_SENT",(e=>`Cannot ${e[0]} headers after they are sent to the client`)),t(TypeError,"ERR_INVALID_HTTP_TOKEN",(e=>`${e[0]} must be a valid HTTP token [${e[1]}]`)),t(TypeError,"ERR_HTTP_INVALID_HEADER_VALUE",(e=>`Invalid value "${e[0]} for header "${e[1]}"`)),t(TypeError,"ERR_INVALID_CHAR",(e=>`Invalid character in ${e[0]} [${e[1]}]`))}(_l);const Dl=R.default,{Writable:El}=B.default,{Agent:Cl,globalAgent:Al}=xl,kl=bl,Sl=wl,Fl=(e,t,i)=>{for(const n of i)e.on(n,((...e)=>t.emit(n,...e)))},Tl=e=>{switch(e){case":method":case":scheme":case":authority":case":path":return!0;default:return!1}},{ERR_INVALID_ARG_TYPE:Bl,ERR_INVALID_PROTOCOL:Ol,ERR_HTTP_HEADERS_SENT:jl,ERR_INVALID_HTTP_TOKEN:Il,ERR_HTTP_INVALID_HEADER_VALUE:Pl,ERR_INVALID_CHAR:Ll}=_l.exports,{HTTP2_HEADER_STATUS:Rl,HTTP2_HEADER_METHOD:Nl,HTTP2_HEADER_PATH:$l,HTTP2_METHOD_CONNECT:Hl}=Dl.constants,Ul=Symbol("headers"),ql=Symbol("origin"),Ml=Symbol("session"),zl=Symbol("options"),Gl=Symbol("flushedHeaders"),Vl=Symbol("jobs"),Wl=/^[\^`\-\w!#$%&*+.|~]+$/,Jl=/[^\t\u0020-\u007E\u0080-\u00FF]/;var Kl=class extends El{constructor(e,t,i){super({autoDestroy:!1});const n="string"==typeof e||e instanceof URL;if(n&&(e=Sl(e instanceof URL?e:new URL(e))),"function"==typeof t||void 0===t?(i=t,t=n?e:{...e}):t={...e,...t},t.h2session)this[Ml]=t.h2session;else if(!1===t.agent)this.agent=new Cl({maxFreeSessions:0});else if(void 0===t.agent||null===t.agent)"function"==typeof t.createConnection?(this.agent=new Cl({maxFreeSessions:0}),this.agent.createConnection=t.createConnection):this.agent=Al;else{if("function"!=typeof t.agent.request)throw new Bl("options.agent",["Agent-like Object","undefined","false"],t.agent);this.agent=t.agent}if(t.protocol&&"https:"!==t.protocol)throw new Ol(t.protocol,"https:");const o=t.port||t.defaultPort||this.agent&&this.agent.defaultPort||443,s=t.hostname||t.host||"localhost";delete t.hostname,delete t.host,delete t.port;const{timeout:r}=t;if(t.timeout=void 0,this[Ul]=Object.create(null),this[Vl]=[],this.socket=null,this.connection=null,this.method=t.method||"GET",this.path=t.path,this.res=null,this.aborted=!1,this.reusedSocket=!1,t.headers)for(const[e,i]of Object.entries(t.headers))this.setHeader(e,i);t.auth&&!("authorization"in this[Ul])&&(this[Ul].authorization="Basic "+Buffer.from(t.auth).toString("base64")),t.session=t.tlsSession,t.path=t.socketPath,this[zl]=t,443===o?(this[ql]=`https://${s}`,":authority"in this[Ul]||(this[Ul][":authority"]=s)):(this[ql]=`https://${s}:${o}`,":authority"in this[Ul]||(this[Ul][":authority"]=`${s}:${o}`)),r&&this.setTimeout(r),i&&this.once("response",i),this[Gl]=!1}get method(){return this[Ul][Nl]}set method(e){e&&(this[Ul][Nl]=e.toUpperCase())}get path(){return this[Ul][$l]}set path(e){e&&(this[Ul][$l]=e)}get _mustNotHaveABody(){return"GET"===this.method||"HEAD"===this.method||"DELETE"===this.method}_write(e,t,i){if(this._mustNotHaveABody)return void i(new Error("The GET, HEAD and DELETE methods must NOT have a body"));this.flushHeaders();const n=()=>this._request.write(e,t,i);this._request?n():this[Vl].push(n)}_final(e){if(this.destroyed)return;this.flushHeaders();const t=()=>{this._mustNotHaveABody?e():this._request.end(e)};this._request?t():this[Vl].push(t)}abort(){this.res&&this.res.complete||(this.aborted||process.nextTick((()=>this.emit("abort"))),this.aborted=!0,this.destroy())}_destroy(e,t){this.res&&this.res._dump(),this._request&&this._request.destroy(),t(e)}async flushHeaders(){if(this[Gl]||this.destroyed)return;this[Gl]=!0;const e=this.method===Hl,t=t=>{if(this._request=t,this.destroyed)return void t.destroy();e||Fl(t,this,["timeout","continue","close","error"]);const i=e=>(...t)=>{this.writable||this.destroyed?this.once("finish",(()=>{e(...t)})):e(...t)};t.once("response",i(((i,n,o)=>{const s=new kl(this.socket,t.readableHighWaterMark);this.res=s,s.req=this,s.statusCode=i[Rl],s.headers=i,s.rawHeaders=o,s.once("end",(()=>{this.aborted?(s.aborted=!0,s.emit("aborted")):(s.complete=!0,s.socket=null,s.connection=null)})),e?(s.upgrade=!0,this.emit("connect",s,t,Buffer.alloc(0))?this.emit("close"):t.destroy()):(t.on("data",(e=>{s._dumped||s.push(e)||t.pause()})),t.once("end",(()=>{s.push(null)})),this.emit("response",s)||s._dump())}))),t.once("headers",i((e=>this.emit("information",{statusCode:e[Rl]})))),t.once("trailers",i(((e,t,i)=>{const{res:n}=this;n.trailers=e,n.rawTrailers=i})));const{socket:n}=t.session;this.socket=n,this.connection=n;for(const e of this[Vl])e();this.emit("socket",this.socket)};if(this[Ml])try{t(this[Ml].request(this[Ul]))}catch(e){this.emit("error",e)}else{this.reusedSocket=!0;try{t(await this.agent.request(this[ql],this[zl],this[Ul]))}catch(e){this.emit("error",e)}}}getHeader(e){if("string"!=typeof e)throw new Bl("name","string",e);return this[Ul][e.toLowerCase()]}get headersSent(){return this[Gl]}removeHeader(e){if("string"!=typeof e)throw new Bl("name","string",e);if(this.headersSent)throw new jl("remove");delete this[Ul][e.toLowerCase()]}setHeader(e,t){if(this.headersSent)throw new jl("set");if("string"!=typeof e||!Wl.test(e)&&!Tl(e))throw new Il("Header name",e);if(void 0===t)throw new Pl(t,e);if(Jl.test(t))throw new Ll("header content",e);this[Ul][e.toLowerCase()]=t}setNoDelay(){}setSocketKeepAlive(){}setTimeout(e,t){const i=()=>this._request.setTimeout(e,t);return this._request?i():this[Vl].push(i),this}get maxHeadersCount(){if(!this.destroyed&&this._request)return this._request.session.localSettings.maxHeaderListSize}set maxHeadersCount(e){}},Ql={exports:{}};const Xl=N.default;const Yl=$.default;const Zl=O.default,ep=j.default,tp=(e={},t=Xl.connect)=>new Promise(((i,n)=>{let o,s=!1;const r=async()=>{await c,o.off("timeout",a),o.off("error",n),e.resolveSocket?(i({alpnProtocol:o.alpnProtocol,socket:o,timeout:s}),s&&(await Promise.resolve(),o.emit("timeout"))):(o.destroy(),i({alpnProtocol:o.alpnProtocol,timeout:s}))},a=async()=>{s=!0,r()},c=(async()=>{try{o=await t(e,r),o.on("error",n),o.once("timeout",a)}catch(e){n(e)}})()})),ip=Kl,np=e=>{let t=e.host;const i=e.headers&&e.headers.host;if(i)if(i.startsWith("[")){t=-1===i.indexOf("]")?i:i.slice(1,-1)}else t=i.split(":",1)[0];return Yl.isIP(t)?"":t},op=wl,sp=new nl({maxSize:100}),rp=new Map,ap=(e,t,i)=>{t._httpMessage={shouldKeepAlive:!0};const n=()=>{e.emit("free",t,i)};t.on("free",n);const o=()=>{e.removeSocket(t,i)};t.on("close",o);const s=()=>{e.removeSocket(t,i),t.off("close",o),t.off("free",n),t.off("agentRemove",s)};t.on("agentRemove",s),e.emit("free",t,i)};Ql.exports=async(e,t,i)=>{if(("string"==typeof e||e instanceof URL)&&(e=op(new URL(e))),"function"==typeof t&&(i=t,t=void 0),t={ALPNProtocols:["h2","http/1.1"],...e,...t,resolveSocket:!0},!Array.isArray(t.ALPNProtocols)||0===t.ALPNProtocols.length)throw new Error("The `ALPNProtocols` option must be an Array with at least one entry");t.protocol=t.protocol||"https:";const n="https:"===t.protocol;t.host=t.hostname||t.host||"localhost",t.session=t.tlsSession,t.servername=t.servername||np(t),t.port=t.port||(n?443:80),t._defaultAgent=n?ep.globalAgent:Zl.globalAgent;const o=t.agent;if(o){if(o.addRequest)throw new Error("The `options.agent` object can contain only `http`, `https` or `http2` properties");t.agent=o[n?"https":"http"]}if(n){const e=await(async e=>{const t=`${e.host}:${e.port}:${e.ALPNProtocols.sort()}`;if(!sp.has(t)){if(rp.has(t))return(await rp.get(t)).alpnProtocol;const{path:i,agent:n}=e;e.path=e.socketPath;const o=tp(e);rp.set(t,o);try{const{socket:s,alpnProtocol:r}=await o;if(sp.set(t,r),e.path=i,"h2"===r)s.destroy();else{const{globalAgent:t}=ep,i=ep.Agent.prototype.createConnection;n?n.createConnection===i?ap(n,s,e):s.destroy():t.createConnection===i?ap(t,s,e):s.destroy()}return rp.delete(t),r}catch(e){throw rp.delete(t),e}}return sp.get(t)})(t);if("h2"===e)return o&&(t.agent=o.http2),new ip(t,i)}return Zl.request(t,i)},Ql.exports.protocolCache=sp;const cp=R.default,up=xl,lp=Kl,pp=bl,dp=Ql.exports;var hp={...cp,ClientRequest:lp,IncomingMessage:pp,...up,request:(e,t,i)=>new lp(e,t,i),get:(e,t,i)=>{const n=new lp(e,t,i);return n.end(),n},auto:dp},mp={},fp={};Object.defineProperty(fp,"__esModule",{value:!0});const gp=ac.exports;fp.default=e=>gp.default.nodeStream(e)&&gp.default.function_(e.getBoundary),Object.defineProperty(mp,"__esModule",{value:!0});const vp=k.default,xp=T.default,yp=ac.exports,bp=fp,wp=xp.promisify(vp.stat);mp.default=async(e,t)=>{if(t&&"content-length"in t)return Number(t["content-length"]);if(!e)return 0;if(yp.default.string(e))return Buffer.byteLength(e);if(yp.default.buffer(e))return e.length;if(bp.default(e))return xp.promisify(e.getLength.bind(e))();if(e instanceof vp.ReadStream){const{size:t}=await wp(e.path);if(0===t)return;return t}};var _p,Dp={};function Ep(){if(_p)return Dp;return _p=1,Object.defineProperty(Dp,"__esModule",{value:!0}),Dp.default=function(e,t,i){const n={};for(const o of i)n[o]=(...e)=>{t.emit(o,...e)},e.on(o,n[o]);return()=>{for(const t of i)e.off(t,n[t])}},Dp}var Cp={},Ap={};Object.defineProperty(Ap,"__esModule",{value:!0}),Ap.default=()=>{const e=[];return{once(t,i,n){t.once(i,n),e.push({origin:t,event:i,fn:n})},unhandleAll(){for(const t of e){const{origin:e,event:i,fn:n}=t;e.removeListener(i,n)}e.length=0}}},Object.defineProperty(Cp,"__esModule",{value:!0}),Cp.TimeoutError=void 0;const kp=$.default,Sp=Ap,Fp=Symbol("reentry"),Tp=()=>{};class Bp extends Error{constructor(e,t){super(`Timeout awaiting '${t}' for ${e}ms`),this.event=t,this.name="TimeoutError",this.code="ETIMEDOUT"}}Cp.TimeoutError=Bp,Cp.default=(e,t,i)=>{if(Fp in e)return Tp;e[Fp]=!0;const n=[],{once:o,unhandleAll:s}=Sp.default(),r=(e,t,i)=>{var o;const s=setTimeout(t,e,e,i);null===(o=s.unref)||void 0===o||o.call(s);const r=()=>{clearTimeout(s)};return n.push(r),r},{host:a,hostname:c}=i,u=(t,i)=>{e.destroy(new Bp(t,i))},l=()=>{for(const e of n)e();s()};if(e.once("error",(t=>{if(l(),0===e.listenerCount("error"))throw t})),e.once("close",l),o(e,"response",(e=>{o(e,"end",l)})),void 0!==t.request&&r(t.request,u,"request"),void 0!==t.socket){const i=()=>{u(t.socket,"socket")};e.setTimeout(t.socket,i),n.push((()=>{e.removeListener("timeout",i)}))}return o(e,"socket",(n=>{var s;const{socketPath:l}=e;if(n.connecting){const e=Boolean(null!=l?l:0!==kp.isIP(null!==(s=null!=c?c:a)&&void 0!==s?s:""));if(void 0!==t.lookup&&!e&&void 0===n.address().address){const e=r(t.lookup,u,"lookup");o(n,"lookup",e)}if(void 0!==t.connect){const i=()=>r(t.connect,u,"connect");e?o(n,"connect",i()):o(n,"lookup",(e=>{null===e&&o(n,"connect",i())}))}void 0!==t.secureConnect&&"https:"===i.protocol&&o(n,"connect",(()=>{const e=r(t.secureConnect,u,"secureConnect");o(n,"secureConnect",e)}))}if(void 0!==t.send){const i=()=>r(t.send,u,"send");n.connecting?o(n,"connect",(()=>{o(e,"upload-complete",i())})):o(e,"upload-complete",i())}})),void 0!==t.response&&o(e,"upload-complete",(()=>{const i=r(t.response,u,"response");o(e,"response",i)})),l};var Op={};Object.defineProperty(Op,"__esModule",{value:!0});const jp=ac.exports;Op.default=e=>{const t={protocol:e.protocol,hostname:jp.default.string(e.hostname)&&e.hostname.startsWith("[")?e.hostname.slice(1,-1):e.hostname,host:e.host,hash:e.hash,search:e.search,pathname:e.pathname,href:e.href,path:`${e.pathname||""}${e.search||""}`};return jp.default.string(e.port)&&e.port.length>0&&(t.port=Number(e.port)),(e.username||e.password)&&(t.auth=`${e.username||""}:${e.password||""}`),t};var Ip={};Object.defineProperty(Ip,"__esModule",{value:!0});const Pp=S.default,Lp=["protocol","host","hostname","port","pathname","search"];Ip.default=(e,t)=>{var i,n;if(t.path){if(t.pathname)throw new TypeError("Parameters `path` and `pathname` are mutually exclusive.");if(t.search)throw new TypeError("Parameters `path` and `search` are mutually exclusive.");if(t.searchParams)throw new TypeError("Parameters `path` and `searchParams` are mutually exclusive.")}if(t.search&&t.searchParams)throw new TypeError("Parameters `search` and `searchParams` are mutually exclusive.");if(!e){if(!t.protocol)throw new TypeError("No URL protocol specified");e=`${t.protocol}//${null!==(n=null!==(i=t.hostname)&&void 0!==i?i:t.host)&&void 0!==n?n:""}`}const o=new Pp.URL(e);if(t.path){const e=t.path.indexOf("?");-1===e?t.pathname=t.path:(t.pathname=t.path.slice(0,e),t.search=t.path.slice(e+1)),delete t.path}for(const e of Lp)t[e]&&(o[e]=t[e].toString());return o};var Rp={};Object.defineProperty(Rp,"__esModule",{value:!0});Rp.default=class{constructor(){this.weakMap=new WeakMap,this.map=new Map}set(e,t){"object"==typeof e?this.weakMap.set(e,t):this.map.set(e,t)}get(e){return"object"==typeof e?this.weakMap.get(e):this.map.get(e)}has(e){return"object"==typeof e?this.weakMap.has(e):this.map.has(e)}};var Np,$p={};function Hp(){if(Np)return $p;Np=1,Object.defineProperty($p,"__esModule",{value:!0});return $p.default=async e=>{const t=[];let i=0;for await(const n of e)t.push(n),i+=Buffer.byteLength(n);return Buffer.isBuffer(t[0])?Buffer.concat(t,i):Buffer.from(t.join(""))},$p}var Up={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.dnsLookupIpVersionToFamily=e.isDnsLookupIpVersion=void 0;const t={auto:0,ipv4:4,ipv6:6};e.isDnsLookupIpVersion=e=>e in t,e.dnsLookupIpVersionToFamily=i=>{if(e.isDnsLookupIpVersion(i))return t[i];throw new Error("Invalid DNS lookup IP version")}}(Up);var qp,Mp={};function zp(){return qp||(qp=1,Object.defineProperty(Mp,"__esModule",{value:!0}),Mp.isResponseOk=void 0,Mp.isResponseOk=e=>{const{statusCode:t}=e,i=e.request.options.followRedirect?299:399;return t>=200&&t<=i||304===t}),Mp}var Gp={};Object.defineProperty(Gp,"__esModule",{value:!0});const Vp=new Set;Gp.default=e=>{Vp.has(e)||(Vp.add(e),process.emitWarning(`Got: ${e}`,{type:"DeprecationWarning"}))};var Wp={};Object.defineProperty(Wp,"__esModule",{value:!0});const Jp=ac.exports;Wp.default=(e,t)=>{if(Jp.default.null_(e.encoding))throw new TypeError("To get a Buffer, set `options.responseType` to `buffer` instead");Jp.assert.any([Jp.default.string,Jp.default.undefined],e.encoding),Jp.assert.any([Jp.default.boolean,Jp.default.undefined],e.resolveBodyOnly),Jp.assert.any([Jp.default.boolean,Jp.default.undefined],e.methodRewriting),Jp.assert.any([Jp.default.boolean,Jp.default.undefined],e.isStream),Jp.assert.any([Jp.default.string,Jp.default.undefined],e.responseType),void 0===e.responseType&&(e.responseType="text");const{retry:i}=e;if(e.retry=t?{...t.retry}:{calculateDelay:e=>e.computedValue,limit:0,methods:[],statusCodes:[],errorCodes:[],maxRetryAfter:void 0},Jp.default.object(i)?(e.retry={...e.retry,...i},e.retry.methods=[...new Set(e.retry.methods.map((e=>e.toUpperCase())))],e.retry.statusCodes=[...new Set(e.retry.statusCodes)],e.retry.errorCodes=[...new Set(e.retry.errorCodes)]):Jp.default.number(i)&&(e.retry.limit=i),Jp.default.undefined(e.retry.maxRetryAfter)&&(e.retry.maxRetryAfter=Math.min(...[e.timeout.request,e.timeout.connect].filter(Jp.default.number))),Jp.default.object(e.pagination)){t&&(e.pagination={...t.pagination,...e.pagination});const{pagination:i}=e;if(!Jp.default.function_(i.transform))throw new Error("`options.pagination.transform` must be implemented");if(!Jp.default.function_(i.shouldContinue))throw new Error("`options.pagination.shouldContinue` must be implemented");if(!Jp.default.function_(i.filter))throw new TypeError("`options.pagination.filter` must be implemented");if(!Jp.default.function_(i.paginate))throw new Error("`options.pagination.paginate` must be implemented")}return"json"===e.responseType&&void 0===e.headers.accept&&(e.headers.accept="application/json"),e};var Kp={};Object.defineProperty(Kp,"__esModule",{value:!0}),Kp.retryAfterStatusCodes=void 0,Kp.retryAfterStatusCodes=new Set([413,429,503]);var Qp;function Xp(){return Qp||(Qp=1,function(e){var t=q&&q.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),i=q&&q.__exportStar||function(e,i){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(i,n)||t(i,e,n)};Object.defineProperty(e,"__esModule",{value:!0}),e.CancelError=e.ParseError=void 0;const n=dc;e.ParseError=class extends n.RequestError{constructor(e,t){const{options:i}=t.request;super(`${e.message} in "${i.url.toString()}"`,e,t.request),this.name="ParseError",this.code="ERR_GOT_REQUEST_ERROR"===this.code?"ERR_BODY_PARSE_FAILURE":this.code}};e.CancelError=class extends n.RequestError{constructor(e){super("Promise was canceled",{},e),this.name="CancelError",this.code="ERR_CANCELED"}get isCanceled(){return!0}},i(dc,e)}(pc)),pc}Kp.default=({attemptCount:e,retryOptions:t,error:i,retryAfter:n})=>{if(e>t.limit)return 0;const o=t.methods.includes(i.options.method),s=t.errorCodes.includes(i.code),r=i.response&&t.statusCodes.includes(i.response.statusCode);if(!o||!s&&!r)return 0;if(i.response){if(n)return void 0===t.maxRetryAfter||n>t.maxRetryAfter?0:n;if(413===i.response.statusCode)return 0}return 2**(e-1)*1e3+100*Math.random()},function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.UnsupportedProtocolError=e.ReadError=e.TimeoutError=e.UploadError=e.CacheError=e.HTTPError=e.MaxRedirectsError=e.RequestError=e.setNonEnumerableProperties=e.knownHookEvents=e.withoutBody=e.kIsNormalizedAlready=void 0;const t=T.default,i=B.default,n=k.default,o=S.default,s=O.default,r=O.default,a=j.default,c=hc.exports,u=fc.exports,l=Ku,p=tl,d=hp,h=mu,m=ac.exports,f=mp,g=fp,v=Ep(),x=Cp,y=Op,b=Ip,w=Rp,_=Hp(),D=Up,E=zp(),C=Gp,A=Wp,F=Kp;let I;const P=Symbol("request"),L=Symbol("response"),R=Symbol("responseSize"),N=Symbol("downloadedSize"),$=Symbol("bodySize"),H=Symbol("uploadedSize"),U=Symbol("serverResponsesPiped"),q=Symbol("unproxyEvents"),M=Symbol("isFromCache"),z=Symbol("cancelTimeouts"),G=Symbol("startedReading"),V=Symbol("stopReading"),W=Symbol("triggerRead"),J=Symbol("body"),K=Symbol("jobs"),Q=Symbol("originalResponse"),X=Symbol("retryTimeout");e.kIsNormalizedAlready=Symbol("isNormalizedAlready");const Y=m.default.string(process.versions.brotli);e.withoutBody=new Set(["GET","HEAD"]),e.knownHookEvents=["init","beforeRequest","beforeRedirect","beforeError","beforeRetry","afterResponse"];const Z=new w.default,ee=new Set([300,301,302,303,304,307,308]),te=["context","body","json","form"];e.setNonEnumerableProperties=(e,t)=>{const i={};for(const t of e)if(t)for(const e of te)e in t&&(i[e]={writable:!0,configurable:!0,enumerable:!1,value:t[e]});Object.defineProperties(t,i)};class ie extends Error{constructor(e,t,i){var n,o;if(super(e),Error.captureStackTrace(this,this.constructor),this.name="RequestError",this.code=null!==(n=t.code)&&void 0!==n?n:"ERR_GOT_REQUEST_ERROR",i instanceof pe?(Object.defineProperty(this,"request",{enumerable:!1,value:i}),Object.defineProperty(this,"response",{enumerable:!1,value:i[L]}),Object.defineProperty(this,"options",{enumerable:!1,value:i.options})):Object.defineProperty(this,"options",{enumerable:!1,value:i}),this.timings=null===(o=this.request)||void 0===o?void 0:o.timings,m.default.string(t.stack)&&m.default.string(this.stack)){const e=this.stack.indexOf(this.message)+this.message.length,i=this.stack.slice(e).split("\n").reverse(),n=t.stack.slice(t.stack.indexOf(t.message)+t.message.length).split("\n").reverse();for(;0!==n.length&&n[0]===i[0];)i.shift();this.stack=`${this.stack.slice(0,e)}${i.reverse().join("\n")}${n.reverse().join("\n")}`}}}e.RequestError=ie;class ne extends ie{constructor(e){super(`Redirected ${e.options.maxRedirects} times. Aborting.`,{},e),this.name="MaxRedirectsError",this.code="ERR_TOO_MANY_REDIRECTS"}}e.MaxRedirectsError=ne;class oe extends ie{constructor(e){super(`Response code ${e.statusCode} (${e.statusMessage})`,{},e.request),this.name="HTTPError",this.code="ERR_NON_2XX_3XX_RESPONSE"}}e.HTTPError=oe;class se extends ie{constructor(e,t){super(e.message,e,t),this.name="CacheError",this.code="ERR_GOT_REQUEST_ERROR"===this.code?"ERR_CACHE_ACCESS":this.code}}e.CacheError=se;class re extends ie{constructor(e,t){super(e.message,e,t),this.name="UploadError",this.code="ERR_GOT_REQUEST_ERROR"===this.code?"ERR_UPLOAD":this.code}}e.UploadError=re;class ae extends ie{constructor(e,t,i){super(e.message,e,i),this.name="TimeoutError",this.event=e.event,this.timings=t}}e.TimeoutError=ae;class ce extends ie{constructor(e,t){super(e.message,e,t),this.name="ReadError",this.code="ERR_GOT_REQUEST_ERROR"===this.code?"ERR_READING_RESPONSE_STREAM":this.code}}e.ReadError=ce;class ue extends ie{constructor(e){super(`Unsupported protocol "${e.url.protocol}"`,{},e),this.name="UnsupportedProtocolError",this.code="ERR_UNSUPPORTED_PROTOCOL"}}e.UnsupportedProtocolError=ue;const le=["socket","connect","continue","information","upgrade","timeout"];class pe extends i.Duplex{constructor(t,i={},o){super({autoDestroy:!1,highWaterMark:0}),this[N]=0,this[H]=0,this.requestInitialized=!1,this[U]=new Set,this.redirects=[],this[V]=!1,this[W]=!1,this[K]=[],this.retryCount=0,this._progressCallbacks=[];const s=()=>this._unlockWrite(),a=()=>this._lockWrite();this.on("pipe",(e=>{e.prependListener("data",s),e.on("data",a),e.prependListener("end",s),e.on("end",a)})),this.on("unpipe",(e=>{e.off("data",s),e.off("data",a),e.off("end",s),e.off("end",a)})),this.on("pipe",(e=>{e instanceof r.IncomingMessage&&(this.options.headers={...e.headers,...this.options.headers})}));const{json:c,body:u,form:l}=i;if((c||u||l)&&this._lockWrite(),e.kIsNormalizedAlready in i)this.options=i;else try{this.options=this.constructor.normalizeArguments(t,i,o)}catch(e){return m.default.nodeStream(i.body)&&i.body.destroy(),void this.destroy(e)}(async()=>{var e;try{this.options.body instanceof n.ReadStream&&await(async e=>new Promise(((t,i)=>{const n=e=>{i(e)};e.pending||t(),e.once("error",n),e.once("ready",(()=>{e.off("error",n),t()}))})))(this.options.body);const{url:t}=this.options;if(!t)throw new TypeError("Missing `url` property");if(this.requestUrl=t.toString(),decodeURI(this.requestUrl),await this._finalizeBody(),await this._makeRequest(),this.destroyed)return void(null===(e=this[P])||void 0===e||e.destroy());for(const e of this[K])e();this[K].length=0,this.requestInitialized=!0}catch(e){if(e instanceof ie)return void this._beforeError(e);this.destroyed||this.destroy(e)}})()}static normalizeArguments(i,n,s){var r,a,c,p,d;const f=n;if(m.default.object(i)&&!m.default.urlInstance(i))n={...s,...i,...n};else{if(i&&n&&void 0!==n.url)throw new TypeError("The `url` option is mutually exclusive with the `input` argument");n={...s,...n},void 0!==i&&(n.url=i),m.default.urlInstance(n.url)&&(n.url=new o.URL(n.url.toString()))}if(!1===n.cache&&(n.cache=void 0),!1===n.dnsCache&&(n.dnsCache=void 0),m.assert.any([m.default.string,m.default.undefined],n.method),m.assert.any([m.default.object,m.default.undefined],n.headers),m.assert.any([m.default.string,m.default.urlInstance,m.default.undefined],n.prefixUrl),m.assert.any([m.default.object,m.default.undefined],n.cookieJar),m.assert.any([m.default.object,m.default.string,m.default.undefined],n.searchParams),m.assert.any([m.default.object,m.default.string,m.default.undefined],n.cache),m.assert.any([m.default.object,m.default.number,m.default.undefined],n.timeout),m.assert.any([m.default.object,m.default.undefined],n.context),m.assert.any([m.default.object,m.default.undefined],n.hooks),m.assert.any([m.default.boolean,m.default.undefined],n.decompress),m.assert.any([m.default.boolean,m.default.undefined],n.ignoreInvalidCookies),m.assert.any([m.default.boolean,m.default.undefined],n.followRedirect),m.assert.any([m.default.number,m.default.undefined],n.maxRedirects),m.assert.any([m.default.boolean,m.default.undefined],n.throwHttpErrors),m.assert.any([m.default.boolean,m.default.undefined],n.http2),m.assert.any([m.default.boolean,m.default.undefined],n.allowGetBody),m.assert.any([m.default.string,m.default.undefined],n.localAddress),m.assert.any([D.isDnsLookupIpVersion,m.default.undefined],n.dnsLookupIpVersion),m.assert.any([m.default.object,m.default.undefined],n.https),m.assert.any([m.default.boolean,m.default.undefined],n.rejectUnauthorized),n.https&&(m.assert.any([m.default.boolean,m.default.undefined],n.https.rejectUnauthorized),m.assert.any([m.default.function_,m.default.undefined],n.https.checkServerIdentity),m.assert.any([m.default.string,m.default.object,m.default.array,m.default.undefined],n.https.certificateAuthority),m.assert.any([m.default.string,m.default.object,m.default.array,m.default.undefined],n.https.key),m.assert.any([m.default.string,m.default.object,m.default.array,m.default.undefined],n.https.certificate),m.assert.any([m.default.string,m.default.undefined],n.https.passphrase),m.assert.any([m.default.string,m.default.buffer,m.default.array,m.default.undefined],n.https.pfx)),m.assert.any([m.default.object,m.default.undefined],n.cacheOptions),m.default.string(n.method)?n.method=n.method.toUpperCase():n.method="GET",n.headers===(null==s?void 0:s.headers)?n.headers={...n.headers}:n.headers=h({...null==s?void 0:s.headers,...n.headers}),"slashes"in n)throw new TypeError("The legacy `url.Url` has been deprecated. Use `URL` instead.");if("auth"in n)throw new TypeError("Parameter `auth` is deprecated. Use `username` / `password` instead.");if("searchParams"in n&&n.searchParams&&n.searchParams!==(null==s?void 0:s.searchParams)){let e;if(m.default.string(n.searchParams)||n.searchParams instanceof o.URLSearchParams)e=new o.URLSearchParams(n.searchParams);else{!function(e){for(const t in e){const i=e[t];if(!(m.default.string(i)||m.default.number(i)||m.default.boolean(i)||m.default.null_(i)||m.default.undefined(i)))throw new TypeError(`The \`searchParams\` value '${String(i)}' must be a string, number, boolean or null`)}}(n.searchParams),e=new o.URLSearchParams;for(const t in n.searchParams){const i=n.searchParams[t];null===i?e.append(t,""):void 0!==i&&e.append(t,i)}}null===(r=null==s?void 0:s.searchParams)||void 0===r||r.forEach(((t,i)=>{e.has(i)||e.append(i,t)})),n.searchParams=e}if(n.username=null!==(a=n.username)&&void 0!==a?a:"",n.password=null!==(c=n.password)&&void 0!==c?c:"",m.default.undefined(n.prefixUrl)?n.prefixUrl=null!==(p=null==s?void 0:s.prefixUrl)&&void 0!==p?p:"":(n.prefixUrl=n.prefixUrl.toString(),""===n.prefixUrl||n.prefixUrl.endsWith("/")||(n.prefixUrl+="/")),m.default.string(n.url)){if(n.url.startsWith("/"))throw new Error("`input` must not start with a slash when using `prefixUrl`");n.url=b.default(n.prefixUrl+n.url,n)}else(m.default.undefined(n.url)&&""!==n.prefixUrl||n.protocol)&&(n.url=b.default(n.prefixUrl,n));if(n.url){"port"in n&&delete n.port;let{prefixUrl:e}=n;Object.defineProperty(n,"prefixUrl",{set:t=>{const i=n.url;if(!i.href.startsWith(t))throw new Error(`Cannot change \`prefixUrl\` from ${e} to ${t}: ${i.href}`);n.url=new o.URL(t+i.href.slice(e.length)),e=t},get:()=>e});let{protocol:t}=n.url;if("unix:"===t&&(t="http:",n.url=new o.URL(`http://unix${n.url.pathname}${n.url.search}`)),n.searchParams&&(n.url.search=n.searchParams.toString()),"http:"!==t&&"https:"!==t)throw new ue(n);""===n.username?n.username=n.url.username:n.url.username=n.username,""===n.password?n.password=n.url.password:n.url.password=n.password}const{cookieJar:g}=n;if(g){let{setCookie:e,getCookieString:i}=g;m.assert.function_(e),m.assert.function_(i),4===e.length&&0===i.length&&(e=t.promisify(e.bind(n.cookieJar)),i=t.promisify(i.bind(n.cookieJar)),n.cookieJar={setCookie:e,getCookieString:i})}const{cache:v}=n;if(v&&(Z.has(v)||Z.set(v,new l(((e,t)=>{const i=e[P](e,t);return m.default.promise(i)&&(i.once=(e,t)=>{if("error"===e)i.catch(t);else{if("abort"!==e)throw new Error(`Unknown HTTP2 promise event: ${e}`);(async()=>{try{(await i).once("abort",t)}catch(e){}})()}return i}),i}),v))),n.cacheOptions={...n.cacheOptions},!0===n.dnsCache)I||(I=new u.default),n.dnsCache=I;else if(!m.default.undefined(n.dnsCache)&&!n.dnsCache.lookup)throw new TypeError(`Parameter \`dnsCache\` must be a CacheableLookup instance or a boolean, got ${m.default(n.dnsCache)}`);m.default.number(n.timeout)?n.timeout={request:n.timeout}:s&&n.timeout!==s.timeout?n.timeout={...s.timeout,...n.timeout}:n.timeout={...n.timeout},n.context||(n.context={});const x=n.hooks===(null==s?void 0:s.hooks);n.hooks={...n.hooks};for(const t of e.knownHookEvents)if(t in n.hooks){if(!m.default.array(n.hooks[t]))throw new TypeError(`Parameter \`${t}\` must be an Array, got ${m.default(n.hooks[t])}`);n.hooks[t]=[...n.hooks[t]]}else n.hooks[t]=[];if(s&&!x)for(const t of e.knownHookEvents){s.hooks[t].length>0&&(n.hooks[t]=[...s.hooks[t],...n.hooks[t]])}if("family"in n&&C.default('"options.family" was never documented, please use "options.dnsLookupIpVersion"'),(null==s?void 0:s.https)&&(n.https={...s.https,...n.https}),"rejectUnauthorized"in n&&C.default('"options.rejectUnauthorized" is now deprecated, please use "options.https.rejectUnauthorized"'),"checkServerIdentity"in n&&C.default('"options.checkServerIdentity" was never documented, please use "options.https.checkServerIdentity"'),"ca"in n&&C.default('"options.ca" was never documented, please use "options.https.certificateAuthority"'),"key"in n&&C.default('"options.key" was never documented, please use "options.https.key"'),"cert"in n&&C.default('"options.cert" was never documented, please use "options.https.certificate"'),"passphrase"in n&&C.default('"options.passphrase" was never documented, please use "options.https.passphrase"'),"pfx"in n&&C.default('"options.pfx" was never documented, please use "options.https.pfx"'),"followRedirects"in n)throw new TypeError("The `followRedirects` option does not exist. Use `followRedirect` instead.");if(n.agent)for(const e in n.agent)if("http"!==e&&"https"!==e&&"http2"!==e)throw new TypeError(`Expected the \`options.agent\` properties to be \`http\`, \`https\` or \`http2\`, got \`${e}\``);return n.maxRedirects=null!==(d=n.maxRedirects)&&void 0!==d?d:0,e.setNonEnumerableProperties([s,f],n),A.default(n,s)}_lockWrite(){const e=()=>{throw new TypeError("The payload has been already provided")};this.write=e,this.end=e}_unlockWrite(){this.write=super.write,this.end=super.end}async _finalizeBody(){const{options:t}=this,{headers:n}=t,s=!m.default.undefined(t.form),r=!m.default.undefined(t.json),a=!m.default.undefined(t.body),c=s||r||a,u=e.withoutBody.has(t.method)&&!("GET"===t.method&&t.allowGetBody);if(this._cannotHaveBody=u,c){if(u)throw new TypeError(`The \`${t.method}\` method cannot be used with a body`);if([a,s,r].filter((e=>e)).length>1)throw new TypeError("The `body`, `json` and `form` options are mutually exclusive");if(a&&!(t.body instanceof i.Readable)&&!m.default.string(t.body)&&!m.default.buffer(t.body)&&!g.default(t.body))throw new TypeError("The `body` option must be a stream.Readable, string or Buffer");if(s&&!m.default.object(t.form))throw new TypeError("The `form` option must be an Object");{const e=!m.default.string(n["content-type"]);a?(g.default(t.body)&&e&&(n["content-type"]=`multipart/form-data; boundary=${t.body.getBoundary()}`),this[J]=t.body):s?(e&&(n["content-type"]="application/x-www-form-urlencoded"),this[J]=new o.URLSearchParams(t.form).toString()):(e&&(n["content-type"]="application/json"),this[J]=t.stringifyJson(t.json));const i=await f.default(this[J],t.headers);m.default.undefined(n["content-length"])&&m.default.undefined(n["transfer-encoding"])&&(u||m.default.undefined(i)||(n["content-length"]=String(i)))}}else u?this._lockWrite():this._unlockWrite();this[$]=Number(n["content-length"])||void 0}async _onResponseBase(e){const{options:t}=this,{url:i}=t;this[Q]=e,t.decompress&&(e=p(e));const n=e.statusCode,r=e;r.statusMessage=r.statusMessage?r.statusMessage:s.STATUS_CODES[n],r.url=t.url.toString(),r.requestUrl=this.requestUrl,r.redirectUrls=this.redirects,r.request=this,r.isFromCache=e.fromCache||!1,r.ip=this.ip,r.retryCount=this.retryCount,this[M]=r.isFromCache,this[R]=Number(e.headers["content-length"])||void 0,this[L]=e,e.once("end",(()=>{this[R]=this[N],this.emit("downloadProgress",this.downloadProgress)})),e.once("error",(t=>{e.destroy(),this._beforeError(new ce(t,this))})),e.once("aborted",(()=>{this._beforeError(new ce({name:"Error",message:"The server aborted pending request",code:"ECONNRESET"},this))})),this.emit("downloadProgress",this.downloadProgress);const a=e.headers["set-cookie"];if(m.default.object(t.cookieJar)&&a){let c=a.map((async e=>t.cookieJar.setCookie(e,i.toString())));t.ignoreInvalidCookies&&(c=c.map((async e=>e.catch((()=>{})))));try{await Promise.all(c)}catch(u){return void this._beforeError(u)}}if(t.followRedirect&&e.headers.location&&ee.has(n)){e.resume(),this[P]&&(this[z](),delete this[P],this[q]());if(!(303===n&&"GET"!==t.method&&"HEAD"!==t.method)&&t.methodRewriting||(t.method="GET","body"in t&&delete t.body,"json"in t&&delete t.json,"form"in t&&delete t.form,this[J]=void 0,delete t.headers["content-length"]),this.redirects.length>=t.maxRedirects)return void this._beforeError(new ne(this));try{const l=Buffer.from(e.headers.location,"binary").toString(),d=new o.URL(l,i),h=d.toString();function f(e){return"unix:"===e.protocol||"unix"===e.hostname}if(decodeURI(h),!f(i)&&f(d))return void this._beforeError(new ie("Cannot redirect to UNIX socket",{},this));d.hostname!==i.hostname||d.port!==i.port?("host"in t.headers&&delete t.headers.host,"cookie"in t.headers&&delete t.headers.cookie,"authorization"in t.headers&&delete t.headers.authorization,(t.username||t.password)&&(t.username="",t.password="")):(d.username=t.username,d.password=t.password),this.redirects.push(h),t.url=d;for(const g of t.hooks.beforeRedirect)await g(t,r);this.emit("redirect",r,t),await this._makeRequest()}catch(v){return void this._beforeError(v)}}else if(t.isStream&&t.throwHttpErrors&&!E.isResponseOk(r))this._beforeError(new oe(r));else{e.on("readable",(()=>{this[W]&&this._read()})),this.on("resume",(()=>{e.resume()})),this.on("pause",(()=>{e.pause()})),e.once("end",(()=>{this.push(null)})),this.emit("response",e);for(const x of this[U])if(!x.headersSent){for(const y in e.headers){const b=!t.decompress||"content-encoding"!==y,w=e.headers[y];b&&x.setHeader(y,w)}x.statusCode=n}}}async _onResponse(e){try{await this._onResponseBase(e)}catch(e){this._beforeError(e)}}_onRequest(e){const{options:t}=this,{timeout:i,url:n}=t;c.default(e),this[z]=x.default(e,i,n);const o=t.cache?"cacheableResponse":"response";e.once(o,(e=>{this._onResponse(e)})),e.once("error",(t=>{var i;e.destroy(),null===(i=e.res)||void 0===i||i.removeAllListeners("end"),t=t instanceof x.TimeoutError?new ae(t,this.timings,this):new ie(t.message,t,this),this._beforeError(t)})),this[q]=v.default(e,this,le),this[P]=e,this.emit("uploadProgress",this.uploadProgress);const s=this[J],r=0===this.redirects.length?this:e;m.default.nodeStream(s)?(s.pipe(r),s.once("error",(e=>{this._beforeError(new re(e,this))}))):(this._unlockWrite(),m.default.undefined(s)?(this._cannotHaveBody||this._noPipe)&&(r.end(),this._lockWrite()):(this._writeRequest(s,void 0,(()=>{})),r.end(),this._lockWrite())),this.emit("request",e)}async _createCacheableRequest(e,t){return new Promise(((i,n)=>{let o;Object.assign(t,y.default(e)),delete t.url;const s=Z.get(t.cache)(t,(async e=>{e._readableState.autoDestroy=!1,o&&(await o).emit("cacheableResponse",e),i(e)}));t.url=e,s.once("error",n),s.once("request",(async e=>{o=e,i(o)}))}))}async _makeRequest(){var e,t,i,n,o;const{options:r}=this,{headers:c}=r;for(const e in c)if(m.default.undefined(c[e]))delete c[e];else if(m.default.null_(c[e]))throw new TypeError(`Use \`undefined\` instead of \`null\` to delete the \`${e}\` header`);if(r.decompress&&m.default.undefined(c["accept-encoding"])&&(c["accept-encoding"]=Y?"gzip, deflate, br":"gzip, deflate"),r.cookieJar){const e=await r.cookieJar.getCookieString(r.url.toString());m.default.nonEmptyString(e)&&(r.headers.cookie=e)}for(const e of r.hooks.beforeRequest){const t=await e(r);if(!m.default.undefined(t)){r.request=()=>t;break}}r.body&&this[J]!==r.body&&(this[J]=r.body);const{agent:u,request:p,timeout:h,url:f}=r;if(r.dnsCache&&!("lookup"in r)&&(r.lookup=r.dnsCache.lookup),"unix"===f.hostname){const e=/(?<socketPath>.+?):(?<path>.+)/.exec(`${f.pathname}${f.search}`);if(null==e?void 0:e.groups){const{socketPath:t,path:i}=e.groups;Object.assign(r,{socketPath:t,path:i,host:""})}}const g="https:"===f.protocol;let v;v=r.http2?d.auto:g?a.request:s.request;const x=null!==(e=r.request)&&void 0!==e?e:v,y=r.cache?this._createCacheableRequest:x;u&&!r.http2&&(r.agent=u[g?"https":"http"]),r[P]=x,delete r.request,delete r.timeout;const b=r;if(b.shared=null===(t=r.cacheOptions)||void 0===t?void 0:t.shared,b.cacheHeuristic=null===(i=r.cacheOptions)||void 0===i?void 0:i.cacheHeuristic,b.immutableMinTimeToLive=null===(n=r.cacheOptions)||void 0===n?void 0:n.immutableMinTimeToLive,b.ignoreCargoCult=null===(o=r.cacheOptions)||void 0===o?void 0:o.ignoreCargoCult,void 0!==r.dnsLookupIpVersion)try{b.family=D.dnsLookupIpVersionToFamily(r.dnsLookupIpVersion)}catch(e){throw new Error("Invalid `dnsLookupIpVersion` option value")}r.https&&("rejectUnauthorized"in r.https&&(b.rejectUnauthorized=r.https.rejectUnauthorized),r.https.checkServerIdentity&&(b.checkServerIdentity=r.https.checkServerIdentity),r.https.certificateAuthority&&(b.ca=r.https.certificateAuthority),r.https.certificate&&(b.cert=r.https.certificate),r.https.key&&(b.key=r.https.key),r.https.passphrase&&(b.passphrase=r.https.passphrase),r.https.pfx&&(b.pfx=r.https.pfx));try{let e=await y(f,b);m.default.undefined(e)&&(e=v(f,b)),r.request=p,r.timeout=h,r.agent=u,r.https&&("rejectUnauthorized"in r.https&&delete b.rejectUnauthorized,r.https.checkServerIdentity&&delete b.checkServerIdentity,r.https.certificateAuthority&&delete b.ca,r.https.certificate&&delete b.cert,r.https.key&&delete b.key,r.https.passphrase&&delete b.passphrase,r.https.pfx&&delete b.pfx),!function(e){return m.default.object(e)&&!("statusCode"in e)}(e)?this.writable?(this.once("finish",(()=>{this._onResponse(e)})),this._unlockWrite(),this.end(),this._lockWrite()):this._onResponse(e):this._onRequest(e)}catch(e){if(e instanceof l.CacheError)throw new se(e,this);throw new ie(e.message,e,this)}}async _error(e){try{for(const t of this.options.hooks.beforeError)e=await t(e)}catch(t){e=new ie(t.message,t,this)}this.destroy(e)}_beforeError(e){if(this[V])return;const{options:t}=this,i=this.retryCount+1;this[V]=!0,e instanceof ie||(e=new ie(e.message,e,this));const n=e,{response:o}=n;(async()=>{if(o&&!o.body){o.setEncoding(this._readableState.encoding);try{o.rawBody=await _.default(o),o.body=o.rawBody.toString()}catch(e){}}if(0!==this.listenerCount("retry")){let s;try{let e;o&&"retry-after"in o.headers&&(e=Number(o.headers["retry-after"]),Number.isNaN(e)?(e=Date.parse(o.headers["retry-after"])-Date.now(),e<=0&&(e=1)):e*=1e3),s=await t.retry.calculateDelay({attemptCount:i,retryOptions:t.retry,error:n,retryAfter:e,computedValue:F.default({attemptCount:i,retryOptions:t.retry,error:n,retryAfter:e,computedValue:0})})}catch(e){return void this._error(new ie(e.message,e,this))}if(s){const t=async()=>{try{for(const e of this.options.hooks.beforeRetry)await e(this.options,n,i)}catch(t){return void this._error(new ie(t.message,e,this))}this.destroyed||(this.destroy(),this.emit("retry",i,e))};return void(this[X]=setTimeout(t,s))}}this._error(n)})()}_read(){this[W]=!0;const e=this[L];if(e&&!this[V]){let t;for(e.readableLength&&(this[W]=!1);null!==(t=e.read());){this[N]+=t.length,this[G]=!0;const e=this.downloadProgress;e.percent<1&&this.emit("downloadProgress",e),this.push(t)}}}_write(e,t,i){const n=()=>{this._writeRequest(e,t,i)};this.requestInitialized?n():this[K].push(n)}_writeRequest(e,t,i){this[P].destroyed||(this._progressCallbacks.push((()=>{this[H]+=Buffer.byteLength(e,t);const i=this.uploadProgress;i.percent<1&&this.emit("uploadProgress",i)})),this[P].write(e,t,(e=>{!e&&this._progressCallbacks.length>0&&this._progressCallbacks.shift()(),i(e)})))}_final(e){const t=()=>{for(;0!==this._progressCallbacks.length;)this._progressCallbacks.shift()();P in this?this[P].destroyed?e():this[P].end((t=>{t||(this[$]=this[H],this.emit("uploadProgress",this.uploadProgress),this[P].emit("upload-complete")),e(t)})):e()};this.requestInitialized?t():this[K].push(t)}_destroy(e,t){var i;this[V]=!0,clearTimeout(this[X]),P in this&&(this[z](),(null===(i=this[L])||void 0===i?void 0:i.complete)||this[P].destroy()),null===e||m.default.undefined(e)||e instanceof ie||(e=new ie(e.message,e,this)),t(e)}get _isAboutToError(){return this[V]}get ip(){var e;return null===(e=this.socket)||void 0===e?void 0:e.remoteAddress}get aborted(){var e,t,i;return(null!==(t=null===(e=this[P])||void 0===e?void 0:e.destroyed)&&void 0!==t?t:this.destroyed)&&!(null===(i=this[Q])||void 0===i?void 0:i.complete)}get socket(){var e,t;return null!==(t=null===(e=this[P])||void 0===e?void 0:e.socket)&&void 0!==t?t:void 0}get downloadProgress(){let e;return e=this[R]?this[N]/this[R]:this[R]===this[N]?1:0,{percent:e,transferred:this[N],total:this[R]}}get uploadProgress(){let e;return e=this[$]?this[H]/this[$]:this[$]===this[H]?1:0,{percent:e,transferred:this[H],total:this[$]}}get timings(){var e;return null===(e=this[P])||void 0===e?void 0:e.timings}get isFromCache(){return this[M]}pipe(e,t){if(this[G])throw new Error("Failed to pipe. The response has been emitted already.");return e instanceof r.ServerResponse&&this[U].add(e),super.pipe(e,t)}unpipe(e){return e instanceof r.ServerResponse&&this[U].delete(e),super.unpipe(e),this}}e.default=pe}(dc);var Yp,Zp,ed={};function td(){return Zp||(Zp=1,function(e){var t=q&&q.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),i=q&&q.__exportStar||function(e,i){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(i,n)||t(i,e,n)};Object.defineProperty(e,"__esModule",{value:!0});const n=F.default,o=ac.exports,s=function(){if(cc)return lc.exports;cc=1;class e extends Error{constructor(e){super(e||"Promise was canceled"),this.name="CancelError"}get isCanceled(){return!0}}class t{static fn(e){return(...i)=>new t(((t,n,o)=>{i.push(o),e(...i).then(t,n)}))}constructor(e){this._cancelHandlers=[],this._isPending=!0,this._isCanceled=!1,this._rejectOnCancel=!0,this._promise=new Promise(((t,i)=>{this._reject=i;const n=e=>{if(!this._isPending)throw new Error("The `onCancel` handler was attached after the promise settled.");this._cancelHandlers.push(e)};return Object.defineProperties(n,{shouldReject:{get:()=>this._rejectOnCancel,set:e=>{this._rejectOnCancel=e}}}),e((e=>{this._isCanceled&&n.shouldReject||(this._isPending=!1,t(e))}),(e=>{this._isPending=!1,i(e)}),n)}))}then(e,t){return this._promise.then(e,t)}catch(e){return this._promise.catch(e)}finally(e){return this._promise.finally(e)}cancel(t){if(this._isPending&&!this._isCanceled){if(this._isCanceled=!0,this._cancelHandlers.length>0)try{for(const e of this._cancelHandlers)e()}catch(e){return void this._reject(e)}this._rejectOnCancel&&this._reject(new e(t))}}get isCanceled(){return this._isCanceled}}return Object.setPrototypeOf(t.prototype,Promise.prototype),lc.exports=t,lc.exports.CancelError=e,lc.exports}(),r=Xp(),a=function(){if(Yp)return ed;Yp=1,Object.defineProperty(ed,"__esModule",{value:!0});const e=Xp();return ed.default=(t,i,n,o)=>{const{rawBody:s}=t;try{if("text"===i)return s.toString(o);if("json"===i)return 0===s.length?"":n(s.toString());if("buffer"===i)return s;throw new e.ParseError({message:`Unknown body type '${i}'`,name:"Error"},t)}catch(i){throw new e.ParseError(i,t)}},ed}(),c=dc,u=Ep(),l=Hp(),p=zp(),d=["request","response","redirect","uploadProgress","downloadProgress"];e.default=function e(t){let i,h;const m=new n.EventEmitter,f=new s(((n,s,g)=>{const v=x=>{const y=new c.default(void 0,t);y.retryCount=x,y._noPipe=!0,g((()=>y.destroy())),g.shouldReject=!1,g((()=>s(new r.CancelError(y)))),i=y,y.once("response",(async t=>{var i;if(t.retryCount=x,t.request.aborted)return;let o;try{o=await l.default(y),t.rawBody=o}catch(e){return}if(y._isAboutToError)return;const s=(null!==(i=t.headers["content-encoding"])&&void 0!==i?i:"").toLowerCase(),u=["gzip","deflate","br"].includes(s),{options:d}=y;if(u&&!d.decompress)t.body=o;else try{t.body=a.default(t,d.responseType,d.parseJson,d.encoding)}catch(e){if(t.body=o.toString(),p.isResponseOk(t))return void y._beforeError(e)}try{for(const[i,n]of d.hooks.afterResponse.entries())t=await n(t,(async t=>{const n=c.default.normalizeArguments(void 0,{...t,retry:{calculateDelay:()=>0},throwHttpErrors:!1,resolveBodyOnly:!1},d);n.hooks.afterResponse=n.hooks.afterResponse.slice(0,i);for(const e of n.hooks.beforeRetry)await e(n);const o=e(n);return g((()=>{o.catch((()=>{})),o.cancel()})),o}))}catch(e){return void y._beforeError(new r.RequestError(e.message,e,y))}h=t,p.isResponseOk(t)?n(y.options.resolveBodyOnly?t.body:t):y._beforeError(new r.HTTPError(t))}));const b=e=>{if(f.isCanceled)return;const{options:t}=y;if(e instanceof r.HTTPError&&!t.throwHttpErrors){const{response:t}=e;n(y.options.resolveBodyOnly?t.body:t)}else s(e)};y.once("error",b);const w=y.options.body;y.once("retry",((e,t)=>{var i,n;w===(null===(i=t.request)||void 0===i?void 0:i.options.body)&&o.default.nodeStream(null===(n=t.request)||void 0===n?void 0:n.options.body)?b(t):v(e)})),u.default(y,m,d)};v(0)}));f.on=(e,t)=>(m.on(e,t),f);const g=e=>{const t=(async()=>{await f;const{options:t}=h.request;return a.default(h,e,t.parseJson,t.encoding)})();return Object.defineProperties(t,Object.getOwnPropertyDescriptors(f)),t};return f.json=()=>{const{headers:e}=i.options;return i.writableFinished||void 0!==e.accept||(e.accept="application/json"),g("json")},f.buffer=()=>g("buffer"),f.text=()=>g("text"),f},i(Xp(),e)}(uc)),uc}var id={};Object.defineProperty(id,"__esModule",{value:!0});const nd=Xp();id.default=function(e,...t){const i=(async()=>{if(e instanceof nd.RequestError)try{for(const i of t)if(i)for(const t of i)e=await t(e)}catch(t){e=t}throw e})(),n=()=>i;return i.json=n,i.text=n,i.buffer=n,i.on=n,i};var od={};Object.defineProperty(od,"__esModule",{value:!0});const sd=ac.exports;od.default=function e(t){for(const i of Object.values(t))(sd.default.plainObject(i)||sd.default.array(i))&&e(i);return Object.freeze(t)};var rd,ad={};!function(e){var t=q&&q.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),i=q&&q.__exportStar||function(e,i){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(i,n)||t(i,e,n)};Object.defineProperty(e,"__esModule",{value:!0}),e.defaultHandler=void 0;const n=ac.exports,o=td(),s=id,r=dc,a=od,c={RequestError:o.RequestError,CacheError:o.CacheError,ReadError:o.ReadError,HTTPError:o.HTTPError,MaxRedirectsError:o.MaxRedirectsError,TimeoutError:o.TimeoutError,ParseError:o.ParseError,CancelError:o.CancelError,UnsupportedProtocolError:o.UnsupportedProtocolError,UploadError:o.UploadError},u=async e=>new Promise((t=>{setTimeout(t,e)})),{normalizeArguments:l}=r.default,p=(...e)=>{let t;for(const i of e)t=l(void 0,i,t);return t},d=e=>e.isStream?new r.default(void 0,e):o.default(e),h=e=>"defaults"in e&&"options"in e.defaults,m=["get","post","put","patch","head","delete"];e.defaultHandler=(e,t)=>t(e);const f=(e,t)=>{if(e)for(const i of e)i(t)},g=t=>{t._rawHandlers=t.handlers,t.handlers=t.handlers.map((e=>(t,i)=>{let n;const o=e(t,(e=>(n=i(e),n)));if(o!==n&&!t.isStream&&n){const e=o,{then:t,catch:i,finally:s}=e;Object.setPrototypeOf(e,Object.getPrototypeOf(n)),Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)),e.then=t,e.catch=i,e.finally=s}return o}));const i=(e,i={},a)=>{var c,u;let p=0;const h=e=>t.handlers[p++](e,p===t.handlers.length?d:h);if(n.default.plainObject(e)){const t={...e,...i};r.setNonEnumerableProperties([e,i],t),i=t,e=void 0}try{let n;try{f(t.options.hooks.init,i),f(null===(c=i.hooks)||void 0===c?void 0:c.init,i)}catch(e){n=e}const s=l(e,i,null!=a?a:t.options);if(s[r.kIsNormalizedAlready]=!0,n)throw new o.RequestError(n.message,n,s);return h(s)}catch(e){if(i.isStream)throw e;return s.default(e,t.options.hooks.beforeError,null===(u=i.hooks)||void 0===u?void 0:u.beforeError)}};i.extend=(...i)=>{const n=[t.options];let o,s=[...t._rawHandlers];for(const e of i)h(e)?(n.push(e.defaults.options),s.push(...e.defaults._rawHandlers),o=e.defaults.mutableDefaults):(n.push(e),"handlers"in e&&s.push(...e.handlers),o=e.mutableDefaults);return s=s.filter((t=>t!==e.defaultHandler)),0===s.length&&s.push(e.defaultHandler),g({options:p(...n),handlers:s,mutableDefaults:Boolean(o)})};const v=async function*(e,o){let s=l(e,o,t.options);s.resolveBodyOnly=!1;const r=s.pagination;if(!n.default.object(r))throw new TypeError("`options.pagination` must be implemented");const a=[];let{countLimit:c}=r,p=0;for(;p<r.requestLimit;){0!==p&&await u(r.backoff);const e=await i(void 0,void 0,s),t=await r.transform(e),n=[];for(const e of t)if(r.filter(e,a,n)){if(!r.shouldContinue(e,a,n))return;if(yield e,r.stackAllItems&&a.push(e),n.push(e),--c<=0)return}const o=r.paginate(e,a,n);if(!1===o)return;o===e.request.options?s=e.request.options:void 0!==o&&(s=l(void 0,o,s)),p++}};(i.paginate=v).all=async(e,t)=>{const i=[];for await(const n of v(e,t))i.push(n);return i},i.paginate.each=v,i.stream=(e,t)=>i(e,{...t,isStream:!0});for(const e of m)i[e]=(t,n)=>i(t,{...n,method:e}),i.stream[e]=(t,n)=>i(t,{...n,method:e,isStream:!0});return Object.assign(i,c),Object.defineProperty(i,"defaults",{value:t.mutableDefaults?t:a.default(t),writable:t.mutableDefaults,configurable:t.mutableDefaults,enumerable:!0}),i.mergeOptions=p,i};e.default=g,i((rd||(rd=1,Object.defineProperty(ad,"__esModule",{value:!0})),ad),e)}(rc),function(e,t){var i=q&&q.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),n=q&&q.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0});const o=S.default,s=rc,r={options:{method:"GET",retry:{limit:2,methods:["GET","PUT","HEAD","DELETE","OPTIONS","TRACE"],statusCodes:[408,413,429,500,502,503,504,521,522,524],errorCodes:["ETIMEDOUT","ECONNRESET","EADDRINUSE","ECONNREFUSED","EPIPE","ENOTFOUND","ENETUNREACH","EAI_AGAIN"],maxRetryAfter:void 0,calculateDelay:({computedValue:e})=>e},timeout:{},headers:{"user-agent":"got (https://github.com/sindresorhus/got)"},hooks:{init:[],beforeRequest:[],beforeRedirect:[],beforeRetry:[],beforeError:[],afterResponse:[]},cache:void 0,dnsCache:void 0,decompress:!0,throwHttpErrors:!0,followRedirect:!0,isStream:!1,responseType:"text",resolveBodyOnly:!1,maxRedirects:10,prefixUrl:"",methodRewriting:!0,ignoreInvalidCookies:!1,context:{},http2:!1,allowGetBody:!1,https:void 0,pagination:{transform:e=>"json"===e.request.options.responseType?e.body:JSON.parse(e.body),paginate:e=>{if(!Reflect.has(e.headers,"link"))return!1;const t=e.headers.link.split(",");let i;for(const e of t){const t=e.split(";");if(t[1].includes("next")){i=t[0].trimStart().trim(),i=i.slice(1,-1);break}}if(i){return{url:new o.URL(i)}}return!1},filter:()=>!0,shouldContinue:()=>!0,countLimit:1/0,backoff:0,requestLimit:1e4,stackAllItems:!0},parseJson:e=>JSON.parse(e),stringifyJson:e=>JSON.stringify(e),cacheOptions:{}},handlers:[s.defaultHandler],mutableDefaults:!1},a=s.default(r);t.default=a,e.exports=a,e.exports.default=a,e.exports.__esModule=!0,n(rc,t),n(td(),t)}(sc,sc.exports);var cd=M(sc.exports);const ud=(e,t)=>{const{isTransformResponse:i,isReturnNativeResponse:n}=t;if(n)return e;if(!1===i)return e.body;const{body:o}=e;if(t.isJsonp&&Ks(o))return nr(o);try{if(Ks(o)&&o.startsWith("{"))return JSON.parse(o)}catch{}return o};class ld{name="VGot";constructor(e){e.baseURL&&(e.prefixUrl=e.baseURL),this.options=e,this.gotInstance=cd.extend(e,{hooks:{afterResponse:[e=>{const{requestOptions:t}=e.request.options;var i;null!=t&&t.withBiliCookie&&(Pa.COOKIE=Aa(Pa.COOKIE,(null===(i=e.headers)||void 0===i?void 0:i["set-cookie"])||[]));return e}]}})}request(e){const{requestOptions:t={},headers:i={}}=this.options;return e.requestOptions=Object.assign({},t,e.requestOptions),e.headers=fr(i,e.headers),t.withBiliCookie&&(e.headers.Cookie=Pa.COOKIE),t.retry&&(e.retry=t.retry),e=function(e){Ks(e.url)||(e.url=e.url.toString()),Vs(e.params)&&!Ks(e.searchParams)&&(e.searchParams={...e.searchParams,...e.params});const t=e.headers["content-type"],i=null==t?void 0:t.startsWith("application/x-www-form-urlencoded");function n(t){e.agent||(e.agent={}),e.agent[t]=e[`${t}Agent`]}return Vs(e.data)&&(i?e.body=hr(e.data):e.json=e.data),Ks(e.data)&&i&&(e.body=e.data),e.httpAgent&&n("http"),e.httpsAgent&&n("https"),e.url&&e.url.startsWith("/")&&(e.url=e.url.substring(1)),e}(e),new Promise(((t,i)=>{this.gotInstance(e).then((n=>{if(Qs(ud))try{const i=ud(n,e.requestOptions);t(i)}catch(e){i(e||new Error("è¯·æ±éè¯¯!"))}else t(n)})).catch((e=>{e.response&&(e.response.status=e.response.statusCode),i(e)}))}))}get(e,t){return Ks(e)?this.request({...t,method:"GET",url:e}):this.request({...e,method:"GET"})}post(e,t,i){return Ks(e)?this.request({...i,method:"POST",url:e,data:t}):this.request({...e,method:"POST"})}put(e,t,i){return this.request({...i,method:"PUT",url:e,data:t})}delete(e,t,i){return this.request({...i,method:"DELETE",url:e,data:t})}patch(e,t,i){return this.request({...i,method:"PATCH",url:e,data:t})}}function pd(e){return new ld(dr({timeout:1e4,headers:{"content-type":nc["content-type"],"user-agent":nc["user-agent"],"accept-language":nc["accept-language"],"accept-encoding":nc["accept-encoding"]},requestOptions:{isTransformResponse:!0,ignoreCancelToken:!0,withBiliCookie:!0}},e||{}))}const dd=pd({requestOptions:{withBiliCookie:!1}}),hd=pd();let md={};function fd(){const e=Pa.message||{};md=function(e={}){return md.SCKEY="",md.BARK_PUSH="",md.BARK_SOUND="",md.BARK_GROUP="QingLong",md.TG_BOT_TOKEN="",md.TG_USER_ID="",md.TG_PROXY_HOST="",md.TG_PROXY_PORT="",md.TG_PROXY_AUTH="",md.TG_API_HOST="api.telegram.org",md.DD_BOT_TOKEN="",md.DD_BOT_SECRET="",md.QYWX_KEY="",md.QYWX_AM="",md.IGOT_PUSH_KEY="",md.PUSH_PLUS_TOKEN="",md.PUSH_PLUS_USER="",md.QQ_SKEY="",md.QQ_MODE="",e}(md),["GOBOT_URL","GOBOT_TOKEN","GOBOT_QQ","SCKEY","QQ_SKEY","QQ_MODE","BARK_PUSH","BARK_SOUND","BARK_GROUP","TG_BOT_TOKEN","TG_USER_ID","TG_PROXY_AUTH","TG_PROXY_HOST","TG_PROXY_PORT","TG_API_HOST","DD_BOT_TOKEN","DD_BOT_SECRET","QYWX_KEY","QYWX_AM","IGOT_PUSH_KEY","PUSH_PLUS_TOKEN","PUSH_PLUS_USER"].forEach((t=>{const i=e[(n=t,n.toLowerCase().replace(/_(\w)/g,((e,t)=>t.toUpperCase())))]||e[t]||process.env[t];var n;i&&(md[t]=i)})),Pa.PUSHPLUS_TOKEN&&(md.PUSH_PLUS_TOKEN=Pa.PUSHPLUS_TOKEN)}async function gd(e,t){var i;const n=null===(i=Pa.message)||void 0===i?void 0:i.email;if(!(n&&n.pass&&n.from&&n.host))return;const{createTransport:o}=await Promise.resolve().then((function(){return by})),s=Number(n.port)||465,r=o({host:n.host,port:s,secure:465===s,auth:{user:n.from,pass:n.pass}}),a=await r.sendMail({from:`${e} <${n.from}>`,to:n.to,subject:e,headers:{"Content-Type":"text/plain; charset=utf-8"},text:t.replace(/\n/g,"\r\n")});wr.info(`é®ä»¶æ¶æ¯å·²åé: ${a.messageId}`)}async function vd(e,t){try{const i=Pa.message.api;if(!i||!i.url)return;const{data:n,proxy:o,timeout:s,headers:r}=i,a={method:i.method.toUpperCase()||"POST",timeout:s,headers:r,url:""};if(a.url=i.url.replace("{title}",encodeURIComponent(e)).replace("{text}",encodeURIComponent(t)),o.host){const e=(await Promise.resolve().then((function(){return Oy}))).httpsOverHttp({proxy:{host:o.host,port:+o.port,proxyAuth:o.auth},maxSockets:1});Object.assign(a,{httpsAgent:e})}const c=Object.keys(n);c.length&&(c.forEach((i=>{"{text}"===n[i]&&(n[i]=t),"{title}"===n[i]&&(n[i]=e)})),Object.assign(a,{data:n})),await dd.request(a),wr.info("èªå®ä¹æ¥å£æ¶æ¯å·²åéï¼")}catch(e){wr.info(`èªå®ä¹æ¥å£æ¶æ¯åéå¤±è´¥: ${e}`),wr.error(e)}}function xd(e,t,i=2100){return new Promise((n=>{const o=md.SCKEY;if(o){t=t.replace(/[\n\r]/g,"\n\n");const s={url:o.includes("SCT")?`https://sctapi.ftqq.com/${o}.send`:`https://sc.ftqq.com/${o}.send`,data:`text=${e}&desp=${t}`,headers:{"Content-Type":"application/x-www-form-urlencoded"},timeout:15e3};setTimeout((()=>{dd.post(s).then((e=>{0===e.errno||0===e.data.errno?wr.info("serveré±åééç¥æ¶æ¯æåð"):1024===e.errno?wr.info(`serveré±åééç¥æ¶æ¯å¼å¸¸: ${e.errmsg}`):wr.info(`serveré±åééç¥æ¶æ¯å¼å¸¸\n${JSON.stringify(e)}`)})).catch((e=>{wr.info("serveré±åééç¥è°ç¨APIå¤±è´¥ï¼ï¼"),wr.info(e)})).finally((()=>{n("")}))}),i)}else n("")}))}function yd(e,t){return new Promise((i=>{const{QQ_SKEY:n,QQ_MODE:o}=md;if(n){const s={url:`https://push.xuthus.cc/${o}/${n}`,headers:{"Content-Type":"application/json"},data:{},params:{}};e=e.replace(/äº¬è±/g,"è±è±"),t=(t=(t=t.replace(/äº¬è±/g,"")).replace(/ð¶/g,"")).replace(/çº¢å/g,"Hå"),s.data="email"===o?{t:e,c:t}:`${e}\n\n${t}`;const r=function(e){switch(e){case"send":return"ä¸ªäºº";case"group":return"QQç¾¤";case"wx":return"å¾®ä¿¡";case"ww":return"ä¼ä¸å¾®ä¿¡";case"email":return"é®ä»¶";default:return"æªç¥æ¹å¼"}};dd.post(s).then((e=>{200===e.code?wr.info(`é·æ¨åé${r(o)}éç¥æ¶æ¯æåð`):400===e.code?wr.info(`QQé·æ¨(Cool Push)åé${r(o)}æ¨éå¤±è´¥ï¼${e.msg}`):503===e.code?wr.info(`QQé·æ¨åºéï¼${e.message}ï¼${e.data}`):wr.info(`é·æ¨æ¨éå¼å¸¸: ${JSON.stringify(e)}`)})).catch((e=>{wr.info(`åé${r(o)}éç¥è°ç¨APIå¤±è´¥ï¼ï¼`),wr.info(e)})).finally((()=>{i("")}))}else i("")}))}function bd(e,t,i={}){return new Promise((n=>{const{BARK_PUSH:o,BARK_SOUND:s,BARK_GROUP:r}=md;if(o){const a={url:`${o}/${encodeURIComponent(e)}/${encodeURIComponent(t)}?sound=${s}&group=${r}&${hr(i)}`,headers:{"Content-Type":"application/x-www-form-urlencoded"},timeout:15e3};dd.get(a).then((e=>{200===e.code?wr.info("Bark APPåééç¥æ¶æ¯æåð"):wr.info(`Bark APPåééå¤±è´¥ï¼${e.message}`)})).catch((e=>{wr.info("Bark APPåééç¥è°ç¨APIå¤±è´¥ï¼ï¼"),wr.error(e)})).finally((()=>{n("")}))}n("")}))}function wd(e,t){return new Promise((async i=>{const{TG_BOT_TOKEN:n,TG_USER_ID:o,TG_API_HOST:s,TG_PROXY_HOST:r,TG_PROXY_PORT:a,TG_PROXY_AUTH:c}=md;if(n&&o){const u={url:`https://${s}/bot${n}/sendMessage`,data:`chat_id=${o}&text=${e}\n\n${t}&disable_web_page_preview=true`,headers:{"Content-Type":"application/x-www-form-urlencoded"},timeout:15e3};if(r&&a){const e=(await Promise.resolve().then((function(){return Oy}))).httpsOverHttp({proxy:{host:r,port:+a,proxyAuth:c},maxSockets:1});Object.assign(u,{httpsAgent:e})}dd.post(u).then((e=>{e.ok?wr.info("Telegramåééç¥æ¶æ¯æåðã"):400===e.error_code?wr.info("è¯·ä¸»å¨ç»botåéä¸æ¡æ¶æ¯å¹¶æ£æ¥æ¥æ¶ç¨æ·IDæ¯å¦æ­£ç¡®ã"):401===e.error_code&&wr.info("Telegram bot token å¡«åéè¯¯ã")})).catch((e=>{wr.info("telegramåééç¥æ¶æ¯å¤±è´¥ï¼ï¼"),wr.info(e)})).finally((()=>{i("")}))}else i("")}))}function _d(e,t){return new Promise((i=>{const{DD_BOT_TOKEN:n,DD_BOT_SECRET:o}=md,s={url:`https://oapi.dingtalk.com/robot/send?access_token=${n}`,data:{msgtype:"text",text:{content:` ${e}\n\n${t}`}},headers:{"Content-Type":"application/json"},timeout:15e3};if(n){if(o){const e=require("crypto"),t=Date.now(),i=e.createHmac("sha256",o);i.update(`${t}\n${o}`);const n=encodeURIComponent(i.digest("base64"));s.url=`${s.url}&timestamp=${t}&sign=${n}`}dd.post(s).then((e=>{0===e.errcode?wr.info("ééåééç¥æ¶æ¯æåðã"):wr.info(`ééåééç¥å¤±è´¥ï¼${e.errmsg}`)})).catch((e=>{wr.info("ééåééç¥æ¶æ¯å¤±è´¥ï¼ï¼"),wr.info(e)})),i("")}else i("")}))}function Dd(e,t){return new Promise((i=>{const{QYWX_KEY:n}=md,o={url:`https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=${n}`,data:{msgtype:"text",text:{content:` ${e}\n\n${t}`}},headers:{"Content-Type":"application/json"},timeout:15e3};n&&dd.post(o).then((e=>{0===e.errcode?wr.info("ä¼ä¸å¾®ä¿¡åééç¥æ¶æ¯æåðã"):wr.info(`ä¼ä¸å¾®ä¿¡åééç¥å¤±è´¥ï¼${e.errmsg}`)})).catch((e=>{wr.info("ä¼ä¸å¾®ä¿¡åééç¥æ¶æ¯å¤±è´¥ï¼ï¼"),wr.info(e)})).finally((()=>{i("")})),i("")}))}function Ed(e){const{QYWX_AM:t}=md,i=null==t?void 0:t.split(",");if(i[2]){const t=i[2].split("|");let n="";for(let i=0;i<t.length;i++){const o="ç­¾å°å· "+(i+1);e.match(o)&&(n=t[i])}return n||(n=i[2]),n}return"@all"}function Cd(e,t){return new Promise((i=>{const n=md.QYWX_AM;if(n){const o=n.split(","),s={url:"https://qyapi.weixin.qq.com/cgi-bin/gettoken",data:{corpid:`${o[0]}`,corpsecret:`${o[1]}`},headers:{"Content-Type":"application/json"},timeout:15e3};dd.post(s).then((n=>{const s=t.replace(/\n/g,"<br/>"),r=JSON.parse(n).access_token;let a;switch(o[4]){case"0":a={msgtype:"textcard",textcard:{title:`${e}`,description:`${t}`,url:"https://github.com/whyour/qinglong",btntxt:"æ´å¤"}};break;case"1":a={msgtype:"text",text:{content:`${e}\n\n${t}`}};break;default:a={msgtype:"mpnews",mpnews:{articles:[{title:`${e}`,thumb_media_id:`${o[4]}`,author:"æºè½å©æ",content_source_url:"",content:`${s}`,digest:`${t}`}]}}}o[4]||(a={msgtype:"text",text:{content:`${e}\n\n${t}`}}),a={url:`https://qyapi.weixin.qq.com/cgi-bin/message/send?access_token=${r}`,data:{touser:`${Ed(t)}`,agentid:`${o[3]}`,safe:"0",...a},headers:{"Content-Type":"application/json"}},dd.post(a).then((e=>{0===e.errcode?wr.info("æåID:"+Ed(t)+"ä¼ä¸å¾®ä¿¡åºç¨æ¶æ¯åééç¥æ¶æ¯æåðã"):wr.info(`ä¼ä¸å¾®ä¿¡åºç¨ï¼${e.errmsg}`)})).catch((e=>{wr.info("æåID:"+Ed(t)+"ä¼ä¸å¾®ä¿¡åºç¨æ¶æ¯åééç¥æ¶æ¯å¤±è´¥ï¼ï¼"),wr.info(e)})).finally((()=>{i("")}))})).catch((e=>{wr.error("ä¼ä¸å¾®ä¿¡åºç¨æ¶æ¯åééç¥æ¶æ¯å¤±è´¥ï¼ï¼")}))}else i("")}))}function Ad(e,t,i={}){return new Promise((n=>{const{IGOT_PUSH_KEY:o}=md;if(o){if(!new RegExp("^[a-zA-Z0-9]{24}$").test(o))return wr.info("æ¨ææä¾çIGOT_PUSH_KEYæ æ"),void n("");const s={url:`https://push.hellyw.com/${o.toLowerCase()}`,data:`title=${e}&content=${t}&${hr(i)}`,headers:{"Content-Type":"application/x-www-form-urlencoded"},timeout:15e3};dd.post(s).then((e=>{"string"==typeof e&&(e=JSON.parse(e)),0===e.ret?wr.info("iGotåééç¥æ¶æ¯æåð"):wr.info(`iGotåééç¥æ¶æ¯å¤±è´¥ï¼${e.errMsg}`)})).catch((e=>{wr.info("iGotåééç¥è°ç¨APIå¤±è´¥ï¼ï¼"),wr.info(e)})).finally((()=>{n("")}))}else n("")}))}function kd(e,t){return new Promise((i=>{const{PUSH_PLUS_TOKEN:n,PUSH_PLUS_USER:o}=md;if(n){t=t.replace(/[\n\r]/g,"<br>");const s={url:"https://www.pushplus.plus/send",data:{token:`${n}`,title:`${e}`,content:`${t}`,topic:`${o}`},headers:{"Content-Type":" application/json"},timeout:15e3};dd.post(s).then((e=>{200===e.code?wr.info(`push+åé${o?"ä¸å¯¹å¤":"ä¸å¯¹ä¸"}éç¥æ¶æ¯å®æã`):wr.info(`push+åé${o?"ä¸å¯¹å¤":"ä¸å¯¹ä¸"}éç¥æ¶æ¯å¤±è´¥ï¼${e.msg}`)})).catch((e=>{wr.info(`push+åé${o?"ä¸å¯¹å¤":"ä¸å¯¹ä¸"}éç¥æ¶æ¯å¤±è´¥ï¼ï¼`),wr.info(e)})).finally((()=>{i("")}))}else i("")}))}var Sd=Object.freeze({__proto__:null,sendMessage:async function(e,t){wr.info("----ãæ¶æ¯æ¨éã----"),e=`Bili-${La.nickname||Pa.USERID}-${e}`,await async function(e,t,i={},n="\n\næ¬éç¥ Byï¼https://github.com/KudouRan/BiliTools"){fd(),t+=n,await Promise.all([xd(e,t),kd(e,t)]),await Promise.all([bd(e,t,i),wd(e,t),_d(e,t),Dd(e,t),Cd(e,t),Ad(e,t,i),gd(e,t),vd(e,t),yd(e,t)])}(e,t,void 0,"")}});const Fd=pd({baseURL:Xa,headers:{"user-agent":Pa.USER_AGENT}}),Td=pd({baseURL:Ya,headers:{Referer:Qa,"user-agent":Pa.USER_AGENT}}),Bd=pd({baseURL:Za,headers:{Referer:Qa,"user-agent":Pa.USER_AGENT}}),Od=pd({baseURL:ec,headers:{"user-agent":Pa.USER_AGENT}}),jd=pd({baseURL:tc,headers:{"user-agent":Pa.USER_AGENT}}),Id=pd({baseURL:ic,headers:{"user-agent":Pa.USER_AGENT}});function Pd(e=1,t=50,i=1){return Td.get(`/xlive/app-ucenter/v1/fansMedal/panel?page=${e}&page_size=${t}&target_id=${i}`)}function Ld({ruid:e,gift_num:t,bag_id:i,gift_id:n,roomid:o}){const s=Pa.BILIJCT,r=s,a={gift_id:n,ruid:e,gift_num:t,bag_id:i,biz_id:o,rnd:(new Date).getTime(),send_ruid:0,storm_beat_id:0,metadata:"",price:0,visit_id:"",csrf:s,platform:"pc",biz_code:"Live",csrf_token:r,uid:Pa.USERID};return Td.post("/xlive/revenue/v2/gift/sendBag",a,{headers:{Origin:Va}})}function Rd(e){return Td.get(`/xlive/lottery-interface/v1/Anchor/Check?roomid=${e}`)}function Nd(){return Bd.get("/x/web-interface/nav",{headers:{Origin:Ga}})}function $d(){return Bd.get("/x/web-interface/coin/today/exp")}function Hd(e=1,t=50,i=-10){return Bd.get("/x/relation/tag",{params:{tagid:i,pn:e,ps:t}})}function Ud(e,t){return Bd.post("/x/relation/tags/addUsers?cross_domain=true",{fids:e,tagids:t,csrf:Pa.BILIJCT},{headers:{Origin:Wa}})}function qd(e){const t=e.level_info,i=t.current_level;if(i>=Pa.BILI_TARGET_LEVEL&&(La.coinsTask=0),wr.info(`å½åç­çº§: ${t.current_level}`),i>=6){const e=Pa.function;e.shareAndWatch=!1,e.addCoins=!1,e.taskReward=!1,wr.info("å·²ç»æ»¡çº§ï¼ä¸éè¦åæå¸äºï¼åä¸ªç½å«æªå§")}else{const e=t.next_exp-t.current_exp;wr.info(`è·ç¦»åçº§è¿éè¦ ${e} ç»éªï¼é¢è®¡ ${function(e){if(Pa.BILI_TARGET_COINS<=0)return e/15;const t=10*Pa.BILI_TARGET_COINS+15,i=e/t,n=La.money/(Pa.BILI_TARGET_COINS-1);return i<n?Math.floor(i):(e-n*t)/25+n}(e).toFixed(2)} å¤©`)}}async function Md(e){try{var t;const{data:i}=await Fd.get("/site/getCoin");wr.info(`ç»å½æå: ${e.uname}`),wr.info(`ç¡¬å¸ä½é¢: ${i.money||0}`),La.nickname=function(e){const t=e.length;return t<=3?e:`${e[0]}**${e[t-1]}`}(e.uname),La.money=i.money||0,La.userLevel=e.level_info.current_level,La.bCoinCouponBalance=(null===(t=e.wallet)||void 0===t?void 0:t.coupon_balance)||0,qd(e),function(e){let t="";switch(La.vipType=e.vipType,La.vipStatus=e.vipStatus,e.vipType){case 0:t="æ å¤§ä¼å";break;case 1:t="æåº¦å¤§ä¼å";break;case 2:t="å¹´åº¦å¤§ä¼å"}0===e.vipStatus&&(t="æ å¤§ä¼å"===t?t:t+"[å·²è¿æ]"),wr.info(`å¤§ä¼åç¶æ: ${t}`)}(e)}catch(e){wr.error(`è·åç¡¬å¸ä¿¡æ¯å¼å¸¸: ${e.message}`),wr.debug(e)}}function zd(e,t,i=1){return Bd.post("/x/web-interface/coin/add",{aid:e,multiply:t,selectLike:i,csrf:Pa.BILIJCT})}function Gd(e,t=1){return hd.post("https://www.bilibili.com/audio/music-service-c/web/coin/add",{sid:e,multiply:t,csrf:Pa.BILIJCT})}const Vd="video",Wd="audio",Jd="article";async function Kd(e=!0){try{const t=Pa.USERID,{data:i,message:n,code:o}=await(e?function(e=1,t=50){return Hd(e,t,-10)}():function(e,t=1,i=50,n="desc",o="attention"){return Bd.get("/x/relation/followings",{params:{vmid:e,pn:t,ps:i,order:n,order_type:o}})}(t)),s=e?i:i.list;if(!s||0===s.length)return{msg:"-1",data:{}};if(0===o){await Ha();const{mid:e}=mr(s)||{};return await Yd(e)}return{msg:e?`æªè·åå°ç¹å«å³æ³¨åè¡¨: ${o}-${n}`:`æªè·åå°å³æ³¨åè¡¨: ${o}-${n}`,data:{}}}catch(e){return{msg:e.message,data:{}}}}async function Qd(){const e=mr([1,3,4,5,160,22,119]);try{const{data:t,message:i,code:n}=await function(e=1,t=3){return Bd.get("/x/web-interface/ranking/region",{params:{rid:e,day:t}})}(e,3);if(0==n){const{aid:e,title:i,author:n}=mr(t);return{msg:"0",data:{id:Number(e),title:i,author:n}}}return{msg:`æªè·åå°æè¡ä¿¡æ¯: ${n}-${i}`,data:{}}}catch(e){return{msg:e.message,data:{}}}}async function Xd(){const e=Pa.BILI_CUSTOMIZE_UP;return 0===e.length?{msg:"-1",data:{}}:await Yd(mr(e))}async function Yd(e){try{const{code:t,data:i,message:n}=await function(e){return Bd.get(`/x/space/navnum?mid=${e}`)}(e);if(t)return{msg:`éè¿uidè·åè§é¢å¤±è´¥: ${t}-${n}`,data:{}};await Ha();const{video:o,audio:s,article:r}=i,{type:a,page:c,index:u}=function([e,t,i]){const n=e+t+i;if(!n)return;const o=sr(0,n-1);let s=o;if(o<e)return{type:Vd,page:or(30,s+1),index:s%30};const r=e+t;return s=o-e,o<r?{type:Wd,page:or(30,s+1),index:s%30}:(s=o-r,{type:Jd,page:or(12,s+1),index:s%12})}([o,s,r]),l={[Vd]:Zd,[Wd]:eh,[Jd]:th},p=await l[a](e,c,u);return p.message?{msg:p.message,data:{}}:{msg:"0",data:p}}catch(e){return wr.debug(e),{msg:e.message,data:{}}}}async function Zd(e,t,i){const{code:n,data:o,message:s}=await function(e,t=30,i=1,n=""){return Bd.get("/x/space/arc/search",{params:{jsonp:"jsonp",order:"pubdate",keyword:n,pn:i,tid:0,ps:t,mid:e}})}(e,30,t);if(n)return{message:s};const{aid:r,title:a,author:c}=o.list.vlist[i];return{type:Vd,id:r,title:a,author:c}}async function eh(e,t,i){const{code:n,data:o,msg:s}=await function(e,t=30,i=1){return Bd.get("/audio/music-service/web/song/upper",{params:{jsonp:"jsonp",order:1,pn:i,ps:t,uid:e}})}(e,30,t);if(n)return{message:s};const{data:r}=o,{id:a,uname:c,title:u}=r[i];return{type:Wd,id:a,title:u,author:c}}async function th(e,t,i){const{code:n,data:o,message:s}=await function(e,t=12,i=1){return Bd.get("/x/space/article",{params:{callback:"__test",jsonp:"jsonp",sort:"publish_time",pn:i,ps:t,mid:e},requestOptions:{isJsonp:!0}})}(e,12,t);if(n)return{message:s};const{articles:r}=o,{id:a,title:c,author:{name:u}}=r[i];return{type:Jd,id:a,title:c,author:u,mid:e}}const ih=function(){const e=[Xd,Kd,()=>Kd(!1),Qd];return Pa.BILI_CUSTOMIZE_UP||e.shift(),e}();async function nh(e=0){ih.splice(0,La.currentStartFun+e);for(let e=0;e<ih.length;e++){const t=ih[e];let i=Number(Pa.BILI_COIN_RETRY_NUM??4);for(i=i<1?1:i>8?8:i;i--;){await Ha();const e=await t();if("-1"===e.msg&&(i=0),"0"===e.msg)return e}i<=0&&(La.currentStartFun=e)}return{msg:"-1",data:{id:0}}}async function oh({id:e,coin:t=1,type:i="video",mid:n}){const o={[Vd]:zd,[Wd]:Gd,[Jd]:(e,t=1)=>function(e,t,i=1){return Bd.post("/x/web-interface/coin/add",{aid:t,upid:e,avtype:2,multiply:i,csrf:Pa.BILIJCT})}(n,e,t)},s=await o[i](Number(e),t);return{code:s.code,message:s.message||s.msg}}async function sh(e){if(await async function(){try{const{data:e,code:t}=await $d();if(0==t){const t=Pa.BILI_TARGET_COINS-e/10;La.coinsTask=t>0?t:0}}catch(e){}}(),La.coinsTask<=0||La.money<=0)return!0;const{data:t,msg:i}=await nh(e.priority);return null!=t&&t.id&&"0"==i?(await Ha(),await async function(e,t){const{id:i,title:n,author:o,type:s,mid:r}=e;try{const e=await oh({id:i,type:s,mid:r});if(0===e.code)La.money--,La.coinsTask--,t.num++,wr.info(`ç»[${n}--upã${o}ã]æå¸æå`);else if(34005===e.code)t.fillCount++,wr.verbose(`å½åç¨¿ä»¶[${i}]ä¸è½åæå¸äº`),t.fillCount>=3&&(wr.warn("èªå®ä¹ç¨æ·ç»æå¸ä¼¼ä¹æ²¡æå¸å¯æäº"),t.priority++);else{if(-111===e.code||-104===e.code)return wr.warn(`${i} ${e.message} æ æ³ç»§ç»­è¿è¡æå¸`),!0;if(t.eCount++,wr.warn(`ç»${i}æå¸å¤±è´¥ ${e.code} ${e.message}`),t.prevCode===e.code)return!0;t.prevCode=e.code}}catch(e){t.eCount++,wr.error(`æå¸å¼å¸¸ ${e.message}`)}finally{await Ha(1500)}return!1}(t,e)):(e.eCount++,!1)}let rh;async function ah(){rh=0;try{const{code:e,msg:t,data:i}=await function(e=1,t=50){return Od.post("twirp/user.v1.User/GetCoupons?platform=web",{not_expired:!0,page_num:e,page_size:t,tab_type:1})}();if(0!==e)return void wr.error(`è·åæ¼«è¯»å¸å¤±è´¥ï¼${e} ${t}`);const{user_coupons:n}=i;if(0===n.length)return void wr.info("æ²¡ææ¼«è¯»å¸ï¼è·³è¿ä»»å¡");const o=n.filter((e=>0!==e.will_expire));return rh=o.reduce(((e,t)=>e+t.remain_amount),0),rh}catch(e){wr.error(`è·åæ¼«è¯»å¸å¼å¸¸: ${e}`)}}async function ch(){try{const{code:e,msg:t,data:i}=await function(e=1,t=50,i=1){return Od.post("twirp/bookshelf.v1.Bookshelf/ListFavorite?platform=web",{page_num:e,page_size:t,order:i,wait_free:0})}();if(0===e)return i;wr.error(`è·åè¿½æ¼«åè¡¨å¤±è´¥ï¼${e} ${t}`)}catch(e){wr.error(`è·åè¿½æ¼«åè¡¨å¼å¸¸: ${e}`)}}async function uh(e){try{const{code:t,msg:i,data:n}=await function(e){return Od.post("twirp/comic.v1.Comic/ComicDetail",{device:"android",version:"4.16.0",comic_id:e})}(e);if(0!==t)return void wr.error(`è·åæ¼«ç»è¯¦æå¤±è´¥ï¼${t} ${i}`);if(!n||!n.ep_list)return;let o=n.ep_list;return 0!==n.disable_coupon_amount&&(o=o.slice(0,o.length-n.disable_coupon_amount)),o.filter((e=>e.is_locked))}catch(e){wr.error(`è·åæ¼«ç»è¯¦æå¼å¸¸: ${e}`)}}async function lh(e){try{const{code:t,msg:i,data:n}=await function(e){return Od.post("twirp/comic.v1.Comic/GetEpisodeBuyInfo?platform=web",{ep_id:e})}(e);if(0!==t)return void wr.error(`è·åè´­ä¹°ä¿¡æ¯å¤±è´¥ï¼${t} ${i}`);if(!n)return;if(!n.allow_coupon)return void wr.info("æ¼«ç»ä¸æ¯ææ¼«è¯»å¸");if(0===n.recommend_coupon_id||0===n.remain_coupon)return rh=0,void wr.info("æ²¡æè¶³å¤çæ¼«è¯»å¸äº");if(!n.remain_lock_ep_num)return;return n.recommend_coupon_id}catch(e){wr.error(`è·åè´­ä¹°ä¿¡æ¯å¼å¸¸: ${e}`)}}async function ph(e){try{const t=await lh(e);if(!t)return!0;const{code:i,msg:n}=await function(e,t,i=2,n=0){return Od.post("twirp/comic.v1.Comic/BuyEpisode?&platform=web",{buy_method:i,ep_id:e,coupon_id:t,auto_pay_gold_status:n})}(e,t);if(0!==i)return void wr.error(`è´­ä¹°æ¼«ç»å¤±è´¥ï¼${i} ${n}`);rh--,wr.info("è´­ä¹°æ¼«ç»æå")}catch(e){wr.error(`è´­ä¹°æ¼«ç»å¼å¸¸: ${e}`)}}async function dh(e){try{const{code:t,msg:i,data:n}=await function(e,t=1,i=9){return Od.post("twirp/comic.v1.Comic/Search?device=pc&platform=web",{keyword:e,page_num:t,page_size:i})}(e);if(0===t)return n;wr.error(`æç´¢æ¼«ç»å¤±è´¥ï¼${t} ${i}`)}catch(e){wr.error(`æç´¢æ¼«ç»å¼å¸¸: ${e}`)}}async function hh(e){const t=await uh(e);if(!t||0===t.length)return!1;for(let e=0;e<t.length;e++)if(await Ha(100),await ph(t[e].id))return!0}async function mh(){rh=await ah(),rh<1?wr.info("æ²¡æå³å°è¿æçæ¼«è¯»å¸ï¼è·³è¿ä»»å¡"):(await async function(){const{mc:e}=Pa.manga;if(0!==e.length)for(let t=0;t<e.length;t++){if(rh<=0)return;const i=e[t];await hh(i)}}(),await async function(){const{name:e}=Pa.manga;if(0!==e.length)for(let t=0;t<e.length;t++){if(rh<=0)return;const i=e[t],n=await dh(i);if(!n||0===n.list.length)continue;const o=n.list.find((e=>e.title===i));o&&await hh(o.id)}}(),await async function(){const{love:e}=Pa.manga;if(!e||rh<=0)return;const t=await ch();if(t&&0!==t.length)for(let e=0;e<t.length;e++){if(rh<=0)return;const i=t[e];await hh(i.comic_id)}}())}async function fh(){try{const{code:e}=await function(e="android"){return Od.post("twirp/activity.v1.Activity/ClockIn",{platform:e})}();0==e?wr.info("æ¼«ç»ç­¾å°æå"):wr.warn("æ¼«ç»ç­¾å°å¤±è´¥")}catch(e){const{status:t,statusCode:i}=e.response||{};400===t||400===i?wr.info("å·²ç»ç­¾å°è¿äºï¼è·³è¿ä»»å¡"):wr.error(`æ¼«ç»ç­¾å°å¼å¸¸ ${e.message}`)}}async function gh(){try{const{data:e,code:t,message:i}=await jd.get("/link_group/v1/member/my_groups");return 0===t?(null==e?void 0:e.list)||[]:(wr.warn(`è·åèªå·±çåºæ´å¢å¼å¸¸å¤±è´¥: ${i}`),[])}catch(e){wr.error(`è·åèªå·±çåºæ´å¢å¼å¸¸: ${e}`)}}function vh(e){return Object.keys(e).forEach((t=>{Js(e[t])?e[t]=e[t].toString():Vs(e[t])?vh(e[t]):Xs(e[t])&&(e[t]=e[t].map((e=>Vs(e)?vh(e):e.toString())))})),e}function xh(e){let t=JSON.stringify(vh(e));const i=["SHA512","SHA3-512","SHA384","SHA3-384","BLAKE2b512"];for(const e of i)t=_.createHash(e).update(t).digest("hex");return t}const yh=["(ââ½â)","ï¼ï¿£â½ï¿£ï¼","(=ã»Ïã»=)","(ï½ã»Ïã»Â´)","(ãï¿£â³ï¿£)ã","(ï½¥âï½¥)","(Â°âÂ°)ï¾","(ï¿£3ï¿£)","â®(ï¿£â½ï¿£)â­","_(:3ãâ )_","( Â´_ãï½)","â_â","â_â","(<_<)","(>_>)","(;Â¬_Â¬)","(ï¾Ðï¾â¡ï¾Ð´ï¾)!?","Î£(ï¾Ð´ï¾;)","Î£( ï¿£â¡ï¿£||)","(Â´ï¼Ïï¼`)","ï¼/TÐT)/","(^ã»Ïã»^ )","(ï½¡ï½¥Ïï½¥ï½¡)","(âï¿£(ï½´)ï¿£â)","Îµ=Îµ=(ãâ§ââ¦)ã","(Â´ï½¥_ï½¥`)","(-_-#)","ï¼ï¿£ã¸ï¿£ï¼","(ï¿£Îµ(#ï¿£) Î£","ã½(`ÐÂ´)ï¾","ï¼#-_-)â¯ââ¯","(â¯Â°å£Â°)â¯(â´ââ´","ââ¡â","( â¥Ð´â¥)","Î£>â(ãÂ°ÏÂ°ã)â¡â","â(â ââ¢âÏââ¢â â)â","(â¬ï¾Ð´ï¾)âï¸»â»â³âä¸","ï½¥*ï½¥:â¡(ãÎµ:)","(æ±)","(è¦ç¬)"].concat("1","2","3","4","5","6","7","8","9","ç­¾å°","åå"),bh=new br({console:"debug",file:"debug",push:"warn"},"live");async function wh(){let e=99,t=0;const i=[];try{for(;t<e;){const{code:n,message:o,data:s}=await Pd(t+1,50,Pa.USERID);if(0!==n)return wr.verbose(`è·ååç« ä¿¡æ¯å¤±è´¥ ${n} ${o}`),null;if(!s)return i;e=s.page_info.total_page,t=s.page_info.current_page,i.push(...s.list,...s.special_list)}return i}catch(e){return wr.error(`è·ååç« å¼å¸¸ ${e.message}`),null}}function _h({room_info:e,medal:t}){if(null==e||!e.room_id)return!1;if(t.level>=20)return!1;if(t.today_feed>=t.day_limit)return!1;if(t.today_feed>=1300)return!1;const{whiteList:i,blackList:n}=Pa.intimacy;return i&&i.length?!(!i.includes(e.room_id)&&!i.includes(t.target_id)):!n||!n.includes(e.room_id)&&!n.includes(t.target_id)}async function Dh(e,t){const i=yh[sr(yh.length-1)];try{const{code:n,message:o}=await function(e,t){const i=Pa.BILIJCT,n=i;return t||(t=sr(10).toString()),Td.post("/msg/send",{color:5566168,fontsize:25,mode:1,msg:t,rnd:Date.now(),roomid:e,bubble:0,csrf:i,csrf_token:n})}(e,i);return 0===n||(11e3===n?(wr.warn(`ã${t}ã${e}-å¯è½æªå¼å¯è¯è®º`),!1):(wr.warn(`ã${t}ã${e}-åéå¤±è´¥ ${o}`),wr.verbose(`code: ${n}`),!1))}catch(e){wr.verbose(`åéå¼¹å¹å¼å¸¸ ${e.message}`)}}async function Eh(e){try{const{code:i,message:n,data:o}=await(t=e,Td.post("xlive/web-room/v1/index/TrigerInteract",{roomid:t,interact_type:3,csrf:Pa.BILIJCT,csrf_token:Pa.BILIJCT,visit_id:""}));if(0===i)return o;wr.info(`ã${e}ãç´æ­é´åäº«å¤±è´¥ ${i} ${n}`)}catch(t){wr.warn(`åäº«ç´æ­é´ [${e}] å¼å¸¸ ${t.message}`)}var t}async function Ch(e){try{const{code:i,message:n,data:o}=await(t=e,Td.post("xlive/web-ucenter/v1/interact/likeInteract",{roomid:t,csrf:Pa.BILIJCT,csrf_token:Pa.BILIJCT}));if(0===i)return o;wr.info(`ã${e}ãç´æ­é´ç¹èµå¤±è´¥ ${i} ${n}`)}catch(e){wr.warn(`ç¹èµç´æ­é´å¼å¸¸ ${e.message}`)}var t}async function Ah(e,t){if(!(t.value>=31))try{const{code:i,message:n}=await function({buvid:e=ar(37).toUpperCase(),gu_id:t=ar(43).toLocaleUpperCase(),visit_id:i=ar(32).toLocaleLowerCase(),uuid:n=tr(),click_id:o=tr(),room_id:s,up_id:r,uid:a,up_level:c=40,up_session:u="",parent_id:l=11,area_id:p=376}){const d={platform:"android",uuid:n,buvid:e,seq_id:"1",room_id:s,parent_id:l,area_id:p,timestamp:String(parseInt(String((new Date).getTime()/1e3))-60),secret_key:"axoaadsffcazxksectbbb",watch_time:"60",up_id:r||a,up_level:c,jump_from:"30000",gu_id:t,play_type:"0",play_url:"",s_time:"0",data_behavior_id:"",data_source_id:"",up_session:u,visit_id:i,watch_status:"",click_id:o,session_id:"-99998",player_type:"0",client_ts:String(parseInt(String((new Date).getTime()/1e3)))},h={...d,ts:parseInt(String((new Date).getTime()/1e3)),client_sign:xh(d),csrf_token:Pa.BILIJCT,csrf:Pa.BILIJCT};return Id.post("xlive/data-interface/v1/heartbeat/mobileHeartBeat",h,{headers:{"User-Agent":oc()}})}(e);if(0!==i)return void wr.warn(`ç´æ­é´å¿è·³å¤±è´¥ ${i} ${n}`);t.value++,bh.info(`ç´æ­é´å¿è·³æå ${e.uname}ï¼${t.value}/31ï¼`)}catch(e){bh.error(e),wr.error(`ç´æ­é´å¿è·³å¼å¸¸ ${e.message}`)}}async function kh(){const e=(t=await wh())&&0!==t.length?t.filter(_h):[];var t;return await Promise.allSettled([Sh(e),Fh(e)])}async function Sh(e){for(let t=0;t<e.length;t++){const i=e[t];await Th(i)}}async function Fh(e){if(0===e.length)return;const{liveHeart:t}=Pa.intimacy;return t?new Promise((t=>function(e,t){for(let e=0;e<t.length;e++){const n={value:0},o=t[e],s={value:void 0},r={buvid:ar(37).toUpperCase(),gu_id:ar(43).toLocaleUpperCase(),visit_id:ar(32).toLocaleLowerCase(),uuid:tr(),click_id:tr()};i(o,r,n,s),s.value=setInterval(i,6e4,o,r,n,s),Ua(50,150)}async function i({medal:e,anchor_info:t,room_info:i},n,o,s){await Ah({up_id:e.target_id,room_id:i.room_id,uname:t.nick_name,...n},o),o.value>=31&&s&&s.value&&clearInterval(s.value)}e("ç´æ­é´å¿è·³")}(t,e))):void 0}async function Th(e){const{room_info:t,anchor_info:i}=e;if(!t||!i)return;const{liveLike:n,liveSendMessage:o,liveShare:s}=Pa.intimacy,r=i.nick_name,a=t.room_id;o&&(bh.verbose(`ã${r}ãå¼å§åéç´æ­å¼¹å¹`),await Dh(a,r)),s&&async function(){await Ha(100,300);for(let e=0;e<5;e++)bh.verbose(`åäº« [${r}] ç´æ­é´`),await Eh(a),await Ha(4e3)}().catch((e=>wr.error(e))),n&&async function(){await Ha(100,300);for(let e=0;e<3;e++)bh.verbose(`ç» [${r}] ç´æ­é´ç¹èµ`),await Ch(a),await Ha(6500)}().catch((e=>wr.error(e))),await Ha(22e3)}async function Bh(){try{const{data:e,message:t,code:i}=await Nd();if(0!==i)return void wr.warn(`è·åç¨æ·ä¿¡æ¯å¤±è´¥ï¼${i} ${t}`);!function(e){var t;La.bCoinCouponBalance=(null===(t=e.wallet)||void 0===t?void 0:t.coupon_balance)||0}(e)}catch(e){wr.error(`è·åç¨æ·ä¿¡æ¯å¼å¸¸ï¼${e.message}`)}}var Oh;async function jh(){try{const{data:e,code:t,message:i}=await Bd.get("/x/vip/privilege/my",{headers:{origin:Ga,referer:Qa}});if(0!==t)return void wr.info(`è·åé¢åç¶æå¤±è´¥ï¼${t} ${i}`);const{list:n}=e,o=n.filter((e=>0===e.state));return 0===o.length?void wr.info("ææ å¯é¢åæçï¼å·²é¢åï¼"):o}catch(e){wr.error(`è·åé¢åç¶æåºç°å¼å¸¸ï¼${e.message}`)}}async function Ih(e){try{const t=function(e){switch(e){case 1:return"B å¸å¸";case 2:return"ä¼åè´­ä¼æ å¸";case 3:return"æ¼«è¯»å¸";case 4:return"ä¼åè´­è¿è´¹å¸";default:return"æªç¥"}}(e),{code:i,message:n}=await function(e=1){return Bd.post("/x/vip/privilege/receive",{csrf:Pa.BILIJCT,type:e},{headers:{origin:Ka,referer:Qa}})}(e);let o="æå";return 0!==i&&(o=`å¤±è´¥ ${n}`),wr.info(`é¢å${t}${o}`),!0}catch(e){wr.error(`é¢åæçåºç°å¼å¸¸ï¼${e.message}`),wr.error(e)}return!1}async function Ph(e){let t=0,i=!1;for(;!(i||(i=await Ih(e),t>2));)t++;return i}!function(e){e[e["æå"]=4]="æå",e[e["ä½äº20çµæ± "]=-2]="ä½äº20çµæ± ",e[e["Bå¸ä¸è¶³"]=-4]="Bå¸ä¸è¶³"}(Oh||(Oh={}));let Lh=0;async function Rh(){try{const{data:{list:e}}=await function(e=3394945){const t=(new Date).getTime();return Td.get(`/xlive/web-room/v1/gift/bag_list?t=${t}&room_id=${e}`)}();return e.filter((e=>{if(e.expire_at<=0)return!1;const t=(1e3*e.expire_at-(new Date).getTime())/864e5<2,i=![1,30607,30426,31531].includes(e.gift_id);return i&&t&&wr.info(`${e.gift_name} å³å°è¿æè¯·å°½å¿«æå`),!i&&t}))}catch(e){if(Lh)return null;await Rh(),Lh++}}async function Nh(e){try{const{data:{live_room:t,name:i}}=await function(e){return Bd.get(`/x/space/acc/info?mid=${e}&jsonp=jsonp`)}(e);if(await Ha(),t.roomStatus)return{roomid:t.roomid,name:i}}catch{}}function $h(e,t,i,n){const o=Pa.BILIJCT,s={is_fav:0,main_id:t,oid:e,detail_id:i,count:n,csrf:o,csrf_token:o};return Bd.post("/x/esports/guess/add",s)}function Hh(){return La.money-Pa.MATCH_COINS<Pa.BILI_TARGET_COINS&&(wr.info(`éè¦ä¿ç${Pa.BILI_TARGET_COINS}ä¸ªç¡¬å¸ï¼ä»»å¡ç»æ`),!0)}async function Uh(){const{data:e,code:t}=await Hd(1,1,0);if(0!==t)throw new Error(`è·åæåä¸ä¸ªå³æ³¨å¤±è´¥: ${t}`);return e[0]}async function qh(e){const{data:t,code:i}=await Bd.get("/x/relation/tags?jsonp=jsonp&callback=__jp3",{headers:{Referer:"https://space.bilibili.com/1/fans/follow?tagid=0"},requestOptions:{isJsonp:!0}});if(0===i)return t.find((t=>t.name===e));wr.warn(`è·ååç»åè¡¨å¤±è´¥: ${i}`)}async function Mh(e){const t=await qh(e);if(t)return t.tagid;await Ha(300);const{data:i,code:n,message:o}=await function(e){return Bd.post("/x/relation/tag/create",{tag:e,jsonp:"jsonp",csrf:Pa.BILIJCT})}(e);if(22106===n){await Ha(300);const t=await qh(e);return t&&t.tagid}return 0!==n&&wr.warn(`åå»ºåç»å¤±è´¥: ${n}-${o}`),i.tagid}async function zh(e,t="å¤©éæ¶å»"){if(0===e.length)return;const i=await Mh(t);if(i)for(const t of e){const{code:e,message:n}=await Ud(t.mid,i);0!==e&&wr.warn(`ç§»å¨ã${t.uname}ãå¤±è´¥: ${e}-${n}`),await Ha()}}async function Gh(e,t,i,n=1){if(e.length>t.length)return;const{data:o,code:s,message:r}=await Hd(n,20,0);if(0===s){for(const{mid:n,uname:s}of o){if(e.length>=t.length)return;if(n===i)return;(t.includes(n)||t.includes(s))&&e.push({mid:n,uname:s})}if(!(o.length<20))return await Gh(e,t,i,n+1)}else wr.warn(`è·åå³æ³¨ç¨æ·å¤±è´¥: ${s}-${r}`)}const Vh=0,Wh=1,Jh=5,Kh=1,Qh=504,Xh=1096;let Yh;async function Zh(){try{const{data:e,code:t,message:i}=await Td.get("/xlive/web-interface/v1/index/getWebAreaList?source_id=2");return 0!==t&&wr.info(`è·åç´æ­ååºå¤±è´¥: ${t}-${i}`),e.data.map((e=>e.list)).map((e=>e.map((e=>({areaId:e.id,parentId:e.parent_id})))))}catch(e){throw wr.error(`è·åç´æ­ååºå¼å¸¸: ${e.message}`),e}}async function em(e,t,i=1,n="lottery"){try{await Ha(100);const{data:o,code:s,message:r}=await function(e,t,i=1){return Td.get(`/xlive/web-interface/v1/second/getList?platform=web&parent_area_id=${e}&area_id=${t}&page=${i}`)}(t,e,i);return 0!==s&&wr.info(`è·åç´æ­é´åè¡¨å¤±è´¥: ${s}-${r}`),function(e){const t=[],i=[];return e.forEach((e=>{const n=e.pendant_info[2];n&&(n.pendent_id===Qh?t.push(e):n.pendent_id===Xh&&i.push(e))})),{lotteryTime:t,lotteryPacket:i}}(o.list)["lottery"===n?"lotteryTime":"lotteryPacket"]}catch(e){throw wr.error(`è·åç´æ­é´åè¡¨å¼å¸¸: ${e.message}`),e}}async function tm(e,t,i=1){const n=await em(e,t,i),o=[];for(const e of n){const t=await im(e);t&&(o.push({...t,uid:e.uid,uname:e.uname}),await Ha(100))}return o}async function im(e){const{blackUid:t}=Pa.lottery;if(t.includes(e.uid))return void wr.info(`è·³è¿é»ååç¨æ·: ${e.uname}`);let i,n,o;try{({data:n,code:i,message:o}=await Rd(e.roomid))}catch(t){return void wr.info(`ç´æ­é´${e.roomid}æ£æµå¼å¸¸: ${t.message}`)}if(0!==i)return void wr.debug(`ç´æ­é´${e.roomid}æ£æµå¤±è´¥: ${i}-${o}`);if(null===n)return;const{excludeAward:s,includeAward:r}=Pa.lottery,a=s.some((e=>n.award_name.match(e)));if(r.some((e=>n.award_name.match(e)))||!a){if(n.status===Kh&&!(n.gift_price>0))return 4===n.require_type&&(wr.info("æ¨è½åé¦ç»ä½èè¾åºäºä»ä¹åï¼"),wr.info(`${n.require_type}--${n.require_text}--${n.require_value}`),wr.info("ä¹è®¸è¿æ­£æ¯æä»¬æ³è¦çã")),n.require_type===Jh&&La.userLevel>=n.require_value||n.require_type===Vh?n:n.require_type!==Wh||Pa.lottery.skipNeedFollow?void 0:n}else wr.info(`è·³è¿å±è½å¥å: ${n.award_name}`)}async function nm(e,t=!0){try{const{id:n,gift_id:o,gift_num:s,award_name:r,uid:a,uname:c,require_type:u,require_text:l}=e;wr.info(`å¤©éä¸»æ­ï¼ã${c}ã`),wr.info(`å¥åï¼${r}`);const{code:p,message:d}=await(i={id:n,gift_id:o,gift_num:s},Td.post("/xlive/lottery-interface/v1/Anchor/Join",{...i,csrf:Pa.BILIJCT,csrf_token:Pa.BILIJCT,visit_id:cr(),platform:"pc"}));if(0!==p)return void wr.info(`å¤©éå¤±è´¥: ${p}-${d}`);if(wr.info("å¤©éæå â"),u===Wh&&t){ur(Yh,a);(function(e){const t=(e=e.replace("å³æ³¨ä¸»æ­","")).split(/\s*\+\s*/);return t.shift(),t})(l).forEach((e=>ur(Yh,e)))}}catch(e){wr.info(`å¤©éå¼å¸¸: ${e.message}`)}var i}async function om(e,t,i=2){for(let n=1;n<=i;n++){const i=await tm(e,t,n);for(const e of i)await nm(e),await Ha(300)}}async function sm(e){try{const{data:t,code:i}=await function(e){return Td.get(`/xlive/lottery-interface/v1/lottery/getLotteryInfoWeb?roomid=${e}`)}(e);if(0!==i)return;const{popularity_red_pocket:n}=t;if(!n)return;const{lot_id:o,lot_status:s}=n[0];if(2===s)return;return o}catch(e){}}async function rm(e,t,i=1){const n=await em(e,t,i,"redPack"),o=[];for(const e of n){const t=await sm(e.roomid);t&&(o.push({uid:e.uid,uname:e.uname,lot_id:t,room_id:e.roomid}),await Ha(100))}return o}async function am(e){try{const{lot_id:i,uid:n,uname:o,room_id:s}=e;wr.info(`çº¢åä¸»æ­ï¼ã${o}ã`);const{code:r,message:a}=await(t={room_id:s,lot_id:i,ruid:n},Td.post("/xlive/lottery-interface/v1/popularityRedPocket/RedPocketDraw",{...t,spm_id:"444.8.red_envelope.extract",jump_from:"",session_id:"",csrf_token:Pa.BILIJCT,csrf:Pa.BILIJCT,visit_id:""}));if(0!==r)return void wr.info(`çº¢åå¤±è´¥: ${r}-${a}`);Yh.push(n),wr.info("çº¢åæå â")}catch(e){wr.info(`çº¢åå¼å¸¸: ${e.message}`)}var t}async function cm(e,t,i=2){for(let n=1;n<=i;n++){const i=await rm(e,t,n);for(const e of i)await am(e),await Ha(200)}}async function um(){const e=[];return await async function t(i=1){try{var n;const{data:o,code:s,message:r}=await function(e=1,t=9){return Td.get(`/xlive/web-ucenter/user/following?page=${e}&page_size=${t}`)}(i,9);if(0!==s)return void wr.info(`è·åå³æ³¨ç´æ­é´å¤±è´¥: ${s}-${r}`);const a=null===(n=o.list)||void 0===n?void 0:n.filter((e=>1===e.live_status));if(9===a.length&&i<o.totalPage)return e.push(...a),t(i+1);e.push(...a)}catch(e){wr.error(`è·åå³æ³¨ç´æ­é´å¼å¸¸: ${e.message}`)}}(),e}async function lm(e){try{const{code:t,message:i,data:n}=await Rd(e.roomid);if(0!==t)return void wr.debug(`ç´æ­é´${e.roomid}æ£æµå¤±è´¥: ${t}-${i}`);if(null===n)return;if(n.status!==Kh)return;if(n.gift_price>0)return;return n}catch(t){return void wr.info(`ç´æ­é´${e.roomid}æ£æµå¼å¸¸: ${t.message}`)}}async function pm(){const{scanFollow:e}=Pa.lottery;if(!e)return!0;try{wr.info("å¼å§æ«æå³æ³¨çä¸»æ­");const e=await async function(){const e=await um(),t=[];for(const i of e){const e=await lm(i);e&&t.push({...e,uid:i.uid,uname:i.uname}),await Ha(100)}return t}();for(const t of e)await nm(t,!1),await Ha(300);wr.info("å³æ³¨çä¸»æ­å¤©éå®æ")}catch(e){wr.error(`å³æ³¨çä¸»æ­å¤©éå¼å¸¸: ${e.message}`)}return"only"!==e}async function dm(e){try{const{code:t,message:i,data:n}=await function({session_type:e}={session_type:1}){return jd.get(`/session_svr/v1/session_svr/get_sessions?session_type=${e}&group_fold=1&unfollow_fold=1&sort_rule=2&build=0&mobi_app=web`)}();if(0!==t)return void wr.warn(`è·åä¼è¯å¤±è´¥ï¼${t}-${i}`);const{session_list:o}=n;if(o.length<=0)return;return o.filter((({unread_count:t,talker_id:i,is_follow:n,last_msg:o})=>{return e.find((e=>e.mid===i))&&t>0&&i===o.sender_uid&&1===n&&(s=o.timestamp,Date.now()-1e3*s<36e5);var s}))}catch(e){wr.error(`è·åä¼è¯å¼å¸¸ï¼${e.message}`)}}async function hm(e){const t=await dm(e);await Ha(200);try{for(let e=0;e<t.length;e++){const i=t[e];await mm(i)}}catch(e){wr.error(`æ´æ°ä¼è¯å¼å¸¸ï¼${e.message}`)}t.length>=19&&await hm(e)}async function mm(e){switch(Pa.lottery.actFollowMsg){case"del":case"delete":await function({talker_id:e,session_type:t}){return jd.post("/session_svr/v1/session_svr/remove_session",{talker_id:e,session_type:t,build:0,mobi_app:"web",csrf_token:Pa.BILIJCT,csrf:Pa.BILIJCT})}(e);break;case"read":await function({talker_id:e,session_type:t,ack_seqno:i}){return jd.post("/session_svr/v1/session_svr/update_ack",{talker_id:e,session_type:t,ack_seqno:i,build:0,mobi_app:"web",csrf_token:Pa.BILIJCT,csrf:Pa.BILIJCT},{headers:{origin:Ja}})}(e)}await Ha(50)}var fm={taskReward:async function(){wr.info("----ãæ¯æ¥ä»»å¡å®ææåµã----");try{const{data:e,message:t,code:i}=await Bd.get("/x/member/web/exp/reward");await Ha();const{data:n}=await $d();if(0!=i)return void wr.warn(`ç¶æè·åå¤±è´¥: ${i} ${t}`);const o=La.money-Pa.BILI_STAY_COINS;let s=0;0===La.coinsTask?wr.info(`ä»æ¥æå¸è·åç»éª: ${n}ï¼è¿éæå¸0é¢ï¼ç»éªå¤äºï¼ä¸æ³æäº`):o<=0?wr.info(`ä»æ¥æå¸è·åç»éª: ${n}ï¼è¿éæå¸0é¢ï¼ç¡¬å¸ä¸å¤äºï¼ä¸æå¸äº`):o<La.coinsTask?(s=La.coinsTask-o,wr.info(`æå¸è·åç»éª: ${n}ï¼è¿éæå¸æ°é: ${s}é¢;(ç®æ ${La.coinsTask}é¢ï¼å¿½ç¥é¨åæå¸)`)):(s=La.coinsTask-n/10,wr.info(`æå¸è·åç»éª: ${n}ï¼è¿éæå¸æ°é: ${s}é¢;(ç®æ ${La.coinsTask}é¢)`)),La.coinsTask=s,wr.info("æ¯æ¥åäº«: "+(e.share?"å·²å®æ":"[æªå®æ]")),wr.info("æ¯æ¥æ­æ¾: "+(e.watch?"å·²å®æ":"[æªå®æ]")),La.share=e.share,La.watch=e.watch}catch(e){wr.error(`ç¶æè·åå¼å¸¸ ${e.message}`)}},liveSignTask:async function(){wr.info("----ãç´æ­ç­¾å°ã----");try{const{data:e}=await Td.get("/xlive/web-ucenter/v1/sign/WebGetSignInfo");if(1===e.status)return wr.info("å·²ç­¾å°ï¼è·³è¿ç­¾å°"),void wr.info(`å·²ç»ç­¾å°${e.hadSignDays}å¤©ï¼${e.specialText}`)}catch(e){}try{const{code:e,data:t,message:i}=await Td.get("/xlive/web-ucenter/v1/sign/DoSign");0===e?wr.info(`ç´æ­ç­¾å°æå: ${t.text}ï¼ç¹å«ä¿¡æ¯: ${t.specialText}ï¼æ¬æç­¾å°å¤©æ°: ${t.hadSignDays}å¤©;`):wr.warn(`ç´æ­ç­¾å°å¤±è´¥: ${e} ${i}`)}catch(e){wr.error(`ç´æ­ç­¾å°å¼å¸¸: ${e.message}`)}},addCoins:async function(){if(wr.info("----ãè§é¢æå¸ã----"),!La.coinsTask)return void wr.info("è·³è¿æå¸ï¼ä»æ¥å·²å®æ");const e={eCount:0,num:0,prevCode:0,fillCount:0,priority:0};let t=!1;for(;La.coinsTask&&!t&&e.eCount<5;)t=await sh(e);e.eCount>=5&&wr.info("åºç°å¼å¸¸/éè¯¯5æ¬¡ï¼èªå¨éåºæå¸"),wr.info(`ä¸å±æåæå¸${e.num}é¢`),wr.info(`ç¡¬å¸è¿å©${La.money}é¢`)},shareAndWatch:async function(){if(wr.info("----ãåäº«/æ­æ¾è§é¢ã----"),La.share&&La.watch)return void wr.info("å·²å®æï¼è·³è¿åäº«/æ­æ¾");let e=0;try{let t=await nh();if("-1"===t.msg&&(t=await Qd()),"0"!==t.msg)return wr.warn(`è·åè§é¢å¤±è´¥ ${t.msg}`),!1;{const{id:i,author:n,title:o}=t.data;e=i,wr.info(`è·åè§é¢: ${o} --upã${n}ã`)}}catch(e){return wr.error(`è·åè§é¢åºç°å¼å¸¸: ${e.message}`),!1}if(!La.share){await Ha();try{const{code:t,message:i}=await function(e){const t={csrf:Pa.BILIJCT,aid:e};return Bd.post("/x/web-interface/share/add",t)}(e);0===t?wr.info("åäº«è§é¢æå!"):wr.warn(`åäº«è§é¢å¤±è´¥: ${t} ${i}`)}catch(e){wr.error(`åäº«è§é¢å¼å¸¸: ${e.message}`)}}if(!La.watch){await Ha();try{const{code:n,message:o}=await(t=e,i=sr(4,60),Bd.post("/x/click-interface/web/heartbeat",{aid:t,played_time:i}));0===n?wr.info("æ­æ¾è§é¢æå!"):wr.warn(`æ­æ¾è§é¢å¤±è´¥: ${n} ${o}`)}catch(e){wr.error(`æ­æ¾è§é¢å¼å¸¸: ${e.message}`)}}var t,i},silver2Coin:async function(){wr.info("----ãé¶çå­åæ¢ç¡¬å¸ã----");try{const{data:e,code:t,message:i}=await Td.get("/xlive/revenue/v1/wallet/getStatus");if(0!=t&&wr.info(`è·åçå­è¯¦æå¤±è´¥ ${i}`),0===e.silver_2_coin_left)wr.info("ä»æ¥å·²åæ¢ä¸æ¬¡");else if(e.silver<700)wr.info("åæ¢å¤±è´¥ï¼ä½ çå­ä¸å¤äº");else{const{message:e}=await Td.post("/xlive/revenue/v1/wallet/silver2coin",{csrf_token:Pa.BILIJCT,csrf:Pa.BILIJCT});wr.info(`åæ¢ç¡¬å¸ï¼ ${e}`),await Td.get("/xlive/revenue/v1/wallet/myWallet?need_bp=1&need_metal=1&platform=pc")}}catch(e){wr.error(`æä½å¼å¸¸ ${e.message}`)}},mangaSign:async function(){wr.info("----ãæ¼«ç»ç­¾å°ã----"),wr.warn("æ¼«ç»ç­¾å°ä»»å¡ç§»å¨å°äºæ¼«ç»ä»»å¡ä¸­ï¼è¯·ä¿®æ¹ä¸ºæ°çä»»å¡"),await fh()},mangaTask:async function(){wr.info("----ãæ¼«ç»ä»»å¡ã----");const{manga:e}=Pa;try{e.sign&&(wr.info("å¼å§ç­¾å°"),await fh());e.buy&&function(){const{buyWeek:e,buyInterval:t}=Pa.manga;if(!e||0===e.length)return!1;if(1===t)return!0;const i=new Date,n=i.getDay(),o=i.getDate();return e.includes(n)||o%t-1==0}()?(wr.info("å¼å§è´­ä¹°æ¼«ç»"),await mh()):wr.info("éè´­ä¹°æ¼«ç»æ¶é´ï¼ä¸è´­ä¹°")}catch(e){wr.error(`æ¼«ç»ä»»å¡å¼å¸¸: ${e}`)}},supGroupSign:async function(){wr.info("----ãåºæ´å¢ç­¾å°ã----");const e=await gh();await Ha();let t=0;for(let o=0;o<e.length;){const s=e[o];try{const{data:e,code:o,message:r}=await(i=s.group_id,n=s.owner_uid,jd.get("/link_setting/v1/link_setting/sign_in",{params:{group_id:i,owner_id:n}}));0===o?0===e.status?t++:wr.info(r):wr.warn(`[${s.group_name}]ç­¾å°å¤±è´¥ ${r}`)}catch(e){wr.error(`ç­¾å°å¼å¸¸ ${e.message}`)}finally{await Ha()}}var i,n;wr.info(`ç­¾å°ç»æï¼æå${t}/${e.length}`)},liveSendMessage:async function(){wr.info("----ãåéç´æ­å¼¹å¹ã----"),wr.info("è¯¥å½æ°å³å°åºå¼ï¼è¯·ä½¿ç¨ liveIntimacy æ¿ä»£");try{const e=await wh(),t=e.length;let i=0,n=0;wr.info(`ä¸å±éè¦åé${t}ä¸ªç´æ­é´`),wr.verbose("æéæ¶é´å¯è½å¾é¿ï¼è¯·èå¿ç­å¾");for(let o=0;o<t;o++){const{room_info:s,anchor_info:r,medal:a}=e[o];null!=s&&s.room_id?100===a.today_feed||a.level>=20?n++:(await Dh(s.room_id,r.nick_name)&&i++,o<t-1&&await Ha(sr(1e4,25e3))):(wr.info(`ã${r.nick_name}ãæ²¡æç´æ­é´å¦`),n++)}wr.info(`æååé${i}ä¸ªå¼¹å¹ï¼è·³è¿${n}ä¸ª`)}catch(e){wr.error(`ç´æ­é´åéå¼¹å¹å¼å¸¸: ${e.message}`)}},charging:async function(){if(wr.info("----ãç»ç®æ åçµã----"),await Bh(),await Ha(),function(){const e=ir(),t=e.getDate(),i=er(e);let n=Pa.charge.presetTime;return Xs(n)||(n=[n]),La.bCoinCouponBalance<2?(wr.info(`å©ä½å¸ä¸º${La.bCoinCouponBalance}ï¼ä¸è¶³2è·³è¿åçµ`),!1):i===t?(wr.info("ä»å¤©æ¯æåä¸å¤©äº"),!0):!!n.some((e=>e===t))||(wr.info("ä¸å¨é¢è®¾æ¶é´ï¼ä¸ç¬¦åæ¡ä»¶"),!1)}())try{const e=La.bCoinCouponBalance||0,t=Pa.charge.mid;let i=0;wr.info(`b å¸å¸ä½é¢${e}`);const n=async()=>{const{code:i,message:n,data:o}=await function(e=50,t=!0,i=Pa.USERID,n="up",o=i){return Bd.post("/x/ugcpay/web/v2/trade/elec/pay/quick",{csrf:Pa.BILIJCT,bp_num:e,is_bp_remains_prior:t,up_mid:i,otype:n,oid:o})}(e,!0,t);0===i?(wr.info(`ç®æ ã${t}ã${Oh[o.status]}`),o.status===Oh["æå"]&&(La.chargeOrderNo=o.order_no,await Ha(),await async function(){try{if(!La.chargeOrderNo)return!1;const e=Us[sr(0,Us.length-1)],{code:t}=await function(e,t="æ¯æå¤§ä½¬ä¸æ³¢"){return Bd.post("/x/ugcpay/trade/elec/message",{csrf:Pa.BILIJCT,message:t,order_id:e})}(La.chargeOrderNo,e);0===t&&wr.info("çè¨æåï¼")}catch{}}())):wr.warn(`åçµå¤±è´¥ï¼${i} ${n}`)};for(La.chargeOrderNo="";!(La.chargeOrderNo||(await n(),await Ha(),i++>2)););}catch(e){wr.error(`åçµåºç°å¼å¸¸ï¼${e.message}`)}},getVipPrivilege:async function(){try{if(wr.info("----ãé¢åå¤§ä¼åæçã----"),0===La.vipStatus||0===La.vipType)return void wr.info("æ¨è¿ä¸æ¯å¤§ä¼åï¼æ æ³é¢åæç");const e=await jh();if(!e||0===e.length)return;for(let t=0;t<e.length;t++){await Ha(100);const i=e[t];await Ph(i.type)}}catch(e){wr.error(`é¢åå¤§ä¼åæçåºç°å¼å¸¸ï¼${e.message}`),wr.error(e)}},matchGame:async function(){if(wr.info("----ãèµäºç¡¬å¸ç«çã----"),Pa.MATCH_COINS<=0)return void wr.info("ç¡¬å¸æ°éä¸è½å°äº 0");if(Hh())return;const e=await async function(){try{const{code:e,message:t,data:{list:i,page:n}}=await function(e="",t=""){return Bd.get(`/x/esports/guess/collection/question?pn=1&ps=50&gid=&sids=&stime=${e}&etime=${t}`)}();return 0!==e?void wr.warn(`è·åèµäºéè¯¯ ${e} ${t}`):0===n.total?(wr.info("ä»æ¥å·²ç»æ æ³è·åèµäº"),null):i}catch(e){}}();if(await Ha(),!e)return;const t=await async function(e){let t=0;try{for(const i of e){const{contest:e,questions:n}=i,o=e.id,[{id:s,title:r,details:a,is_guess:c}]=n,[u,l]=a;if(Hh())return t;if(c)continue;wr.info(`${r} <=> ${u.odds}:${l.odds}`);const p=u.odds>l.odds;let d;d=Pa.MATCH_SELECTION>0?p?l:u:p?u:l,wr.info(`é¢æµ[ ${d.option} ] ${Pa.MATCH_COINS} é¢ç¡¬å¸`),await Ha();const{code:h}=await $h(o,s,d.detail_id,Pa.MATCH_COINS);0!==h?wr.info("é¢æµå¤±è´¥"):(t++,La.money-=Pa.MATCH_COINS)}}catch(e){console.warn(e.message)}return t}(function(e,t){return e.filter((e=>{const{questions:i}=e,[{details:n,is_guess:o}]=i;if(o)return!1;const[s,r]=n;return Math.abs(s.odds-r.odds)>=t}))}(e,Pa.MATCH_DIFF));wr.info(`ãç«çç»æãä¸å±åä¸${t}æ¬¡é¢æµ`)},liveLottery:async function(){wr.info("----ãå¤©éæ¶å»ã----");const e=await pm();if(!e)return e;try{const e=await Uh();wr.info(`æåä¸ä¸ªå³æ³¨çUP: ${e.uname}`);const t=await async function(){Yh=[];const{pageNum:e}=Pa.lottery,t=await Zh();for(const i of t)for(const t of i)await om(t.areaId,t.parentId,e);return Yh}();wr.info("æ«æå®æ");const i=[];await Gh(i,t,null==e?void 0:e.mid),await zh(i),wr.info("ç§»å¨å³æ³¨UPå°åç»æå")}catch(e){wr.warn(`å¤©éæ¶å»å¼å¸¸: ${e.message}`),wr.debug(e)}wr.info("ç»æå¤©éæ¶å»")},liveRedPack:async function(){wr.info("----ãå¤©éçº¢åã----");try{const e=await Uh();wr.info(`æåä¸ä¸ªå³æ³¨çUP: ${e.uname}`);const t=await async function(){Yh=[];const{pageNum:e}=Pa.lottery,t=await Zh();for(const i of t)for(const t of i)await cm(t.areaId,t.parentId,e);return Yh}();wr.info("æ«æå®æï¼è·åæ°å³æ³¨çUP");const i=[];await Gh(i,t,null==e?void 0:e.mid),wr.info("å¼å§è¯»åæ¶æ¯"),await hm(i),wr.info("ç§»å¨å³æ³¨UPå°åç»"),await zh(i),wr.info("ç§»å¨å³æ³¨UPå°åç»æå")}catch(e){wr.warn(`å¤©éæ¶å»å¼å¸¸: ${e.message}`),wr.debug(e)}wr.info("ç»æå¤©éçº¢å")},liveIntimacy:async function(){wr.info("----ãç´æ­äº²å¯åº¦ã----");try{await kh(),wr.info("ç´æ­äº²å¯åº¦å®æ")}catch(e){wr.error(`ç´æ­äº²å¯åº¦: ${e.message}`)}},giveGift:async function(){wr.info("----ãæåè¿æé£ç©ã----");try{const e=await Rh();if(await Ha(),null==e||!e.length)return void wr.info("æ²¡æ2å¤©åè¿æçç®åç¤¼ç©");const t=await async function(){const e=Object.assign([],Pa.BILI_GIFT_UP),t=()=>e.splice(sr(Pa.BILI_GIFT_UP.length-1),1)[0];for(;e.length;){const e=t(),i=await Nh(e);if(i)return{mid:e,...i}}return await async function(){const{data:{count:e,items:t}}=await function(e=1,t=10){return e>10&&(e=10),Td.get(`/xlive/app-ucenter/v1/user/GetMyMedals?page=${e}&page_size=${t}`)}();if(await Ha(),!e)return;const i=t[sr(t.length-1)];return{mid:i.target_id,roomid:i.roomid||0,name:i.uname}}()}();if(!t)return void wr.info("æ²¡ææ¾å°æåç®æ ");await async function({roomid:e,mid:t,name:i},n){for(const o of n){await Ha();try{const{code:n,message:s,data:r}=await Ld({roomid:e,ruid:t,bag_id:o.bag_id,gift_id:o.gift_id,gift_num:o.gift_num});if(0!==n){wr.warn(`å[${i}]æå[${o.gift_name}]ï¼${s}`);continue}r.gift_list.forEach((e=>{wr.info(`æåç» [${i}] æå${e.gift_name}`)}))}catch{}}}(t,e)}catch(e){wr.info(`æåè¿æé£ç©å¼å¸¸ ${e}`)}}},gm=Object.freeze({__proto__:null,loginTask:async function(){wr.info("----ãç»å½ã----");const{data:e,message:t,code:i}=await Nd();if(0!==i)throw wr.error(`ç»å½éè¯¯ ${i} ${t}`),new Error(t);if(!e.isLogin)throw new Error("æ¥å£è¿åä¸ºæªç»å½");await Ha(),await Md(e)},default:fm}),vm=!W((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),xm=yt,ym=Ae,bm=gt,wm=vm,_m=Gi("IE_PROTO"),Dm=Object,Em=Dm.prototype,Cm=wm?Dm.getPrototypeOf:function(e){var t=bm(e);if(xm(t,_m))return t[_m];var i=t.constructor;return ym(i)&&t instanceof i?i.prototype:t instanceof Dm?Em:null},Am={},km=Kn,Sm=Qn,Fm=Object.keys||function(e){return km(e,Sm)},Tm=J,Bm=ci,Om=ai,jm=di,Im=Ce,Pm=Fm;Am.f=Tm&&!Bm?Object.defineProperties:function(e,t){jm(e);for(var i,n=Im(t),o=Pm(t),s=o.length,r=0;s>r;)Om.f(e,i=o[r++],n[i]);return e};var Lm,Rm=Oe("document","documentElement"),Nm=di,$m=Am,Hm=Qn,Um=Vi,qm=Rm,Mm=Kt,zm=Gi("IE_PROTO"),Gm=function(){},Vm=function(e){return"<script>"+e+"<\/script>"},Wm=function(e){e.write(Vm("")),e.close();var t=e.parentWindow.Object;return e=null,t},Jm=function(){try{Lm=new ActiveXObject("htmlfile")}catch(e){}var e,t;Jm="undefined"!=typeof document?document.domain&&Lm?Wm(Lm):((t=Mm("iframe")).style.display="none",qm.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(Vm("document.F=Object")),e.close(),e.F):Wm(Lm);for(var i=Hm.length;i--;)delete Jm.prototype[Hm[i]];return Jm()};Um[zm]=!0;var Km=Object.create||function(e,t){var i;return null!==e?(Gm.prototype=Nm(e),i=new Gm,Gm.prototype=null,i[zm]=e):i=Jm(),void 0===t?i:$m.f(i,t)},Qm=et,Xm=K,Ym=pe(pe.bind),Zm={},ef=Zm,tf=Pt("iterator"),nf=Array.prototype,of=Yo,sf=it,rf=Zm,af=Pt("iterator"),cf=function(e){if(null!=e)return sf(e,af)||sf(e,"@@iterator")||rf[of(e)]},uf=Y,lf=et,pf=di,df=Qe,hf=cf,mf=TypeError,ff=Y,gf=di,vf=it,xf=function(e,t){return Qm(e),void 0===t?e:Xm?Ym(e,t):function(){return e.apply(t,arguments)}},yf=Y,bf=di,wf=Qe,_f=function(e){return void 0!==e&&(ef.Array===e||nf[tf]===e)},Df=Nn,Ef=je,Cf=function(e,t){var i=arguments.length<2?hf(e):t;if(lf(i))return pf(uf(i,e));throw mf(df(e)+" is not iterable")},Af=cf,kf=function(e,t,i){var n,o;gf(e);try{if(!(n=vf(e,"return"))){if("throw"===t)throw i;return i}n=ff(n,e)}catch(e){o=!0,n=e}if("throw"===t)throw i;if(o)throw n;return gf(n),i},Sf=TypeError,Ff=function(e,t){this.stopped=e,this.result=t},Tf=Ff.prototype,Bf=function(e,t,i){var n,o,s,r,a,c,u,l=i&&i.that,p=!(!i||!i.AS_ENTRIES),d=!(!i||!i.IS_ITERATOR),h=!(!i||!i.INTERRUPTED),m=xf(t,l),f=function(e){return n&&kf(n,"normal",e),new Ff(!0,e)},g=function(e){return p?(bf(e),h?m(e[0],e[1],f):m(e[0],e[1])):h?m(e,f):m(e)};if(d)n=e;else{if(!(o=Af(e)))throw Sf(wf(e)+" is not iterable");if(_f(o)){for(s=0,r=Df(e);r>s;s++)if((a=g(e[s]))&&Ef(Tf,a))return a;return new Ff(!1)}n=Cf(e,o)}for(c=n.next;!(u=yf(c,n)).done;){try{a=g(u.value)}catch(e){kf(n,"throw",e)}if("object"==typeof a&&a&&Ef(Tf,a))return a}return new Ff(!1)},Of=So,jf=je,If=Cm,Pf=Ho,Lf=lo,Rf=Km,Nf=Di,$f=se,Hf=ps,Uf=ss,qf=Bf,Mf=is,zf=hs,Gf=Pt("toStringTag"),Vf=Error,Wf=[].push,Jf=function(e,t){var i,n=arguments.length>2?arguments[2]:void 0,o=jf(Kf,this);Pf?i=Pf(new Vf,o?If(this):Kf):(i=o?this:Rf(Kf),Nf(i,Gf,"Error")),void 0!==t&&Nf(i,"message",Mf(t)),zf&&Nf(i,"stack",Hf(i.stack,1)),Uf(i,n);var s=[];return qf(e,Wf,{that:s}),Nf(i,"errors",s),i};Pf?Pf(Jf,Vf):Lf(Jf,Vf,{name:!0});var Kf=Jf.prototype=Rf(Vf.prototype,{constructor:$f(1,Jf),message:$f(1,""),name:$f(1,"AggregateError")});Of({global:!0,constructor:!0,arity:2},{AggregateError:Jf});var Qf={},Xf=et,Yf=function(e){var t,i;this.promise=new e((function(e,n){if(void 0!==t||void 0!==i)throw TypeError("Bad Promise constructor");t=e,i=n})),this.resolve=Xf(t),this.reject=Xf(i)};Qf.f=function(e){return new Yf(e)};var Zf=Y,eg=et,tg=Oe,ig=Qf,ng=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}},og=Bf;function sg(){wr.info("å½åçæ¬ãv0.5.11886ã")}So({target:"Promise",stat:!0},{any:function(e){var t=this,i=tg("AggregateError"),n=ig.f(t),o=n.resolve,s=n.reject,r=ng((function(){var n=eg(t.resolve),r=[],a=0,c=1,u=!1;og(e,(function(e){var l=a++,p=!1;c++,Zf(n,t,e).then((function(e){p||u||(u=!0,o(e))}),(function(e){p||u||(p=!0,r[l]=e,--c||s(new i(r,"No one promise resolved")))}))})),--c||s(new i(r,"No one promise resolved"))}));return r.error&&s(r.value),n.promise}});var rg=Object.freeze({__proto__:null,printVersion:async function(){let e="v0.5.11886";e.includes(".")?sg():e=void 0;try{if(e||(e="v"+(function(){try{return require("../../package.json").version}catch{}}()||function(){try{return A.readFileSync(E.resolve(__dirname,"../version.txt"),"utf8").trim()}catch{}}()),wr.info(`å½åçæ¬ã${e}ã`)),!e)return;const t=await async function(){const e={timeout:6e3};try{return(await Promise.any([dd.get("https://api.github.com/repos/KudouRan/BiliTools/releases/latest",e),dd.get("https://gitee.com/api/v5/repos/catlair/BiliTools/releases/latest",e)])).tag_name}catch(e){return}}();t&&t!==e&&wr.info(`å¯æ´æ°ï¼ææ°çæ¬ã${t}ã`)}catch{}},printStrVersion:sg}),ag={},cg={exports:{}},ug={exports:{}};const lg=S.default;var pg=class{constructor(e){this.options=e||{},this.cookies=[]}set(e,t){let i,n=lg.parse(t||""),o=this.parse(e);return o.domain?(i=o.domain.replace(/^\./,""),(n.hostname.length<i.length||("."+n.hostname).substr(1-i.length)!=="."+i)&&(o.domain=n.hostname)):o.domain=n.hostname,o.path||(o.path=this.getPath(n.pathname)),o.expires||(o.expires=new Date(Date.now()+1e3*(Number(this.options.sessionTimeout||1800)||1800))),this.add(o)}get(e){return this.list(e).map((e=>e.name+"="+e.value)).join("; ")}list(e){let t,i,n=[];for(t=this.cookies.length-1;t>=0;t--)i=this.cookies[t],this.isExpired(i)?this.cookies.splice(t,t):this.match(i,e)&&n.unshift(i);return n}parse(e){let t={};return(e||"").toString().split(";").forEach((e=>{let i,n=e.split("="),o=n.shift().trim().toLowerCase(),s=n.join("=").trim();if(o)switch(o){case"expires":s=new Date(s),"Invalid Date"!==s.toString()&&(t.expires=s);break;case"path":t.path=s;break;case"domain":i=s.toLowerCase(),i.length&&"."!==i.charAt(0)&&(i="."+i),t.domain=i;break;case"max-age":t.expires=new Date(Date.now()+1e3*(Number(s)||0));break;case"secure":t.secure=!0;break;case"httponly":t.httponly=!0;break;default:t.name||(t.name=o,t.value=s)}})),t}match(e,t){let i=lg.parse(t||"");return(i.hostname===e.domain||"."===e.domain.charAt(0)&&("."+i.hostname).substr(-e.domain.length)===e.domain)&&(this.getPath(i.pathname).substr(0,e.path.length)===e.path&&(!e.secure||"https:"===i.protocol))}add(e){let t,i;if(!e||!e.name)return!1;for(t=0,i=this.cookies.length;t<i;t++)if(this.compare(this.cookies[t],e))return this.isExpired(e)?(this.cookies.splice(t,1),!1):(this.cookies[t]=e,!0);return this.isExpired(e)||this.cookies.push(e),!0}compare(e,t){return e.name===t.name&&e.path===t.path&&e.domain===t.domain&&e.secure===t.secure&&e.httponly==e.httponly}isExpired(e){return e.expires&&e.expires<new Date||!e.value}getPath(e){let t=(e||"/").split("/");return t.pop(),t=t.join("/").trim(),"/"!==t.charAt(0)&&(t="/"+t),"/"!==t.substr(-1)&&(t+="/"),t}},dg={name:"nodemailer",version:"6.7.5",description:"Easy as cake e-mail sending from your Node.js applications",main:"lib/nodemailer.js",scripts:{test:"grunt --trace-warnings"},repository:{type:"git",url:"https://github.com/nodemailer/nodemailer.git"},keywords:["Nodemailer"],author:"Andris Reinman",license:"MIT",bugs:{url:"https://github.com/nodemailer/nodemailer/issues"},homepage:"https://nodemailer.com/",devDependencies:{"@aws-sdk/client-ses":"3.79.0","aws-sdk":"2.1124.0",bunyan:"1.8.15",chai:"4.3.6","eslint-config-nodemailer":"1.2.0","eslint-config-prettier":"8.5.0",grunt:"1.5.2","grunt-cli":"1.4.3","grunt-eslint":"24.0.0","grunt-mocha-test":"0.13.3",libbase64:"1.2.1",libmime:"5.1.0",libqp:"1.1.0",mocha:"9.2.2","nodemailer-ntlm-auth":"1.0.1",proxy:"1.0.2","proxy-test-server":"1.0.0",sinon:"13.0.2","smtp-server":"3.11.0"},engines:{node:">=6.0.0"}};const hg=O.default,mg=j.default,fg=S.default,gg=w.default,vg=B.default.PassThrough,xg=pg,yg=dg;function bg(e,t){(t=t||{}).fetchRes=t.fetchRes||new vg,t.cookies=t.cookies||new xg,t.redirects=t.redirects||0,t.maxRedirects=isNaN(t.maxRedirects)?5:t.maxRedirects,t.cookie&&([].concat(t.cookie||[]).forEach((i=>{t.cookies.set(i,e)})),t.cookie=!1);let i,n,o,s=t.fetchRes,r=fg.parse(e),a=(t.method||"").toString().trim().toUpperCase()||"GET",c=!1,u="https:"===r.protocol?mg:hg,l={"accept-encoding":"gzip,deflate","user-agent":"nodemailer/"+yg.version};if(Object.keys(t.headers||{}).forEach((e=>{l[e.toLowerCase().trim()]=t.headers[e]})),t.userAgent&&(l["user-agent"]=t.userAgent),r.auth&&(l.Authorization="Basic "+Buffer.from(r.auth).toString("base64")),(i=t.cookies.get(e))&&(l.cookie=i),t.body){if(!1!==t.contentType&&(l["Content-Type"]=t.contentType||"application/x-www-form-urlencoded"),"function"==typeof t.body.pipe)l["Transfer-Encoding"]="chunked",n=t.body,n.on("error",(t=>{c||(c=!0,t.type="FETCH",t.sourceUrl=e,s.emit("error",t))}));else{if(t.body instanceof Buffer)n=t.body;else if("object"==typeof t.body)try{n=Buffer.from(Object.keys(t.body).map((e=>{let i=t.body[e].toString().trim();return encodeURIComponent(e)+"="+encodeURIComponent(i)})).join("&"))}catch(t){if(c)return;return c=!0,t.type="FETCH",t.sourceUrl=e,void s.emit("error",t)}else n=Buffer.from(t.body.toString().trim());l["Content-Type"]=t.contentType||"application/x-www-form-urlencoded",l["Content-Length"]=n.length}a=(t.method||"").toString().trim().toUpperCase()||"POST"}let p={method:a,host:r.hostname,path:r.path,port:r.port?r.port:"https:"===r.protocol?443:80,headers:l,rejectUnauthorized:!1,agent:!1};t.tls&&Object.keys(t.tls).forEach((e=>{p[e]=t.tls[e]}));try{o=u.request(p)}catch(t){return c=!0,setImmediate((()=>{t.type="FETCH",t.sourceUrl=e,s.emit("error",t)})),s}return t.timeout&&o.setTimeout(t.timeout,(()=>{if(c)return;c=!0,o.abort();let t=new Error("Request Timeout");t.type="FETCH",t.sourceUrl=e,s.emit("error",t)})),o.on("error",(t=>{c||(c=!0,t.type="FETCH",t.sourceUrl=e,s.emit("error",t))})),o.on("response",(i=>{let n;if(!c){switch(i.headers["content-encoding"]){case"gzip":case"deflate":n=gg.createUnzip()}if(i.headers["set-cookie"]&&[].concat(i.headers["set-cookie"]||[]).forEach((i=>{t.cookies.set(i,e)})),[301,302,303,307,308].includes(i.statusCode)&&i.headers.location){if(t.redirects++,t.redirects>t.maxRedirects){c=!0;let t=new Error("Maximum redirect count exceeded");return t.type="FETCH",t.sourceUrl=e,s.emit("error",t),void o.abort()}return t.method="GET",t.body=!1,bg(fg.resolve(e,i.headers.location),t)}if(s.statusCode=i.statusCode,s.headers=i.headers,i.statusCode>=300&&!t.allowErrorResponse){c=!0;let t=new Error("Invalid status code "+i.statusCode);return t.type="FETCH",t.sourceUrl=e,s.emit("error",t),void o.abort()}i.on("error",(t=>{c||(c=!0,t.type="FETCH",t.sourceUrl=e,s.emit("error",t),o.abort())})),n?(i.pipe(n).pipe(s),n.on("error",(t=>{c||(c=!0,t.type="FETCH",t.sourceUrl=e,s.emit("error",t),o.abort())}))):i.pipe(s)}})),setImmediate((()=>{if(n)try{if("function"==typeof n.pipe)return n.pipe(o);o.write(n)}catch(t){return c=!0,t.type="FETCH",t.sourceUrl=e,void s.emit("error",t)}o.end()})),s}ug.exports=function(e,t){return bg(e,t)},ug.exports.Cookies=xg,function(e){const t=S.default,i=T.default,n=k.default,o=ug.exports,s=I.default,r=$.default,a=P.default,c=3e5,u=e.exports.networkInterfaces=a.networkInterfaces(),l=e=>{const t=Object.keys(u).map((e=>u[e])).reduce(((e,t)=>e.concat(t)),[]).filter((e=>!e.internal)).filter((t=>t.family==="IPv"+e||t.family===e)).length>0;return t},p=(e,t,i)=>{if(!l(e))return i(null,[]);s["resolve"+e](t,((e,t)=>{if(e){switch(e.code){case s.NODATA:case s.NOTFOUND:case s.NOTIMP:case s.SERVFAIL:case s.CONNREFUSED:case"EAI_AGAIN":return i(null,[])}return i(e)}return i(null,Array.isArray(t)?t:[].concat(t||[]))}))},d=e.exports.dnsCache=new Map,h=(e,t)=>e?Object.assign({servername:e.servername,host:e.addresses&&e.addresses.length?1===e.addresses.length?e.addresses[0]:e.addresses[Math.floor(Math.random()*e.addresses.length)]:null},t||{}):Object.assign({},t||{});function m(e,t){let i=!1,n=[],o=0;e.on("error",(e=>{i||(i=!0,t(e))})),e.on("readable",(()=>{let t;for(;null!==(t=e.read());)n.push(t),o+=t.length})),e.on("end",(()=>{if(i)return;let e;i=!0;try{e=Buffer.concat(n,o)}catch(e){return t(e)}t(null,e)}))}e.exports.resolveHostname=(e,t)=>{if(!(e=e||{}).host&&e.servername&&(e.host=e.servername),!e.host||r.isIP(e.host)){let i={addresses:[e.host],servername:e.servername||!1};return t(null,h(i,{cached:!1}))}let i;if(d.has(e.host)&&(i=d.get(e.host),!i.expires||i.expires>=Date.now()))return t(null,h(i.value,{cached:!0}));p(4,e.host,((n,o)=>{if(n)return i?t(null,h(i.value,{cached:!0,error:n})):t(n);if(o&&o.length){let i={addresses:o,servername:e.servername||e.host};return d.set(e.host,{value:i,expires:Date.now()+(e.dnsTtl||c)}),t(null,h(i,{cached:!1}))}p(6,e.host,((n,o)=>{if(n)return i?t(null,h(i.value,{cached:!0,error:n})):t(n);if(o&&o.length){let i={addresses:o,servername:e.servername||e.host};return d.set(e.host,{value:i,expires:Date.now()+(e.dnsTtl||c)}),t(null,h(i,{cached:!1}))}try{s.lookup(e.host,{all:!0},((n,o)=>{if(n)return i?t(null,h(i.value,{cached:!0,error:n})):t(n);let s=!!o&&o.filter((e=>l(e.family))).map((e=>e.address)).shift();if(o&&o.length&&!s){let e=new Error(`Can not use IPv${o[0].family} addresses with current network`);return t(e)}if(!s&&i)return t(null,h(i.value,{cached:!0}));let r={addresses:s?[s]:[e.host],servername:e.servername||e.host};return d.set(e.host,{value:r,expires:Date.now()+(e.dnsTtl||c)}),t(null,h(r,{cached:!1}))}))}catch(n){return i?t(null,h(i.value,{cached:!0,error:n})):t(n)}}))}))},e.exports.parseConnectionUrl=e=>{e=e||"";let i={};return[t.parse(e,!0)].forEach((e=>{let t;switch(e.protocol){case"smtp:":i.secure=!1;break;case"smtps:":i.secure=!0;break;case"direct:":i.direct=!0}!isNaN(e.port)&&Number(e.port)&&(i.port=Number(e.port)),e.hostname&&(i.host=e.hostname),e.auth&&(t=e.auth.split(":"),i.auth||(i.auth={}),i.auth.user=t.shift(),i.auth.pass=t.join(":")),Object.keys(e.query||{}).forEach((t=>{let n=i,o=t,s=e.query[t];switch(isNaN(s)||(s=Number(s)),s){case"true":s=!0;break;case"false":s=!1}if(0===t.indexOf("tls."))o=t.substr(4),i.tls||(i.tls={}),n=i.tls;else if(t.indexOf(".")>=0)return;o in n||(n[o]=s)}))})),i},e.exports._logFunc=(e,t,i,n,o,...s)=>{let r={};Object.keys(i||{}).forEach((e=>{"level"!==e&&(r[e]=i[e])})),Object.keys(n||{}).forEach((e=>{"level"!==e&&(r[e]=n[e])})),e[t](r,o,...s)},e.exports.getLogger=(t,n)=>{let o={},s=["trace","debug","info","warn","error","fatal"];if(!(t=t||{}).logger)return s.forEach((e=>{o[e]=()=>!1})),o;let r=t.logger;return!0===t.logger&&(r=function(e){let t=0,n=new Map;e.forEach((e=>{e.length>t&&(t=e.length)})),e.forEach((e=>{let i=e.toUpperCase();i.length<t&&(i+=" ".repeat(t-i.length)),n.set(e,i)}));let o=(e,t,o,...s)=>{let r="";t&&("server"===t.tnx?r="S: ":"client"===t.tnx&&(r="C: "),t.sid&&(r="["+t.sid+"] "+r),t.cid&&(r="[#"+t.cid+"] "+r)),(o=i.format(o,...s)).split(/\r?\n/).forEach((t=>{console.log("[%s] %s %s",(new Date).toISOString().substr(0,19).replace(/T/," "),n.get(e),r+t)}))},s={};return e.forEach((e=>{s[e]=o.bind(null,e)})),s}(s)),s.forEach((t=>{o[t]=(i,o,...s)=>{e.exports._logFunc(r,t,n,i,o,...s)}})),o},e.exports.callbackPromise=(e,t)=>function(){let i=Array.from(arguments),n=i.shift();n?t(n):e(...i)},e.exports.resolveContent=(t,i,s)=>{let r;s||(r=new Promise(((t,i)=>{s=e.exports.callbackPromise(t,i)})));let a,c=t&&t[i]&&t[i].content||t[i],u=("object"==typeof t[i]&&t[i].encoding||"utf8").toString().toLowerCase().replace(/[-_\s]/g,"");if(!c)return s(null,c);if("object"==typeof c){if("function"==typeof c.pipe)return m(c,((e,n)=>{if(e)return s(e);t[i].content?t[i].content=n:t[i]=n,s(null,n)}));if(/^https?:\/\//i.test(c.path||c.href))return a=o(c.path||c.href),m(a,s);if(/^data:/i.test(c.path||c.href)){let e=(c.path||c.href).match(/^data:((?:[^;]*;)*(?:[^,]*)),(.*)$/i);return s(null,e?/\bbase64$/i.test(e[1])?Buffer.from(e[2],"base64"):Buffer.from(decodeURIComponent(e[2])):Buffer.from(0))}if(c.path)return m(n.createReadStream(c.path),s)}return"string"!=typeof t[i].content||["utf8","usascii","ascii"].includes(u)||(c=Buffer.from(t[i].content,u)),setImmediate((()=>s(null,c))),r},e.exports.assign=function(){let e=Array.from(arguments),t=e.shift()||{};return e.forEach((e=>{Object.keys(e||{}).forEach((i=>{["tls","auth"].includes(i)&&e[i]&&"object"==typeof e[i]?(t[i]||(t[i]={}),Object.keys(e[i]).forEach((n=>{t[i][n]=e[i][n]}))):t[i]=e[i]}))})),t},e.exports.encodeXText=e=>{if(!/[^\x21-\x2A\x2C-\x3C\x3E-\x7E]/.test(e))return e;let t=Buffer.from(e),i="";for(let e=0,n=t.length;e<n;e++){let n=t[e];i+=n<33||n>126||43===n||61===n?"+"+(n<16?"0":"")+n.toString(16).toUpperCase():String.fromCharCode(n)}return i}}(cg);const wg=C.default,_g=new Map([["application/acad","dwg"],["application/applixware","aw"],["application/arj","arj"],["application/atom+xml","xml"],["application/atomcat+xml","atomcat"],["application/atomsvc+xml","atomsvc"],["application/base64",["mm","mme"]],["application/binhex","hqx"],["application/binhex4","hqx"],["application/book",["book","boo"]],["application/ccxml+xml,","ccxml"],["application/cdf","cdf"],["application/cdmi-capability","cdmia"],["application/cdmi-container","cdmic"],["application/cdmi-domain","cdmid"],["application/cdmi-object","cdmio"],["application/cdmi-queue","cdmiq"],["application/clariscad","ccad"],["application/commonground","dp"],["application/cu-seeme","cu"],["application/davmount+xml","davmount"],["application/drafting","drw"],["application/dsptype","tsp"],["application/dssc+der","dssc"],["application/dssc+xml","xdssc"],["application/dxf","dxf"],["application/ecmascript",["js","es"]],["application/emma+xml","emma"],["application/envoy","evy"],["application/epub+zip","epub"],["application/excel",["xls","xl","xla","xlb","xlc","xld","xlk","xll","xlm","xlt","xlv","xlw"]],["application/exi","exi"],["application/font-tdpfr","pfr"],["application/fractals","fif"],["application/freeloader","frl"],["application/futuresplash","spl"],["application/gnutar","tgz"],["application/groupwise","vew"],["application/hlp","hlp"],["application/hta","hta"],["application/hyperstudio","stk"],["application/i-deas","unv"],["application/iges",["iges","igs"]],["application/inf","inf"],["application/internet-property-stream","acx"],["application/ipfix","ipfix"],["application/java","class"],["application/java-archive","jar"],["application/java-byte-code","class"],["application/java-serialized-object","ser"],["application/java-vm","class"],["application/javascript","js"],["application/json","json"],["application/lha","lha"],["application/lzx","lzx"],["application/mac-binary","bin"],["application/mac-binhex","hqx"],["application/mac-binhex40","hqx"],["application/mac-compactpro","cpt"],["application/macbinary","bin"],["application/mads+xml","mads"],["application/marc","mrc"],["application/marcxml+xml","mrcx"],["application/mathematica","ma"],["application/mathml+xml","mathml"],["application/mbedlet","mbd"],["application/mbox","mbox"],["application/mcad","mcd"],["application/mediaservercontrol+xml","mscml"],["application/metalink4+xml","meta4"],["application/mets+xml","mets"],["application/mime","aps"],["application/mods+xml","mods"],["application/mp21","m21"],["application/mp4","mp4"],["application/mspowerpoint",["ppt","pot","pps","ppz"]],["application/msword",["doc","dot","w6w","wiz","word"]],["application/mswrite","wri"],["application/mxf","mxf"],["application/netmc","mcp"],["application/octet-stream",["*"]],["application/oda","oda"],["application/oebps-package+xml","opf"],["application/ogg","ogx"],["application/olescript","axs"],["application/onenote","onetoc"],["application/patch-ops-error+xml","xer"],["application/pdf","pdf"],["application/pgp-encrypted","asc"],["application/pgp-signature","pgp"],["application/pics-rules","prf"],["application/pkcs-12","p12"],["application/pkcs-crl","crl"],["application/pkcs10","p10"],["application/pkcs7-mime",["p7c","p7m"]],["application/pkcs7-signature","p7s"],["application/pkcs8","p8"],["application/pkix-attr-cert","ac"],["application/pkix-cert",["cer","crt"]],["application/pkix-crl","crl"],["application/pkix-pkipath","pkipath"],["application/pkixcmp","pki"],["application/plain","text"],["application/pls+xml","pls"],["application/postscript",["ps","ai","eps"]],["application/powerpoint","ppt"],["application/pro_eng",["part","prt"]],["application/prs.cww","cww"],["application/pskc+xml","pskcxml"],["application/rdf+xml","rdf"],["application/reginfo+xml","rif"],["application/relax-ng-compact-syntax","rnc"],["application/resource-lists+xml","rl"],["application/resource-lists-diff+xml","rld"],["application/ringing-tones","rng"],["application/rls-services+xml","rs"],["application/rsd+xml","rsd"],["application/rss+xml","xml"],["application/rtf",["rtf","rtx"]],["application/sbml+xml","sbml"],["application/scvp-cv-request","scq"],["application/scvp-cv-response","scs"],["application/scvp-vp-request","spq"],["application/scvp-vp-response","spp"],["application/sdp","sdp"],["application/sea","sea"],["application/set","set"],["application/set-payment-initiation","setpay"],["application/set-registration-initiation","setreg"],["application/shf+xml","shf"],["application/sla","stl"],["application/smil",["smi","smil"]],["application/smil+xml","smi"],["application/solids","sol"],["application/sounder","sdr"],["application/sparql-query","rq"],["application/sparql-results+xml","srx"],["application/srgs","gram"],["application/srgs+xml","grxml"],["application/sru+xml","sru"],["application/ssml+xml","ssml"],["application/step",["step","stp"]],["application/streamingmedia","ssm"],["application/tei+xml","tei"],["application/thraud+xml","tfi"],["application/timestamped-data","tsd"],["application/toolbook","tbk"],["application/vda","vda"],["application/vnd.3gpp.pic-bw-large","plb"],["application/vnd.3gpp.pic-bw-small","psb"],["application/vnd.3gpp.pic-bw-var","pvb"],["application/vnd.3gpp2.tcap","tcap"],["application/vnd.3m.post-it-notes","pwn"],["application/vnd.accpac.simply.aso","aso"],["application/vnd.accpac.simply.imp","imp"],["application/vnd.acucobol","acu"],["application/vnd.acucorp","atc"],["application/vnd.adobe.air-application-installer-package+zip","air"],["application/vnd.adobe.fxp","fxp"],["application/vnd.adobe.xdp+xml","xdp"],["application/vnd.adobe.xfdf","xfdf"],["application/vnd.ahead.space","ahead"],["application/vnd.airzip.filesecure.azf","azf"],["application/vnd.airzip.filesecure.azs","azs"],["application/vnd.amazon.ebook","azw"],["application/vnd.americandynamics.acc","acc"],["application/vnd.amiga.ami","ami"],["application/vnd.android.package-archive","apk"],["application/vnd.anser-web-certificate-issue-initiation","cii"],["application/vnd.anser-web-funds-transfer-initiation","fti"],["application/vnd.antix.game-component","atx"],["application/vnd.apple.installer+xml","mpkg"],["application/vnd.apple.mpegurl","m3u8"],["application/vnd.aristanetworks.swi","swi"],["application/vnd.audiograph","aep"],["application/vnd.blueice.multipass","mpm"],["application/vnd.bmi","bmi"],["application/vnd.businessobjects","rep"],["application/vnd.chemdraw+xml","cdxml"],["application/vnd.chipnuts.karaoke-mmd","mmd"],["application/vnd.cinderella","cdy"],["application/vnd.claymore","cla"],["application/vnd.cloanto.rp9","rp9"],["application/vnd.clonk.c4group","c4g"],["application/vnd.cluetrust.cartomobile-config","c11amc"],["application/vnd.cluetrust.cartomobile-config-pkg","c11amz"],["application/vnd.commonspace","csp"],["application/vnd.contact.cmsg","cdbcmsg"],["application/vnd.cosmocaller","cmc"],["application/vnd.crick.clicker","clkx"],["application/vnd.crick.clicker.keyboard","clkk"],["application/vnd.crick.clicker.palette","clkp"],["application/vnd.crick.clicker.template","clkt"],["application/vnd.crick.clicker.wordbank","clkw"],["application/vnd.criticaltools.wbs+xml","wbs"],["application/vnd.ctc-posml","pml"],["application/vnd.cups-ppd","ppd"],["application/vnd.curl.car","car"],["application/vnd.curl.pcurl","pcurl"],["application/vnd.data-vision.rdz","rdz"],["application/vnd.denovo.fcselayout-link","fe_launch"],["application/vnd.dna","dna"],["application/vnd.dolby.mlp","mlp"],["application/vnd.dpgraph","dpg"],["application/vnd.dreamfactory","dfac"],["application/vnd.dvb.ait","ait"],["application/vnd.dvb.service","svc"],["application/vnd.dynageo","geo"],["application/vnd.ecowin.chart","mag"],["application/vnd.enliven","nml"],["application/vnd.epson.esf","esf"],["application/vnd.epson.msf","msf"],["application/vnd.epson.quickanime","qam"],["application/vnd.epson.salt","slt"],["application/vnd.epson.ssf","ssf"],["application/vnd.eszigno3+xml","es3"],["application/vnd.ezpix-album","ez2"],["application/vnd.ezpix-package","ez3"],["application/vnd.fdf","fdf"],["application/vnd.fdsn.seed","seed"],["application/vnd.flographit","gph"],["application/vnd.fluxtime.clip","ftc"],["application/vnd.framemaker","fm"],["application/vnd.frogans.fnc","fnc"],["application/vnd.frogans.ltf","ltf"],["application/vnd.fsc.weblaunch","fsc"],["application/vnd.fujitsu.oasys","oas"],["application/vnd.fujitsu.oasys2","oa2"],["application/vnd.fujitsu.oasys3","oa3"],["application/vnd.fujitsu.oasysgp","fg5"],["application/vnd.fujitsu.oasysprs","bh2"],["application/vnd.fujixerox.ddd","ddd"],["application/vnd.fujixerox.docuworks","xdw"],["application/vnd.fujixerox.docuworks.binder","xbd"],["application/vnd.fuzzysheet","fzs"],["application/vnd.genomatix.tuxedo","txd"],["application/vnd.geogebra.file","ggb"],["application/vnd.geogebra.tool","ggt"],["application/vnd.geometry-explorer","gex"],["application/vnd.geonext","gxt"],["application/vnd.geoplan","g2w"],["application/vnd.geospace","g3w"],["application/vnd.gmx","gmx"],["application/vnd.google-earth.kml+xml","kml"],["application/vnd.google-earth.kmz","kmz"],["application/vnd.grafeq","gqf"],["application/vnd.groove-account","gac"],["application/vnd.groove-help","ghf"],["application/vnd.groove-identity-message","gim"],["application/vnd.groove-injector","grv"],["application/vnd.groove-tool-message","gtm"],["application/vnd.groove-tool-template","tpl"],["application/vnd.groove-vcard","vcg"],["application/vnd.hal+xml","hal"],["application/vnd.handheld-entertainment+xml","zmm"],["application/vnd.hbci","hbci"],["application/vnd.hhe.lesson-player","les"],["application/vnd.hp-hpgl",["hgl","hpg","hpgl"]],["application/vnd.hp-hpid","hpid"],["application/vnd.hp-hps","hps"],["application/vnd.hp-jlyt","jlt"],["application/vnd.hp-pcl","pcl"],["application/vnd.hp-pclxl","pclxl"],["application/vnd.hydrostatix.sof-data","sfd-hdstx"],["application/vnd.hzn-3d-crossword","x3d"],["application/vnd.ibm.minipay","mpy"],["application/vnd.ibm.modcap","afp"],["application/vnd.ibm.rights-management","irm"],["application/vnd.ibm.secure-container","sc"],["application/vnd.iccprofile","icc"],["application/vnd.igloader","igl"],["application/vnd.immervision-ivp","ivp"],["application/vnd.immervision-ivu","ivu"],["application/vnd.insors.igm","igm"],["application/vnd.intercon.formnet","xpw"],["application/vnd.intergeo","i2g"],["application/vnd.intu.qbo","qbo"],["application/vnd.intu.qfx","qfx"],["application/vnd.ipunplugged.rcprofile","rcprofile"],["application/vnd.irepository.package+xml","irp"],["application/vnd.is-xpr","xpr"],["application/vnd.isac.fcs","fcs"],["application/vnd.jam","jam"],["application/vnd.jcp.javame.midlet-rms","rms"],["application/vnd.jisp","jisp"],["application/vnd.joost.joda-archive","joda"],["application/vnd.kahootz","ktz"],["application/vnd.kde.karbon","karbon"],["application/vnd.kde.kchart","chrt"],["application/vnd.kde.kformula","kfo"],["application/vnd.kde.kivio","flw"],["application/vnd.kde.kontour","kon"],["application/vnd.kde.kpresenter","kpr"],["application/vnd.kde.kspread","ksp"],["application/vnd.kde.kword","kwd"],["application/vnd.kenameaapp","htke"],["application/vnd.kidspiration","kia"],["application/vnd.kinar","kne"],["application/vnd.koan","skp"],["application/vnd.kodak-descriptor","sse"],["application/vnd.las.las+xml","lasxml"],["application/vnd.llamagraphics.life-balance.desktop","lbd"],["application/vnd.llamagraphics.life-balance.exchange+xml","lbe"],["application/vnd.lotus-1-2-3","123"],["application/vnd.lotus-approach","apr"],["application/vnd.lotus-freelance","pre"],["application/vnd.lotus-notes","nsf"],["application/vnd.lotus-organizer","org"],["application/vnd.lotus-screencam","scm"],["application/vnd.lotus-wordpro","lwp"],["application/vnd.macports.portpkg","portpkg"],["application/vnd.mcd","mcd"],["application/vnd.medcalcdata","mc1"],["application/vnd.mediastation.cdkey","cdkey"],["application/vnd.mfer","mwf"],["application/vnd.mfmp","mfm"],["application/vnd.micrografx.flo","flo"],["application/vnd.micrografx.igx","igx"],["application/vnd.mif","mif"],["application/vnd.mobius.daf","daf"],["application/vnd.mobius.dis","dis"],["application/vnd.mobius.mbk","mbk"],["application/vnd.mobius.mqy","mqy"],["application/vnd.mobius.msl","msl"],["application/vnd.mobius.plc","plc"],["application/vnd.mobius.txf","txf"],["application/vnd.mophun.application","mpn"],["application/vnd.mophun.certificate","mpc"],["application/vnd.mozilla.xul+xml","xul"],["application/vnd.ms-artgalry","cil"],["application/vnd.ms-cab-compressed","cab"],["application/vnd.ms-excel",["xls","xla","xlc","xlm","xlt","xlw","xlb","xll"]],["application/vnd.ms-excel.addin.macroenabled.12","xlam"],["application/vnd.ms-excel.sheet.binary.macroenabled.12","xlsb"],["application/vnd.ms-excel.sheet.macroenabled.12","xlsm"],["application/vnd.ms-excel.template.macroenabled.12","xltm"],["application/vnd.ms-fontobject","eot"],["application/vnd.ms-htmlhelp","chm"],["application/vnd.ms-ims","ims"],["application/vnd.ms-lrm","lrm"],["application/vnd.ms-officetheme","thmx"],["application/vnd.ms-outlook","msg"],["application/vnd.ms-pki.certstore","sst"],["application/vnd.ms-pki.pko","pko"],["application/vnd.ms-pki.seccat","cat"],["application/vnd.ms-pki.stl","stl"],["application/vnd.ms-pkicertstore","sst"],["application/vnd.ms-pkiseccat","cat"],["application/vnd.ms-pkistl","stl"],["application/vnd.ms-powerpoint",["ppt","pot","pps","ppa","pwz"]],["application/vnd.ms-powerpoint.addin.macroenabled.12","ppam"],["application/vnd.ms-powerpoint.presentation.macroenabled.12","pptm"],["application/vnd.ms-powerpoint.slide.macroenabled.12","sldm"],["application/vnd.ms-powerpoint.slideshow.macroenabled.12","ppsm"],["application/vnd.ms-powerpoint.template.macroenabled.12","potm"],["application/vnd.ms-project","mpp"],["application/vnd.ms-word.document.macroenabled.12","docm"],["application/vnd.ms-word.template.macroenabled.12","dotm"],["application/vnd.ms-works",["wks","wcm","wdb","wps"]],["application/vnd.ms-wpl","wpl"],["application/vnd.ms-xpsdocument","xps"],["application/vnd.mseq","mseq"],["application/vnd.musician","mus"],["application/vnd.muvee.style","msty"],["application/vnd.neurolanguage.nlu","nlu"],["application/vnd.noblenet-directory","nnd"],["application/vnd.noblenet-sealer","nns"],["application/vnd.noblenet-web","nnw"],["application/vnd.nokia.configuration-message","ncm"],["application/vnd.nokia.n-gage.data","ngdat"],["application/vnd.nokia.n-gage.symbian.install","n-gage"],["application/vnd.nokia.radio-preset","rpst"],["application/vnd.nokia.radio-presets","rpss"],["application/vnd.nokia.ringing-tone","rng"],["application/vnd.novadigm.edm","edm"],["application/vnd.novadigm.edx","edx"],["application/vnd.novadigm.ext","ext"],["application/vnd.oasis.opendocument.chart","odc"],["application/vnd.oasis.opendocument.chart-template","otc"],["application/vnd.oasis.opendocument.database","odb"],["application/vnd.oasis.opendocument.formula","odf"],["application/vnd.oasis.opendocument.formula-template","odft"],["application/vnd.oasis.opendocument.graphics","odg"],["application/vnd.oasis.opendocument.graphics-template","otg"],["application/vnd.oasis.opendocument.image","odi"],["application/vnd.oasis.opendocument.image-template","oti"],["application/vnd.oasis.opendocument.presentation","odp"],["application/vnd.oasis.opendocument.presentation-template","otp"],["application/vnd.oasis.opendocument.spreadsheet","ods"],["application/vnd.oasis.opendocument.spreadsheet-template","ots"],["application/vnd.oasis.opendocument.text","odt"],["application/vnd.oasis.opendocument.text-master","odm"],["application/vnd.oasis.opendocument.text-template","ott"],["application/vnd.oasis.opendocument.text-web","oth"],["application/vnd.olpc-sugar","xo"],["application/vnd.oma.dd2+xml","dd2"],["application/vnd.openofficeorg.extension","oxt"],["application/vnd.openxmlformats-officedocument.presentationml.presentation","pptx"],["application/vnd.openxmlformats-officedocument.presentationml.slide","sldx"],["application/vnd.openxmlformats-officedocument.presentationml.slideshow","ppsx"],["application/vnd.openxmlformats-officedocument.presentationml.template","potx"],["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","xlsx"],["application/vnd.openxmlformats-officedocument.spreadsheetml.template","xltx"],["application/vnd.openxmlformats-officedocument.wordprocessingml.document","docx"],["application/vnd.openxmlformats-officedocument.wordprocessingml.template","dotx"],["application/vnd.osgeo.mapguide.package","mgp"],["application/vnd.osgi.dp","dp"],["application/vnd.palm","pdb"],["application/vnd.pawaafile","paw"],["application/vnd.pg.format","str"],["application/vnd.pg.osasli","ei6"],["application/vnd.picsel","efif"],["application/vnd.pmi.widget","wg"],["application/vnd.pocketlearn","plf"],["application/vnd.powerbuilder6","pbd"],["application/vnd.previewsystems.box","box"],["application/vnd.proteus.magazine","mgz"],["application/vnd.publishare-delta-tree","qps"],["application/vnd.pvi.ptid1","ptid"],["application/vnd.quark.quarkxpress","qxd"],["application/vnd.realvnc.bed","bed"],["application/vnd.recordare.musicxml","mxl"],["application/vnd.recordare.musicxml+xml","musicxml"],["application/vnd.rig.cryptonote","cryptonote"],["application/vnd.rim.cod","cod"],["application/vnd.rn-realmedia","rm"],["application/vnd.rn-realplayer","rnx"],["application/vnd.route66.link66+xml","link66"],["application/vnd.sailingtracker.track","st"],["application/vnd.seemail","see"],["application/vnd.sema","sema"],["application/vnd.semd","semd"],["application/vnd.semf","semf"],["application/vnd.shana.informed.formdata","ifm"],["application/vnd.shana.informed.formtemplate","itp"],["application/vnd.shana.informed.interchange","iif"],["application/vnd.shana.informed.package","ipk"],["application/vnd.simtech-mindmapper","twd"],["application/vnd.smaf","mmf"],["application/vnd.smart.teacher","teacher"],["application/vnd.solent.sdkm+xml","sdkm"],["application/vnd.spotfire.dxp","dxp"],["application/vnd.spotfire.sfs","sfs"],["application/vnd.stardivision.calc","sdc"],["application/vnd.stardivision.draw","sda"],["application/vnd.stardivision.impress","sdd"],["application/vnd.stardivision.math","smf"],["application/vnd.stardivision.writer","sdw"],["application/vnd.stardivision.writer-global","sgl"],["application/vnd.stepmania.stepchart","sm"],["application/vnd.sun.xml.calc","sxc"],["application/vnd.sun.xml.calc.template","stc"],["application/vnd.sun.xml.draw","sxd"],["application/vnd.sun.xml.draw.template","std"],["application/vnd.sun.xml.impress","sxi"],["application/vnd.sun.xml.impress.template","sti"],["application/vnd.sun.xml.math","sxm"],["application/vnd.sun.xml.writer","sxw"],["application/vnd.sun.xml.writer.global","sxg"],["application/vnd.sun.xml.writer.template","stw"],["application/vnd.sus-calendar","sus"],["application/vnd.svd","svd"],["application/vnd.symbian.install","sis"],["application/vnd.syncml+xml","xsm"],["application/vnd.syncml.dm+wbxml","bdm"],["application/vnd.syncml.dm+xml","xdm"],["application/vnd.tao.intent-module-archive","tao"],["application/vnd.tmobile-livetv","tmo"],["application/vnd.trid.tpt","tpt"],["application/vnd.triscape.mxs","mxs"],["application/vnd.trueapp","tra"],["application/vnd.ufdl","ufd"],["application/vnd.uiq.theme","utz"],["application/vnd.umajin","umj"],["application/vnd.unity","unityweb"],["application/vnd.uoml+xml","uoml"],["application/vnd.vcx","vcx"],["application/vnd.visio","vsd"],["application/vnd.visionary","vis"],["application/vnd.vsf","vsf"],["application/vnd.wap.wbxml","wbxml"],["application/vnd.wap.wmlc","wmlc"],["application/vnd.wap.wmlscriptc","wmlsc"],["application/vnd.webturbo","wtb"],["application/vnd.wolfram.player","nbp"],["application/vnd.wordperfect","wpd"],["application/vnd.wqd","wqd"],["application/vnd.wt.stf","stf"],["application/vnd.xara",["web","xar"]],["application/vnd.xfdl","xfdl"],["application/vnd.yamaha.hv-dic","hvd"],["application/vnd.yamaha.hv-script","hvs"],["application/vnd.yamaha.hv-voice","hvp"],["application/vnd.yamaha.openscoreformat","osf"],["application/vnd.yamaha.openscoreformat.osfpvg+xml","osfpvg"],["application/vnd.yamaha.smaf-audio","saf"],["application/vnd.yamaha.smaf-phrase","spf"],["application/vnd.yellowriver-custom-menu","cmp"],["application/vnd.zul","zir"],["application/vnd.zzazz.deck+xml","zaz"],["application/vocaltec-media-desc","vmd"],["application/vocaltec-media-file","vmf"],["application/voicexml+xml","vxml"],["application/widget","wgt"],["application/winhlp","hlp"],["application/wordperfect",["wp","wp5","wp6","wpd"]],["application/wordperfect6.0",["w60","wp5"]],["application/wordperfect6.1","w61"],["application/wsdl+xml","wsdl"],["application/wspolicy+xml","wspolicy"],["application/x-123","wk1"],["application/x-7z-compressed","7z"],["application/x-abiword","abw"],["application/x-ace-compressed","ace"],["application/x-aim","aim"],["application/x-authorware-bin","aab"],["application/x-authorware-map","aam"],["application/x-authorware-seg","aas"],["application/x-bcpio","bcpio"],["application/x-binary","bin"],["application/x-binhex40","hqx"],["application/x-bittorrent","torrent"],["application/x-bsh",["bsh","sh","shar"]],["application/x-bytecode.elisp","elc"],["applicaiton/x-bytecode.python","pyc"],["application/x-bzip","bz"],["application/x-bzip2",["boz","bz2"]],["application/x-cdf","cdf"],["application/x-cdlink","vcd"],["application/x-chat",["cha","chat"]],["application/x-chess-pgn","pgn"],["application/x-cmu-raster","ras"],["application/x-cocoa","cco"],["application/x-compactpro","cpt"],["application/x-compress","z"],["application/x-compressed",["tgz","gz","z","zip"]],["application/x-conference","nsc"],["application/x-cpio","cpio"],["application/x-cpt","cpt"],["application/x-csh","csh"],["application/x-debian-package","deb"],["application/x-deepv","deepv"],["application/x-director",["dir","dcr","dxr"]],["application/x-doom","wad"],["application/x-dtbncx+xml","ncx"],["application/x-dtbook+xml","dtb"],["application/x-dtbresource+xml","res"],["application/x-dvi","dvi"],["application/x-elc","elc"],["application/x-envoy",["env","evy"]],["application/x-esrehber","es"],["application/x-excel",["xls","xla","xlb","xlc","xld","xlk","xll","xlm","xlt","xlv","xlw"]],["application/x-font-bdf","bdf"],["application/x-font-ghostscript","gsf"],["application/x-font-linux-psf","psf"],["application/x-font-otf","otf"],["application/x-font-pcf","pcf"],["application/x-font-snf","snf"],["application/x-font-ttf","ttf"],["application/x-font-type1","pfa"],["application/x-font-woff","woff"],["application/x-frame","mif"],["application/x-freelance","pre"],["application/x-futuresplash","spl"],["application/x-gnumeric","gnumeric"],["application/x-gsp","gsp"],["application/x-gss","gss"],["application/x-gtar","gtar"],["application/x-gzip",["gz","gzip"]],["application/x-hdf","hdf"],["application/x-helpfile",["help","hlp"]],["application/x-httpd-imap","imap"],["application/x-ima","ima"],["application/x-internet-signup",["ins","isp"]],["application/x-internett-signup","ins"],["application/x-inventor","iv"],["application/x-ip2","ip"],["application/x-iphone","iii"],["application/x-java-class","class"],["application/x-java-commerce","jcm"],["application/x-java-jnlp-file","jnlp"],["application/x-javascript","js"],["application/x-koan",["skd","skm","skp","skt"]],["application/x-ksh","ksh"],["application/x-latex",["latex","ltx"]],["application/x-lha","lha"],["application/x-lisp","lsp"],["application/x-livescreen","ivy"],["application/x-lotus","wq1"],["application/x-lotusscreencam","scm"],["application/x-lzh","lzh"],["application/x-lzx","lzx"],["application/x-mac-binhex40","hqx"],["application/x-macbinary","bin"],["application/x-magic-cap-package-1.0","mc$"],["application/x-mathcad","mcd"],["application/x-meme","mm"],["application/x-midi",["mid","midi"]],["application/x-mif","mif"],["application/x-mix-transfer","nix"],["application/x-mobipocket-ebook","prc"],["application/x-mplayer2","asx"],["application/x-ms-application","application"],["application/x-ms-wmd","wmd"],["application/x-ms-wmz","wmz"],["application/x-ms-xbap","xbap"],["application/x-msaccess","mdb"],["application/x-msbinder","obd"],["application/x-mscardfile","crd"],["application/x-msclip","clp"],["application/x-msdownload",["exe","dll"]],["application/x-msexcel",["xls","xla","xlw"]],["application/x-msmediaview",["mvb","m13","m14"]],["application/x-msmetafile","wmf"],["application/x-msmoney","mny"],["application/x-mspowerpoint","ppt"],["application/x-mspublisher","pub"],["application/x-msschedule","scd"],["application/x-msterminal","trm"],["application/x-mswrite","wri"],["application/x-navi-animation","ani"],["application/x-navidoc","nvd"],["application/x-navimap","map"],["application/x-navistyle","stl"],["application/x-netcdf",["cdf","nc"]],["application/x-newton-compatible-pkg","pkg"],["application/x-nokia-9000-communicator-add-on-software","aos"],["application/x-omc","omc"],["application/x-omcdatamaker","omcd"],["application/x-omcregerator","omcr"],["application/x-pagemaker",["pm4","pm5"]],["application/x-pcl","pcl"],["application/x-perfmon",["pma","pmc","pml","pmr","pmw"]],["application/x-pixclscript","plx"],["application/x-pkcs10","p10"],["application/x-pkcs12",["p12","pfx"]],["application/x-pkcs7-certificates",["p7b","spc"]],["application/x-pkcs7-certreqresp","p7r"],["application/x-pkcs7-mime",["p7m","p7c"]],["application/x-pkcs7-signature",["p7s","p7a"]],["application/x-pointplus","css"],["application/x-portable-anymap","pnm"],["application/x-project",["mpc","mpt","mpv","mpx"]],["application/x-qpro","wb1"],["application/x-rar-compressed","rar"],["application/x-rtf","rtf"],["application/x-sdp","sdp"],["application/x-sea","sea"],["application/x-seelogo","sl"],["application/x-sh","sh"],["application/x-shar",["shar","sh"]],["application/x-shockwave-flash","swf"],["application/x-silverlight-app","xap"],["application/x-sit","sit"],["application/x-sprite",["spr","sprite"]],["application/x-stuffit","sit"],["application/x-stuffitx","sitx"],["application/x-sv4cpio","sv4cpio"],["application/x-sv4crc","sv4crc"],["application/x-tar","tar"],["application/x-tbook",["sbk","tbk"]],["application/x-tcl","tcl"],["application/x-tex","tex"],["application/x-tex-tfm","tfm"],["application/x-texinfo",["texi","texinfo"]],["application/x-troff",["roff","t","tr"]],["application/x-troff-man","man"],["application/x-troff-me","me"],["application/x-troff-ms","ms"],["application/x-troff-msvideo","avi"],["application/x-ustar","ustar"],["application/x-visio",["vsd","vst","vsw"]],["application/x-vnd.audioexplosion.mzz","mzz"],["application/x-vnd.ls-xpix","xpix"],["application/x-vrml","vrml"],["application/x-wais-source",["src","wsrc"]],["application/x-winhelp","hlp"],["application/x-wintalk","wtk"],["application/x-world",["wrl","svr"]],["application/x-wpwin","wpd"],["application/x-wri","wri"],["application/x-x509-ca-cert",["cer","crt","der"]],["application/x-x509-user-cert","crt"],["application/x-xfig","fig"],["application/x-xpinstall","xpi"],["application/x-zip-compressed","zip"],["application/xcap-diff+xml","xdf"],["application/xenc+xml","xenc"],["application/xhtml+xml","xhtml"],["application/xml","xml"],["application/xml-dtd","dtd"],["application/xop+xml","xop"],["application/xslt+xml","xslt"],["application/xspf+xml","xspf"],["application/xv+xml","mxml"],["application/yang","yang"],["application/yin+xml","yin"],["application/ynd.ms-pkipko","pko"],["application/zip","zip"],["audio/adpcm","adp"],["audio/aiff",["aiff","aif","aifc"]],["audio/basic",["snd","au"]],["audio/it","it"],["audio/make",["funk","my","pfunk"]],["audio/make.my.funk","pfunk"],["audio/mid",["mid","rmi"]],["audio/midi",["midi","kar","mid"]],["audio/mod","mod"],["audio/mp4","mp4a"],["audio/mpeg",["mpga","mp3","m2a","mp2","mpa","mpg"]],["audio/mpeg3","mp3"],["audio/nspaudio",["la","lma"]],["audio/ogg","oga"],["audio/s3m","s3m"],["audio/tsp-audio","tsi"],["audio/tsplayer","tsp"],["audio/vnd.dece.audio","uva"],["audio/vnd.digital-winds","eol"],["audio/vnd.dra","dra"],["audio/vnd.dts","dts"],["audio/vnd.dts.hd","dtshd"],["audio/vnd.lucent.voice","lvp"],["audio/vnd.ms-playready.media.pya","pya"],["audio/vnd.nuera.ecelp4800","ecelp4800"],["audio/vnd.nuera.ecelp7470","ecelp7470"],["audio/vnd.nuera.ecelp9600","ecelp9600"],["audio/vnd.qcelp","qcp"],["audio/vnd.rip","rip"],["audio/voc","voc"],["audio/voxware","vox"],["audio/wav","wav"],["audio/webm","weba"],["audio/x-aac","aac"],["audio/x-adpcm","snd"],["audio/x-aiff",["aiff","aif","aifc"]],["audio/x-au","au"],["audio/x-gsm",["gsd","gsm"]],["audio/x-jam","jam"],["audio/x-liveaudio","lam"],["audio/x-mid",["mid","midi"]],["audio/x-midi",["midi","mid"]],["audio/x-mod","mod"],["audio/x-mpeg","mp2"],["audio/x-mpeg-3","mp3"],["audio/x-mpegurl","m3u"],["audio/x-mpequrl","m3u"],["audio/x-ms-wax","wax"],["audio/x-ms-wma","wma"],["audio/x-nspaudio",["la","lma"]],["audio/x-pn-realaudio",["ra","ram","rm","rmm","rmp"]],["audio/x-pn-realaudio-plugin",["ra","rmp","rpm"]],["audio/x-psid","sid"],["audio/x-realaudio","ra"],["audio/x-twinvq","vqf"],["audio/x-twinvq-plugin",["vqe","vql"]],["audio/x-vnd.audioexplosion.mjuicemediafile","mjf"],["audio/x-voc","voc"],["audio/x-wav","wav"],["audio/xm","xm"],["chemical/x-cdx","cdx"],["chemical/x-cif","cif"],["chemical/x-cmdf","cmdf"],["chemical/x-cml","cml"],["chemical/x-csml","csml"],["chemical/x-pdb",["pdb","xyz"]],["chemical/x-xyz","xyz"],["drawing/x-dwf","dwf"],["i-world/i-vrml","ivr"],["image/bmp",["bmp","bm"]],["image/cgm","cgm"],["image/cis-cod","cod"],["image/cmu-raster",["ras","rast"]],["image/fif","fif"],["image/florian",["flo","turbot"]],["image/g3fax","g3"],["image/gif","gif"],["image/ief",["ief","iefs"]],["image/jpeg",["jpeg","jpe","jpg","jfif","jfif-tbnl"]],["image/jutvision","jut"],["image/ktx","ktx"],["image/naplps",["nap","naplps"]],["image/pict",["pic","pict"]],["image/pipeg","jfif"],["image/pjpeg",["jfif","jpe","jpeg","jpg"]],["image/png",["png","x-png"]],["image/prs.btif","btif"],["image/svg+xml","svg"],["image/tiff",["tif","tiff"]],["image/vasa","mcf"],["image/vnd.adobe.photoshop","psd"],["image/vnd.dece.graphic","uvi"],["image/vnd.djvu","djvu"],["image/vnd.dvb.subtitle","sub"],["image/vnd.dwg",["dwg","dxf","svf"]],["image/vnd.dxf","dxf"],["image/vnd.fastbidsheet","fbs"],["image/vnd.fpx","fpx"],["image/vnd.fst","fst"],["image/vnd.fujixerox.edmics-mmr","mmr"],["image/vnd.fujixerox.edmics-rlc","rlc"],["image/vnd.ms-modi","mdi"],["image/vnd.net-fpx",["fpx","npx"]],["image/vnd.rn-realflash","rf"],["image/vnd.rn-realpix","rp"],["image/vnd.wap.wbmp","wbmp"],["image/vnd.xiff","xif"],["image/webp","webp"],["image/x-cmu-raster","ras"],["image/x-cmx","cmx"],["image/x-dwg",["dwg","dxf","svf"]],["image/x-freehand","fh"],["image/x-icon","ico"],["image/x-jg","art"],["image/x-jps","jps"],["image/x-niff",["niff","nif"]],["image/x-pcx","pcx"],["image/x-pict",["pct","pic"]],["image/x-portable-anymap","pnm"],["image/x-portable-bitmap","pbm"],["image/x-portable-graymap","pgm"],["image/x-portable-greymap","pgm"],["image/x-portable-pixmap","ppm"],["image/x-quicktime",["qif","qti","qtif"]],["image/x-rgb","rgb"],["image/x-tiff",["tif","tiff"]],["image/x-windows-bmp","bmp"],["image/x-xbitmap","xbm"],["image/x-xbm","xbm"],["image/x-xpixmap",["xpm","pm"]],["image/x-xwd","xwd"],["image/x-xwindowdump","xwd"],["image/xbm","xbm"],["image/xpm","xpm"],["message/rfc822",["eml","mht","mhtml","nws","mime"]],["model/iges",["iges","igs"]],["model/mesh","msh"],["model/vnd.collada+xml","dae"],["model/vnd.dwf","dwf"],["model/vnd.gdl","gdl"],["model/vnd.gtw","gtw"],["model/vnd.mts","mts"],["model/vnd.vtu","vtu"],["model/vrml",["vrml","wrl","wrz"]],["model/x-pov","pov"],["multipart/x-gzip","gzip"],["multipart/x-ustar","ustar"],["multipart/x-zip","zip"],["music/crescendo",["mid","midi"]],["music/x-karaoke","kar"],["paleovu/x-pv","pvu"],["text/asp","asp"],["text/calendar","ics"],["text/css","css"],["text/csv","csv"],["text/ecmascript","js"],["text/h323","323"],["text/html",["html","htm","stm","acgi","htmls","htx","shtml"]],["text/iuls","uls"],["text/javascript","js"],["text/mcf","mcf"],["text/n3","n3"],["text/pascal","pas"],["text/plain",["txt","bas","c","h","c++","cc","com","conf","cxx","def","f","f90","for","g","hh","idc","jav","java","list","log","lst","m","mar","pl","sdml","text"]],["text/plain-bas","par"],["text/prs.lines.tag","dsc"],["text/richtext",["rtx","rt","rtf"]],["text/scriplet","wsc"],["text/scriptlet","sct"],["text/sgml",["sgm","sgml"]],["text/tab-separated-values","tsv"],["text/troff","t"],["text/turtle","ttl"],["text/uri-list",["uni","unis","uri","uris"]],["text/vnd.abc","abc"],["text/vnd.curl","curl"],["text/vnd.curl.dcurl","dcurl"],["text/vnd.curl.mcurl","mcurl"],["text/vnd.curl.scurl","scurl"],["text/vnd.fly","fly"],["text/vnd.fmi.flexstor","flx"],["text/vnd.graphviz","gv"],["text/vnd.in3d.3dml","3dml"],["text/vnd.in3d.spot","spot"],["text/vnd.rn-realtext","rt"],["text/vnd.sun.j2me.app-descriptor","jad"],["text/vnd.wap.wml","wml"],["text/vnd.wap.wmlscript","wmls"],["text/webviewhtml","htt"],["text/x-asm",["asm","s"]],["text/x-audiosoft-intra","aip"],["text/x-c",["c","cc","cpp"]],["text/x-component","htc"],["text/x-fortran",["for","f","f77","f90"]],["text/x-h",["h","hh"]],["text/x-java-source",["java","jav"]],["text/x-java-source,java","java"],["text/x-la-asf","lsx"],["text/x-m","m"],["text/x-pascal","p"],["text/x-script","hlb"],["text/x-script.csh","csh"],["text/x-script.elisp","el"],["text/x-script.guile","scm"],["text/x-script.ksh","ksh"],["text/x-script.lisp","lsp"],["text/x-script.perl","pl"],["text/x-script.perl-module","pm"],["text/x-script.phyton","py"],["text/x-script.rexx","rexx"],["text/x-script.scheme","scm"],["text/x-script.sh","sh"],["text/x-script.tcl","tcl"],["text/x-script.tcsh","tcsh"],["text/x-script.zsh","zsh"],["text/x-server-parsed-html",["shtml","ssi"]],["text/x-setext","etx"],["text/x-sgml",["sgm","sgml"]],["text/x-speech",["spc","talk"]],["text/x-uil","uil"],["text/x-uuencode",["uu","uue"]],["text/x-vcalendar","vcs"],["text/x-vcard","vcf"],["text/xml","xml"],["video/3gpp","3gp"],["video/3gpp2","3g2"],["video/animaflex","afl"],["video/avi","avi"],["video/avs-video","avs"],["video/dl","dl"],["video/fli","fli"],["video/gl","gl"],["video/h261","h261"],["video/h263","h263"],["video/h264","h264"],["video/jpeg","jpgv"],["video/jpm","jpm"],["video/mj2","mj2"],["video/mp4","mp4"],["video/mpeg",["mpeg","mp2","mpa","mpe","mpg","mpv2","m1v","m2v","mp3"]],["video/msvideo","avi"],["video/ogg","ogv"],["video/quicktime",["mov","qt","moov"]],["video/vdo","vdo"],["video/vivo",["viv","vivo"]],["video/vnd.dece.hd","uvh"],["video/vnd.dece.mobile","uvm"],["video/vnd.dece.pd","uvp"],["video/vnd.dece.sd","uvs"],["video/vnd.dece.video","uvv"],["video/vnd.fvt","fvt"],["video/vnd.mpegurl","mxu"],["video/vnd.ms-playready.media.pyv","pyv"],["video/vnd.rn-realvideo","rv"],["video/vnd.uvvu.mp4","uvu"],["video/vnd.vivo",["viv","vivo"]],["video/vosaic","vos"],["video/webm","webm"],["video/x-amt-demorun","xdr"],["video/x-amt-showrun","xsr"],["video/x-atomic3d-feature","fmf"],["video/x-dl","dl"],["video/x-dv",["dif","dv"]],["video/x-f4v","f4v"],["video/x-fli","fli"],["video/x-flv","flv"],["video/x-gl","gl"],["video/x-isvideo","isu"],["video/x-la-asf",["lsf","lsx"]],["video/x-m4v","m4v"],["video/x-motion-jpeg","mjpg"],["video/x-mpeg",["mp3","mp2"]],["video/x-mpeq2a","mp2"],["video/x-ms-asf",["asf","asr","asx"]],["video/x-ms-asf-plugin","asx"],["video/x-ms-wm","wm"],["video/x-ms-wmv","wmv"],["video/x-ms-wmx","wmx"],["video/x-ms-wvx","wvx"],["video/x-msvideo","avi"],["video/x-qtc","qtc"],["video/x-scm","scm"],["video/x-sgi-movie",["movie","mv"]],["windows/metafile","wmf"],["www/mime","mime"],["x-conference/x-cooltalk","ice"],["x-music/x-midi",["mid","midi"]],["x-world/x-3dmf",["3dm","3dmf","qd3","qd3d"]],["x-world/x-svr","svr"],["x-world/x-vrml",["flr","vrml","wrl","wrz","xaf","xof"]],["x-world/x-vrt","vrt"],["xgl/drawing","xgz"],["xgl/movie","xmz"]]),Dg=new Map([["123","application/vnd.lotus-1-2-3"],["323","text/h323"],["*","application/octet-stream"],["3dm","x-world/x-3dmf"],["3dmf","x-world/x-3dmf"],["3dml","text/vnd.in3d.3dml"],["3g2","video/3gpp2"],["3gp","video/3gpp"],["7z","application/x-7z-compressed"],["a","application/octet-stream"],["aab","application/x-authorware-bin"],["aac","audio/x-aac"],["aam","application/x-authorware-map"],["aas","application/x-authorware-seg"],["abc","text/vnd.abc"],["abw","application/x-abiword"],["ac","application/pkix-attr-cert"],["acc","application/vnd.americandynamics.acc"],["ace","application/x-ace-compressed"],["acgi","text/html"],["acu","application/vnd.acucobol"],["acx","application/internet-property-stream"],["adp","audio/adpcm"],["aep","application/vnd.audiograph"],["afl","video/animaflex"],["afp","application/vnd.ibm.modcap"],["ahead","application/vnd.ahead.space"],["ai","application/postscript"],["aif",["audio/aiff","audio/x-aiff"]],["aifc",["audio/aiff","audio/x-aiff"]],["aiff",["audio/aiff","audio/x-aiff"]],["aim","application/x-aim"],["aip","text/x-audiosoft-intra"],["air","application/vnd.adobe.air-application-installer-package+zip"],["ait","application/vnd.dvb.ait"],["ami","application/vnd.amiga.ami"],["ani","application/x-navi-animation"],["aos","application/x-nokia-9000-communicator-add-on-software"],["apk","application/vnd.android.package-archive"],["application","application/x-ms-application"],["apr","application/vnd.lotus-approach"],["aps","application/mime"],["arc","application/octet-stream"],["arj",["application/arj","application/octet-stream"]],["art","image/x-jg"],["asf","video/x-ms-asf"],["asm","text/x-asm"],["aso","application/vnd.accpac.simply.aso"],["asp","text/asp"],["asr","video/x-ms-asf"],["asx",["video/x-ms-asf","application/x-mplayer2","video/x-ms-asf-plugin"]],["atc","application/vnd.acucorp"],["atomcat","application/atomcat+xml"],["atomsvc","application/atomsvc+xml"],["atx","application/vnd.antix.game-component"],["au",["audio/basic","audio/x-au"]],["avi",["video/avi","video/msvideo","application/x-troff-msvideo","video/x-msvideo"]],["avs","video/avs-video"],["aw","application/applixware"],["axs","application/olescript"],["azf","application/vnd.airzip.filesecure.azf"],["azs","application/vnd.airzip.filesecure.azs"],["azw","application/vnd.amazon.ebook"],["bas","text/plain"],["bcpio","application/x-bcpio"],["bdf","application/x-font-bdf"],["bdm","application/vnd.syncml.dm+wbxml"],["bed","application/vnd.realvnc.bed"],["bh2","application/vnd.fujitsu.oasysprs"],["bin",["application/octet-stream","application/mac-binary","application/macbinary","application/x-macbinary","application/x-binary"]],["bm","image/bmp"],["bmi","application/vnd.bmi"],["bmp",["image/bmp","image/x-windows-bmp"]],["boo","application/book"],["book","application/book"],["box","application/vnd.previewsystems.box"],["boz","application/x-bzip2"],["bsh","application/x-bsh"],["btif","image/prs.btif"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["c",["text/plain","text/x-c"]],["c++","text/plain"],["c11amc","application/vnd.cluetrust.cartomobile-config"],["c11amz","application/vnd.cluetrust.cartomobile-config-pkg"],["c4g","application/vnd.clonk.c4group"],["cab","application/vnd.ms-cab-compressed"],["car","application/vnd.curl.car"],["cat",["application/vnd.ms-pkiseccat","application/vnd.ms-pki.seccat"]],["cc",["text/plain","text/x-c"]],["ccad","application/clariscad"],["cco","application/x-cocoa"],["ccxml","application/ccxml+xml,"],["cdbcmsg","application/vnd.contact.cmsg"],["cdf",["application/cdf","application/x-cdf","application/x-netcdf"]],["cdkey","application/vnd.mediastation.cdkey"],["cdmia","application/cdmi-capability"],["cdmic","application/cdmi-container"],["cdmid","application/cdmi-domain"],["cdmio","application/cdmi-object"],["cdmiq","application/cdmi-queue"],["cdx","chemical/x-cdx"],["cdxml","application/vnd.chemdraw+xml"],["cdy","application/vnd.cinderella"],["cer",["application/pkix-cert","application/x-x509-ca-cert"]],["cgm","image/cgm"],["cha","application/x-chat"],["chat","application/x-chat"],["chm","application/vnd.ms-htmlhelp"],["chrt","application/vnd.kde.kchart"],["cif","chemical/x-cif"],["cii","application/vnd.anser-web-certificate-issue-initiation"],["cil","application/vnd.ms-artgalry"],["cla","application/vnd.claymore"],["class",["application/octet-stream","application/java","application/java-byte-code","application/java-vm","application/x-java-class"]],["clkk","application/vnd.crick.clicker.keyboard"],["clkp","application/vnd.crick.clicker.palette"],["clkt","application/vnd.crick.clicker.template"],["clkw","application/vnd.crick.clicker.wordbank"],["clkx","application/vnd.crick.clicker"],["clp","application/x-msclip"],["cmc","application/vnd.cosmocaller"],["cmdf","chemical/x-cmdf"],["cml","chemical/x-cml"],["cmp","application/vnd.yellowriver-custom-menu"],["cmx","image/x-cmx"],["cod",["image/cis-cod","application/vnd.rim.cod"]],["com",["application/octet-stream","text/plain"]],["conf","text/plain"],["cpio","application/x-cpio"],["cpp","text/x-c"],["cpt",["application/mac-compactpro","application/x-compactpro","application/x-cpt"]],["crd","application/x-mscardfile"],["crl",["application/pkix-crl","application/pkcs-crl"]],["crt",["application/pkix-cert","application/x-x509-user-cert","application/x-x509-ca-cert"]],["cryptonote","application/vnd.rig.cryptonote"],["csh",["text/x-script.csh","application/x-csh"]],["csml","chemical/x-csml"],["csp","application/vnd.commonspace"],["css",["text/css","application/x-pointplus"]],["csv","text/csv"],["cu","application/cu-seeme"],["curl","text/vnd.curl"],["cww","application/prs.cww"],["cxx","text/plain"],["dae","model/vnd.collada+xml"],["daf","application/vnd.mobius.daf"],["davmount","application/davmount+xml"],["dcr","application/x-director"],["dcurl","text/vnd.curl.dcurl"],["dd2","application/vnd.oma.dd2+xml"],["ddd","application/vnd.fujixerox.ddd"],["deb","application/x-debian-package"],["deepv","application/x-deepv"],["def","text/plain"],["der","application/x-x509-ca-cert"],["dfac","application/vnd.dreamfactory"],["dif","video/x-dv"],["dir","application/x-director"],["dis","application/vnd.mobius.dis"],["djvu","image/vnd.djvu"],["dl",["video/dl","video/x-dl"]],["dll","application/x-msdownload"],["dms","application/octet-stream"],["dna","application/vnd.dna"],["doc","application/msword"],["docm","application/vnd.ms-word.document.macroenabled.12"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["dot","application/msword"],["dotm","application/vnd.ms-word.template.macroenabled.12"],["dotx","application/vnd.openxmlformats-officedocument.wordprocessingml.template"],["dp",["application/commonground","application/vnd.osgi.dp"]],["dpg","application/vnd.dpgraph"],["dra","audio/vnd.dra"],["drw","application/drafting"],["dsc","text/prs.lines.tag"],["dssc","application/dssc+der"],["dtb","application/x-dtbook+xml"],["dtd","application/xml-dtd"],["dts","audio/vnd.dts"],["dtshd","audio/vnd.dts.hd"],["dump","application/octet-stream"],["dv","video/x-dv"],["dvi","application/x-dvi"],["dwf",["model/vnd.dwf","drawing/x-dwf"]],["dwg",["application/acad","image/vnd.dwg","image/x-dwg"]],["dxf",["application/dxf","image/vnd.dwg","image/vnd.dxf","image/x-dwg"]],["dxp","application/vnd.spotfire.dxp"],["dxr","application/x-director"],["ecelp4800","audio/vnd.nuera.ecelp4800"],["ecelp7470","audio/vnd.nuera.ecelp7470"],["ecelp9600","audio/vnd.nuera.ecelp9600"],["edm","application/vnd.novadigm.edm"],["edx","application/vnd.novadigm.edx"],["efif","application/vnd.picsel"],["ei6","application/vnd.pg.osasli"],["el","text/x-script.elisp"],["elc",["application/x-elc","application/x-bytecode.elisp"]],["eml","message/rfc822"],["emma","application/emma+xml"],["env","application/x-envoy"],["eol","audio/vnd.digital-winds"],["eot","application/vnd.ms-fontobject"],["eps","application/postscript"],["epub","application/epub+zip"],["es",["application/ecmascript","application/x-esrehber"]],["es3","application/vnd.eszigno3+xml"],["esf","application/vnd.epson.esf"],["etx","text/x-setext"],["evy",["application/envoy","application/x-envoy"]],["exe",["application/octet-stream","application/x-msdownload"]],["exi","application/exi"],["ext","application/vnd.novadigm.ext"],["ez2","application/vnd.ezpix-album"],["ez3","application/vnd.ezpix-package"],["f",["text/plain","text/x-fortran"]],["f4v","video/x-f4v"],["f77","text/x-fortran"],["f90",["text/plain","text/x-fortran"]],["fbs","image/vnd.fastbidsheet"],["fcs","application/vnd.isac.fcs"],["fdf","application/vnd.fdf"],["fe_launch","application/vnd.denovo.fcselayout-link"],["fg5","application/vnd.fujitsu.oasysgp"],["fh","image/x-freehand"],["fif",["application/fractals","image/fif"]],["fig","application/x-xfig"],["fli",["video/fli","video/x-fli"]],["flo",["image/florian","application/vnd.micrografx.flo"]],["flr","x-world/x-vrml"],["flv","video/x-flv"],["flw","application/vnd.kde.kivio"],["flx","text/vnd.fmi.flexstor"],["fly","text/vnd.fly"],["fm","application/vnd.framemaker"],["fmf","video/x-atomic3d-feature"],["fnc","application/vnd.frogans.fnc"],["for",["text/plain","text/x-fortran"]],["fpx",["image/vnd.fpx","image/vnd.net-fpx"]],["frl","application/freeloader"],["fsc","application/vnd.fsc.weblaunch"],["fst","image/vnd.fst"],["ftc","application/vnd.fluxtime.clip"],["fti","application/vnd.anser-web-funds-transfer-initiation"],["funk","audio/make"],["fvt","video/vnd.fvt"],["fxp","application/vnd.adobe.fxp"],["fzs","application/vnd.fuzzysheet"],["g","text/plain"],["g2w","application/vnd.geoplan"],["g3","image/g3fax"],["g3w","application/vnd.geospace"],["gac","application/vnd.groove-account"],["gdl","model/vnd.gdl"],["geo","application/vnd.dynageo"],["gex","application/vnd.geometry-explorer"],["ggb","application/vnd.geogebra.file"],["ggt","application/vnd.geogebra.tool"],["ghf","application/vnd.groove-help"],["gif","image/gif"],["gim","application/vnd.groove-identity-message"],["gl",["video/gl","video/x-gl"]],["gmx","application/vnd.gmx"],["gnumeric","application/x-gnumeric"],["gph","application/vnd.flographit"],["gqf","application/vnd.grafeq"],["gram","application/srgs"],["grv","application/vnd.groove-injector"],["grxml","application/srgs+xml"],["gsd","audio/x-gsm"],["gsf","application/x-font-ghostscript"],["gsm","audio/x-gsm"],["gsp","application/x-gsp"],["gss","application/x-gss"],["gtar","application/x-gtar"],["gtm","application/vnd.groove-tool-message"],["gtw","model/vnd.gtw"],["gv","text/vnd.graphviz"],["gxt","application/vnd.geonext"],["gz",["application/x-gzip","application/x-compressed"]],["gzip",["multipart/x-gzip","application/x-gzip"]],["h",["text/plain","text/x-h"]],["h261","video/h261"],["h263","video/h263"],["h264","video/h264"],["hal","application/vnd.hal+xml"],["hbci","application/vnd.hbci"],["hdf","application/x-hdf"],["help","application/x-helpfile"],["hgl","application/vnd.hp-hpgl"],["hh",["text/plain","text/x-h"]],["hlb","text/x-script"],["hlp",["application/winhlp","application/hlp","application/x-helpfile","application/x-winhelp"]],["hpg","application/vnd.hp-hpgl"],["hpgl","application/vnd.hp-hpgl"],["hpid","application/vnd.hp-hpid"],["hps","application/vnd.hp-hps"],["hqx",["application/mac-binhex40","application/binhex","application/binhex4","application/mac-binhex","application/x-binhex40","application/x-mac-binhex40"]],["hta","application/hta"],["htc","text/x-component"],["htke","application/vnd.kenameaapp"],["htm","text/html"],["html","text/html"],["htmls","text/html"],["htt","text/webviewhtml"],["htx","text/html"],["hvd","application/vnd.yamaha.hv-dic"],["hvp","application/vnd.yamaha.hv-voice"],["hvs","application/vnd.yamaha.hv-script"],["i2g","application/vnd.intergeo"],["icc","application/vnd.iccprofile"],["ice","x-conference/x-cooltalk"],["ico","image/x-icon"],["ics","text/calendar"],["idc","text/plain"],["ief","image/ief"],["iefs","image/ief"],["ifm","application/vnd.shana.informed.formdata"],["iges",["application/iges","model/iges"]],["igl","application/vnd.igloader"],["igm","application/vnd.insors.igm"],["igs",["application/iges","model/iges"]],["igx","application/vnd.micrografx.igx"],["iif","application/vnd.shana.informed.interchange"],["iii","application/x-iphone"],["ima","application/x-ima"],["imap","application/x-httpd-imap"],["imp","application/vnd.accpac.simply.imp"],["ims","application/vnd.ms-ims"],["inf","application/inf"],["ins",["application/x-internet-signup","application/x-internett-signup"]],["ip","application/x-ip2"],["ipfix","application/ipfix"],["ipk","application/vnd.shana.informed.package"],["irm","application/vnd.ibm.rights-management"],["irp","application/vnd.irepository.package+xml"],["isp","application/x-internet-signup"],["isu","video/x-isvideo"],["it","audio/it"],["itp","application/vnd.shana.informed.formtemplate"],["iv","application/x-inventor"],["ivp","application/vnd.immervision-ivp"],["ivr","i-world/i-vrml"],["ivu","application/vnd.immervision-ivu"],["ivy","application/x-livescreen"],["jad","text/vnd.sun.j2me.app-descriptor"],["jam",["application/vnd.jam","audio/x-jam"]],["jar","application/java-archive"],["jav",["text/plain","text/x-java-source"]],["java",["text/plain","text/x-java-source,java","text/x-java-source"]],["jcm","application/x-java-commerce"],["jfif",["image/pipeg","image/jpeg","image/pjpeg"]],["jfif-tbnl","image/jpeg"],["jisp","application/vnd.jisp"],["jlt","application/vnd.hp-jlyt"],["jnlp","application/x-java-jnlp-file"],["joda","application/vnd.joost.joda-archive"],["jpe",["image/jpeg","image/pjpeg"]],["jpeg",["image/jpeg","image/pjpeg"]],["jpg",["image/jpeg","image/pjpeg"]],["jpgv","video/jpeg"],["jpm","video/jpm"],["jps","image/x-jps"],["js",["application/javascript","application/ecmascript","text/javascript","text/ecmascript","application/x-javascript"]],["json","application/json"],["jut","image/jutvision"],["kar",["audio/midi","music/x-karaoke"]],["karbon","application/vnd.kde.karbon"],["kfo","application/vnd.kde.kformula"],["kia","application/vnd.kidspiration"],["kml","application/vnd.google-earth.kml+xml"],["kmz","application/vnd.google-earth.kmz"],["kne","application/vnd.kinar"],["kon","application/vnd.kde.kontour"],["kpr","application/vnd.kde.kpresenter"],["ksh",["application/x-ksh","text/x-script.ksh"]],["ksp","application/vnd.kde.kspread"],["ktx","image/ktx"],["ktz","application/vnd.kahootz"],["kwd","application/vnd.kde.kword"],["la",["audio/nspaudio","audio/x-nspaudio"]],["lam","audio/x-liveaudio"],["lasxml","application/vnd.las.las+xml"],["latex","application/x-latex"],["lbd","application/vnd.llamagraphics.life-balance.desktop"],["lbe","application/vnd.llamagraphics.life-balance.exchange+xml"],["les","application/vnd.hhe.lesson-player"],["lha",["application/octet-stream","application/lha","application/x-lha"]],["lhx","application/octet-stream"],["link66","application/vnd.route66.link66+xml"],["list","text/plain"],["lma",["audio/nspaudio","audio/x-nspaudio"]],["log","text/plain"],["lrm","application/vnd.ms-lrm"],["lsf","video/x-la-asf"],["lsp",["application/x-lisp","text/x-script.lisp"]],["lst","text/plain"],["lsx",["video/x-la-asf","text/x-la-asf"]],["ltf","application/vnd.frogans.ltf"],["ltx","application/x-latex"],["lvp","audio/vnd.lucent.voice"],["lwp","application/vnd.lotus-wordpro"],["lzh",["application/octet-stream","application/x-lzh"]],["lzx",["application/lzx","application/octet-stream","application/x-lzx"]],["m",["text/plain","text/x-m"]],["m13","application/x-msmediaview"],["m14","application/x-msmediaview"],["m1v","video/mpeg"],["m21","application/mp21"],["m2a","audio/mpeg"],["m2v","video/mpeg"],["m3u",["audio/x-mpegurl","audio/x-mpequrl"]],["m3u8","application/vnd.apple.mpegurl"],["m4v","video/x-m4v"],["ma","application/mathematica"],["mads","application/mads+xml"],["mag","application/vnd.ecowin.chart"],["man","application/x-troff-man"],["map","application/x-navimap"],["mar","text/plain"],["mathml","application/mathml+xml"],["mbd","application/mbedlet"],["mbk","application/vnd.mobius.mbk"],["mbox","application/mbox"],["mc$","application/x-magic-cap-package-1.0"],["mc1","application/vnd.medcalcdata"],["mcd",["application/mcad","application/vnd.mcd","application/x-mathcad"]],["mcf",["image/vasa","text/mcf"]],["mcp","application/netmc"],["mcurl","text/vnd.curl.mcurl"],["mdb","application/x-msaccess"],["mdi","image/vnd.ms-modi"],["me","application/x-troff-me"],["meta4","application/metalink4+xml"],["mets","application/mets+xml"],["mfm","application/vnd.mfmp"],["mgp","application/vnd.osgeo.mapguide.package"],["mgz","application/vnd.proteus.magazine"],["mht","message/rfc822"],["mhtml","message/rfc822"],["mid",["audio/mid","audio/midi","music/crescendo","x-music/x-midi","audio/x-midi","application/x-midi","audio/x-mid"]],["midi",["audio/midi","music/crescendo","x-music/x-midi","audio/x-midi","application/x-midi","audio/x-mid"]],["mif",["application/vnd.mif","application/x-mif","application/x-frame"]],["mime",["message/rfc822","www/mime"]],["mj2","video/mj2"],["mjf","audio/x-vnd.audioexplosion.mjuicemediafile"],["mjpg","video/x-motion-jpeg"],["mlp","application/vnd.dolby.mlp"],["mm",["application/base64","application/x-meme"]],["mmd","application/vnd.chipnuts.karaoke-mmd"],["mme","application/base64"],["mmf","application/vnd.smaf"],["mmr","image/vnd.fujixerox.edmics-mmr"],["mny","application/x-msmoney"],["mod",["audio/mod","audio/x-mod"]],["mods","application/mods+xml"],["moov","video/quicktime"],["mov","video/quicktime"],["movie","video/x-sgi-movie"],["mp2",["video/mpeg","audio/mpeg","video/x-mpeg","audio/x-mpeg","video/x-mpeq2a"]],["mp3",["audio/mpeg","audio/mpeg3","video/mpeg","audio/x-mpeg-3","video/x-mpeg"]],["mp4",["video/mp4","application/mp4"]],["mp4a","audio/mp4"],["mpa",["video/mpeg","audio/mpeg"]],["mpc",["application/vnd.mophun.certificate","application/x-project"]],["mpe","video/mpeg"],["mpeg","video/mpeg"],["mpg",["video/mpeg","audio/mpeg"]],["mpga","audio/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["mpm","application/vnd.blueice.multipass"],["mpn","application/vnd.mophun.application"],["mpp","application/vnd.ms-project"],["mpt","application/x-project"],["mpv","application/x-project"],["mpv2","video/mpeg"],["mpx","application/x-project"],["mpy","application/vnd.ibm.minipay"],["mqy","application/vnd.mobius.mqy"],["mrc","application/marc"],["mrcx","application/marcxml+xml"],["ms","application/x-troff-ms"],["mscml","application/mediaservercontrol+xml"],["mseq","application/vnd.mseq"],["msf","application/vnd.epson.msf"],["msg","application/vnd.ms-outlook"],["msh","model/mesh"],["msl","application/vnd.mobius.msl"],["msty","application/vnd.muvee.style"],["mts","model/vnd.mts"],["mus","application/vnd.musician"],["musicxml","application/vnd.recordare.musicxml+xml"],["mv","video/x-sgi-movie"],["mvb","application/x-msmediaview"],["mwf","application/vnd.mfer"],["mxf","application/mxf"],["mxl","application/vnd.recordare.musicxml"],["mxml","application/xv+xml"],["mxs","application/vnd.triscape.mxs"],["mxu","video/vnd.mpegurl"],["my","audio/make"],["mzz","application/x-vnd.audioexplosion.mzz"],["n-gage","application/vnd.nokia.n-gage.symbian.install"],["n3","text/n3"],["nap","image/naplps"],["naplps","image/naplps"],["nbp","application/vnd.wolfram.player"],["nc","application/x-netcdf"],["ncm","application/vnd.nokia.configuration-message"],["ncx","application/x-dtbncx+xml"],["ngdat","application/vnd.nokia.n-gage.data"],["nif","image/x-niff"],["niff","image/x-niff"],["nix","application/x-mix-transfer"],["nlu","application/vnd.neurolanguage.nlu"],["nml","application/vnd.enliven"],["nnd","application/vnd.noblenet-directory"],["nns","application/vnd.noblenet-sealer"],["nnw","application/vnd.noblenet-web"],["npx","image/vnd.net-fpx"],["nsc","application/x-conference"],["nsf","application/vnd.lotus-notes"],["nvd","application/x-navidoc"],["nws","message/rfc822"],["o","application/octet-stream"],["oa2","application/vnd.fujitsu.oasys2"],["oa3","application/vnd.fujitsu.oasys3"],["oas","application/vnd.fujitsu.oasys"],["obd","application/x-msbinder"],["oda","application/oda"],["odb","application/vnd.oasis.opendocument.database"],["odc","application/vnd.oasis.opendocument.chart"],["odf","application/vnd.oasis.opendocument.formula"],["odft","application/vnd.oasis.opendocument.formula-template"],["odg","application/vnd.oasis.opendocument.graphics"],["odi","application/vnd.oasis.opendocument.image"],["odm","application/vnd.oasis.opendocument.text-master"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["omc","application/x-omc"],["omcd","application/x-omcdatamaker"],["omcr","application/x-omcregerator"],["onetoc","application/onenote"],["opf","application/oebps-package+xml"],["org","application/vnd.lotus-organizer"],["osf","application/vnd.yamaha.openscoreformat"],["osfpvg","application/vnd.yamaha.openscoreformat.osfpvg+xml"],["otc","application/vnd.oasis.opendocument.chart-template"],["otf","application/x-font-otf"],["otg","application/vnd.oasis.opendocument.graphics-template"],["oth","application/vnd.oasis.opendocument.text-web"],["oti","application/vnd.oasis.opendocument.image-template"],["otp","application/vnd.oasis.opendocument.presentation-template"],["ots","application/vnd.oasis.opendocument.spreadsheet-template"],["ott","application/vnd.oasis.opendocument.text-template"],["oxt","application/vnd.openofficeorg.extension"],["p","text/x-pascal"],["p10",["application/pkcs10","application/x-pkcs10"]],["p12",["application/pkcs-12","application/x-pkcs12"]],["p7a","application/x-pkcs7-signature"],["p7b","application/x-pkcs7-certificates"],["p7c",["application/pkcs7-mime","application/x-pkcs7-mime"]],["p7m",["application/pkcs7-mime","application/x-pkcs7-mime"]],["p7r","application/x-pkcs7-certreqresp"],["p7s",["application/pkcs7-signature","application/x-pkcs7-signature"]],["p8","application/pkcs8"],["par","text/plain-bas"],["part","application/pro_eng"],["pas","text/pascal"],["paw","application/vnd.pawaafile"],["pbd","application/vnd.powerbuilder6"],["pbm","image/x-portable-bitmap"],["pcf","application/x-font-pcf"],["pcl",["application/vnd.hp-pcl","application/x-pcl"]],["pclxl","application/vnd.hp-pclxl"],["pct","image/x-pict"],["pcurl","application/vnd.curl.pcurl"],["pcx","image/x-pcx"],["pdb",["application/vnd.palm","chemical/x-pdb"]],["pdf","application/pdf"],["pfa","application/x-font-type1"],["pfr","application/font-tdpfr"],["pfunk",["audio/make","audio/make.my.funk"]],["pfx","application/x-pkcs12"],["pgm",["image/x-portable-graymap","image/x-portable-greymap"]],["pgn","application/x-chess-pgn"],["pgp","application/pgp-signature"],["pic",["image/pict","image/x-pict"]],["pict","image/pict"],["pkg","application/x-newton-compatible-pkg"],["pki","application/pkixcmp"],["pkipath","application/pkix-pkipath"],["pko",["application/ynd.ms-pkipko","application/vnd.ms-pki.pko"]],["pl",["text/plain","text/x-script.perl"]],["plb","application/vnd.3gpp.pic-bw-large"],["plc","application/vnd.mobius.plc"],["plf","application/vnd.pocketlearn"],["pls","application/pls+xml"],["plx","application/x-pixclscript"],["pm",["text/x-script.perl-module","image/x-xpixmap"]],["pm4","application/x-pagemaker"],["pm5","application/x-pagemaker"],["pma","application/x-perfmon"],["pmc","application/x-perfmon"],["pml",["application/vnd.ctc-posml","application/x-perfmon"]],["pmr","application/x-perfmon"],["pmw","application/x-perfmon"],["png","image/png"],["pnm",["application/x-portable-anymap","image/x-portable-anymap"]],["portpkg","application/vnd.macports.portpkg"],["pot",["application/vnd.ms-powerpoint","application/mspowerpoint"]],["potm","application/vnd.ms-powerpoint.template.macroenabled.12"],["potx","application/vnd.openxmlformats-officedocument.presentationml.template"],["pov","model/x-pov"],["ppa","application/vnd.ms-powerpoint"],["ppam","application/vnd.ms-powerpoint.addin.macroenabled.12"],["ppd","application/vnd.cups-ppd"],["ppm","image/x-portable-pixmap"],["pps",["application/vnd.ms-powerpoint","application/mspowerpoint"]],["ppsm","application/vnd.ms-powerpoint.slideshow.macroenabled.12"],["ppsx","application/vnd.openxmlformats-officedocument.presentationml.slideshow"],["ppt",["application/vnd.ms-powerpoint","application/mspowerpoint","application/powerpoint","application/x-mspowerpoint"]],["pptm","application/vnd.ms-powerpoint.presentation.macroenabled.12"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["ppz","application/mspowerpoint"],["prc","application/x-mobipocket-ebook"],["pre",["application/vnd.lotus-freelance","application/x-freelance"]],["prf","application/pics-rules"],["prt","application/pro_eng"],["ps","application/postscript"],["psb","application/vnd.3gpp.pic-bw-small"],["psd",["application/octet-stream","image/vnd.adobe.photoshop"]],["psf","application/x-font-linux-psf"],["pskcxml","application/pskc+xml"],["ptid","application/vnd.pvi.ptid1"],["pub","application/x-mspublisher"],["pvb","application/vnd.3gpp.pic-bw-var"],["pvu","paleovu/x-pv"],["pwn","application/vnd.3m.post-it-notes"],["pwz","application/vnd.ms-powerpoint"],["py","text/x-script.phyton"],["pya","audio/vnd.ms-playready.media.pya"],["pyc","applicaiton/x-bytecode.python"],["pyv","video/vnd.ms-playready.media.pyv"],["qam","application/vnd.epson.quickanime"],["qbo","application/vnd.intu.qbo"],["qcp","audio/vnd.qcelp"],["qd3","x-world/x-3dmf"],["qd3d","x-world/x-3dmf"],["qfx","application/vnd.intu.qfx"],["qif","image/x-quicktime"],["qps","application/vnd.publishare-delta-tree"],["qt","video/quicktime"],["qtc","video/x-qtc"],["qti","image/x-quicktime"],["qtif","image/x-quicktime"],["qxd","application/vnd.quark.quarkxpress"],["ra",["audio/x-realaudio","audio/x-pn-realaudio","audio/x-pn-realaudio-plugin"]],["ram","audio/x-pn-realaudio"],["rar","application/x-rar-compressed"],["ras",["image/cmu-raster","application/x-cmu-raster","image/x-cmu-raster"]],["rast","image/cmu-raster"],["rcprofile","application/vnd.ipunplugged.rcprofile"],["rdf","application/rdf+xml"],["rdz","application/vnd.data-vision.rdz"],["rep","application/vnd.businessobjects"],["res","application/x-dtbresource+xml"],["rexx","text/x-script.rexx"],["rf","image/vnd.rn-realflash"],["rgb","image/x-rgb"],["rif","application/reginfo+xml"],["rip","audio/vnd.rip"],["rl","application/resource-lists+xml"],["rlc","image/vnd.fujixerox.edmics-rlc"],["rld","application/resource-lists-diff+xml"],["rm",["application/vnd.rn-realmedia","audio/x-pn-realaudio"]],["rmi","audio/mid"],["rmm","audio/x-pn-realaudio"],["rmp",["audio/x-pn-realaudio-plugin","audio/x-pn-realaudio"]],["rms","application/vnd.jcp.javame.midlet-rms"],["rnc","application/relax-ng-compact-syntax"],["rng",["application/ringing-tones","application/vnd.nokia.ringing-tone"]],["rnx","application/vnd.rn-realplayer"],["roff","application/x-troff"],["rp","image/vnd.rn-realpix"],["rp9","application/vnd.cloanto.rp9"],["rpm","audio/x-pn-realaudio-plugin"],["rpss","application/vnd.nokia.radio-presets"],["rpst","application/vnd.nokia.radio-preset"],["rq","application/sparql-query"],["rs","application/rls-services+xml"],["rsd","application/rsd+xml"],["rt",["text/richtext","text/vnd.rn-realtext"]],["rtf",["application/rtf","text/richtext","application/x-rtf"]],["rtx",["text/richtext","application/rtf"]],["rv","video/vnd.rn-realvideo"],["s","text/x-asm"],["s3m","audio/s3m"],["saf","application/vnd.yamaha.smaf-audio"],["saveme","application/octet-stream"],["sbk","application/x-tbook"],["sbml","application/sbml+xml"],["sc","application/vnd.ibm.secure-container"],["scd","application/x-msschedule"],["scm",["application/vnd.lotus-screencam","video/x-scm","text/x-script.guile","application/x-lotusscreencam","text/x-script.scheme"]],["scq","application/scvp-cv-request"],["scs","application/scvp-cv-response"],["sct","text/scriptlet"],["scurl","text/vnd.curl.scurl"],["sda","application/vnd.stardivision.draw"],["sdc","application/vnd.stardivision.calc"],["sdd","application/vnd.stardivision.impress"],["sdkm","application/vnd.solent.sdkm+xml"],["sdml","text/plain"],["sdp",["application/sdp","application/x-sdp"]],["sdr","application/sounder"],["sdw","application/vnd.stardivision.writer"],["sea",["application/sea","application/x-sea"]],["see","application/vnd.seemail"],["seed","application/vnd.fdsn.seed"],["sema","application/vnd.sema"],["semd","application/vnd.semd"],["semf","application/vnd.semf"],["ser","application/java-serialized-object"],["set","application/set"],["setpay","application/set-payment-initiation"],["setreg","application/set-registration-initiation"],["sfd-hdstx","application/vnd.hydrostatix.sof-data"],["sfs","application/vnd.spotfire.sfs"],["sgl","application/vnd.stardivision.writer-global"],["sgm",["text/sgml","text/x-sgml"]],["sgml",["text/sgml","text/x-sgml"]],["sh",["application/x-shar","application/x-bsh","application/x-sh","text/x-script.sh"]],["shar",["application/x-bsh","application/x-shar"]],["shf","application/shf+xml"],["shtml",["text/html","text/x-server-parsed-html"]],["sid","audio/x-psid"],["sis","application/vnd.symbian.install"],["sit",["application/x-stuffit","application/x-sit"]],["sitx","application/x-stuffitx"],["skd","application/x-koan"],["skm","application/x-koan"],["skp",["application/vnd.koan","application/x-koan"]],["skt","application/x-koan"],["sl","application/x-seelogo"],["sldm","application/vnd.ms-powerpoint.slide.macroenabled.12"],["sldx","application/vnd.openxmlformats-officedocument.presentationml.slide"],["slt","application/vnd.epson.salt"],["sm","application/vnd.stepmania.stepchart"],["smf","application/vnd.stardivision.math"],["smi",["application/smil","application/smil+xml"]],["smil","application/smil"],["snd",["audio/basic","audio/x-adpcm"]],["snf","application/x-font-snf"],["sol","application/solids"],["spc",["text/x-speech","application/x-pkcs7-certificates"]],["spf","application/vnd.yamaha.smaf-phrase"],["spl",["application/futuresplash","application/x-futuresplash"]],["spot","text/vnd.in3d.spot"],["spp","application/scvp-vp-response"],["spq","application/scvp-vp-request"],["spr","application/x-sprite"],["sprite","application/x-sprite"],["src","application/x-wais-source"],["sru","application/sru+xml"],["srx","application/sparql-results+xml"],["sse","application/vnd.kodak-descriptor"],["ssf","application/vnd.epson.ssf"],["ssi","text/x-server-parsed-html"],["ssm","application/streamingmedia"],["ssml","application/ssml+xml"],["sst",["application/vnd.ms-pkicertstore","application/vnd.ms-pki.certstore"]],["st","application/vnd.sailingtracker.track"],["stc","application/vnd.sun.xml.calc.template"],["std","application/vnd.sun.xml.draw.template"],["step","application/step"],["stf","application/vnd.wt.stf"],["sti","application/vnd.sun.xml.impress.template"],["stk","application/hyperstudio"],["stl",["application/vnd.ms-pkistl","application/sla","application/vnd.ms-pki.stl","application/x-navistyle"]],["stm","text/html"],["stp","application/step"],["str","application/vnd.pg.format"],["stw","application/vnd.sun.xml.writer.template"],["sub","image/vnd.dvb.subtitle"],["sus","application/vnd.sus-calendar"],["sv4cpio","application/x-sv4cpio"],["sv4crc","application/x-sv4crc"],["svc","application/vnd.dvb.service"],["svd","application/vnd.svd"],["svf",["image/vnd.dwg","image/x-dwg"]],["svg","image/svg+xml"],["svr",["x-world/x-svr","application/x-world"]],["swf","application/x-shockwave-flash"],["swi","application/vnd.aristanetworks.swi"],["sxc","application/vnd.sun.xml.calc"],["sxd","application/vnd.sun.xml.draw"],["sxg","application/vnd.sun.xml.writer.global"],["sxi","application/vnd.sun.xml.impress"],["sxm","application/vnd.sun.xml.math"],["sxw","application/vnd.sun.xml.writer"],["t",["text/troff","application/x-troff"]],["talk","text/x-speech"],["tao","application/vnd.tao.intent-module-archive"],["tar","application/x-tar"],["tbk",["application/toolbook","application/x-tbook"]],["tcap","application/vnd.3gpp2.tcap"],["tcl",["text/x-script.tcl","application/x-tcl"]],["tcsh","text/x-script.tcsh"],["teacher","application/vnd.smart.teacher"],["tei","application/tei+xml"],["tex","application/x-tex"],["texi","application/x-texinfo"],["texinfo","application/x-texinfo"],["text",["application/plain","text/plain"]],["tfi","application/thraud+xml"],["tfm","application/x-tex-tfm"],["tgz",["application/gnutar","application/x-compressed"]],["thmx","application/vnd.ms-officetheme"],["tif",["image/tiff","image/x-tiff"]],["tiff",["image/tiff","image/x-tiff"]],["tmo","application/vnd.tmobile-livetv"],["torrent","application/x-bittorrent"],["tpl","application/vnd.groove-tool-template"],["tpt","application/vnd.trid.tpt"],["tr","application/x-troff"],["tra","application/vnd.trueapp"],["trm","application/x-msterminal"],["tsd","application/timestamped-data"],["tsi","audio/tsp-audio"],["tsp",["application/dsptype","audio/tsplayer"]],["tsv","text/tab-separated-values"],["ttf","application/x-font-ttf"],["ttl","text/turtle"],["turbot","image/florian"],["twd","application/vnd.simtech-mindmapper"],["txd","application/vnd.genomatix.tuxedo"],["txf","application/vnd.mobius.txf"],["txt","text/plain"],["ufd","application/vnd.ufdl"],["uil","text/x-uil"],["uls","text/iuls"],["umj","application/vnd.umajin"],["uni","text/uri-list"],["unis","text/uri-list"],["unityweb","application/vnd.unity"],["unv","application/i-deas"],["uoml","application/vnd.uoml+xml"],["uri","text/uri-list"],["uris","text/uri-list"],["ustar",["application/x-ustar","multipart/x-ustar"]],["utz","application/vnd.uiq.theme"],["uu",["application/octet-stream","text/x-uuencode"]],["uue","text/x-uuencode"],["uva","audio/vnd.dece.audio"],["uvh","video/vnd.dece.hd"],["uvi","image/vnd.dece.graphic"],["uvm","video/vnd.dece.mobile"],["uvp","video/vnd.dece.pd"],["uvs","video/vnd.dece.sd"],["uvu","video/vnd.uvvu.mp4"],["uvv","video/vnd.dece.video"],["vcd","application/x-cdlink"],["vcf","text/x-vcard"],["vcg","application/vnd.groove-vcard"],["vcs","text/x-vcalendar"],["vcx","application/vnd.vcx"],["vda","application/vda"],["vdo","video/vdo"],["vew","application/groupwise"],["vis","application/vnd.visionary"],["viv",["video/vivo","video/vnd.vivo"]],["vivo",["video/vivo","video/vnd.vivo"]],["vmd","application/vocaltec-media-desc"],["vmf","application/vocaltec-media-file"],["voc",["audio/voc","audio/x-voc"]],["vos","video/vosaic"],["vox","audio/voxware"],["vqe","audio/x-twinvq-plugin"],["vqf","audio/x-twinvq"],["vql","audio/x-twinvq-plugin"],["vrml",["model/vrml","x-world/x-vrml","application/x-vrml"]],["vrt","x-world/x-vrt"],["vsd",["application/vnd.visio","application/x-visio"]],["vsf","application/vnd.vsf"],["vst","application/x-visio"],["vsw","application/x-visio"],["vtu","model/vnd.vtu"],["vxml","application/voicexml+xml"],["w60","application/wordperfect6.0"],["w61","application/wordperfect6.1"],["w6w","application/msword"],["wad","application/x-doom"],["wav",["audio/wav","audio/x-wav"]],["wax","audio/x-ms-wax"],["wb1","application/x-qpro"],["wbmp","image/vnd.wap.wbmp"],["wbs","application/vnd.criticaltools.wbs+xml"],["wbxml","application/vnd.wap.wbxml"],["wcm","application/vnd.ms-works"],["wdb","application/vnd.ms-works"],["web","application/vnd.xara"],["weba","audio/webm"],["webm","video/webm"],["webp","image/webp"],["wg","application/vnd.pmi.widget"],["wgt","application/widget"],["wiz","application/msword"],["wk1","application/x-123"],["wks","application/vnd.ms-works"],["wm","video/x-ms-wm"],["wma","audio/x-ms-wma"],["wmd","application/x-ms-wmd"],["wmf",["windows/metafile","application/x-msmetafile"]],["wml","text/vnd.wap.wml"],["wmlc","application/vnd.wap.wmlc"],["wmls","text/vnd.wap.wmlscript"],["wmlsc","application/vnd.wap.wmlscriptc"],["wmv","video/x-ms-wmv"],["wmx","video/x-ms-wmx"],["wmz","application/x-ms-wmz"],["woff","application/x-font-woff"],["word","application/msword"],["wp","application/wordperfect"],["wp5",["application/wordperfect","application/wordperfect6.0"]],["wp6","application/wordperfect"],["wpd",["application/wordperfect","application/vnd.wordperfect","application/x-wpwin"]],["wpl","application/vnd.ms-wpl"],["wps","application/vnd.ms-works"],["wq1","application/x-lotus"],["wqd","application/vnd.wqd"],["wri",["application/mswrite","application/x-wri","application/x-mswrite"]],["wrl",["model/vrml","x-world/x-vrml","application/x-world"]],["wrz",["model/vrml","x-world/x-vrml"]],["wsc","text/scriplet"],["wsdl","application/wsdl+xml"],["wspolicy","application/wspolicy+xml"],["wsrc","application/x-wais-source"],["wtb","application/vnd.webturbo"],["wtk","application/x-wintalk"],["wvx","video/x-ms-wvx"],["x-png","image/png"],["x3d","application/vnd.hzn-3d-crossword"],["xaf","x-world/x-vrml"],["xap","application/x-silverlight-app"],["xar","application/vnd.xara"],["xbap","application/x-ms-xbap"],["xbd","application/vnd.fujixerox.docuworks.binder"],["xbm",["image/xbm","image/x-xbm","image/x-xbitmap"]],["xdf","application/xcap-diff+xml"],["xdm","application/vnd.syncml.dm+xml"],["xdp","application/vnd.adobe.xdp+xml"],["xdr","video/x-amt-demorun"],["xdssc","application/dssc+xml"],["xdw","application/vnd.fujixerox.docuworks"],["xenc","application/xenc+xml"],["xer","application/patch-ops-error+xml"],["xfdf","application/vnd.adobe.xfdf"],["xfdl","application/vnd.xfdl"],["xgz","xgl/drawing"],["xhtml","application/xhtml+xml"],["xif","image/vnd.xiff"],["xl","application/excel"],["xla",["application/vnd.ms-excel","application/excel","application/x-msexcel","application/x-excel"]],["xlam","application/vnd.ms-excel.addin.macroenabled.12"],["xlb",["application/excel","application/vnd.ms-excel","application/x-excel"]],["xlc",["application/vnd.ms-excel","application/excel","application/x-excel"]],["xld",["application/excel","application/x-excel"]],["xlk",["application/excel","application/x-excel"]],["xll",["application/excel","application/vnd.ms-excel","application/x-excel"]],["xlm",["application/vnd.ms-excel","application/excel","application/x-excel"]],["xls",["application/vnd.ms-excel","application/excel","application/x-msexcel","application/x-excel"]],["xlsb","application/vnd.ms-excel.sheet.binary.macroenabled.12"],["xlsm","application/vnd.ms-excel.sheet.macroenabled.12"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xlt",["application/vnd.ms-excel","application/excel","application/x-excel"]],["xltm","application/vnd.ms-excel.template.macroenabled.12"],["xltx","application/vnd.openxmlformats-officedocument.spreadsheetml.template"],["xlv",["application/excel","application/x-excel"]],["xlw",["application/vnd.ms-excel","application/excel","application/x-msexcel","application/x-excel"]],["xm","audio/xm"],["xml",["application/xml","text/xml","application/atom+xml","application/rss+xml"]],["xmz","xgl/movie"],["xo","application/vnd.olpc-sugar"],["xof","x-world/x-vrml"],["xop","application/xop+xml"],["xpi","application/x-xpinstall"],["xpix","application/x-vnd.ls-xpix"],["xpm",["image/xpm","image/x-xpixmap"]],["xpr","application/vnd.is-xpr"],["xps","application/vnd.ms-xpsdocument"],["xpw","application/vnd.intercon.formnet"],["xslt","application/xslt+xml"],["xsm","application/vnd.syncml+xml"],["xspf","application/xspf+xml"],["xsr","video/x-amt-showrun"],["xul","application/vnd.mozilla.xul+xml"],["xwd",["image/x-xwd","image/x-xwindowdump"]],["xyz",["chemical/x-xyz","chemical/x-pdb"]],["yang","application/yang"],["yin","application/yin+xml"],["z",["application/x-compressed","application/x-compress"]],["zaz","application/vnd.zzazz.deck+xml"],["zip",["application/zip","multipart/x-zip","application/x-zip-compressed","application/x-compressed"]],["zir","application/vnd.zul"],["zmm","application/vnd.handheld-entertainment+xml"],["zoo","application/octet-stream"],["zsh","text/x-script.zsh"]]);var Eg={detectMimeType(e){if(!e)return"application/octet-stream";let t=wg.parse(e),i=(t.ext.substr(1)||t.name||"").split("?").shift().trim().toLowerCase(),n="application/octet-stream";return Dg.has(i)&&(n=Dg.get(i)),Array.isArray(n)?n[0]:n},detectExtension(e){if(!e)return"bin";let t=(e||"").toLowerCase().trim().split("/"),i=t.shift().trim(),n=t.join("/").trim();if(_g.has(i+"/"+n)){let e=_g.get(i+"/"+n);return Array.isArray(e)?e[0]:e}return"text"===i?"txt":"bin"}};const Cg=B.default.Transform;function Ag(e){return"string"==typeof e&&(e=Buffer.from(e,"utf-8")),e.toString("base64")}function kg(e,t){if(t=t||76,(e=(e||"").toString()).length<=t)return e;let i=[],n=0,o=1024*t;for(;n<e.length;){let s=e.substr(n,o).replace(new RegExp(".{"+t+"}","g"),"$&\r\n").trim();i.push(s),n+=o}return i.join("\r\n").trim()}var Sg={encode:Ag,wrap:kg,Encoder:class extends Cg{constructor(e){super(),this.options=e||{},!1!==this.options.lineLength&&(this.options.lineLength=this.options.lineLength||76),this._curLine="",this._remainingBytes=!1,this.inputBytes=0,this.outputBytes=0}_transform(e,t,i){if("buffer"!==t&&(e=Buffer.from(e,t)),!e||!e.length)return setImmediate(i);this.inputBytes+=e.length,this._remainingBytes&&this._remainingBytes.length&&(e=Buffer.concat([this._remainingBytes,e],this._remainingBytes.length+e.length),this._remainingBytes=!1),e.length%3?(this._remainingBytes=e.slice(e.length-e.length%3),e=e.slice(0,e.length-e.length%3)):this._remainingBytes=!1;let n=this._curLine+Ag(e);if(this.options.lineLength){n=kg(n,this.options.lineLength);let e=n.lastIndexOf("\n");e<0?(this._curLine=n,n=""):e===n.length-1?this._curLine="":(this._curLine=n.substr(e+1),n=n.substr(0,e+1))}n&&(this.outputBytes+=n.length,this.push(Buffer.from(n,"ascii"))),setImmediate(i)}_flush(e){this._remainingBytes&&this._remainingBytes.length&&(this._curLine+=Ag(this._remainingBytes)),this._curLine&&(this._curLine=kg(this._curLine,this.options.lineLength),this.outputBytes+=this._curLine.length,this.push(this._curLine,"ascii"),this._curLine=""),e()}}};const Fg=B.default.Transform;function Tg(e){"string"==typeof e&&(e=Buffer.from(e,"utf-8"));let t,i=[[9],[10],[13],[32,60],[62,126]],n="";for(let o=0,s=e.length;o<s;o++)t=e[o],Og(t,i)&&(32!==t&&9!==t||o!==s-1&&10!==e[o+1]&&13!==e[o+1])?n+=String.fromCharCode(t):n+="="+(t<16?"0":"")+t.toString(16).toUpperCase();return n}function Bg(e,t){if(t=t||76,(e=(e||"").toString()).length<=t)return e;let i,n,o,s=0,r=e.length,a=Math.floor(t/3),c="";for(;s<r;)if(o=e.substr(s,t),i=o.match(/\r\n/))o=o.substr(0,i.index+i[0].length),c+=o,s+=o.length;else if("\n"!==o.substr(-1))if(i=o.substr(-a).match(/\n.*?$/))o=o.substr(0,o.length-(i[0].length-1)),c+=o,s+=o.length;else{if(o.length>t-a&&(i=o.substr(-a).match(/[ \t.,!?][^ \t.,!?]*$/)))o=o.substr(0,o.length-(i[0].length-1));else if(o.match(/[=][\da-f]{0,2}$/i))for((i=o.match(/[=][\da-f]{0,1}$/i))&&(o=o.substr(0,o.length-i[0].length));o.length>3&&o.length<r-s&&!o.match(/^(?:=[\da-f]{2}){1,4}$/i)&&(i=o.match(/[=][\da-f]{2}$/gi))&&(n=parseInt(i[0].substr(1,2),16),!(n<128))&&(o=o.substr(0,o.length-3),!(n>=192)););s+o.length<r&&"\n"!==o.substr(-1)?(o.length===t&&o.match(/[=][\da-f]{2}$/i)?o=o.substr(0,o.length-3):o.length===t&&(o=o.substr(0,o.length-1)),s+=o.length,o+="=\r\n"):s+=o.length,c+=o}else c+=o,s+=o.length;return c}function Og(e,t){for(let i=t.length-1;i>=0;i--)if(t[i].length){if(1===t[i].length&&e===t[i][0])return!0;if(2===t[i].length&&e>=t[i][0]&&e<=t[i][1])return!0}return!1}var jg={encode:Tg,wrap:Bg,Encoder:class extends Fg{constructor(e){super(),this.options=e||{},!1!==this.options.lineLength&&(this.options.lineLength=this.options.lineLength||76),this._curLine="",this.inputBytes=0,this.outputBytes=0}_transform(e,t,i){let n;if("buffer"!==t&&(e=Buffer.from(e,t)),!e||!e.length)return i();this.inputBytes+=e.length,this.options.lineLength?(n=this._curLine+Tg(e),n=Bg(n,this.options.lineLength),n=n.replace(/(^|\n)([^\n]*)$/,((e,t,i)=>(this._curLine=i,t))),n&&(this.outputBytes+=n.length,this.push(n))):(n=Tg(e),this.outputBytes+=n.length,this.push(n,"ascii")),i()}_flush(e){this._curLine&&(this.outputBytes+=this._curLine.length,this.push(this._curLine,"ascii")),e()}}};const Ig=Sg,Pg=jg,Lg=Eg;var Rg={isPlainText:(e,t)=>"string"==typeof e&&!(t?/[\x00-\x08\x0b\x0c\x0e-\x1f"\u0080-\uFFFF]/:/[\x00-\x08\x0b\x0c\x0e-\x1f\u0080-\uFFFF]/).test(e),hasLongerLines:(e,t)=>e.length>131072||new RegExp("^.{"+(t+1)+",}","m").test(e),encodeWord(e,t,i){let n;t=(t||"Q").toString().toUpperCase().trim().charAt(0);let o="UTF-8";if((i=i||0)&&i>7+o.length&&(i-=7+o.length),"Q"===t?n=Pg.encode(e).replace(/[^a-z0-9!*+\-/=]/gi,(e=>{let t=e.charCodeAt(0).toString(16).toUpperCase();return" "===e?"_":"="+(1===t.length?"0"+t:t)})):"B"===t&&(n="string"==typeof e?e:Ig.encode(e),i=i?Math.max(3,(i-i%4)/4*3):0),i&&("B"!==t?n:Ig.encode(e)).length>i)if("Q"===t)n=this.splitMimeEncodedString(n,i).join("?= =?UTF-8?"+t+"?");else{let e=[],o="";for(let t=0,s=n.length;t<s;t++){let s=n.charAt(t);Buffer.byteLength(o+s)<=i||0===t?o+=s:(e.push(Ig.encode(o)),o=s)}o&&e.push(Ig.encode(o)),n=e.length>1?e.join("?= =?UTF-8?"+t+"?"):e.join("")}else"B"===t&&(n=Ig.encode(e));return"=?UTF-8?"+t+"?"+n+("?="===n.substr(-2)?"":"?=")},encodeWords(e,t,i,n){let o;i=i||0;let s=e.match(/(?:^|\s)([^\s]*["\u0080-\uFFFF])/);if(!s)return e;if(n)return this.encodeWord(e,t,i);let r=e.match(/(["\u0080-\uFFFF][^\s]*)[^"\u0080-\uFFFF]*$/);if(!r)return e;let a=s.index+(s[0].match(/[^\s]/)||{index:0}).index,c=r.index+(r[1]||"").length;return o=(a?e.substr(0,a):"")+this.encodeWord(e.substring(a,c),t||"Q",i)+(c<e.length?e.substr(c):""),o},buildHeaderValue(e){let t=[];return Object.keys(e.params||{}).forEach((i=>{let n=e.params[i];!this.isPlainText(n,!0)||n.length>=75?this.buildHeaderParam(i,n,50).forEach((e=>{/[\s"\\;:/=(),<>@[\]?]|^[-']|'$/.test(e.value)&&"*"!==e.key.substr(-1)?t.push(e.key+"="+JSON.stringify(e.value)):t.push(e.key+"="+e.value)})):/[\s'"\\;:/=(),<>@[\]?]|^-/.test(n)?t.push(i+"="+JSON.stringify(n)):t.push(i+"="+n)})),e.value+(t.length?"; "+t.join("; "):"")},buildHeaderParam(e,t,i){let n,o,s,r,a,c,u=[],l="string"==typeof t?t:(t||"").toString(),p=0;if(i=i||50,this.isPlainText(t,!0)){if(l.length<=i)return[{key:e,value:l}];l=l.replace(new RegExp(".{"+i+"}","g"),(e=>(u.push({line:e}),""))),l&&u.push({line:l})}else{if(/[\uD800-\uDBFF]/.test(l)){for(n=[],a=0,c=l.length;a<c;a++)o=l.charAt(a),s=o.charCodeAt(0),s>=55296&&s<=56319&&a<c-1?(o+=l.charAt(a+1),n.push(o),a++):n.push(o);l=n}r="utf-8''";let e=!0;for(p=0,a=0,c=l.length;a<c;a++){if(o=l[a],e)o=this.safeEncodeURIComponent(o);else if(o=" "===o?o:this.safeEncodeURIComponent(o),o!==l[a]){if(!((this.safeEncodeURIComponent(r)+o).length>=i)){e=!0,a=p,r="";continue}u.push({line:r,encoded:e}),r="",p=a-1}(r+o).length>=i?(u.push({line:r,encoded:e}),r=o=" "===l[a]?" ":this.safeEncodeURIComponent(l[a]),o===l[a]?(e=!1,p=a-1):e=!0):r+=o}r&&u.push({line:r,encoded:e})}return u.map(((t,i)=>({key:e+"*"+i+(t.encoded?"*":""),value:t.line})))},parseHeaderValue(e){let t,i={value:!1,params:{}},n=!1,o="",s="value",r=!1,a=!1;for(let c=0,u=e.length;c<u;c++)if(t=e.charAt(c),"key"===s){if("="===t){n=o.trim().toLowerCase(),s="value",o="";continue}o+=t}else{if(a)o+=t;else{if("\\"===t){a=!0;continue}r&&t===r?r=!1:r||'"'!==t?r||";"!==t?o+=t:(!1===n?i.value=o.trim():i.params[n]=o.trim(),s="key",o=""):r=t}a=!1}return"value"===s?!1===n?i.value=o.trim():i.params[n]=o.trim():o.trim()&&(i.params[o.trim().toLowerCase()]=""),Object.keys(i.params).forEach((e=>{let t,n,o,s;(o=e.match(/(\*(\d+)|\*(\d+)\*|\*)$/))&&(t=e.substr(0,o.index),n=Number(o[2]||o[3])||0,i.params[t]&&"object"==typeof i.params[t]||(i.params[t]={charset:!1,values:[]}),s=i.params[e],0===n&&"*"===o[0].substr(-1)&&(o=s.match(/^([^']*)'[^']*'(.*)$/))&&(i.params[t].charset=o[1]||"iso-8859-1",s=o[2]),i.params[t].values[n]=s,delete i.params[e])})),Object.keys(i.params).forEach((e=>{let t;i.params[e]&&Array.isArray(i.params[e].values)&&(t=i.params[e].values.map((e=>e||"")).join(""),i.params[e].charset?i.params[e]="=?"+i.params[e].charset+"?Q?"+t.replace(/[=?_\s]/g,(e=>{let t=e.charCodeAt(0).toString(16);return" "===e?"_":"%"+(t.length<2?"0":"")+t})).replace(/%/g,"=")+"?=":i.params[e]=t)})),i},detectExtension:e=>Lg.detectExtension(e),detectMimeType:e=>Lg.detectMimeType(e),foldLines(e,t,i){t=t||76;let n,o,s=0,r=(e=(e||"").toString()).length,a="";for(;s<r;){if(n=e.substr(s,t),n.length<t){a+=n;break}(o=n.match(/^[^\n\r]*(\r?\n|\r)/))?(n=o[0],a+=n,s+=n.length):((o=n.match(/(\s+)[^\s]*$/))&&o[0].length-(i?(o[1]||"").length:0)<n.length?n=n.substr(0,n.length-(o[0].length-(i?(o[1]||"").length:0))):(o=e.substr(s+n.length).match(/^[^\s]+(\s*)/))&&(n+=o[0].substr(0,o[0].length-(i?0:(o[1]||"").length))),a+=n,s+=n.length,s<r&&(a+="\r\n"))}return a},splitMimeEncodedString:(e,t)=>{let i,n,o,s,r=[];for(t=Math.max(t||0,12);e.length;){for(i=e.substr(0,t),(n=i.match(/[=][0-9A-F]?$/i))&&(i=i.substr(0,n.index)),s=!1;!s;)s=!0,(n=e.substr(i.length).match(/^[=]([0-9A-F]{2})/i))&&(o=parseInt(n[1],16),o<194&&o>127&&(i=i.substr(0,i.length-3),s=!1));i.length&&r.push(i),e=e.substr(i.length)}return r},encodeURICharComponent:e=>{let t="",i=e.charCodeAt(0).toString(16).toUpperCase();if(i.length%2&&(i="0"+i),i.length>2)for(let e=0,n=i.length/2;e<n;e++)t+="%"+i.substr(e,2);else t+="%"+i;return t},safeEncodeURIComponent(e){e=(e||"").toString();try{e=encodeURIComponent(e)}catch(t){return e.replace(/[^\x00-\x1F *'()<>@,;:\\"[\]?=\u007F-\uFFFF]+/g,"")}return e.replace(/[\x00-\x1F *'()<>@,;:\\"[\]?=\u007F-\uFFFF]/g,(e=>this.encodeURICharComponent(e)))}};class Ng{constructor(e){this.str=(e||"").toString(),this.operatorCurrent="",this.operatorExpecting="",this.node=null,this.escaped=!1,this.list=[],this.operators={'"':'"',"(":")","<":">",",":"",":":";",";":""}}tokenize(){let e,t=[];for(let t=0,i=this.str.length;t<i;t++)e=this.str.charAt(t),this.checkChar(e);return this.list.forEach((e=>{e.value=(e.value||"").toString().trim(),e.value&&t.push(e)})),t}checkChar(e){if(this.escaped);else{if(e===this.operatorExpecting)return this.node={type:"operator",value:e},this.list.push(this.node),this.node=null,this.operatorExpecting="",void(this.escaped=!1);if(!this.operatorExpecting&&e in this.operators)return this.node={type:"operator",value:e},this.list.push(this.node),this.node=null,this.operatorExpecting=this.operators[e],void(this.escaped=!1);if(['"',"'"].includes(this.operatorExpecting)&&"\\"===e)return void(this.escaped=!0)}this.node||(this.node={type:"text",value:""},this.list.push(this.node)),"\n"===e&&(e=" "),(e.charCodeAt(0)>=33||[" ","\t"].includes(e))&&(this.node.value+=e),this.escaped=!1}}function $g(e,t){t=t||{};let i=new Ng(e).tokenize(),n=[],o=[],s=[];if(i.forEach((e=>{"operator"!==e.type||","!==e.value&&";"!==e.value?o.push(e):(o.length&&n.push(o),o=[])})),o.length&&n.push(o),n.forEach((e=>{e=function(e){let t,i,n,o,s=!1,r="text",a=[],c={address:[],comment:[],group:[],text:[]};for(n=0,o=e.length;n<o;n++)if(t=e[n],"operator"===t.type)switch(t.value){case"<":r="address";break;case"(":r="comment";break;case":":r="group",s=!0;break;default:r="text"}else t.value&&("address"===r&&(t.value=t.value.replace(/^[^<]*<\s*/,"")),c[r].push(t.value));if(!c.text.length&&c.comment.length&&(c.text=c.comment,c.comment=[]),s)c.text=c.text.join(" "),a.push({name:c.text||i&&i.name,group:c.group.length?$g(c.group.join(",")):[]});else{if(!c.address.length&&c.text.length){for(n=c.text.length-1;n>=0;n--)if(c.text[n].match(/^[^@\s]+@[^@\s]+$/)){c.address=c.text.splice(n,1);break}let e=function(e){return c.address.length?e:(c.address=[e.trim()]," ")};if(!c.address.length)for(n=c.text.length-1;n>=0&&(c.text[n]=c.text[n].replace(/\s*\b[^@\s]+@[^\s]+\b\s*/,e).trim(),!c.address.length);n--);}if(!c.text.length&&c.comment.length&&(c.text=c.comment,c.comment=[]),c.address.length>1&&(c.text=c.text.concat(c.address.splice(1))),c.text=c.text.join(" "),c.address=c.address.join(" "),!c.address&&s)return[];i={address:c.address||c.text||"",name:c.text||c.address||""},i.address===i.name&&((i.address||"").match(/@/)?i.name="":i.address=""),a.push(i)}return a}(e),e.length&&(s=s.concat(e))})),t.flatten){let e=[],t=i=>{i.forEach((i=>{if(i.group)return t(i.group);e.push(i)}))};return t(s),e}return s}var Hg=$g;const Ug=B.default.Transform;var qg=class extends Ug{constructor(){super(),this.lastByte=!1}_transform(e,t,i){e.length&&(this.lastByte=e[e.length-1]),this.push(e),i()}_flush(e){return 10===this.lastByte?e():13===this.lastByte?(this.push(Buffer.from("\n")),e()):(this.push(Buffer.from("\r\n")),e())}};const Mg=B.default.Transform;var zg=class extends Mg{constructor(e){super(e),this.options=e||{},this.lastByte=!1}_transform(e,t,i){let n,o=0;for(let t=0,i=e.length;t<i;t++)10===e[t]&&(t&&13!==e[t-1]||!t&&13!==this.lastByte)&&(t>o&&(n=e.slice(o,t),this.push(n)),this.push(Buffer.from("\r\n")),o=t+1);o&&o<e.length?(n=e.slice(o),this.push(n)):o||this.push(e),this.lastByte=e[e.length-1],i()}};const Gg=B.default.Transform;var Vg=class extends Gg{constructor(e){super(e),this.options=e||{}}_transform(e,t,i){let n,o=0;for(let t=0,i=e.length;t<i;t++)13===e[t]&&(n=e.slice(o,t),o=t+1,this.push(n));o&&o<e.length?(n=e.slice(o),this.push(n)):o||this.push(e),i()}};const Wg=D.default,Jg=P.default,Kg=k.default,Qg=H.default,Xg=B.default.PassThrough,Yg=cg.exports,Zg=Rg,ev=jg,tv=Sg,iv=Hg,nv=ug.exports,ov=qg,sv=zg,rv=Vg;class av{constructor(e,t){this.nodeCounter=0,t=t||{},this.baseBoundary=t.baseBoundary||Wg.randomBytes(8).toString("hex"),this.boundaryPrefix=t.boundaryPrefix||"--_NmP",this.disableFileAccess=!!t.disableFileAccess,this.disableUrlAccess=!!t.disableUrlAccess,this.normalizeHeaderKey=t.normalizeHeaderKey,this.date=new Date,this.rootNode=t.rootNode||this,this.keepBcc=!!t.keepBcc,t.filename&&(this.filename=t.filename,e||(e=Zg.detectMimeType(this.filename.split(".").pop()))),this.textEncoding=(t.textEncoding||"").toString().trim().charAt(0).toUpperCase(),this.parentNode=t.parentNode,this.hostname=t.hostname,this.newline=t.newline,this.childNodes=[],this._nodeId=++this.rootNode.nodeCounter,this._headers=[],this._isPlainText=!1,this._hasLongLines=!1,this._envelope=!1,this._raw=!1,this._transforms=[],this._processFuncs=[],e&&this.setHeader("Content-Type",e)}createChild(e,t){t||"object"!=typeof e||(t=e,e=void 0);let i=new av(e,t);return this.appendChild(i),i}appendChild(e){return e.rootNode!==this.rootNode&&(e.rootNode=this.rootNode,e._nodeId=++this.rootNode.nodeCounter),e.parentNode=this,this.childNodes.push(e),e}replace(e){return e===this?this:(this.parentNode.childNodes.forEach(((t,i)=>{t===this&&(e.rootNode=this.rootNode,e.parentNode=this.parentNode,e._nodeId=this._nodeId,this.rootNode=this,this.parentNode=void 0,e.parentNode.childNodes[i]=e)})),e)}remove(){if(!this.parentNode)return this;for(let e=this.parentNode.childNodes.length-1;e>=0;e--)if(this.parentNode.childNodes[e]===this)return this.parentNode.childNodes.splice(e,1),this.parentNode=void 0,this.rootNode=this,this}setHeader(e,t){let i,n=!1;if(!t&&e&&"object"==typeof e)return e.key&&"value"in e?this.setHeader(e.key,e.value):Array.isArray(e)?e.forEach((e=>{this.setHeader(e.key,e.value)})):Object.keys(e).forEach((t=>{this.setHeader(t,e[t])})),this;i={key:e=this._normalizeHeaderKey(e),value:t};for(let t=0,o=this._headers.length;t<o;t++)this._headers[t].key===e&&(n?(this._headers.splice(t,1),t--,o--):(this._headers[t]=i,n=!0));return n||this._headers.push(i),this}addHeader(e,t){return!t&&e&&"object"==typeof e?(e.key&&e.value?this.addHeader(e.key,e.value):Array.isArray(e)?e.forEach((e=>{this.addHeader(e.key,e.value)})):Object.keys(e).forEach((t=>{this.addHeader(t,e[t])})),this):Array.isArray(t)?(t.forEach((t=>{this.addHeader(e,t)})),this):(this._headers.push({key:this._normalizeHeaderKey(e),value:t}),this)}getHeader(e){e=this._normalizeHeaderKey(e);for(let t=0,i=this._headers.length;t<i;t++)if(this._headers[t].key===e)return this._headers[t].value}setContent(e){return this.content=e,"function"==typeof this.content.pipe?(this._contentErrorHandler=e=>{this.content.removeListener("error",this._contentErrorHandler),this.content=e},this.content.once("error",this._contentErrorHandler)):"string"==typeof this.content&&(this._isPlainText=Zg.isPlainText(this.content),this._isPlainText&&Zg.hasLongerLines(this.content,76)&&(this._hasLongLines=!0)),this}build(e){let t;e||(t=new Promise(((t,i)=>{e=Yg.callbackPromise(t,i)})));let i=this.createReadStream(),n=[],o=0,s=!1;return i.on("readable",(()=>{let e;for(;null!==(e=i.read());)n.push(e),o+=e.length})),i.once("error",(t=>{if(!s)return s=!0,e(t)})),i.once("end",(t=>{if(!s)return s=!0,t&&t.length&&(n.push(t),o+=t.length),e(null,Buffer.concat(n,o))})),t}getTransferEncoding(){let e=!1,t=(this.getHeader("Content-Type")||"").toString().toLowerCase().trim();return this.content&&(e=(this.getHeader("Content-Transfer-Encoding")||"").toString().toLowerCase().trim(),e&&["base64","quoted-printable"].includes(e)||(/^text\//i.test(t)?e=this._isPlainText&&!this._hasLongLines?"7bit":"string"==typeof this.content||this.content instanceof Buffer?"Q"===this._getTextEncoding(this.content)?"quoted-printable":"base64":"B"===this.textEncoding?"base64":"quoted-printable":/^(multipart|message)\//i.test(t)||(e=e||"base64"))),e}buildHeaders(){let e=this.getTransferEncoding(),t=[];return e&&this.setHeader("Content-Transfer-Encoding",e),this.filename&&!this.getHeader("Content-Disposition")&&this.setHeader("Content-Disposition","attachment"),this.rootNode===this&&(this.getHeader("Date")||this.setHeader("Date",this.date.toUTCString().replace(/GMT/,"+0000")),this.messageId(),this.getHeader("MIME-Version")||this.setHeader("MIME-Version","1.0")),this._headers.forEach((e=>{let i,n,o=e.key,s=e.value,r={};if(!s||"object"!=typeof s||["From","Sender","To","Cc","Bcc","Reply-To","Date","References"].includes(o)||(Object.keys(s).forEach((e=>{"value"!==e&&(r[e]=s[e])})),s=(s.value||"").toString(),s.trim()))if(r.prepared)r.foldLines?t.push(Zg.foldLines(o+": "+s)):t.push(o+": "+s);else{switch(e.key){case"Content-Disposition":i=Zg.parseHeaderValue(s),this.filename&&(i.params.filename=this.filename),s=Zg.buildHeaderValue(i);break;case"Content-Type":i=Zg.parseHeaderValue(s),this._handleContentType(i),i.value.match(/^text\/plain\b/)&&"string"==typeof this.content&&/[\u0080-\uFFFF]/.test(this.content)&&(i.params.charset="utf-8"),s=Zg.buildHeaderValue(i),this.filename&&(n=this._encodeWords(this.filename),(n!==this.filename||/[\s'"\\;:/=(),<>@[\]?]|^-/.test(n))&&(n='"'+n+'"'),s+="; name="+n);break;case"Bcc":if(!this.keepBcc)return}if(s=this._encodeHeaderValue(o,s),(s||"").toString().trim()){if("function"==typeof this.normalizeHeaderKey){let e=this.normalizeHeaderKey(o,s);e&&"string"==typeof e&&e.length&&(o=e)}t.push(Zg.foldLines(o+": "+s,76))}}})),t.join("\r\n")}createReadStream(e){let t,i=new Xg(e=e||{}),n=i;this.stream(i,e,(e=>{e?n.emit("error",e):i.end()}));for(let e=0,i=this._transforms.length;e<i;e++)t="function"==typeof this._transforms[e]?this._transforms[e]():this._transforms[e],n.once("error",(e=>{t.emit("error",e)})),n=n.pipe(t);t=new ov,n.once("error",(e=>{t.emit("error",e)})),n=n.pipe(t);for(let e=0,i=this._processFuncs.length;e<i;e++)t=this._processFuncs[e],n=t(n);if(this.newline){const e=["win","windows","dos","\r\n"].includes(this.newline.toString().toLowerCase())?new sv:new rv,t=n.pipe(e);return n.on("error",(e=>t.emit("error",e))),t}return n}transform(e){this._transforms.push(e)}processFunc(e){this._processFuncs.push(e)}stream(e,t,i){let n,o,s=this.getTransferEncoding(),r=!1,a=e=>{r||(r=!0,i(e))},c=()=>{let i=0,n=()=>{if(i>=this.childNodes.length)return e.write("\r\n--"+this.boundary+"--\r\n"),a();let o=this.childNodes[i++];e.write((i>1?"\r\n":"")+"--"+this.boundary+"\r\n"),o.stream(e,t,(e=>{if(e)return a(e);setImmediate(n)}))};if(!this.multipart)return a();setImmediate(n)},u=()=>{if(!this.content)return setImmediate(c);{if("[object Error]"===Object.prototype.toString.call(this.content))return a(this.content);"function"==typeof this.content.pipe&&(this.content.removeListener("error",this._contentErrorHandler),this._contentErrorHandler=e=>a(e),this.content.once("error",this._contentErrorHandler));let i=()=>{["quoted-printable","base64"].includes(s)?(n=new("base64"===s?tv:ev).Encoder(t),n.pipe(e,{end:!1}),n.once("end",c),n.once("error",(e=>a(e))),o=this._getStream(this.content),o.pipe(n)):(o=this._getStream(this.content),o.pipe(e,{end:!1}),o.once("end",c)),o.once("error",(e=>a(e)))};if(this.content._resolve){let e=[],t=0,n=!1,o=this._getStream(this.content);o.on("error",(e=>{n||(n=!0,a(e))})),o.on("readable",(()=>{let i;for(;null!==(i=o.read());)e.push(i),t+=i.length})),o.on("end",(()=>{n||(n=!0,this.content._resolve=!1,this.content._resolvedValue=Buffer.concat(e,t),setImmediate(i))}))}else setImmediate(i)}};this._raw?setImmediate((()=>{if("[object Error]"===Object.prototype.toString.call(this._raw))return a(this._raw);"function"==typeof this._raw.pipe&&this._raw.removeListener("error",this._contentErrorHandler);let t=this._getStream(this._raw);t.pipe(e,{end:!1}),t.on("error",(t=>e.emit("error",t))),t.on("end",c)})):(e.write(this.buildHeaders()+"\r\n\r\n"),setImmediate(u))}setEnvelope(e){let t;this._envelope={from:!1,to:[]},e.from&&(t=[],this._convertAddresses(this._parseAddresses(e.from),t),t=t.filter((e=>e&&e.address)),t.length&&t[0]&&(this._envelope.from=t[0].address)),["to","cc","bcc"].forEach((t=>{e[t]&&this._convertAddresses(this._parseAddresses(e[t]),this._envelope.to)})),this._envelope.to=this._envelope.to.map((e=>e.address)).filter((e=>e));let i=["to","cc","bcc","from"];return Object.keys(e).forEach((t=>{i.includes(t)||(this._envelope[t]=e[t])})),this}getAddresses(){let e={};return this._headers.forEach((t=>{let i=t.key.toLowerCase();["from","sender","reply-to","to","cc","bcc"].includes(i)&&(Array.isArray(e[i])||(e[i]=[]),this._convertAddresses(this._parseAddresses(t.value),e[i]))})),e}getEnvelope(){if(this._envelope)return this._envelope;let e={from:!1,to:[]};return this._headers.forEach((t=>{let i=[];"From"===t.key||!e.from&&["Reply-To","Sender"].includes(t.key)?(this._convertAddresses(this._parseAddresses(t.value),i),i.length&&i[0]&&(e.from=i[0].address)):["To","Cc","Bcc"].includes(t.key)&&this._convertAddresses(this._parseAddresses(t.value),e.to)})),e.to=e.to.map((e=>e.address)),e}messageId(){let e=this.getHeader("Message-ID");return e||(e=this._generateMessageId(),this.setHeader("Message-ID",e)),e}setRaw(e){return this._raw=e,this._raw&&"function"==typeof this._raw.pipe&&(this._contentErrorHandler=e=>{this._raw.removeListener("error",this._contentErrorHandler),this._raw=e},this._raw.once("error",this._contentErrorHandler)),this}_getStream(e){let t;return e._resolvedValue?(t=new Xg,setImmediate((()=>t.end(e._resolvedValue))),t):"function"==typeof e.pipe?e:e&&"string"==typeof e.path&&!e.href?this.disableFileAccess?(t=new Xg,setImmediate((()=>t.emit("error",new Error("File access rejected for "+e.path)))),t):Kg.createReadStream(e.path):e&&"string"==typeof e.href?this.disableUrlAccess?(t=new Xg,setImmediate((()=>t.emit("error",new Error("Url access rejected for "+e.href)))),t):nv(e.href,{headers:e.httpHeaders}):(t=new Xg,setImmediate((()=>t.end(e||""))),t)}_parseAddresses(e){return[].concat.apply([],[].concat(e).map((e=>e&&e.address?(e.address=this._normalizeAddress(e.address),e.name=e.name||"",[e]):iv(e))))}_normalizeHeaderKey(e){return e=(e||"").toString().replace(/\r?\n|\r/g," ").trim().toLowerCase().replace(/^X-SMTPAPI$|^(MIME|DKIM|ARC|BIMI)\b|^[a-z]|-(SPF|FBL|ID|MD5)$|-[a-z]/gi,(e=>e.toUpperCase())).replace(/^Content-Features$/i,"Content-features"),e}_handleContentType(e){this.contentType=e.value.trim().toLowerCase(),this.multipart=!!/^multipart\//i.test(this.contentType)&&this.contentType.substr(this.contentType.indexOf("/")+1),this.multipart?this.boundary=e.params.boundary=e.params.boundary||this.boundary||this._generateBoundary():this.boundary=!1}_generateBoundary(){return this.rootNode.boundaryPrefix+"-"+this.rootNode.baseBoundary+"-Part_"+this._nodeId}_encodeHeaderValue(e,t){switch(e=this._normalizeHeaderKey(e)){case"From":case"Sender":case"To":case"Cc":case"Bcc":case"Reply-To":return this._convertAddresses(this._parseAddresses(t));case"Message-ID":case"In-Reply-To":case"Content-Id":return"<"!==(t=(t||"").toString().replace(/\r?\n|\r/g," ")).charAt(0)&&(t="<"+t),">"!==t.charAt(t.length-1)&&(t+=">"),t;case"References":return(t=[].concat.apply([],[].concat(t||"").map((e=>(e=(e||"").toString().replace(/\r?\n|\r/g," ").trim()).replace(/<[^>]*>/g,(e=>e.replace(/\s/g,""))).split(/\s+/)))).map((e=>("<"!==e.charAt(0)&&(e="<"+e),">"!==e.charAt(e.length-1)&&(e+=">"),e)))).join(" ").trim();case"Date":return"[object Date]"===Object.prototype.toString.call(t)?t.toUTCString().replace(/GMT/,"+0000"):(t=(t||"").toString().replace(/\r?\n|\r/g," "),this._encodeWords(t));case"Content-Type":case"Content-Disposition":return(t||"").toString().replace(/\r?\n|\r/g," ");default:return t=(t||"").toString().replace(/\r?\n|\r/g," "),this._encodeWords(t)}}_convertAddresses(e,t){let i=[];return t=t||[],[].concat(e||[]).forEach((e=>{if(e.address)e.address=this._normalizeAddress(e.address),e.name?e.name&&i.push(`${this._encodeAddressName(e.name)} <${e.address}>`):i.push(e.address.indexOf(" ")>=0?`<${e.address}>`:`${e.address}`),e.address&&(t.filter((t=>t.address===e.address)).length||t.push(e));else if(e.group){let n=(e.group.length?this._convertAddresses(e.group,t):"").trim();i.push(`${this._encodeAddressName(e.name)}:${n};`)}})),i.join(", ")}_normalizeAddress(e){let t=(e=(e||"").toString().replace(/[\x00-\x1F<>]+/g," ").trim()).lastIndexOf("@");if(t<0)return e;let i,n=e.substr(0,t),o=e.substr(t+1);try{i=Qg.toASCII(o.toLowerCase())}catch(e){}return n.indexOf(" ")>=0&&('"'!==n.charAt(0)&&(n='"'+n),'"'!==n.substr(-1)&&(n+='"')),`${n}@${i}`}_encodeAddressName(e){return/^[\w ']*$/.test(e)?e:/^[\x20-\x7e]*$/.test(e)?'"'+e.replace(/([\\"])/g,"\\$1")+'"':Zg.encodeWord(e,this._getTextEncoding(e),52)}_encodeWords(e){return Zg.encodeWords(e,this._getTextEncoding(e),52,!0)}_getTextEncoding(e){e=(e||"").toString();let t,i,n=this.textEncoding;return n||(i=(e.match(/[\x00-\x08\x0B\x0C\x0E-\x1F\u0080-\uFFFF]/g)||[]).length,t=(e.match(/[a-z]/gi)||[]).length,n=i<t?"Q":"B"),n}_generateMessageId(){return"<"+[2,2,2,6].reduce(((e,t)=>e+"-"+Wg.randomBytes(t).toString("hex")),Wg.randomBytes(4).toString("hex"))+"@"+(this.getEnvelope().from||this.hostname||Jg.hostname()||"localhost").split("@").pop()+">"}}var cv=av;const uv=cv,lv=Rg;var pv=class{constructor(e){this.mail=e||{},this.message=!1}compile(){return this._alternatives=this.getAlternatives(),this._htmlNode=this._alternatives.filter((e=>/^text\/html\b/i.test(e.contentType))).pop(),this._attachments=this.getAttachments(!!this._htmlNode),this._useRelated=!(!this._htmlNode||!this._attachments.related.length),this._useAlternative=this._alternatives.length>1,this._useMixed=this._attachments.attached.length>1||this._alternatives.length&&1===this._attachments.attached.length,this.mail.raw?this.message=new uv("message/rfc822",{newline:this.mail.newline}).setRaw(this.mail.raw):this._useMixed?this.message=this._createMixed():this._useAlternative?this.message=this._createAlternative():this._useRelated?this.message=this._createRelated():this.message=this._createContentNode(!1,[].concat(this._alternatives||[]).concat(this._attachments.attached||[]).shift()||{contentType:"text/plain",content:""}),this.mail.headers&&this.message.addHeader(this.mail.headers),["from","sender","to","cc","bcc","reply-to","in-reply-to","references","subject","message-id","date"].forEach((e=>{let t=e.replace(/-(\w)/g,((e,t)=>t.toUpperCase()));this.mail[t]&&this.message.setHeader(e,this.mail[t])})),this.mail.envelope&&this.message.setEnvelope(this.mail.envelope),this.message.messageId(),this.message}getAttachments(e){let t,i,n=[].concat(this.mail.attachments||[]).map(((e,t)=>{let i,n=/^message\//i.test(e.contentType);return/^data:/i.test(e.path||e.href)&&(e=this._processDataUrl(e)),i={contentType:e.contentType||lv.detectMimeType(e.filename||e.path||e.href||"bin"),contentDisposition:e.contentDisposition||(n?"inline":"attachment"),contentTransferEncoding:"contentTransferEncoding"in e?e.contentTransferEncoding:"base64"},e.filename?i.filename=e.filename:n||!1===e.filename||(i.filename=(e.path||e.href||"").split("/").pop().split("?").shift()||"attachment-"+(t+1),i.filename.indexOf(".")<0&&(i.filename+="."+lv.detectExtension(i.contentType))),/^https?:\/\//i.test(e.path)&&(e.href=e.path,e.path=void 0),e.cid&&(i.cid=e.cid),e.raw?i.raw=e.raw:e.path?i.content={path:e.path}:e.href?i.content={href:e.href,httpHeaders:e.httpHeaders}:i.content=e.content||"",e.encoding&&(i.encoding=e.encoding),e.headers&&(i.headers=e.headers),i}));return this.mail.icalEvent&&(t="object"==typeof this.mail.icalEvent&&(this.mail.icalEvent.content||this.mail.icalEvent.path||this.mail.icalEvent.href||this.mail.icalEvent.raw)?this.mail.icalEvent:{content:this.mail.icalEvent},i={},Object.keys(t).forEach((e=>{i[e]=t[e]})),i.contentType="application/ics",i.headers||(i.headers={}),i.filename=i.filename||"invite.ics",i.headers["Content-Disposition"]="attachment",i.headers["Content-Transfer-Encoding"]="base64"),e?{attached:n.filter((e=>!e.cid)).concat(i||[]),related:n.filter((e=>!!e.cid))}:{attached:n.concat(i||[]),related:[]}}getAlternatives(){let e,t,i,n,o,s,r=[];return this.mail.text&&(e="object"==typeof this.mail.text&&(this.mail.text.content||this.mail.text.path||this.mail.text.href||this.mail.text.raw)?this.mail.text:{content:this.mail.text},e.contentType="text/plain; charset=utf-8"),this.mail.watchHtml&&(i="object"==typeof this.mail.watchHtml&&(this.mail.watchHtml.content||this.mail.watchHtml.path||this.mail.watchHtml.href||this.mail.watchHtml.raw)?this.mail.watchHtml:{content:this.mail.watchHtml},i.contentType="text/watch-html; charset=utf-8"),this.mail.amp&&(n="object"==typeof this.mail.amp&&(this.mail.amp.content||this.mail.amp.path||this.mail.amp.href||this.mail.amp.raw)?this.mail.amp:{content:this.mail.amp},n.contentType="text/x-amp-html; charset=utf-8"),this.mail.icalEvent&&(o="object"==typeof this.mail.icalEvent&&(this.mail.icalEvent.content||this.mail.icalEvent.path||this.mail.icalEvent.href||this.mail.icalEvent.raw)?this.mail.icalEvent:{content:this.mail.icalEvent},s={},Object.keys(o).forEach((e=>{s[e]=o[e]})),s.content&&"object"==typeof s.content&&(s.content._resolve=!0),s.filename=!1,s.contentType="text/calendar; charset=utf-8; method="+(s.method||"PUBLISH").toString().trim().toUpperCase(),s.headers||(s.headers={})),this.mail.html&&(t="object"==typeof this.mail.html&&(this.mail.html.content||this.mail.html.path||this.mail.html.href||this.mail.html.raw)?this.mail.html:{content:this.mail.html},t.contentType="text/html; charset=utf-8"),[].concat(e||[]).concat(i||[]).concat(n||[]).concat(t||[]).concat(s||[]).concat(this.mail.alternatives||[]).forEach((e=>{let t;/^data:/i.test(e.path||e.href)&&(e=this._processDataUrl(e)),t={contentType:e.contentType||lv.detectMimeType(e.filename||e.path||e.href||"txt"),contentTransferEncoding:e.contentTransferEncoding},e.filename&&(t.filename=e.filename),/^https?:\/\//i.test(e.path)&&(e.href=e.path,e.path=void 0),e.raw?t.raw=e.raw:e.path?t.content={path:e.path}:e.href?t.content={href:e.href}:t.content=e.content||"",e.encoding&&(t.encoding=e.encoding),e.headers&&(t.headers=e.headers),r.push(t)})),r}_createMixed(e){let t;return t=e?e.createChild("multipart/mixed",{disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline}):new uv("multipart/mixed",{baseBoundary:this.mail.baseBoundary,textEncoding:this.mail.textEncoding,boundaryPrefix:this.mail.boundaryPrefix,disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline}),this._useAlternative?this._createAlternative(t):this._useRelated&&this._createRelated(t),[].concat(!this._useAlternative&&this._alternatives||[]).concat(this._attachments.attached||[]).forEach((e=>{this._useRelated&&e===this._htmlNode||this._createContentNode(t,e)})),t}_createAlternative(e){let t;return t=e?e.createChild("multipart/alternative",{disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline}):new uv("multipart/alternative",{baseBoundary:this.mail.baseBoundary,textEncoding:this.mail.textEncoding,boundaryPrefix:this.mail.boundaryPrefix,disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline}),this._alternatives.forEach((e=>{this._useRelated&&this._htmlNode===e?this._createRelated(t):this._createContentNode(t,e)})),t}_createRelated(e){let t;return t=e?e.createChild('multipart/related; type="text/html"',{disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline}):new uv('multipart/related; type="text/html"',{baseBoundary:this.mail.baseBoundary,textEncoding:this.mail.textEncoding,boundaryPrefix:this.mail.boundaryPrefix,disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline}),this._createContentNode(t,this._htmlNode),this._attachments.related.forEach((e=>this._createContentNode(t,e))),t}_createContentNode(e,t){let i;(t=t||{}).content=t.content||"";let n=(t.encoding||"utf8").toString().toLowerCase().replace(/[-_\s]/g,"");return i=e?e.createChild(t.contentType,{filename:t.filename,textEncoding:this.mail.textEncoding,disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline}):new uv(t.contentType,{filename:t.filename,baseBoundary:this.mail.baseBoundary,textEncoding:this.mail.textEncoding,boundaryPrefix:this.mail.boundaryPrefix,disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline}),t.headers&&i.addHeader(t.headers),t.cid&&i.setHeader("Content-Id","<"+t.cid.replace(/[<>]/g,"")+">"),t.contentTransferEncoding?i.setHeader("Content-Transfer-Encoding",t.contentTransferEncoding):this.mail.encoding&&/^text\//i.test(t.contentType)&&i.setHeader("Content-Transfer-Encoding",this.mail.encoding),/^text\//i.test(t.contentType)&&!t.contentDisposition||i.setHeader("Content-Disposition",t.contentDisposition||(t.cid?"inline":"attachment")),"string"!=typeof t.content||["utf8","usascii","ascii"].includes(n)||(t.content=Buffer.from(t.content,n)),t.raw?i.setRaw(t.raw):i.setContent(t.content),i}_processDataUrl(e){let t=(e.path||e.href).match(/^data:((?:[^;]*;)*(?:[^,]*)),(.*)$/i);return t?(e.content=/\bbase64$/i.test(t[1])?Buffer.from(t[2],"base64"):Buffer.from(decodeURIComponent(t[2])),"path"in e&&(e.path=!1),"href"in e&&(e.href=!1),t[1].split(";").forEach((t=>{/^\w+\/[^/]+$/i.test(t)&&(e.contentType=e.contentType||t.toLowerCase())})),e):e}};const dv=B.default.Transform;var hv=class extends dv{constructor(e){super(e),this.lastBytes=Buffer.alloc(4),this.headersParsed=!1,this.headerBytes=0,this.headerChunks=[],this.rawHeaders=!1,this.bodySize=0}updateLastBytes(e){let t=this.lastBytes.length,i=Math.min(e.length,t);for(let e=0,n=t-i;e<n;e++)this.lastBytes[e]=this.lastBytes[e+i];for(let n=1;n<=i;n++)this.lastBytes[t-n]=e[e.length-n]}checkHeaders(e){if(this.headersParsed)return!0;let t=this.lastBytes.length,i=0;this.curLinePos=0;for(let n=0,o=this.lastBytes.length+e.length;n<o;n++){let o;if(o=n<t?this.lastBytes[n]:e[n-t],10===o&&n){let o=n-1<t?this.lastBytes[n-1]:e[n-1-t],s=n>1&&(n-2<t?this.lastBytes[n-2]:e[n-2-t]);if(10===o){this.headersParsed=!0,i=n-t+1,this.headerBytes+=i;break}if(13===o&&10===s){this.headersParsed=!0,i=n-t+1,this.headerBytes+=i;break}}}if(this.headersParsed){if(this.headerChunks.push(e.slice(0,i)),this.rawHeaders=Buffer.concat(this.headerChunks,this.headerBytes),this.headerChunks=null,this.emit("headers",this.parseHeaders()),e.length-1>i){let t=e.slice(i);this.bodySize+=t.length,setImmediate((()=>this.push(t)))}return!1}return this.headerBytes+=e.length,this.headerChunks.push(e),this.updateLastBytes(e),!1}_transform(e,t,i){if(!e||!e.length)return i();let n;"string"==typeof e&&(e=Buffer.from(e,t));try{n=this.checkHeaders(e)}catch(e){return i(e)}n&&(this.bodySize+=e.length,this.push(e)),setImmediate(i)}_flush(e){if(this.headerChunks){let e=Buffer.concat(this.headerChunks,this.headerBytes);this.bodySize+=e.length,this.push(e),this.headerChunks=null}e()}parseHeaders(){let e=(this.rawHeaders||"").toString().split(/\r?\n/);for(let t=e.length-1;t>0;t--)/^\s/.test(e[t])&&(e[t-1]+="\n"+e[t],e.splice(t,1));return e.filter((e=>e.trim())).map((e=>({key:e.substr(0,e.indexOf(":")).trim().toLowerCase(),line:e})))}};const mv=B.default.Transform,fv=D.default;var gv=class extends mv{constructor(e){super(),e=e||{},this.chunkBuffer=[],this.chunkBufferLen=0,this.bodyHash=fv.createHash(e.hashAlgo||"sha1"),this.remainder="",this.byteLength=0,this.debug=e.debug,this._debugBody=!!e.debug&&[]}updateHash(e){let t,i="",n="file";for(let t=e.length-1;t>=0;t--){let o=e[t];if("file"!==n||10!==o&&13!==o)if("file"!==n||9!==o&&32!==o)if("line"!==n||9!==o&&32!==o){if(("file"===n||"line"===n)&&(n="body",t===e.length-1))break}else;else n="line";else;if(0===t){if("file"===n&&(!this.remainder||/[\r\n]$/.test(this.remainder))||"line"===n&&(!this.remainder||/[ \t]$/.test(this.remainder)))return void(this.remainder+=e.toString("binary"));if("line"===n||"file"===n){i=e.toString("binary"),e=!1;break}}if("body"===n){i=e.slice(t+1).toString("binary"),e=e.slice(0,t+1);break}}let o=!!this.remainder;if(e&&!o)for(let t=0,i=e.length;t<i;t++){if(t&&10===e[t]&&13!==e[t-1]){o=!0;break}if(t&&13===e[t]&&32===e[t-1]){o=!0;break}if(t&&32===e[t]&&32===e[t-1]){o=!0;break}if(9===e[t]){o=!0;break}}o?(t=this.remainder+(e?e.toString("binary"):""),this.remainder=i,t=t.replace(/\r?\n/g,"\n").replace(/[ \t]*$/gm,"").replace(/[ \t]+/gm," ").replace(/\n/g,"\r\n"),e=Buffer.from(t,"binary")):i&&(this.remainder=i),this.debug&&this._debugBody.push(e),this.bodyHash.update(e)}_transform(e,t,i){if(!e||!e.length)return i();"string"==typeof e&&(e=Buffer.from(e,t)),this.updateHash(e),this.byteLength+=e.length,this.push(e),i()}_flush(e){/[\r\n]$/.test(this.remainder)&&this.byteLength>2&&this.bodyHash.update(Buffer.from("\r\n")),this.byteLength||this.push(Buffer.from("\r\n")),this.emit("hash",this.bodyHash.digest("base64"),!!this.debug&&Buffer.concat(this._debugBody)),e()}},vv={exports:{}};const xv=H.default,yv=Rg,bv=D.default;function wv(e,t,i){let n=new Set,o=new Set,s=new Map;(i||"").toLowerCase().split(":").forEach((e=>{o.add(e.trim())})),(t||"").toLowerCase().split(":").filter((e=>!o.has(e.trim()))).forEach((e=>{n.add(e.trim())}));for(let t=e.length-1;t>=0;t--){let i=e[t];n.has(i.key)&&!s.has(i.key)&&s.set(i.key,_v(i.line))}let r=[],a=[];return n.forEach((e=>{s.has(e)&&(a.push(e),r.push(e+":"+s.get(e)))})),{headers:r.join("\r\n")+"\r\n",fieldNames:a.join(":")}}function _v(e){return e.substr(e.indexOf(":")+1).replace(/\r?\n/g,"").replace(/\s+/g," ").trim()}vv.exports=(e,t,i,n)=>{let o,s,r=wv(e,(n=n||{}).headerFieldNames||"From:Sender:Reply-To:Subject:Date:Message-ID:To:Cc:MIME-Version:Content-Type:Content-Transfer-Encoding:Content-ID:Content-Description:Resent-Date:Resent-From:Resent-Sender:Resent-To:Resent-Cc:Resent-Message-ID:In-Reply-To:References:List-Id:List-Help:List-Unsubscribe:List-Subscribe:List-Post:List-Owner:List-Archive",n.skipFields),a=function(e,t,i,n,o){let s=["v=1","a=rsa-"+n,"c=relaxed/relaxed","d="+xv.toASCII(e),"q=dns/txt","s="+t,"bh="+o,"h="+i].join("; ");return yv.foldLines("DKIM-Signature: "+s,76)+";\r\n b="}(n.domainName,n.keySelector,r.fieldNames,t,i);r.headers+="dkim-signature:"+_v(a),o=bv.createSign(("rsa-"+t).toUpperCase()),o.update(r.headers);try{s=o.sign(n.privateKey,"base64")}catch(e){return!1}return a+s.replace(/(^.{73}|.{75}(?!\r?\n|\r))/g,"$&\r\n ").trim()},vv.exports.relaxedHeaders=wv;const Dv=hv,Ev=gv,Cv=vv.exports,Av=B.default.PassThrough,kv=k.default,Sv=C.default,Fv=D.default;class Tv{constructor(e,t,i,n){this.options=e||{},this.keys=t,this.cacheTreshold=Number(this.options.cacheTreshold)||131072,this.hashAlgo=this.options.hashAlgo||"sha256",this.cacheDir=this.options.cacheDir||!1,this.chunks=[],this.chunklen=0,this.readPos=0,this.cachePath=!!this.cacheDir&&Sv.join(this.cacheDir,"message."+Date.now()+"-"+Fv.randomBytes(14).toString("hex")),this.cache=!1,this.headers=!1,this.bodyHash=!1,this.parser=!1,this.relaxedBody=!1,this.input=i,this.output=n,this.output.usingCache=!1,this.hasErrored=!1,this.input.on("error",(e=>{this.hasErrored=!0,this.cleanup(),n.emit("error",e)}))}cleanup(){this.cache&&this.cachePath&&kv.unlink(this.cachePath,(()=>!1))}createReadCache(){this.cache=kv.createReadStream(this.cachePath),this.cache.once("error",(e=>{this.cleanup(),this.output.emit("error",e)})),this.cache.once("close",(()=>{this.cleanup()})),this.cache.pipe(this.output)}sendNextChunk(){if(this.hasErrored)return;if(this.readPos>=this.chunks.length)return this.cache?this.createReadCache():this.output.end();let e=this.chunks[this.readPos++];if(!1===this.output.write(e))return this.output.once("drain",(()=>{this.sendNextChunk()}));setImmediate((()=>this.sendNextChunk()))}sendSignedOutput(){let e=0,t=()=>{if(e>=this.keys.length)return this.output.write(this.parser.rawHeaders),setImmediate((()=>this.sendNextChunk()));let i=this.keys[e++],n=Cv(this.headers,this.hashAlgo,this.bodyHash,{domainName:i.domainName,keySelector:i.keySelector,privateKey:i.privateKey,headerFieldNames:this.options.headerFieldNames,skipFields:this.options.skipFields});return n&&this.output.write(Buffer.from(n+"\r\n")),setImmediate(t)};if(this.bodyHash&&this.headers)return t();this.output.write(this.parser.rawHeaders),this.sendNextChunk()}createWriteCache(){this.output.usingCache=!0,this.cache=kv.createWriteStream(this.cachePath),this.cache.once("error",(e=>{this.cleanup(),this.relaxedBody.unpipe(this.cache),this.relaxedBody.on("readable",(()=>{for(;null!==this.relaxedBody.read(););})),this.hasErrored=!0,this.output.emit("error",e)})),this.cache.once("close",(()=>{this.sendSignedOutput()})),this.relaxedBody.removeAllListeners("readable"),this.relaxedBody.pipe(this.cache)}signStream(){this.parser=new Dv,this.relaxedBody=new Ev({hashAlgo:this.hashAlgo}),this.parser.on("headers",(e=>{this.headers=e})),this.relaxedBody.on("hash",(e=>{this.bodyHash=e})),this.relaxedBody.on("readable",(()=>{let e;if(!this.cache)for(;null!==(e=this.relaxedBody.read());)if(this.chunks.push(e),this.chunklen+=e.length,this.chunklen>=this.cacheTreshold&&this.cachePath)return this.createWriteCache()})),this.relaxedBody.on("end",(()=>{this.cache||this.sendSignedOutput()})),this.parser.pipe(this.relaxedBody),setImmediate((()=>this.input.pipe(this.parser)))}}var Bv=class{constructor(e){this.options=e||{},this.keys=[].concat(this.options.keys||{domainName:e.domainName,keySelector:e.keySelector,privateKey:e.privateKey})}sign(e,t){let i=new Av,n=e,o=!1;Buffer.isBuffer(e)?(o=e,n=new Av):"string"==typeof e&&(o=Buffer.from(e),n=new Av);let s=this.options;t&&Object.keys(t).length&&(s={},Object.keys(this.options||{}).forEach((e=>{s[e]=this.options[e]})),Object.keys(t||{}).forEach((e=>{e in s||(s[e]=t[e])})));let r=new Tv(s,this.keys,n,i);return setImmediate((()=>{r.signStream(),o&&setImmediate((()=>{n.end(o)}))})),i}};const Ov=$.default,jv=N.default,Iv=S.default;var Pv=function(e,t,i,n){let o,s,r,a=Iv.parse(e);o={host:a.hostname,port:Number(a.port)?Number(a.port):"https:"===a.protocol?443:80},"https:"===a.protocol?(o.rejectUnauthorized=!1,s=jv.connect.bind(jv)):s=Ov.connect.bind(Ov);let c=!1,u=function(e){if(!c){c=!0;try{r.destroy()}catch(e){}n(e)}};r=s(o,(()=>{if(c)return;let e={Host:i+":"+t,Connection:"close"};a.auth&&(e["Proxy-Authorization"]="Basic "+Buffer.from(a.auth).toString("base64")),r.write("CONNECT "+i+":"+t+" HTTP/1.1\r\n"+Object.keys(e).map((t=>t+": "+e[t])).join("\r\n")+"\r\n\r\n");let o="",s=e=>{let t,i;if(!c&&(o+=e.toString("binary"),t=o.match(/\r\n\r\n/))){if(r.removeListener("data",s),i=o.substr(t.index+t[0].length),o=o.substr(0,t.index),i&&r.unshift(Buffer.from(i,"binary")),c=!0,t=o.match(/^HTTP\/\d+\.\d+ (\d+)/i),!t||"2"!==(t[1]||"").charAt(0)){try{r.destroy()}catch(e){}return n(new Error("Invalid response from proxy"+(t&&": "+t[1]||"")))}return r.removeListener("error",u),n(null,r)}};r.on("data",s)})),r.once("error",u)};const Lv=cg.exports,Rv=cv,Nv=Rg;var $v=class{constructor(e,t){this.mailer=e,this.data={},this.message=null,t=t||{};let i=e.options||{},n=e._defaults||{};Object.keys(t).forEach((e=>{this.data[e]=t[e]})),this.data.headers=this.data.headers||{},Object.keys(n).forEach((e=>{e in this.data?"headers"===e&&Object.keys(n.headers).forEach((e=>{e in this.data.headers||(this.data.headers[e]=n.headers[e])})):this.data[e]=n[e]})),["disableFileAccess","disableUrlAccess","normalizeHeaderKey"].forEach((e=>{e in i&&(this.data[e]=i[e])}))}resolveContent(...e){return Lv.resolveContent(...e)}resolveAll(e){let t=[[this.data,"html"],[this.data,"text"],[this.data,"watchHtml"],[this.data,"amp"],[this.data,"icalEvent"]];this.data.alternatives&&this.data.alternatives.length&&this.data.alternatives.forEach(((e,i)=>{t.push([this.data.alternatives,i])})),this.data.attachments&&this.data.attachments.length&&this.data.attachments.forEach(((e,i)=>{e.filename||(e.filename=(e.path||e.href||"").split("/").pop().split("?").shift()||"attachment-"+(i+1),e.filename.indexOf(".")<0&&(e.filename+="."+Nv.detectExtension(e.contentType))),e.contentType||(e.contentType=Nv.detectMimeType(e.filename||e.path||e.href||"bin")),t.push([this.data.attachments,i])}));let i=new Rv;["from","to","cc","bcc","sender","replyTo"].forEach((e=>{let t;this.message?t=[].concat(i._parseAddresses(this.message.getHeader("replyTo"===e?"reply-to":e))||[]):this.data[e]&&(t=[].concat(i._parseAddresses(this.data[e])||[])),t&&t.length?this.data[e]=t:e in this.data&&(this.data[e]=null)}));["from","sender","replyTo"].forEach((e=>{this.data[e]&&(this.data[e]=this.data[e].shift())}));let n=0,o=()=>{if(n>=t.length)return e(null,this.data);let i=t[n++];if(!i[0]||!i[0][i[1]])return o();Lv.resolveContent(...i,((t,n)=>{if(t)return e(t);let s={content:n};i[0][i[1]]&&"object"==typeof i[0][i[1]]&&!Buffer.isBuffer(i[0][i[1]])&&Object.keys(i[0][i[1]]).forEach((e=>{e in s||["content","path","href","raw"].includes(e)||(s[e]=i[0][i[1]][e])})),i[0][i[1]]=s,o()}))};setImmediate((()=>o()))}normalize(e){let t=this.data.envelope||this.message.getEnvelope(),i=this.message.messageId();this.resolveAll(((n,o)=>{if(n)return e(n);if(o.envelope=t,o.messageId=i,["html","text","watchHtml","amp"].forEach((e=>{o[e]&&o[e].content&&("string"==typeof o[e].content?o[e]=o[e].content:Buffer.isBuffer(o[e].content)&&(o[e]=o[e].content.toString()))})),o.icalEvent&&Buffer.isBuffer(o.icalEvent.content)&&(o.icalEvent.content=o.icalEvent.content.toString("base64"),o.icalEvent.encoding="base64"),o.alternatives&&o.alternatives.length&&o.alternatives.forEach((e=>{e&&e.content&&Buffer.isBuffer(e.content)&&(e.content=e.content.toString("base64"),e.encoding="base64")})),o.attachments&&o.attachments.length&&o.attachments.forEach((e=>{e&&e.content&&Buffer.isBuffer(e.content)&&(e.content=e.content.toString("base64"),e.encoding="base64")})),o.normalizedHeaders={},Object.keys(o.headers||{}).forEach((e=>{let t=[].concat(o.headers[e]||[]).shift();t=t&&t.value||t,t&&(["references","in-reply-to","message-id","content-id"].includes(e)&&(t=this.message._encodeHeaderValue(e,t)),o.normalizedHeaders[e]=t)})),o.list&&"object"==typeof o.list){this._getListHeaders(o.list).forEach((e=>{o.normalizedHeaders[e.key]=e.value.map((e=>e&&e.value||e)).join(", ")}))}return o.references&&(o.normalizedHeaders.references=this.message._encodeHeaderValue("references",o.references)),o.inReplyTo&&(o.normalizedHeaders["in-reply-to"]=this.message._encodeHeaderValue("in-reply-to",o.inReplyTo)),e(null,o)}))}setMailerHeader(){this.message&&this.data.xMailer&&this.message.setHeader("X-Mailer",this.data.xMailer)}setPriorityHeaders(){if(this.message&&this.data.priority)switch((this.data.priority||"").toString().toLowerCase()){case"high":this.message.setHeader("X-Priority","1 (Highest)"),this.message.setHeader("X-MSMail-Priority","High"),this.message.setHeader("Importance","High");break;case"low":this.message.setHeader("X-Priority","5 (Lowest)"),this.message.setHeader("X-MSMail-Priority","Low"),this.message.setHeader("Importance","Low")}}setListHeaders(){this.message&&this.data.list&&"object"==typeof this.data.list&&this.data.list&&"object"==typeof this.data.list&&this._getListHeaders(this.data.list).forEach((e=>{e.value.forEach((t=>{this.message.addHeader(e.key,t)}))}))}_getListHeaders(e){return Object.keys(e).map((t=>({key:"list-"+t.toLowerCase().trim(),value:[].concat(e[t]||[]).map((e=>({prepared:!0,foldLines:!0,value:[].concat(e||[]).map((e=>{if("string"==typeof e&&(e={url:e}),e&&e.url){if("id"===t.toLowerCase().trim()){let t=e.comment||"";return t=Nv.isPlainText(t)?'"'+t+'"':Nv.encodeWord(t),(e.comment?t+" ":"")+this._formatListUrl(e.url).replace(/^<[^:]+\/{,2}/,"")}let i=e.comment||"";return Nv.isPlainText(i)||(i=Nv.encodeWord(i)),this._formatListUrl(e.url)+(e.comment?" ("+i+")":"")}return""})).filter((e=>e)).join(", ")})))})))}_formatListUrl(e){return e=e.replace(/[\s<]+|[\s>]+/g,""),/^(https?|mailto|ftp):/.test(e)?"<"+e+">":/^[^@]+@[^@]+$/.test(e)?"<mailto:"+e+">":"<http://"+e+">"}};const Hv=F.default,Uv=cg.exports,qv=Eg,Mv=pv,zv=Bv,Gv=Pv,Vv=T.default,Wv=S.default,Jv=dg,Kv=$v,Qv=$.default,Xv=I.default,Yv=D.default;var Zv=class extends Hv{constructor(e,t,i){super(),this.options=t||{},this._defaults=i||{},this._defaultPlugins={compile:[(...e)=>this._convertDataImages(...e)],stream:[]},this._userPlugins={compile:[],stream:[]},this.meta=new Map,this.dkim=!!this.options.dkim&&new zv(this.options.dkim),this.transporter=e,this.transporter.mailer=this,this.logger=Uv.getLogger(this.options,{component:this.options.component||"mail"}),this.logger.debug({tnx:"create"},"Creating transport: %s",this.getVersionString()),"function"==typeof this.transporter.on&&(this.transporter.on("log",(e=>{this.logger.debug({tnx:"transport"},"%s: %s",e.type,e.message)})),this.transporter.on("error",(e=>{this.logger.error({err:e,tnx:"transport"},"Transport Error: %s",e.message),this.emit("error",e)})),this.transporter.on("idle",((...e)=>{this.emit("idle",...e)}))),["close","isIdle","verify"].forEach((e=>{this[e]=(...t)=>"function"==typeof this.transporter[e]?("verify"===e&&"function"==typeof this.getSocket&&(this.transporter.getSocket=this.getSocket,this.getSocket=!1),this.transporter[e](...t)):(this.logger.warn({tnx:"transport",methodName:e},"Non existing method %s called for transport",e),!1)})),this.options.proxy&&"string"==typeof this.options.proxy&&this.setupProxy(this.options.proxy)}use(e,t){return e=(e||"").toString(),this._userPlugins.hasOwnProperty(e)?this._userPlugins[e].push(t):this._userPlugins[e]=[t],this}sendMail(e,t){let i;t||(i=new Promise(((e,i)=>{t=Uv.callbackPromise(e,i)}))),"function"==typeof this.getSocket&&(this.transporter.getSocket=this.getSocket,this.getSocket=!1);let n=new Kv(this,e);return this.logger.debug({tnx:"transport",name:this.transporter.name,version:this.transporter.version,action:"send"},"Sending mail using %s/%s",this.transporter.name,this.transporter.version),this._processPlugins("compile",n,(e=>{if(e)return this.logger.error({err:e,tnx:"plugin",action:"compile"},"PluginCompile Error: %s",e.message),t(e);n.message=new Mv(n.data).compile(),n.setMailerHeader(),n.setPriorityHeaders(),n.setListHeaders(),this._processPlugins("stream",n,(e=>{if(e)return this.logger.error({err:e,tnx:"plugin",action:"stream"},"PluginStream Error: %s",e.message),t(e);(n.data.dkim||this.dkim)&&n.message.processFunc((e=>{let t=n.data.dkim?new zv(n.data.dkim):this.dkim;return this.logger.debug({tnx:"DKIM",messageId:n.message.messageId(),dkimDomains:t.keys.map((e=>e.keySelector+"."+e.domainName)).join(", ")},"Signing outgoing message with %s keys",t.keys.length),t.sign(e,n.data._dkim)})),this.transporter.send(n,((...e)=>{e[0]&&this.logger.error({err:e[0],tnx:"transport",action:"send"},"Send Error: %s",e[0].message),t(...e)}))}))})),i}getVersionString(){return Vv.format("%s (%s; +%s; %s/%s)",Jv.name,Jv.version,Jv.homepage,this.transporter.name,this.transporter.version)}_processPlugins(e,t,i){if(e=(e||"").toString(),!this._userPlugins.hasOwnProperty(e))return i();let n=this._userPlugins[e]||[],o=this._defaultPlugins[e]||[];if(n.length&&this.logger.debug({tnx:"transaction",pluginCount:n.length,step:e},"Using %s plugins for %s",n.length,e),n.length+o.length===0)return i();let s=0,r="default",a=()=>{let e="default"===r?o:n;if(s>=e.length){if("default"!==r||!n.length)return i();r="user",s=0,e=n}(0,e[s++])(t,(e=>{if(e)return i(e);a()}))};a()}setupProxy(e){let t=Wv.parse(e);this.getSocket=(e,i)=>{let n=t.protocol.replace(/:$/,"").toLowerCase();if(this.meta.has("proxy_handler_"+n))return this.meta.get("proxy_handler_"+n)(t,e,i);switch(n){case"http":case"https":return void Gv(t.href,e.port,e.host,((e,t)=>e?i(e):i(null,{connection:t})));case"socks":case"socks5":case"socks4":case"socks4a":{if(!this.meta.has("proxy_socks_module"))return i(new Error("Socks module not loaded"));let n=n=>{let o=!!this.meta.get("proxy_socks_module").SocksClient,s=o?this.meta.get("proxy_socks_module").SocksClient:this.meta.get("proxy_socks_module"),r=Number(t.protocol.replace(/\D/g,""))||5,a={proxy:{ipaddress:n,port:Number(t.port),type:r},[o?"destination":"target"]:{host:e.host,port:e.port},command:"connect"};if(t.auth){let e=decodeURIComponent(t.auth.split(":").shift()),i=decodeURIComponent(t.auth.split(":").pop());o?(a.proxy.userId=e,a.proxy.password=i):4===r?a.userid=e:a.authentication={username:e,password:i}}s.createConnection(a,((e,t)=>e?i(e):i(null,{connection:t.socket||t})))};return Qv.isIP(t.hostname)?n(t.hostname):Xv.resolve(t.hostname,((e,t)=>{if(e)return i(e);n(Array.isArray(t)?t[0]:t)}))}}i(new Error("Unknown proxy configuration"))}}_convertDataImages(e,t){if(!this.options.attachDataUrls&&!e.data.attachDataUrls||!e.data.html)return t();e.resolveContent(e.data,"html",((i,n)=>{if(i)return t(i);let o=0;n=(n||"").toString().replace(/(<img\b[^>]* src\s*=[\s"']*)(data:([^;]+);[^"'>\s]+)/gi,((t,i,n,s)=>{let r=Yv.randomBytes(10).toString("hex")+"@localhost";return e.data.attachments||(e.data.attachments=[]),Array.isArray(e.data.attachments)||(e.data.attachments=[].concat(e.data.attachments||[])),e.data.attachments.push({path:n,cid:r,filename:"image-"+ ++o+"."+qv.detectExtension(s)}),i+"cid:"+r})),e.data.html=n,t()}))}set(e,t){return this.meta.set(e,t)}get(e){return this.meta.get(e)}};const ex=B.default.Transform;var tx=class extends ex{constructor(e){super(e),this.options=e||{},this._curLine="",this.inByteCount=0,this.outByteCount=0,this.lastByte=!1}_transform(e,t,i){let n,o,s,r=[],a=0,c=0;if(!e||!e.length)return i();for("string"==typeof e&&(e=Buffer.from(e)),this.inByteCount+=e.length,n=0,o=e.length;n<o;n++)46===e[n]?(n&&10===e[n-1]||!n&&(!this.lastByte||10===this.lastByte))&&(s=e.slice(c,n+1),r.push(s),r.push(Buffer.from(".")),a+=s.length+1,c=n+1):10===e[n]&&(n&&13!==e[n-1]||!n&&13!==this.lastByte)&&(n>c?(s=e.slice(c,n),r.push(s),a+=s.length+2):a+=2,r.push(Buffer.from("\r\n")),c=n+1);a?(c<e.length&&(s=e.slice(c),r.push(s),a+=s.length),this.outByteCount+=a,this.push(Buffer.concat(r,a))):(this.outByteCount+=e.length,this.push(e)),this.lastByte=e[e.length-1],i()}_flush(e){let t;t=10===this.lastByte?Buffer.from(".\r\n"):13===this.lastByte?Buffer.from("\n.\r\n"):Buffer.from("\r\n.\r\n"),this.outByteCount+=t.length,this.push(t),e()}};const ix=dg,nx=F.default.EventEmitter,ox=$.default,sx=N.default,rx=P.default,ax=D.default,cx=tx,ux=B.default.PassThrough,lx=cg.exports;var px=class extends nx{constructor(e){super(e),this.id=ax.randomBytes(8).toString("base64").replace(/\W/g,""),this.stage="init",this.options=e||{},this.secureConnection=!!this.options.secure,this.alreadySecured=!!this.options.secured,this.port=Number(this.options.port)||(this.secureConnection?465:587),this.host=this.options.host||"localhost",void 0===this.options.secure&&465===this.port&&(this.secureConnection=!0),this.name=this.options.name||this._getHostname(),this.logger=lx.getLogger(this.options,{component:this.options.component||"smtp-connection",sid:this.id}),this.customAuth=new Map,Object.keys(this.options.customAuth||{}).forEach((e=>{let t=(e||"").toString().trim().toUpperCase();t&&this.customAuth.set(t,this.options.customAuth[e])})),this.version=ix.version,this.authenticated=!1,this.destroyed=!1,this.secure=!!this.secureConnection,this._remainder="",this._responseQueue=[],this.lastServerResponse=!1,this._socket=!1,this._supportedAuth=[],this.allowsAuth=!1,this._envelope=!1,this._supportedExtensions=[],this._maxAllowedSize=0,this._responseActions=[],this._recipientQueue=[],this._greetingTimeout=!1,this._connectionTimeout=!1,this._destroyed=!1,this._closing=!1,this._onSocketData=e=>this._onData(e),this._onSocketError=e=>this._onError(e,"ESOCKET",!1,"CONN"),this._onSocketClose=()=>this._onClose(),this._onSocketEnd=()=>this._onEnd(),this._onSocketTimeout=()=>this._onTimeout()}connect(e){if("function"==typeof e){this.once("connect",(()=>{this.logger.debug({tnx:"smtp"},"SMTP handshake finished"),e()}));const t=this._isDestroyedMessage("connect");if(t)return e(this._formatError(t,"ECONNECTION",!1,"CONN"))}let t={port:this.port,host:this.host};this.options.localAddress&&(t.localAddress=this.options.localAddress);let i=()=>{this._connectionTimeout=setTimeout((()=>{this._onError("Connection timeout","ETIMEDOUT",!1,"CONN")}),this.options.connectionTimeout||12e4),this._socket.on("error",this._onSocketError)};return this.options.connection?(this._socket=this.options.connection,void(this.secureConnection&&!this.alreadySecured?setImmediate((()=>this._upgradeConnection((e=>{e?this._onError(new Error("Error initiating TLS - "+(e.message||e)),"ETLS",!1,"CONN"):this._onConnect()})))):setImmediate((()=>this._onConnect())))):this.options.socket?(this._socket=this.options.socket,lx.resolveHostname(t,((e,n)=>{if(e)return setImmediate((()=>this._onError(e,"EDNS",!1,"CONN")));this.logger.debug({tnx:"dns",source:t.host,resolved:n.host,cached:!!n.cached},"Resolved %s as %s [cache %s]",t.host,n.host,n.cached?"hit":"miss"),Object.keys(n).forEach((e=>{"_"!==e.charAt(0)&&n[e]&&(t[e]=n[e])}));try{this._socket.connect(this.port,this.host,(()=>{this._socket.setKeepAlive(!0),this._onConnect()})),i()}catch(e){return setImmediate((()=>this._onError(e,"ECONNECTION",!1,"CONN")))}}))):this.secureConnection?(this.options.tls&&Object.keys(this.options.tls).forEach((e=>{t[e]=this.options.tls[e]})),lx.resolveHostname(t,((e,n)=>{if(e)return setImmediate((()=>this._onError(e,"EDNS",!1,"CONN")));this.logger.debug({tnx:"dns",source:t.host,resolved:n.host,cached:!!n.cached},"Resolved %s as %s [cache %s]",t.host,n.host,n.cached?"hit":"miss"),Object.keys(n).forEach((e=>{"_"!==e.charAt(0)&&n[e]&&(t[e]=n[e])}));try{this._socket=sx.connect(t,(()=>{this._socket.setKeepAlive(!0),this._onConnect()})),i()}catch(e){return setImmediate((()=>this._onError(e,"ECONNECTION",!1,"CONN")))}}))):lx.resolveHostname(t,((e,n)=>{if(e)return setImmediate((()=>this._onError(e,"EDNS",!1,"CONN")));this.logger.debug({tnx:"dns",source:t.host,resolved:n.host,cached:!!n.cached},"Resolved %s as %s [cache %s]",t.host,n.host,n.cached?"hit":"miss"),Object.keys(n).forEach((e=>{"_"!==e.charAt(0)&&n[e]&&(t[e]=n[e])}));try{this._socket=ox.connect(t,(()=>{this._socket.setKeepAlive(!0),this._onConnect()})),i()}catch(e){return setImmediate((()=>this._onError(e,"ECONNECTION",!1,"CONN")))}}))}quit(){this._sendCommand("QUIT"),this._responseActions.push(this.close)}close(){if(clearTimeout(this._connectionTimeout),clearTimeout(this._greetingTimeout),this._responseActions=[],this._closing)return;this._closing=!0;let e="end";"init"===this.stage&&(e="destroy"),this.logger.debug({tnx:"smtp"},'Closing connection to the server using "%s"',e);let t=this._socket&&this._socket.socket||this._socket;if(t&&!t.destroyed)try{this._socket[e]()}catch(e){}this._destroy()}login(e,t){const i=this._isDestroyedMessage("login");if(i)return t(this._formatError(i,"ECONNECTION",!1,"API"));if(this._auth=e||{},this._authMethod=(this._auth.method||"").toString().trim().toUpperCase()||!1,this._authMethod||!this._auth.oauth2||this._auth.credentials?this._authMethod&&("XOAUTH2"!==this._authMethod||this._auth.oauth2)||(this._authMethod=(this._supportedAuth[0]||"PLAIN").toUpperCase().trim()):this._authMethod="XOAUTH2",!("XOAUTH2"===this._authMethod||this._auth.credentials&&this._auth.credentials.user&&this._auth.credentials.pass)){if(!this._auth.user||!this._auth.pass)return t(this._formatError('Missing credentials for "'+this._authMethod+'"',"EAUTH",!1,"API"));this._auth.credentials={user:this._auth.user,pass:this._auth.pass,options:this._auth.options}}if(!this.customAuth.has(this._authMethod)){switch(this._authMethod){case"XOAUTH2":return void this._handleXOauth2Token(!1,t);case"LOGIN":return this._responseActions.push((e=>{this._actionAUTH_LOGIN_USER(e,t)})),void this._sendCommand("AUTH LOGIN");case"PLAIN":return this._responseActions.push((e=>{this._actionAUTHComplete(e,t)})),void this._sendCommand("AUTH PLAIN "+Buffer.from("\0"+this._auth.credentials.user+"\0"+this._auth.credentials.pass,"utf-8").toString("base64"),"AUTH PLAIN "+Buffer.from("\0"+this._auth.credentials.user+"\0/* secret */","utf-8").toString("base64"));case"CRAM-MD5":return this._responseActions.push((e=>{this._actionAUTH_CRAM_MD5(e,t)})),void this._sendCommand("AUTH CRAM-MD5")}return t(this._formatError('Unknown authentication method "'+this._authMethod+'"',"EAUTH",!1,"API"))}{let e,i=this.customAuth.get(this._authMethod),n=!1,o=()=>{n||(n=!0,this.logger.info({tnx:"smtp",username:this._auth.user,action:"authenticated",method:this._authMethod},"User %s authenticated",JSON.stringify(this._auth.user)),this.authenticated=!0,t(null,!0))},s=i=>{n||(n=!0,t(this._formatError(i,"EAUTH",e,"AUTH "+this._authMethod)))},r=i({auth:this._auth,method:this._authMethod,extensions:[].concat(this._supportedExtensions),authMethods:[].concat(this._supportedAuth),maxAllowedSize:this._maxAllowedSize||!1,sendCommand:(t,i)=>{let n;return i||(n=new Promise(((e,t)=>{i=lx.callbackPromise(e,t)}))),this._responseActions.push((n=>{e=n;let o=n.match(/^(\d+)(?:\s(\d+\.\d+\.\d+))?\s/),s={command:t,response:n};o?(s.status=Number(o[1])||0,o[2]&&(s.code=o[2]),s.text=n.substr(o[0].length)):(s.text=n,s.status=0),i(null,s)})),setImmediate((()=>this._sendCommand(t))),n},resolve:o,reject:s});r&&"function"==typeof r.catch&&r.then(o).catch(s)}}send(e,t,i){if(!t)return i(this._formatError("Empty message","EMESSAGE",!1,"API"));const n=this._isDestroyedMessage("send message");if(n)return i(this._formatError(n,"ECONNECTION",!1,"API"));if(this._maxAllowedSize&&e.size>this._maxAllowedSize)return setImmediate((()=>{i(this._formatError("Message size larger than allowed "+this._maxAllowedSize,"EMESSAGE",!1,"MAIL FROM"))}));let o=!1,s=function(){o||(o=!0,i(...arguments))};"function"==typeof t.on&&t.on("error",(e=>s(this._formatError(e,"ESTREAM",!1,"API"))));let r=Date.now();this._setEnvelope(e,((e,i)=>{if(e)return s(e);let n=Date.now(),o=this._createSendStream(((e,t)=>e?s(e):(i.envelopeTime=n-r,i.messageTime=Date.now()-n,i.messageSize=o.outByteCount,i.response=t,s(null,i))));"function"==typeof t.pipe?t.pipe(o):(o.write(t),o.end())}))}reset(e){this._sendCommand("RSET"),this._responseActions.push((t=>"2"!==t.charAt(0)?e(this._formatError("Could not reset session state. response="+t,"EPROTOCOL",t,"RSET")):(this._envelope=!1,e(null,!0))))}_onConnect(){clearTimeout(this._connectionTimeout),this.logger.info({tnx:"network",localAddress:this._socket.localAddress,localPort:this._socket.localPort,remoteAddress:this._socket.remoteAddress,remotePort:this._socket.remotePort},"%s established to %s:%s",this.secure?"Secure connection":"Connection",this._socket.remoteAddress,this._socket.remotePort),this._destroyed?this.close():(this.stage="connected",this._socket.removeListener("data",this._onSocketData),this._socket.removeListener("timeout",this._onSocketTimeout),this._socket.removeListener("close",this._onSocketClose),this._socket.removeListener("end",this._onSocketEnd),this._socket.on("data",this._onSocketData),this._socket.once("close",this._onSocketClose),this._socket.once("end",this._onSocketEnd),this._socket.setTimeout(this.options.socketTimeout||6e5),this._socket.on("timeout",this._onSocketTimeout),this._greetingTimeout=setTimeout((()=>{this._socket&&!this._destroyed&&this._responseActions[0]===this._actionGreeting&&this._onError("Greeting never received","ETIMEDOUT",!1,"CONN")}),this.options.greetingTimeout||3e4),this._responseActions.push(this._actionGreeting),this._socket.resume())}_onData(e){if(this._destroyed||!e||!e.length)return;let t,i=(e||"").toString("binary"),n=(this._remainder+i).split(/\r?\n/);this._remainder=n.pop();for(let e=0,i=n.length;e<i;e++)this._responseQueue.length&&(t=this._responseQueue[this._responseQueue.length-1],/^\d+-/.test(t.split("\n").pop()))?this._responseQueue[this._responseQueue.length-1]+="\n"+n[e]:this._responseQueue.push(n[e]);this._responseQueue.length&&(t=this._responseQueue[this._responseQueue.length-1],/^\d+-/.test(t.split("\n").pop()))||this._processResponse()}_onError(e,t,i,n){clearTimeout(this._connectionTimeout),clearTimeout(this._greetingTimeout),this._destroyed||(e=this._formatError(e,t,i,n),this.logger.error(i,e.message),this.emit("error",e),this.close())}_formatError(e,t,i,n){let o;o=/Error\]$/i.test(Object.prototype.toString.call(e))?e:new Error(e),t&&"Error"!==t&&(o.code=t),i&&(o.response=i,o.message+=": "+i);let s="string"==typeof i&&Number((i.match(/^\d+/)||[])[0])||!1;return s&&(o.responseCode=s),n&&(o.command=n),o}_onClose(){return this.logger.info({tnx:"network"},"Connection closed"),this.upgrading&&!this._destroyed?this._onError(new Error("Connection closed unexpectedly"),"ETLS",!1,"CONN"):[this._actionGreeting,this.close].includes(this._responseActions[0])||this._destroyed?void this._destroy():this._onError(new Error("Connection closed unexpectedly"),"ECONNECTION",!1,"CONN")}_onEnd(){this._socket&&!this._socket.destroyed&&this._socket.destroy()}_onTimeout(){return this._onError(new Error("Timeout"),"ETIMEDOUT",!1,"CONN")}_destroy(){this._destroyed||(this._destroyed=!0,this.emit("end"))}_upgradeConnection(e){this._socket.removeListener("data",this._onSocketData),this._socket.removeListener("timeout",this._onSocketTimeout);let t=this._socket,i={socket:this._socket,host:this.host};Object.keys(this.options.tls||{}).forEach((e=>{i[e]=this.options.tls[e]})),this.upgrading=!0;try{this._socket=sx.connect(i,(()=>(this.secure=!0,this.upgrading=!1,this._socket.on("data",this._onSocketData),t.removeListener("close",this._onSocketClose),t.removeListener("end",this._onSocketEnd),e(null,!0))))}catch(t){return e(t)}this._socket.on("error",this._onSocketError),this._socket.once("close",this._onSocketClose),this._socket.once("end",this._onSocketEnd),this._socket.setTimeout(this.options.socketTimeout||6e5),this._socket.on("timeout",this._onSocketTimeout),t.resume()}_processResponse(){if(!this._responseQueue.length)return!1;let e=this.lastServerResponse=(this._responseQueue.shift()||"").toString();if(/^\d+-/.test(e.split("\n").pop()))return;(this.options.debug||this.options.transactionLog)&&this.logger.debug({tnx:"server"},e.replace(/\r?\n$/,"")),e.trim()||setImmediate((()=>this._processResponse(!0)));let t=this._responseActions.shift();if("function"!=typeof t)return this._onError(new Error("Unexpected Response"),"EPROTOCOL",e,"CONN");t.call(this,e),setImmediate((()=>this._processResponse(!0)))}_sendCommand(e,t){if(!this._destroyed){if(this._socket.destroyed)return this.close();(this.options.debug||this.options.transactionLog)&&this.logger.debug({tnx:"client"},(t||e||"").toString().replace(/\r?\n$/,"")),this._socket.write(Buffer.from(e+"\r\n","utf-8"))}}_setEnvelope(e,t){let i=[],n=!1;if(this._envelope=e||{},this._envelope.from=(this._envelope.from&&this._envelope.from.address||this._envelope.from||"").toString().trim(),this._envelope.to=[].concat(this._envelope.to||[]).map((e=>(e&&e.address||e||"").toString().trim())),!this._envelope.to.length)return t(this._formatError("No recipients defined","EENVELOPE",!1,"API"));if(this._envelope.from&&/[\r\n<>]/.test(this._envelope.from))return t(this._formatError("Invalid sender "+JSON.stringify(this._envelope.from),"EENVELOPE",!1,"API"));/[\x80-\uFFFF]/.test(this._envelope.from)&&(n=!0);for(let e=0,i=this._envelope.to.length;e<i;e++){if(!this._envelope.to[e]||/[\r\n<>]/.test(this._envelope.to[e]))return t(this._formatError("Invalid recipient "+JSON.stringify(this._envelope.to[e]),"EENVELOPE",!1,"API"));/[\x80-\uFFFF]/.test(this._envelope.to[e])&&(n=!0)}if(this._envelope.rcptQueue=JSON.parse(JSON.stringify(this._envelope.to||[])),this._envelope.rejected=[],this._envelope.rejectedErrors=[],this._envelope.accepted=[],this._envelope.dsn)try{this._envelope.dsn=this._setDsnEnvelope(this._envelope.dsn)}catch(e){return t(this._formatError("Invalid DSN "+e.message,"EENVELOPE",!1,"API"))}this._responseActions.push((e=>{this._actionMAIL(e,t)})),n&&this._supportedExtensions.includes("SMTPUTF8")&&(i.push("SMTPUTF8"),this._usingSmtpUtf8=!0),this._envelope.use8BitMime&&this._supportedExtensions.includes("8BITMIME")&&(i.push("BODY=8BITMIME"),this._using8BitMime=!0),this._envelope.size&&this._supportedExtensions.includes("SIZE")&&i.push("SIZE="+this._envelope.size),this._envelope.dsn&&this._supportedExtensions.includes("DSN")&&(this._envelope.dsn.ret&&i.push("RET="+lx.encodeXText(this._envelope.dsn.ret)),this._envelope.dsn.envid&&i.push("ENVID="+lx.encodeXText(this._envelope.dsn.envid))),this._sendCommand("MAIL FROM:<"+this._envelope.from+">"+(i.length?" "+i.join(" "):""))}_setDsnEnvelope(e){let t=(e.ret||e.return||"").toString().toUpperCase()||null;if(t)switch(t){case"HDRS":case"HEADERS":t="HDRS";break;case"FULL":case"BODY":t="FULL"}if(t&&!["FULL","HDRS"].includes(t))throw new Error("ret: "+JSON.stringify(t));let i=(e.envid||e.id||"").toString()||null,n=e.notify||null;if(n){"string"==typeof n&&(n=n.split(",")),n=n.map((e=>e.trim().toUpperCase()));let e=["NEVER","SUCCESS","FAILURE","DELAY"];if(n.filter((t=>!e.includes(t))).length||n.length>1&&n.includes("NEVER"))throw new Error("notify: "+JSON.stringify(n.join(",")));n=n.join(",")}let o=(e.recipient||e.orcpt||"").toString()||null;return o&&o.indexOf(";")<0&&(o="rfc822;"+o),{ret:t,envid:i,notify:n,orcpt:o}}_getDsnRcptToArgs(){let e=[];return this._envelope.dsn&&this._supportedExtensions.includes("DSN")&&(this._envelope.dsn.notify&&e.push("NOTIFY="+lx.encodeXText(this._envelope.dsn.notify)),this._envelope.dsn.orcpt&&e.push("ORCPT="+lx.encodeXText(this._envelope.dsn.orcpt))),e.length?" "+e.join(" "):""}_createSendStream(e){let t,i=new cx;return this.options.lmtp?this._envelope.accepted.forEach(((t,i)=>{let n=i===this._envelope.accepted.length-1;this._responseActions.push((i=>{this._actionLMTPStream(t,n,i,e)}))})):this._responseActions.push((t=>{this._actionSMTPStream(t,e)})),i.pipe(this._socket,{end:!1}),this.options.debug&&(t=new ux,t.on("readable",(()=>{let e;for(;e=t.read();)this.logger.debug({tnx:"message"},e.toString("binary").replace(/\r?\n$/,""))})),i.pipe(t)),i.once("end",(()=>{this.logger.info({tnx:"message",inByteCount:i.inByteCount,outByteCount:i.outByteCount},"<%s bytes encoded mime message (source size %s bytes)>",i.outByteCount,i.inByteCount)})),i}_actionGreeting(e){clearTimeout(this._greetingTimeout),"220"===e.substr(0,3)?this.options.lmtp?(this._responseActions.push(this._actionLHLO),this._sendCommand("LHLO "+this.name)):(this._responseActions.push(this._actionEHLO),this._sendCommand("EHLO "+this.name)):this._onError(new Error("Invalid greeting. response="+e),"EPROTOCOL",e,"CONN")}_actionLHLO(e){"2"===e.charAt(0)?this._actionEHLO(e):this._onError(new Error("Invalid LHLO. response="+e),"EPROTOCOL",e,"LHLO")}_actionEHLO(e){let t;if("421"!==e.substr(0,3)){if("2"!==e.charAt(0))return this.options.requireTLS?void this._onError(new Error("EHLO failed but HELO does not support required STARTTLS. response="+e),"ECONNECTION",e,"EHLO"):(this._responseActions.push(this._actionHELO),void this._sendCommand("HELO "+this.name));if(!this.secure&&!this.options.ignoreTLS&&(/[ -]STARTTLS\b/im.test(e)||this.options.requireTLS))return this._sendCommand("STARTTLS"),void this._responseActions.push(this._actionSTARTTLS);/[ -]SMTPUTF8\b/im.test(e)&&this._supportedExtensions.push("SMTPUTF8"),/[ -]DSN\b/im.test(e)&&this._supportedExtensions.push("DSN"),/[ -]8BITMIME\b/im.test(e)&&this._supportedExtensions.push("8BITMIME"),/[ -]PIPELINING\b/im.test(e)&&this._supportedExtensions.push("PIPELINING"),/[ -]AUTH\b/i.test(e)&&(this.allowsAuth=!0),/[ -]AUTH(?:(\s+|=)[^\n]*\s+|\s+|=)PLAIN/i.test(e)&&this._supportedAuth.push("PLAIN"),/[ -]AUTH(?:(\s+|=)[^\n]*\s+|\s+|=)LOGIN/i.test(e)&&this._supportedAuth.push("LOGIN"),/[ -]AUTH(?:(\s+|=)[^\n]*\s+|\s+|=)CRAM-MD5/i.test(e)&&this._supportedAuth.push("CRAM-MD5"),/[ -]AUTH(?:(\s+|=)[^\n]*\s+|\s+|=)XOAUTH2/i.test(e)&&this._supportedAuth.push("XOAUTH2"),(t=e.match(/[ -]SIZE(?:[ \t]+(\d+))?/im))&&(this._supportedExtensions.push("SIZE"),this._maxAllowedSize=Number(t[1])||0),this.emit("connect")}else this._onError(new Error("Server terminates connection. response="+e),"ECONNECTION",e,"EHLO")}_actionHELO(e){"2"===e.charAt(0)?(this.allowsAuth=!0,this.emit("connect")):this._onError(new Error("Invalid HELO. response="+e),"EPROTOCOL",e,"HELO")}_actionSTARTTLS(e){if("2"!==e.charAt(0))return this.options.opportunisticTLS?(this.logger.info({tnx:"smtp"},"Failed STARTTLS upgrade, continuing unencrypted"),this.emit("connect")):void this._onError(new Error("Error upgrading connection with STARTTLS"),"ETLS",e,"STARTTLS");this._upgradeConnection(((e,t)=>{e?this._onError(new Error("Error initiating TLS - "+(e.message||e)),"ETLS",!1,"STARTTLS"):(this.logger.info({tnx:"smtp"},"Connection upgraded with STARTTLS"),t?this.options.lmtp?(this._responseActions.push(this._actionLHLO),this._sendCommand("LHLO "+this.name)):(this._responseActions.push(this._actionEHLO),this._sendCommand("EHLO "+this.name)):this.emit("connect"))}))}_actionAUTH_LOGIN_USER(e,t){/^334[ -]/.test(e)?(this._responseActions.push((e=>{this._actionAUTH_LOGIN_PASS(e,t)})),this._sendCommand(Buffer.from(this._auth.credentials.user+"","utf-8").toString("base64"))):t(this._formatError('Invalid login sequence while waiting for "334 VXNlcm5hbWU6"',"EAUTH",e,"AUTH LOGIN"))}_actionAUTH_CRAM_MD5(e,t){let i=e.match(/^334\s+(.+)$/),n="";if(!i)return t(this._formatError("Invalid login sequence while waiting for server challenge string","EAUTH",e,"AUTH CRAM-MD5"));n=i[1];let o=Buffer.from(n,"base64").toString("ascii"),s=ax.createHmac("md5",this._auth.credentials.pass);s.update(o);let r=this._auth.credentials.user+" "+s.digest("hex");this._responseActions.push((e=>{this._actionAUTH_CRAM_MD5_PASS(e,t)})),this._sendCommand(Buffer.from(r).toString("base64"),Buffer.from(this._auth.credentials.user+" /* secret */").toString("base64"))}_actionAUTH_CRAM_MD5_PASS(e,t){if(!e.match(/^235\s+/))return t(this._formatError('Invalid login sequence while waiting for "235"',"EAUTH",e,"AUTH CRAM-MD5"));this.logger.info({tnx:"smtp",username:this._auth.user,action:"authenticated",method:this._authMethod},"User %s authenticated",JSON.stringify(this._auth.user)),this.authenticated=!0,t(null,!0)}_actionAUTH_LOGIN_PASS(e,t){if(!/^334[ -]/.test(e))return t(this._formatError('Invalid login sequence while waiting for "334 UGFzc3dvcmQ6"',"EAUTH",e,"AUTH LOGIN"));this._responseActions.push((e=>{this._actionAUTHComplete(e,t)})),this._sendCommand(Buffer.from((this._auth.credentials.pass||"").toString(),"utf-8").toString("base64"),Buffer.from("/* secret */","utf-8").toString("base64"))}_actionAUTHComplete(e,t,i){return i||"function"!=typeof t||(i=t,t=!1),"334"===e.substr(0,3)?(this._responseActions.push((e=>{t||"XOAUTH2"!==this._authMethod?this._actionAUTHComplete(e,!0,i):setImmediate((()=>this._handleXOauth2Token(!0,i)))})),void this._sendCommand("")):"2"!==e.charAt(0)?(this.logger.info({tnx:"smtp",username:this._auth.user,action:"authfail",method:this._authMethod},"User %s failed to authenticate",JSON.stringify(this._auth.user)),i(this._formatError("Invalid login","EAUTH",e,"AUTH "+this._authMethod))):(this.logger.info({tnx:"smtp",username:this._auth.user,action:"authenticated",method:this._authMethod},"User %s authenticated",JSON.stringify(this._auth.user)),this.authenticated=!0,void i(null,!0))}_actionMAIL(e,t){let i,n;if(2!==Number(e.charAt(0)))return i=this._usingSmtpUtf8&&/^550 /.test(e)&&/[\x80-\uFFFF]/.test(this._envelope.from)?"Internationalized mailbox name not allowed":"Mail command failed",t(this._formatError(i,"EENVELOPE",e,"MAIL FROM"));if(!this._envelope.rcptQueue.length)return t(this._formatError("Can't send mail - no recipients defined","EENVELOPE",!1,"API"));if(this._recipientQueue=[],this._supportedExtensions.includes("PIPELINING"))for(;this._envelope.rcptQueue.length;)n=this._envelope.rcptQueue.shift(),this._recipientQueue.push(n),this._responseActions.push((e=>{this._actionRCPT(e,t)})),this._sendCommand("RCPT TO:<"+n+">"+this._getDsnRcptToArgs());else n=this._envelope.rcptQueue.shift(),this._recipientQueue.push(n),this._responseActions.push((e=>{this._actionRCPT(e,t)})),this._sendCommand("RCPT TO:<"+n+">"+this._getDsnRcptToArgs())}_actionRCPT(e,t){let i,n,o=this._recipientQueue.shift();if(2!==Number(e.charAt(0))?(i=this._usingSmtpUtf8&&/^553 /.test(e)&&/[\x80-\uFFFF]/.test(o)?"Internationalized mailbox name not allowed":"Recipient command failed",this._envelope.rejected.push(o),n=this._formatError(i,"EENVELOPE",e,"RCPT TO"),n.recipient=o,this._envelope.rejectedErrors.push(n)):this._envelope.accepted.push(o),this._envelope.rcptQueue.length||this._recipientQueue.length)this._envelope.rcptQueue.length&&(o=this._envelope.rcptQueue.shift(),this._recipientQueue.push(o),this._responseActions.push((e=>{this._actionRCPT(e,t)})),this._sendCommand("RCPT TO:<"+o+">"+this._getDsnRcptToArgs()));else{if(!(this._envelope.rejected.length<this._envelope.to.length))return n=this._formatError("Can't send mail - all recipients were rejected","EENVELOPE",e,"RCPT TO"),n.rejected=this._envelope.rejected,n.rejectedErrors=this._envelope.rejectedErrors,t(n);this._responseActions.push((e=>{this._actionDATA(e,t)})),this._sendCommand("DATA")}}_actionDATA(e,t){if(!/^[23]/.test(e))return t(this._formatError("Data command failed","EENVELOPE",e,"DATA"));let i={accepted:this._envelope.accepted,rejected:this._envelope.rejected};this._envelope.rejectedErrors.length&&(i.rejectedErrors=this._envelope.rejectedErrors),t(null,i)}_actionSMTPStream(e,t){return 2!==Number(e.charAt(0))?t(this._formatError("Message failed","EMESSAGE",e,"DATA")):t(null,e)}_actionLMTPStream(e,t,i,n){let o;if(2!==Number(i.charAt(0))){o=this._formatError("Message failed for recipient "+e,"EMESSAGE",i,"DATA"),o.recipient=e,this._envelope.rejected.push(e),this._envelope.rejectedErrors.push(o);for(let t=0,i=this._envelope.accepted.length;t<i;t++)this._envelope.accepted[t]===e&&this._envelope.accepted.splice(t,1)}if(t)return n(null,i)}_handleXOauth2Token(e,t){this._auth.oauth2.getToken(e,((i,n)=>{if(i)return this.logger.info({tnx:"smtp",username:this._auth.user,action:"authfail",method:this._authMethod},"User %s failed to authenticate",JSON.stringify(this._auth.user)),t(this._formatError(i,"EAUTH",!1,"AUTH XOAUTH2"));this._responseActions.push((i=>{this._actionAUTHComplete(i,e,t)})),this._sendCommand("AUTH XOAUTH2 "+this._auth.oauth2.buildXOAuth2Token(n),"AUTH XOAUTH2 "+this._auth.oauth2.buildXOAuth2Token("/* secret */"))}))}_isDestroyedMessage(e){if(this._destroyed)return"Cannot "+e+" - smtp connection is already destroyed.";if(this._socket){if(this._socket.destroyed)return"Cannot "+e+" - smtp connection socket is already destroyed.";if(!this._socket.writable)return"Cannot "+e+" - smtp connection socket is already half-closed."}}_getHostname(){let e=rx.hostname()||"";return e.indexOf(".")<0&&(e="[127.0.0.1]"),e.match(/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/)&&(e="["+e+"]"),e}};const dx=B.default.Stream,hx=ug.exports,mx=D.default,fx=cg.exports;var gx=class extends dx{constructor(e,t){if(super(),this.options=e||{},e&&e.serviceClient){if(!e.privateKey||!e.user)return void setImmediate((()=>this.emit("error",new Error('Options "privateKey" and "user" are required for service account!'))));let t=Math.min(Math.max(Number(this.options.serviceRequestTimeout)||0,0),3600);this.options.serviceRequestTimeout=t||300}if(this.logger=fx.getLogger({logger:t},{component:this.options.component||"OAuth2"}),this.provisionCallback="function"==typeof this.options.provisionCallback&&this.options.provisionCallback,this.options.accessUrl=this.options.accessUrl||"https://accounts.google.com/o/oauth2/token",this.options.customHeaders=this.options.customHeaders||{},this.options.customParams=this.options.customParams||{},this.accessToken=this.options.accessToken||!1,this.options.expires&&Number(this.options.expires))this.expires=this.options.expires;else{let e=Math.max(Number(this.options.timeout)||0,0);this.expires=e&&Date.now()+1e3*e||0}}getToken(e,t){if(!e&&this.accessToken&&(!this.expires||this.expires>Date.now()))return t(null,this.accessToken);let i=(...e)=>{e[0]?this.logger.error({err:e[0],tnx:"OAUTH2",user:this.options.user,action:"renew"},"Failed generating new Access Token for %s",this.options.user):this.logger.info({tnx:"OAUTH2",user:this.options.user,action:"renew"},"Generated new Access Token for %s",this.options.user),t(...e)};this.provisionCallback?this.provisionCallback(this.options.user,!!e,((e,t,n)=>{!e&&t&&(this.accessToken=t,this.expires=n||0),i(e,t)})):this.generateToken(i)}updateToken(e,t){this.accessToken=e,t=Math.max(Number(t)||0,0),this.expires=t&&Date.now()+1e3*t||0,this.emit("token",{user:this.options.user,accessToken:e||"",expires:this.expires})}generateToken(e){let t,i;if(this.options.serviceClient){let n,o=Math.floor(Date.now()/1e3),s={iss:this.options.serviceClient,scope:this.options.scope||"https://mail.google.com/",sub:this.options.user,aud:this.options.accessUrl,iat:o,exp:o+this.options.serviceRequestTimeout};try{n=this.jwtSignRS256(s)}catch(t){return e(new Error("Can't generate token. Check your auth options"))}t={grant_type:"urn:ietf:params:oauth:grant-type:jwt-bearer",assertion:n},i={grant_type:"urn:ietf:params:oauth:grant-type:jwt-bearer",assertion:s}}else{if(!this.options.refreshToken)return e(new Error("Can't create new access token for user"));t={client_id:this.options.clientId||"",client_secret:this.options.clientSecret||"",refresh_token:this.options.refreshToken,grant_type:"refresh_token"},i={client_id:this.options.clientId||"",client_secret:(this.options.clientSecret||"").substr(0,6)+"...",refresh_token:(this.options.refreshToken||"").substr(0,6)+"...",grant_type:"refresh_token"}}Object.keys(this.options.customParams).forEach((e=>{t[e]=this.options.customParams[e],i[e]=this.options.customParams[e]})),this.logger.debug({tnx:"OAUTH2",user:this.options.user,action:"generate"},"Requesting token using: %s",JSON.stringify(i)),this.postRequest(this.options.accessUrl,t,this.options,((t,i)=>{let n;if(t)return e(t);try{n=JSON.parse(i.toString())}catch(t){return e(t)}if(!n||"object"!=typeof n)return this.logger.debug({tnx:"OAUTH2",user:this.options.user,action:"post"},"Response: %s",(i||"").toString()),e(new Error("Invalid authentication response"));let o={};if(Object.keys(n).forEach((e=>{o[e]="access_token"!==e?n[e]:(n[e]||"").toString().substr(0,6)+"..."})),this.logger.debug({tnx:"OAUTH2",user:this.options.user,action:"post"},"Response: %s",JSON.stringify(o)),n.error){let t=n.error;return n.error_description&&(t+=": "+n.error_description),n.error_uri&&(t+=" ("+n.error_uri+")"),e(new Error(t))}return n.access_token?(this.updateToken(n.access_token,n.expires_in),e(null,this.accessToken)):e(new Error("No access token"))}))}buildXOAuth2Token(e){let t=["user="+(this.options.user||""),"auth=Bearer "+(e||this.accessToken),"",""];return Buffer.from(t.join(""),"utf-8").toString("base64")}postRequest(e,t,i,n){let o=!1,s=[],r=0,a=hx(e,{method:"post",headers:i.customHeaders,body:t,allowErrorResponse:!0});a.on("readable",(()=>{let e;for(;null!==(e=a.read());)s.push(e),r+=e.length})),a.once("error",(e=>{if(!o)return o=!0,n(e)})),a.once("end",(()=>{if(!o)return o=!0,n(null,Buffer.concat(s,r))}))}toBase64URL(e){return"string"==typeof e&&(e=Buffer.from(e)),e.toString("base64").replace(/[=]+/g,"").replace(/\+/g,"-").replace(/\//g,"_")}jwtSignRS256(e){e=['{"alg":"RS256","typ":"JWT"}',JSON.stringify(e)].map((e=>this.toBase64URL(e))).join(".");let t=mx.createSign("RSA-SHA256").update(e).sign(this.options.privateKey);return e+"."+this.toBase64URL(t)}};const vx=px,xx=cg.exports.assign,yx=gx,bx=F.default;var wx=class extends bx{constructor(e){if(super(),this.pool=e,this.options=e.options,this.logger=this.pool.logger,this.options.auth)switch((this.options.auth.type||"").toString().toUpperCase()){case"OAUTH2":{let e=new yx(this.options.auth,this.logger);e.provisionCallback=this.pool.mailer&&this.pool.mailer.get("oauth2_provision_cb")||e.provisionCallback,this.auth={type:"OAUTH2",user:this.options.auth.user,oauth2:e,method:"XOAUTH2"},e.on("token",(e=>this.pool.mailer.emit("token",e))),e.on("error",(e=>this.emit("error",e)));break}default:if(!this.options.auth.user&&!this.options.auth.pass)break;this.auth={type:(this.options.auth.type||"").toString().toUpperCase()||"LOGIN",user:this.options.auth.user,credentials:{user:this.options.auth.user||"",pass:this.options.auth.pass,options:this.options.auth.options},method:(this.options.auth.method||"").trim().toUpperCase()||this.options.authMethod||!1}}this._connection=!1,this._connected=!1,this.messages=0,this.available=!0}connect(e){this.pool.getSocket(this.options,((t,i)=>{if(t)return e(t);let n=!1,o=this.options;i&&i.connection&&(this.logger.info({tnx:"proxy",remoteAddress:i.connection.remoteAddress,remotePort:i.connection.remotePort,destHost:o.host||"",destPort:o.port||"",action:"connected"},"Using proxied socket from %s:%s to %s:%s",i.connection.remoteAddress,i.connection.remotePort,o.host||"",o.port||""),o=xx(!1,o),Object.keys(i).forEach((e=>{o[e]=i[e]}))),this.connection=new vx(o),this.connection.once("error",(t=>{if(this.emit("error",t),!n)return n=!0,e(t)})),this.connection.once("end",(()=>{if(this.close(),n)return;n=!0;let t=setTimeout((()=>{if(n)return;let t=new Error("Unexpected socket close");this.connection&&this.connection._socket&&this.connection._socket.upgrading&&(t.code="ETLS"),e(t)}),1e3);try{t.unref()}catch(e){}})),this.connection.connect((()=>{if(!n)return this.auth&&(this.connection.allowsAuth||o.forceAuth)?void this.connection.login(this.auth,(t=>{if(!n){if(n=!0,t)return this.connection.close(),this.emit("error",t),e(t);this._connected=!0,e(null,!0)}})):(n=!0,this._connected=!0,e(null,!0))}))}))}send(e,t){if(!this._connected)return this.connect((i=>i?t(i):this.send(e,t)));let i=e.message.getEnvelope(),n=e.message.messageId(),o=[].concat(i.to||[]);o.length>3&&o.push("...and "+o.splice(2).length+" more"),this.logger.info({tnx:"send",messageId:n,cid:this.id},"Sending message %s using #%s to <%s>",n,this.id,o.join(", ")),e.data.dsn&&(i.dsn=e.data.dsn),this.connection.send(i,e.message.createReadStream(),((e,o)=>{if(this.messages++,e)return this.connection.close(),this.emit("error",e),t(e);o.envelope={from:i.from,to:i.to},o.messageId=n,setImmediate((()=>{let e;this.messages>=this.options.maxMessages?(e=new Error("Resource exhausted"),e.code="EMAXLIMIT",this.connection.close(),this.emit("error",e)):this.pool._checkRateLimit((()=>{this.available=!0,this.emit("available")}))})),t(null,o)}))}close(){this._connected=!1,this.auth&&this.auth.oauth2&&this.auth.oauth2.removeAllListeners(),this.connection&&this.connection.close(),this.emit("close")}};const _x={126:{host:"smtp.126.com",port:465,secure:!0},163:{host:"smtp.163.com",port:465,secure:!0},"1und1":{host:"smtp.1und1.de",port:465,secure:!0,authMethod:"LOGIN"},AOL:{domains:["aol.com"],host:"smtp.aol.com",port:587},DebugMail:{host:"debugmail.io",port:25},DynectEmail:{aliases:["Dynect"],host:"smtp.dynect.net",port:25},Ethereal:{aliases:["ethereal.email"],host:"smtp.ethereal.email",port:587},FastMail:{domains:["fastmail.fm"],host:"smtp.fastmail.com",port:465,secure:!0},GandiMail:{aliases:["Gandi","Gandi Mail"],host:"mail.gandi.net",port:587},Gmail:{aliases:["Google Mail"],domains:["gmail.com","googlemail.com"],host:"smtp.gmail.com",port:465,secure:!0},Godaddy:{host:"smtpout.secureserver.net",port:25},GodaddyAsia:{host:"smtp.asia.secureserver.net",port:25},GodaddyEurope:{host:"smtp.europe.secureserver.net",port:25},"hot.ee":{host:"mail.hot.ee"},Hotmail:{aliases:["Outlook","Outlook.com","Hotmail.com"],domains:["hotmail.com","outlook.com"],host:"smtp-mail.outlook.com",port:587},iCloud:{aliases:["Me","Mac"],domains:["me.com","mac.com"],host:"smtp.mail.me.com",port:587},Infomaniak:{host:"mail.infomaniak.com",domains:["ik.me","ikmail.com","etik.com"],port:587},"mail.ee":{host:"smtp.mail.ee"},"Mail.ru":{host:"smtp.mail.ru",port:465,secure:!0},Maildev:{port:1025,ignoreTLS:!0},Mailgun:{host:"smtp.mailgun.org",port:465,secure:!0},Mailjet:{host:"in.mailjet.com",port:587},Mailosaur:{host:"mailosaur.io",port:25},Mailtrap:{host:"smtp.mailtrap.io",port:2525},Mandrill:{host:"smtp.mandrillapp.com",port:587},Naver:{host:"smtp.naver.com",port:587},One:{host:"send.one.com",port:465,secure:!0},OpenMailBox:{aliases:["OMB","openmailbox.org"],host:"smtp.openmailbox.org",port:465,secure:!0},Outlook365:{host:"smtp.office365.com",port:587,secure:!1},OhMySMTP:{host:"smtp.ohmysmtp.com",port:587,secure:!1},Postmark:{aliases:["PostmarkApp"],host:"smtp.postmarkapp.com",port:2525},"qiye.aliyun":{host:"smtp.mxhichina.com",port:"465",secure:!0},QQ:{domains:["qq.com"],host:"smtp.qq.com",port:465,secure:!0},QQex:{aliases:["QQ Enterprise"],domains:["exmail.qq.com"],host:"smtp.exmail.qq.com",port:465,secure:!0},SendCloud:{host:"smtpcloud.sohu.com",port:25},SendGrid:{host:"smtp.sendgrid.net",port:587},SendinBlue:{host:"smtp-relay.sendinblue.com",port:587},SendPulse:{host:"smtp-pulse.com",port:465,secure:!0},SES:{host:"email-smtp.us-east-1.amazonaws.com",port:465,secure:!0},"SES-US-EAST-1":{host:"email-smtp.us-east-1.amazonaws.com",port:465,secure:!0},"SES-US-WEST-2":{host:"email-smtp.us-west-2.amazonaws.com",port:465,secure:!0},"SES-EU-WEST-1":{host:"email-smtp.eu-west-1.amazonaws.com",port:465,secure:!0},Sparkpost:{aliases:["SparkPost","SparkPost Mail"],domains:["sparkpost.com"],host:"smtp.sparkpostmail.com",port:587,secure:!1},Tipimail:{host:"smtp.tipimail.com",port:587},Yahoo:{domains:["yahoo.com"],host:"smtp.mail.yahoo.com",port:465,secure:!0},Yandex:{domains:["yandex.ru"],host:"smtp.yandex.ru",port:465,secure:!0},Zoho:{host:"smtp.zoho.com",port:465,secure:!0,authMethod:"LOGIN"}},Dx={};function Ex(e){return e.replace(/[^a-zA-Z0-9.-]/g,"").toLowerCase()}function Cx(e){let t=["domains","aliases"],i={};return Object.keys(e).forEach((n=>{t.indexOf(n)<0&&(i[n]=e[n])})),i}Object.keys(_x).forEach((e=>{let t=_x[e];Dx[Ex(e)]=Cx(t),[].concat(t.aliases||[]).forEach((e=>{Dx[Ex(e)]=Cx(t)})),[].concat(t.domains||[]).forEach((e=>{Dx[Ex(e)]=Cx(t)}))}));var Ax=function(e){return e=Ex(e.split("@").pop()),Dx[e]||!1};const kx=F.default,Sx=wx,Fx=px,Tx=Ax,Bx=cg.exports,Ox=dg;var jx=class extends kx{constructor(e){let t;super(),"string"==typeof(e=e||{})&&(e={url:e});let i=e.service;"function"==typeof e.getSocket&&(this.getSocket=e.getSocket),e.url&&(t=Bx.parseConnectionUrl(e.url),i=i||t.service),this.options=Bx.assign(!1,e,t,i&&Tx(i)),this.options.maxConnections=this.options.maxConnections||5,this.options.maxMessages=this.options.maxMessages||100,this.logger=Bx.getLogger(this.options,{component:this.options.component||"smtp-pool"});let n=new Fx(this.options);this.name="SMTP (pool)",this.version=Ox.version+"[client:"+n.version+"]",this._rateLimit={counter:0,timeout:null,waiting:[],checkpoint:!1,delta:Number(this.options.rateDelta)||1e3,limit:Number(this.options.rateLimit)||0},this._closed=!1,this._queue=[],this._connections=[],this._connectionCounter=0,this.idling=!0,setImmediate((()=>{this.idling&&this.emit("idle")}))}getSocket(e,t){return setImmediate((()=>t(null,!1)))}send(e,t){return!this._closed&&(this._queue.push({mail:e,requeueAttempts:0,callback:t}),this.idling&&this._queue.length>=this.options.maxConnections&&(this.idling=!1),setImmediate((()=>this._processMessages())),!0)}close(){let e,t=this._connections.length;if(this._closed=!0,clearTimeout(this._rateLimit.timeout),!t&&!this._queue.length)return;for(let i=t-1;i>=0;i--)this._connections[i]&&this._connections[i].available&&(e=this._connections[i],e.close(),this.logger.info({tnx:"connection",cid:e.id,action:"removed"},"Connection #%s removed",e.id));if(t&&!this._connections.length&&this.logger.debug({tnx:"connection"},"All connections removed"),!this._queue.length)return;let i=()=>{if(!this._queue.length)return void this.logger.debug({tnx:"connection"},"Pending queue entries cleared");let t=this._queue.shift();if(t&&"function"==typeof t.callback)try{t.callback(new Error("Connection pool was closed"))}catch(t){this.logger.error({err:t,tnx:"callback",cid:e.id},"Callback error for #%s: %s",e.id,t.message)}setImmediate(i)};setImmediate(i)}_processMessages(){let e,t,i;if(this._closed)return;if(!this._queue.length)return void(this.idling||(this.idling=!0,this.emit("idle")));for(t=0,i=this._connections.length;t<i;t++)if(this._connections[t].available){e=this._connections[t];break}if(!e&&this._connections.length<this.options.maxConnections&&(e=this._createConnection()),!e)return void(this.idling=!1);!this.idling&&this._queue.length<this.options.maxConnections&&(this.idling=!0,this.emit("idle"));let n=e.queueEntry=this._queue.shift();n.messageId=(e.queueEntry.mail.message.getHeader("message-id")||"").replace(/[<>\s]/g,""),e.available=!1,this.logger.debug({tnx:"pool",cid:e.id,messageId:n.messageId,action:"assign"},"Assigned message <%s> to #%s (%s)",n.messageId,e.id,e.messages+1),this._rateLimit.limit&&(this._rateLimit.counter++,this._rateLimit.checkpoint||(this._rateLimit.checkpoint=Date.now())),e.send(n.mail,((t,i)=>{if(n===e.queueEntry){try{n.callback(t,i)}catch(t){this.logger.error({err:t,tnx:"callback",cid:e.id},"Callback error for #%s: %s",e.id,t.message)}e.queueEntry=!1}}))}_createConnection(){let e=new Sx(this);return e.id=++this._connectionCounter,this.logger.info({tnx:"pool",cid:e.id,action:"conection"},"Created new pool resource #%s",e.id),e.on("available",(()=>{this.logger.debug({tnx:"connection",cid:e.id,action:"available"},"Connection #%s became available",e.id),this._closed?this.close():this._processMessages()})),e.once("error",(t=>{if("EMAXLIMIT"!==t.code?this.logger.error({err:t,tnx:"pool",cid:e.id},"Pool Error for #%s: %s",e.id,t.message):this.logger.debug({tnx:"pool",cid:e.id,action:"maxlimit"},"Max messages limit exchausted for #%s",e.id),e.queueEntry){try{e.queueEntry.callback(t)}catch(t){this.logger.error({err:t,tnx:"callback",cid:e.id},"Callback error for #%s: %s",e.id,t.message)}e.queueEntry=!1}this._removeConnection(e),this._continueProcessing()})),e.once("close",(()=>{this.logger.info({tnx:"connection",cid:e.id,action:"closed"},"Connection #%s was closed",e.id),this._removeConnection(e),e.queueEntry?setTimeout((()=>{e.queueEntry&&(this._shouldRequeuOnConnectionClose(e.queueEntry)?this._requeueEntryOnConnectionClose(e):this._failDeliveryOnConnectionClose(e)),this._continueProcessing()}),50):this._continueProcessing()})),this._connections.push(e),e}_shouldRequeuOnConnectionClose(e){return void 0===this.options.maxRequeues||this.options.maxRequeues<0||e.requeueAttempts<this.options.maxRequeues}_failDeliveryOnConnectionClose(e){if(e.queueEntry&&e.queueEntry.callback){try{e.queueEntry.callback(new Error("Reached maximum number of retries after connection was closed"))}catch(t){this.logger.error({err:t,tnx:"callback",messageId:e.queueEntry.messageId,cid:e.id},"Callback error for #%s: %s",e.id,t.message)}e.queueEntry=!1}}_requeueEntryOnConnectionClose(e){e.queueEntry.requeueAttempts=e.queueEntry.requeueAttempts+1,this.logger.debug({tnx:"pool",cid:e.id,messageId:e.queueEntry.messageId,action:"requeue"},"Re-queued message <%s> for #%s. Attempt: #%s",e.queueEntry.messageId,e.id,e.queueEntry.requeueAttempts),this._queue.unshift(e.queueEntry),e.queueEntry=!1}_continueProcessing(){this._closed?this.close():setTimeout((()=>this._processMessages()),100)}_removeConnection(e){let t=this._connections.indexOf(e);-1!==t&&this._connections.splice(t,1)}_checkRateLimit(e){if(!this._rateLimit.limit)return e();let t=Date.now();return this._rateLimit.counter<this._rateLimit.limit?e():(this._rateLimit.waiting.push(e),this._rateLimit.checkpoint<=t-this._rateLimit.delta?this._clearRateLimit():void(this._rateLimit.timeout||(this._rateLimit.timeout=setTimeout((()=>this._clearRateLimit()),this._rateLimit.delta-(t-this._rateLimit.checkpoint)),this._rateLimit.checkpoint=t)))}_clearRateLimit(){for(clearTimeout(this._rateLimit.timeout),this._rateLimit.timeout=null,this._rateLimit.counter=0,this._rateLimit.checkpoint=!1;this._rateLimit.waiting.length;){let e=this._rateLimit.waiting.shift();setImmediate(e)}}isIdle(){return this.idling}verify(e){let t;e||(t=new Promise(((t,i)=>{e=Bx.callbackPromise(t,i)})));let i=new Sx(this).auth;return this.getSocket(this.options,((t,n)=>{if(t)return e(t);let o=this.options;n&&n.connection&&(this.logger.info({tnx:"proxy",remoteAddress:n.connection.remoteAddress,remotePort:n.connection.remotePort,destHost:o.host||"",destPort:o.port||"",action:"connected"},"Using proxied socket from %s:%s to %s:%s",n.connection.remoteAddress,n.connection.remotePort,o.host||"",o.port||""),o=Bx.assign(!1,o),Object.keys(n).forEach((e=>{o[e]=n[e]})));let s=new Fx(o),r=!1;s.once("error",(t=>{if(!r)return r=!0,s.close(),e(t)})),s.once("end",(()=>{if(!r)return r=!0,e(new Error("Connection closed"))}));let a=()=>{if(!r)return r=!0,s.quit(),e(null,!0)};s.connect((()=>{r||(i&&(s.allowsAuth||o.forceAuth)?s.login(i,(t=>{if(!r)return t?(r=!0,s.close(),e(t)):void a()})):a())}))})),t}};const Ix=F.default,Px=px,Lx=Ax,Rx=cg.exports,Nx=gx,$x=dg;var Hx=class extends Ix{constructor(e){let t;super(),"string"==typeof(e=e||{})&&(e={url:e});let i=e.service;"function"==typeof e.getSocket&&(this.getSocket=e.getSocket),e.url&&(t=Rx.parseConnectionUrl(e.url),i=i||t.service),this.options=Rx.assign(!1,e,t,i&&Lx(i)),this.logger=Rx.getLogger(this.options,{component:this.options.component||"smtp-transport"});let n=new Px(this.options);this.name="SMTP",this.version=$x.version+"[client:"+n.version+"]",this.options.auth&&(this.auth=this.getAuth({}))}getSocket(e,t){return setImmediate((()=>t(null,!1)))}getAuth(e){if(!e)return this.auth;let t=!1,i={};if(this.options.auth&&"object"==typeof this.options.auth&&Object.keys(this.options.auth).forEach((e=>{t=!0,i[e]=this.options.auth[e]})),e&&"object"==typeof e&&Object.keys(e).forEach((n=>{t=!0,i[n]=e[n]})),!t)return!1;if("OAUTH2"===(i.type||"").toString().toUpperCase()){if(!i.service&&!i.user)return!1;let e=new Nx(i,this.logger);return e.provisionCallback=this.mailer&&this.mailer.get("oauth2_provision_cb")||e.provisionCallback,e.on("token",(e=>this.mailer.emit("token",e))),e.on("error",(e=>this.emit("error",e))),{type:"OAUTH2",user:i.user,oauth2:e,method:"XOAUTH2"}}return{type:(i.type||"").toString().toUpperCase()||"LOGIN",user:i.user,credentials:{user:i.user||"",pass:i.pass,options:i.options},method:(i.method||"").trim().toUpperCase()||this.options.authMethod||!1}}send(e,t){this.getSocket(this.options,((i,n)=>{if(i)return t(i);let o=!1,s=this.options;n&&n.connection&&(this.logger.info({tnx:"proxy",remoteAddress:n.connection.remoteAddress,remotePort:n.connection.remotePort,destHost:s.host||"",destPort:s.port||"",action:"connected"},"Using proxied socket from %s:%s to %s:%s",n.connection.remoteAddress,n.connection.remotePort,s.host||"",s.port||""),s=Rx.assign(!1,s),Object.keys(n).forEach((e=>{s[e]=n[e]})));let r=new Px(s);r.once("error",(e=>{if(!o)return o=!0,r.close(),t(e)})),r.once("end",(()=>{if(o)return;let e=setTimeout((()=>{if(o)return;o=!0;let e=new Error("Unexpected socket close");r&&r._socket&&r._socket.upgrading&&(e.code="ETLS"),t(e)}),1e3);try{e.unref()}catch(e){}}));let a=()=>{let i=e.message.getEnvelope(),n=e.message.messageId(),s=[].concat(i.to||[]);s.length>3&&s.push("...and "+s.splice(2).length+" more"),e.data.dsn&&(i.dsn=e.data.dsn),this.logger.info({tnx:"send",messageId:n},"Sending message %s to <%s>",n,s.join(", ")),r.send(i,e.message.createReadStream(),((e,s)=>{if(o=!0,r.close(),e)return this.logger.error({err:e,tnx:"send"},"Send error for %s: %s",n,e.message),t(e);s.envelope={from:i.from,to:i.to},s.messageId=n;try{return t(null,s)}catch(e){this.logger.error({err:e,tnx:"callback"},"Callback error for %s: %s",n,e.message)}}))};r.connect((()=>{if(o)return;let i=this.getAuth(e.data.auth);i&&(r.allowsAuth||s.forceAuth)?r.login(i,(e=>{if(i&&i!==this.auth&&i.oauth2&&i.oauth2.removeAllListeners(),!o)return e?(o=!0,r.close(),t(e)):void a()})):a()}))}))}verify(e){let t;return e||(t=new Promise(((t,i)=>{e=Rx.callbackPromise(t,i)}))),this.getSocket(this.options,((t,i)=>{if(t)return e(t);let n=this.options;i&&i.connection&&(this.logger.info({tnx:"proxy",remoteAddress:i.connection.remoteAddress,remotePort:i.connection.remotePort,destHost:n.host||"",destPort:n.port||"",action:"connected"},"Using proxied socket from %s:%s to %s:%s",i.connection.remoteAddress,i.connection.remotePort,n.host||"",n.port||""),n=Rx.assign(!1,n),Object.keys(i).forEach((e=>{n[e]=i[e]})));let o=new Px(n),s=!1;o.once("error",(t=>{if(!s)return s=!0,o.close(),e(t)})),o.once("end",(()=>{if(!s)return s=!0,e(new Error("Connection closed"))}));let r=()=>{if(!s)return s=!0,o.quit(),e(null,!0)};o.connect((()=>{if(s)return;let t=this.getAuth({});t&&(o.allowsAuth||n.forceAuth)?o.login(t,(t=>{if(!s)return t?(s=!0,o.close(),e(t)):void r()})):r()}))})),t}close(){this.auth&&this.auth.oauth2&&this.auth.oauth2.removeAllListeners(),this.emit("close")}};const Ux=U.default.spawn,qx=dg,Mx=cg.exports;var zx=class{constructor(e){e=e||{},this._spawn=Ux,this.options=e||{},this.name="Sendmail",this.version=qx.version,this.path="sendmail",this.args=!1,this.winbreak=!1,this.logger=Mx.getLogger(this.options,{component:this.options.component||"sendmail"}),e&&("string"==typeof e?this.path=e:"object"==typeof e&&(e.path&&(this.path=e.path),Array.isArray(e.args)&&(this.args=e.args),this.winbreak=["win","windows","dos","\r\n"].includes((e.newline||"").toString().toLowerCase())))}send(e,t){e.message.keepBcc=!0;let i,n,o,s=e.data.envelope||e.message.getEnvelope(),r=e.message.messageId();if([].concat(s.from||[]).concat(s.to||[]).some((e=>/^-/.test(e))))return t(new Error("Can not send mail. Invalid envelope addresses."));i=this.args?["-i"].concat(this.args).concat(s.to):["-i"].concat(s.from?["-f",s.from]:[]).concat(s.to);let a=i=>{if(!o)return o=!0,"function"==typeof t?i?t(i):t(null,{envelope:e.data.envelope||e.message.getEnvelope(),messageId:r,response:"Messages queued for delivery"}):void 0};try{n=this._spawn(this.path,i)}catch(e){return this.logger.error({err:e,tnx:"spawn",messageId:r},"Error occurred while spawning sendmail. %s",e.message),a(e)}if(!n)return a(new Error("sendmail was not found"));{n.on("error",(e=>{this.logger.error({err:e,tnx:"spawn",messageId:r},"Error occurred when sending message %s. %s",r,e.message),a(e)})),n.once("exit",(e=>{if(!e)return a();let t;t=127===e?new Error("Sendmail command not found, process exited with code "+e):new Error("Sendmail exited with code "+e),this.logger.error({err:t,tnx:"stdin",messageId:r},"Error sending message %s to sendmail. %s",r,t.message),a(t)})),n.once("close",a),n.stdin.on("error",(e=>{this.logger.error({err:e,tnx:"stdin",messageId:r},"Error occurred when piping message %s to sendmail. %s",r,e.message),a(e)}));let t=[].concat(s.to||[]);t.length>3&&t.push("...and "+t.splice(2).length+" more"),this.logger.info({tnx:"send",messageId:r},"Sending message %s to <%s>",r,t.join(", "));let i=e.message.createReadStream();i.once("error",(e=>{this.logger.error({err:e,tnx:"stdin",messageId:r},"Error occurred when generating message %s. %s",r,e.message),n.kill("SIGINT"),a(e)})),i.pipe(n.stdin)}}};const Gx=dg,Vx=cg.exports;var Wx=class{constructor(e){e=e||{},this.options=e||{},this.name="StreamTransport",this.version=Gx.version,this.logger=Vx.getLogger(this.options,{component:this.options.component||"stream-transport"}),this.winbreak=["win","windows","dos","\r\n"].includes((e.newline||"").toString().toLowerCase())}send(e,t){e.message.keepBcc=!0;let i=e.data.envelope||e.message.getEnvelope(),n=e.message.messageId(),o=[].concat(i.to||[]);o.length>3&&o.push("...and "+o.splice(2).length+" more"),this.logger.info({tnx:"send",messageId:n},"Sending message %s to <%s> using %s line breaks",n,o.join(", "),this.winbreak?"<CR><LF>":"<LF>"),setImmediate((()=>{let i;try{i=e.message.createReadStream()}catch(e){return this.logger.error({err:e,tnx:"send",messageId:n},"Creating send stream failed for %s. %s",n,e.message),t(e)}if(!this.options.buffer)return i.once("error",(e=>{this.logger.error({err:e,tnx:"send",messageId:n},"Failed creating message for %s. %s",n,e.message)})),t(null,{envelope:e.data.envelope||e.message.getEnvelope(),messageId:n,message:i});let o=[],s=0;i.on("readable",(()=>{let e;for(;null!==(e=i.read());)o.push(e),s+=e.length})),i.once("error",(e=>(this.logger.error({err:e,tnx:"send",messageId:n},"Failed creating message for %s. %s",n,e.message),t(e)))),i.on("end",(()=>t(null,{envelope:e.data.envelope||e.message.getEnvelope(),messageId:n,message:Buffer.concat(o,s)})))}))}};const Jx=dg,Kx=cg.exports;var Qx=class{constructor(e){e=e||{},this.options=e||{},this.name="JSONTransport",this.version=Jx.version,this.logger=Kx.getLogger(this.options,{component:this.options.component||"json-transport"})}send(e,t){e.message.keepBcc=!0;let i=e.data.envelope||e.message.getEnvelope(),n=e.message.messageId(),o=[].concat(i.to||[]);o.length>3&&o.push("...and "+o.splice(2).length+" more"),this.logger.info({tnx:"send",messageId:n},"Composing JSON structure of %s to <%s>",n,o.join(", ")),setImmediate((()=>{e.normalize(((e,o)=>e?(this.logger.error({err:e,tnx:"send",messageId:n},"Failed building JSON structure for %s. %s",n,e.message),t(e)):(delete o.envelope,delete o.normalizedHeaders,t(null,{envelope:i,messageId:n,message:this.options.skipEncoding?o:JSON.stringify(o)}))))}))}};const Xx=F.default,Yx=dg,Zx=cg.exports,ey=zg;var ty=class extends Xx{constructor(e){super(),e=e||{},this.options=e||{},this.ses=this.options.SES,this.name="SESTransport",this.version=Yx.version,this.logger=Zx.getLogger(this.options,{component:this.options.component||"ses-transport"}),this.maxConnections=Number(this.options.maxConnections)||1/0,this.connections=0,this.sendingRate=Number(this.options.sendingRate)||1/0,this.sendingRateTTL=null,this.rateInterval=1e3,this.rateMessages=[],this.pending=[],this.idling=!0,setImmediate((()=>{this.idling&&this.emit("idle")}))}send(e,t){return this.connections>=this.maxConnections?(this.idling=!1,this.pending.push({mail:e,callback:t})):this._checkSendingRate()?void this._send(e,((...e)=>{setImmediate((()=>t(...e))),this._sent()})):(this.idling=!1,this.pending.push({mail:e,callback:t}))}_checkRatedQueue(){if(this.connections>=this.maxConnections||!this._checkSendingRate())return;if(!this.pending.length)return void(this.idling||(this.idling=!0,this.emit("idle")));let e=this.pending.shift();this._send(e.mail,((...t)=>{setImmediate((()=>e.callback(...t))),this._sent()}))}_checkSendingRate(){clearTimeout(this.sendingRateTTL);let e=Date.now(),t=!1;for(let i=this.rateMessages.length-1;i>=0;i--)this.rateMessages[i].ts>=e-this.rateInterval&&(!t||this.rateMessages[i].ts<t)&&(t=this.rateMessages[i].ts),this.rateMessages[i].ts<e-this.rateInterval&&!this.rateMessages[i].pending&&this.rateMessages.splice(i,1);if(this.rateMessages.length<this.sendingRate)return!0;let i=Math.max(t+1001,e+20);this.sendingRateTTL=setTimeout((()=>this._checkRatedQueue()),e-i);try{this.sendingRateTTL.unref()}catch(e){}return!1}_sent(){this.connections--,this._checkRatedQueue()}isIdle(){return this.idling}_send(e,t){let i={ts:Date.now(),pending:!0};this.connections++,this.rateMessages.push(i);let n=e.data.envelope||e.message.getEnvelope(),o=e.message.messageId(),s=[].concat(n.to||[]);s.length>3&&s.push("...and "+s.splice(2).length+" more"),this.logger.info({tnx:"send",messageId:o},"Sending message %s to <%s>",o,s.join(", "));setImmediate((()=>(t=>{e.data._dkim||(e.data._dkim={}),e.data._dkim.skipFields&&"string"==typeof e.data._dkim.skipFields?e.data._dkim.skipFields+=":date:message-id":e.data._dkim.skipFields="date:message-id";let i=e.message.createReadStream(),n=i.pipe(new ey),o=[],s=0;n.on("readable",(()=>{let e;for(;null!==(e=n.read());)o.push(e),s+=e.length})),i.once("error",(e=>n.emit("error",e))),n.once("error",(e=>{t(e)})),n.once("end",(()=>t(null,Buffer.concat(o,s))))})(((s,r)=>{if(s)return this.logger.error({err:s,tnx:"send",messageId:o},"Failed creating message for %s. %s",o,s.message),i.pending=!1,t(s);let a={RawMessage:{Data:r},Source:n.from,Destinations:n.to};Object.keys(e.data.ses||{}).forEach((t=>{a[t]=e.data.ses[t]}));let c=(this.ses.aws?this.ses.ses:this.ses)||{},u=this.ses.aws||{};var l;l=(e,s)=>{let l;!e&&s||(s="us-east-1"),l="function"==typeof c.send&&u.SendRawEmailCommand?c.send(new u.SendRawEmailCommand(a)):c.sendRawEmail(a).promise(),l.then((e=>{"us-east-1"===s&&(s="email"),i.pending=!1,t(null,{envelope:{from:n.from,to:n.to},messageId:"<"+e.MessageId+(/@/.test(e.MessageId)?"":"@"+s+".amazonses.com")+">",response:e.MessageId,raw:r})})).catch((e=>{this.logger.error({err:e,tnx:"send"},"Send error for %s: %s",o,e.message),i.pending=!1,t(e)}))},c.config&&"function"==typeof c.config.region?c.config.region().then((e=>l(null,e))).catch((e=>l(e))):l(null,c.config&&c.config.region||"us-east-1")}))))}verify(e){let t,i=(this.ses.aws?this.ses.ses:this.ses)||{},n=this.ses.aws||{};const o={RawMessage:{Data:"From: invalid@invalid\r\nTo: invalid@invalid\r\n Subject: Invalid\r\n\r\nInvalid"},Source:"invalid@invalid",Destinations:["invalid@invalid"]};e||(t=new Promise(((t,i)=>{e=Zx.callbackPromise(t,i)})));const s=t=>t&&"InvalidParameterValue"!==(t.code||t.Code)?e(t):e(null,!0);return"function"==typeof i.send&&n.SendRawEmailCommand?(o.RawMessage.Data=Buffer.from(o.RawMessage.Data),i.send(new n.SendRawEmailCommand(o),s)):i.sendRawEmail(o,s),t}};const iy=Zv,ny=cg.exports,oy=jx,sy=Hx,ry=zx,ay=Wx,cy=Qx,uy=ty,ly=ug.exports,py=dg,dy=(process.env.ETHEREAL_API||"https://api.nodemailer.com").replace(/\/+$/,""),hy=(process.env.ETHEREAL_WEB||"https://ethereal.email").replace(/\/+$/,""),my=["true","yes","y","1"].includes((process.env.ETHEREAL_CACHE||"yes").toString().trim().toLowerCase());let fy=!1;var gy,vy=ag.createTransport=function(e,t){let i,n,o;return("object"==typeof e&&"function"!=typeof e.send||"string"==typeof e&&/^(smtps?|direct):/i.test(e))&&(n=(i="string"==typeof e?e:e.url)?ny.parseConnectionUrl(i):e,e=n.pool?new oy(n):n.sendmail?new ry(n):n.streamTransport?new ay(n):n.jsonTransport?new cy(n):n.SES?new uy(n):new sy(n)),o=new iy(e,n,t),o},xy=ag.createTestAccount=function(e,t){let i;if(t||"function"!=typeof e||(t=e,e=!1),t||(i=new Promise(((e,i)=>{t=ny.callbackPromise(e,i)}))),my&&fy)return setImmediate((()=>t(null,fy))),i;let n=[],o=0,s=ly((e=e||dy)+"/user",{contentType:"application/json",method:"POST",body:Buffer.from(JSON.stringify({requestor:py.name,version:py.version}))});return s.on("readable",(()=>{let e;for(;null!==(e=s.read());)n.push(e),o+=e.length})),s.once("error",(e=>t(e))),s.once("end",(()=>{let e,i,s=Buffer.concat(n,o);try{e=JSON.parse(s.toString())}catch(e){i=e}return i?t(i):"success"!==e.status||e.error?t(new Error(e.error||"Request failed")):(delete e.status,fy=e,void t(null,fy))})),i},yy=ag.getTestMessageUrl=function(e){if(!e||!e.response)return!1;let t=new Map;return e.response.replace(/\[([^\]]+)\]$/,((e,i)=>{i.replace(/\b([A-Z0-9]+)=([^\s]+)/g,((e,i,n)=>{t.set(i,n)}))})),!(!t.has("STATUS")||!t.has("MSGID"))&&(fy.web||hy)+"/message/"+t.get("MSGID")},by=b({__proto__:null,createTransport:vy,createTestAccount:xy,getTestMessageUrl:yy,default:ag},[ag]),wy={exports:{}},_y={},Dy=N.default,Ey=O.default,Cy=j.default,Ay=F.default,ky=T.default;function Sy(e){var t=this;t.options=e||{},t.proxyOptions=t.options.proxy||{},t.maxSockets=t.options.maxSockets||Ey.Agent.defaultMaxSockets,t.requests=[],t.sockets=[],t.on("free",(function(e,i,n,o){for(var s=Ty(i,n,o),r=0,a=t.requests.length;r<a;++r){var c=t.requests[r];if(c.host===s.host&&c.port===s.port)return t.requests.splice(r,1),void c.request.onSocket(e)}e.destroy(),t.removeSocket(e)}))}function Fy(e,t){var i=this;Sy.prototype.createSocket.call(i,e,(function(n){var o=e.request.getHeader("host"),s=By({},i.options,{socket:n,servername:o?o.replace(/:.*$/,""):e.host}),r=Dy.connect(0,s);i.sockets[i.sockets.indexOf(n)]=r,t(r)}))}function Ty(e,t,i){return"string"==typeof e?{host:e,port:t,localAddress:i}:e}function By(e){for(var t=1,i=arguments.length;t<i;++t){var n=arguments[t];if("object"==typeof n)for(var o=Object.keys(n),s=0,r=o.length;s<r;++s){var a=o[s];void 0!==n[a]&&(e[a]=n[a])}}return e}_y.httpOverHttp=function(e){var t=new Sy(e);return t.request=Ey.request,t},_y.httpsOverHttp=function(e){var t=new Sy(e);return t.request=Ey.request,t.createSocket=Fy,t.defaultPort=443,t},_y.httpOverHttps=function(e){var t=new Sy(e);return t.request=Cy.request,t},_y.httpsOverHttps=function(e){var t=new Sy(e);return t.request=Cy.request,t.createSocket=Fy,t.defaultPort=443,t},ky.inherits(Sy,Ay.EventEmitter),Sy.prototype.addRequest=function(e,t,i,n){var o=this,s=By({request:e},o.options,Ty(t,i,n));o.sockets.length>=this.maxSockets?o.requests.push(s):o.createSocket(s,(function(t){function i(){o.emit("free",t,s)}function n(e){o.removeSocket(t),t.removeListener("free",i),t.removeListener("close",n),t.removeListener("agentRemove",n)}t.on("free",i),t.on("close",n),t.on("agentRemove",n),e.onSocket(t)}))},Sy.prototype.createSocket=function(e,t){var i=this,n={};i.sockets.push(n);var o=By({},i.proxyOptions,{method:"CONNECT",path:e.host+":"+e.port,agent:!1,headers:{host:e.host+":"+e.port}});e.localAddress&&(o.localAddress=e.localAddress),o.proxyAuth&&(o.headers=o.headers||{},o.headers["Proxy-Authorization"]="Basic "+new Buffer(o.proxyAuth).toString("base64")),gy("making CONNECT request");var s=i.request(o);function r(o,r,a){var c;return s.removeAllListeners(),r.removeAllListeners(),200!==o.statusCode?(gy("tunneling socket could not be established, statusCode=%d",o.statusCode),r.destroy(),(c=new Error("tunneling socket could not be established, statusCode="+o.statusCode)).code="ECONNRESET",e.request.emit("error",c),void i.removeSocket(n)):a.length>0?(gy("got illegal response body from proxy"),r.destroy(),(c=new Error("got illegal response body from proxy")).code="ECONNRESET",e.request.emit("error",c),void i.removeSocket(n)):(gy("tunneling connection has established"),i.sockets[i.sockets.indexOf(n)]=r,t(r))}s.useChunkedEncodingByDefault=!1,s.once("response",(function(e){e.upgrade=!0})),s.once("upgrade",(function(e,t,i){process.nextTick((function(){r(e,t,i)}))})),s.once("connect",r),s.once("error",(function(t){s.removeAllListeners(),gy("tunneling socket could not be established, cause=%s\n",t.message,t.stack);var o=new Error("tunneling socket could not be established, cause="+t.message);o.code="ECONNRESET",e.request.emit("error",o),i.removeSocket(n)})),s.end()},Sy.prototype.removeSocket=function(e){var t=this.sockets.indexOf(e);if(-1!==t){this.sockets.splice(t,1);var i=this.requests.shift();i&&this.createSocket(i,(function(e){i.request.onSocket(e)}))}},gy=process.env.NODE_DEBUG&&/\btunnel\b/.test(process.env.NODE_DEBUG)?function(){var e=Array.prototype.slice.call(arguments);"string"==typeof e[0]?e[0]="TUNNEL: "+e[0]:e.unshift("TUNNEL:"),console.error.apply(console,e)}:function(){},_y.debug=gy;var Oy=b({__proto__:null,default:M(wy.exports=_y)},[wy.exports]);
